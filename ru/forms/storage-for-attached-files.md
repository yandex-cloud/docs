# Сохранять прикрепленные файлы из ответов в хранилище

Если форма подразумевает, что пользователи прикрепляют в ответах [файлы](blocks-ref/file.md), вы можете настроить сохранение этих файлов во внешнем хранилище, например, в [бакетах](../storage/concepts/bucket.md) {{ objstorage-full-name }} или на Яндекс Диске. Благодаря этому вы сможете:

* Управлять файлами в хранилище и настраивать для них автоматизации.
* Выбирать условия хранения и удаления файлов. Если не использовать хранилище, то файлы хранятся в течение года, после чего удаляются без возможности восстановления.
* Обходить [ограничение](blocks-ref/file.md) на размер и количество прикрепляемых файлов.

После подключения внешнего хранилища прикрепленные файлы из новых ответов будут сохраняться уже в нем. В сервисе {{ forms-name }} об этих файлах будет храниться только метаинформация, но появится возможность скачивать их по ссылке в настройках формы, на вкладке **Ответы**. Файлы, которые были получены до подключения настройки, продолжат храниться в сервисе {{ forms-name }} в течение [ограниченного времени](answers.md#files).

{% note warning %}

Следите, чтобы во внешнем хранилище было достаточно места для скачивания новых файлов. Если место закончится, пользователи не смогут заполнить форму и увидят ошибку <q>Прикрепление файлов временно приостановлено</q>.

{% endnote %}




## Подключить форму к Яндекс Диску {#disk}

{% note warning %}

Опция доступна только для [личных форм](personal-forms.md).

{% endnote %}

Чтобы сохранять прикрепленные файлы из ответов на Яндекс Диск, откройте форму, перейдите на страницу **Настройки** → **Дополнительно** и активируйте опцию **Сохранять прикрепленные файлы из ответов в Яндекс Диск**.

После этого на диске владельца формы появится папка Yandex.Forms, в которую будут сохраняться файлы из новых ответов пользователей. Файлы, которые были получены до подключения настройки, продолжат храниться в сервисе {{ forms-name }} в течение [ограниченного времени](answers.md#files).



## Подключить форму к {{ objstorage-name }} {#s3-ext}

{% note warning %}

Опция доступна только для [форм для бизнеса](forms-for-org.md).

{% endnote %}

1. Убедитесь, что форма подключена к организации, в которой есть [облако](../organization/concepts/manage-services.md#cloud). Чтобы узнать организацию, на верхней панели нажмите **Для организации** — в списке будет отмечена подключенная организация. Посмотреть, есть ли облако, можно в [консоли управления]({{ link-console-main }}) {{ yandex-cloud }}. Если облака нет, создайте его [по инструкции](../resource-manager/operations/cloud/create.md).

1. В облаке должен быть [сервисный аккаунт](../iam/concepts/users/service-accounts.md). Если сервисного аккаунта нет, создайте его [по инструкции](../iam/operations/sa/create.md).

1. [Назначьте](../iam/operations/sa/assign-role-for-sa.md) сервисному аккаунту [роль](../storage/security/index.md#storage-editor) `storage.editor` для записи и чтения файлов в бакетах.

1. Для сервисного аккаунта создайте статический ключ доступа [по инструкции](../iam/operations/sa/create-access-key.md). Сохраните созданный ключ — он понадобится для настройки формы.

1. В интерфейсе {{ forms-name }} откройте форму, к которой хотите подключить {{ objstorage-name }}, и в настройках, в разделе **Сохранять в пользовательском хранилище**, укажите статический ключ, созданный на предыдущем шаге. Добавленный ключ будет действовать для всех форм этой организации.

1. В [консоли управления]({{ link-console-main }}) {{ yandex-cloud }} перейдите в {{ objstorage-name }} и запомните путь до бакета, в котором хотите сохранять прикрепленные файлы. Если бакета у вас нет, создайте его [по инструкции](../storage/operations/buckets/create.md).

1. В интерфейсе {{ forms-name }} перейдите в настройки формы, в раздел **Дополнительно**. В поле **Сохранять прикрепленные файлы из ответов в указанный S3** укажите путь до бакета `path` в формате `s3://path`. При сохранении настройки будет проверена доступность бакета. Если бакет недоступен, вы увидите ошибку.
   
Если бакет доступен, файлы из новых ответов пользователей будут сохраняться в нем. Файлы, которые были получены до указания бакета, продолжат храниться в сервисе {{ forms-name }} в течение [ограниченного времени](answers.md#files).

Чтобы прекратить сохранять файлы в бакет, в интерфейсе {{ forms-name }}, в настройках формы **Настройки** → **Дополнительно** удалите содержимое поля **Сохранять прикрепленные файлы из ответов в указанный S3**.

