# Переменные в настройках интеграции

При настройке интеграции формы с другими сервисами вы можете передавать в сервис ответы на вопросы или другие данные из формы. Например, можно вставить ответы пользователя в текст письма или записать данные в поля задачи в {{ tracker-short-name }}.

Для этого используйте переменные:

1. В форме на вкладке **Интеграции** [добавьте действие](notifications.md#add-integration). 

1. Выберите поле и справа нажмите значок ![](../_assets/forms/add-var.png).

1. Выберите в списке переменную, которую нужно добавить в поле.

1. Если вы используете переменные <q>Ответ на вопрос</q>, <q>Идентификатор варианта ответа на вопрос</q> и подобные,  при необходимости выберите [фильтр](#var-filters) для значения переменной.

1. Нажмите кнопку **Сохранить**.

При отправке данных в сервис переменная автоматически преобразуется в значение — ответ на вопрос, результат теста или технические данные.

{% note warning %}

Чтобы при [интеграции с {{ tracker-short-name }}](create-task.md) добавить в поля **Автор**, **Исполнитель**, **Наблюдатели** сотрудника, указанного в ответе на вопрос типа {% if audience == "external" %}<q>Люди</q>,{% else %}<q>Данные Стаффа</q>,{% endif %} добавьте в поле переменную **Идентификатор варианта ответа на вопрос**. Если вы используете переменную **Ответ на вопрос**, интеграция не сработает.

{% endnote %}

> Пример: текст письма, содержащий все ответы пользователя на вопросы формы.
>
> ![](../_assets/forms/variables-example-new.png)

## Фильтры {#var-filters}

Если в настройки интеграции с помощью переменных подставлены ответы на вопросы, могут возникнуть ошибки из-за того, что ответ не соответствует формату, который требуется для интеграции. Например, если в тело HTTP-запроса добавить ответ на вопрос <q>Длинный текст</q>, содержащий переводы строк, интеграция не сработает.

Чтобы избежать ошибок, связанных с форматом данных, используйте фильтры для переменных:

* **Sanitize stirng** — удаляет из текста ответа специальные символы.

* **JSON** — преобразует текст ответа в формат, совместимый с JSON.

{% if audience == "internal" %}

* **Логин на стаффе** — преобразует текст ответа в нижний регистр.

{% endif %}

![](../_assets/forms/var-filter-json.png)

## Справочник переменных {#section_wqx_1j2_p2b}

В настройках действий можно использовать следующие переменные:

Переменная | Описание
----- | -----
**Данные пользователя** | Личные данные пользователя, заполнившего форму<br/>{% if audience == "external" %}<br/><br/>Переменные из этой группы преобразуются в персональные данные пользователя только в том случае, если форма создана в [{{ forms-full-name }} для бизнеса](forms-for-org.md) и заполнивший форму пользователь является сотрудником организации. Данные внешних пользователей можно получить, только если пользователи укажут свои данные в ответ на вопросы формы.{% endif %}
Имя | Имя пользователя
Логин | Логин пользователя
{% if audience == "internal" %}UID | UID пользователя{% endif %}
Электронная почта | Почта пользователя
{% if audience == "external" %}Пол | Пол пользователя{% endif %}
{% if audience == "external" %}Отдел | Отдел, к которому относится сотрудник (для пользователей [{{ forms-full-name }} для бизнеса](forms-for-org.md)){% endif %}
{% if audience == "external" %}Телефон | Рабочий телефон сотрудника (для пользователей [{{ forms-full-name }} для бизнеса](forms-for-org.md)){% endif %}
{% if audience == "external" %}Руководитель | Непосредственный руководитель сотрудника (для пользователей [{{ forms-full-name }} для бизнеса](forms-for-org.md)){% endif %}
{% if audience == "external" %}Команда | Команды, в которых состоит сотрудник (для пользователей [{{ forms-full-name }} для бизнеса](forms-for-org.md)){% endif %}
{% if audience == "external" %}**Данные из организации** | Информация из адресной книги организации в [{{ org-full-name }}]({{ link-org-main }}){% else %}**Данные со Стаффа** | Информация из справочника сотрудников{% endif %}
Инфо о пользователе | Одно из полей карточки сотрудника, заполнившего форму
Инфо из ответа на вопрос | Для вопросов типа {% if audience == "external" %}**Люди**, **Отделы** и **Команды**{% else %}**Данные Стаффа**{% endif %} — одно из полей карточки сотрудника или подразделения, указанных в ответе. {% if audience == "internal" %}Также можно использовать переменную для других типов вопросов, если в ответе указан логин пользователя.{% endif %}
**Результаты теста** | Результат прохождения [теста или квиза](tests.md)
Максимум баллов в тесте | Максимальное количество баллов, которое можно набрать в тесте
Всего вопросов с баллами | Количество вопросов, за которые можно получить баллы
Набрано баллов | Количество баллов, набранных пользователем
Заголовок результатов теста | [Заголовок для сегмента](tests.md#test-result), в который попал результат пользователя
Описание результатов теста | [Описание для сегмента](tests.md#test-result), в который попал результат пользователя
Набрано баллов на вопросе | Количество баллов, которое получено за выбранный вопрос
**Форма** | Параметры формы и ответы на ее вопросы
ID формы | Уникальный идентификатор формы
Название | Название формы
Ответ на вопрос | Ответ пользователя на определенный вопрос формы — выберите вопрос
Ответы на вопросы | Ответы пользователя на несколько вопросов формы — выберите вопросы
ID ответа | Уникальный идентификатор заполненной формы
Идентификатор варианта ответа на вопрос | Уникальный идентификатор варианта ответа для вопросов с выбором вариантов (например, <q>Люди</q> или <q>Выпадающий список</q>). {% if audience == "internal" %}Идентификаторы вариантов ответа можно просматривать только в [старой админке {{ forms-name }}](https://admin-int.forms.yandex-team.ru/?force_old).{% endif %}
Дата ответа | Дата заполнения формы
Email автора формы | Почта пользователя, который создал форму
{% if audience == "internal" %}Статус валидации | Значение статуса для [внешней валидации](https://doc.yandex-team.ru/forms/external/validation.html){% endif %}
{% if audience == "internal" %}**Геобаза** | Информация о географическом положении пользователя{% endif %}
{% if audience == "internal" %}Код региона | Код региона пользователя{% endif %}
{% if audience == "internal" %}Имя региона | Регион пользователя{% endif %}
**Браузер** | Информация о браузере и операционной системе пользователя
{% if audience == "internal" %}Все данные | Все доступные параметры браузера{% endif %}
Семейство ОС | Тип операционной системы
Название ОС | Название операционной системы
Версия ОС | Версия операционной системы
Название браузера | Название
Версия браузера | Версия
{% if audience == "internal" %}Движок | Движок браузера{% endif %}
**Запрос** | Технические параметры HTTP-сессии
{% if audience == "internal" %}IP-адрес | IP адрес компьютера пользователя{% endif %}
Хост | Имя компьютера пользователя
URL | Адрес формы
{% if audience == "internal" %}Все заголовки | Значения всех заголовков запроса{% endif %}
{% if audience == "internal" %}Заголовок | Значение определенного заголовка запроса — укажите имя заголовка{% endif %}
Все GET-параметры | Значения всех параметров запроса.<br/><br/>Читайте подробнее, как [использовать GET-параметры для предзаполнения формы](get-params.md).
GET-параметр | Значение определенного параметра запроса — укажите имя параметра.<br/><br/>Читайте подробнее, как [использовать GET-параметры для предзаполнения формы](get-params.md).
{% if audience == "internal" %}Все куки | Значения всех кук в запросе{% endif %}
{% if audience == "internal" %}Кука | Значение определенной куки — укажите имя куки{% endif %}
{% if audience == "internal" %}**Сессия**<br/>Реферер | Адрес страницы, с которой пользователь попал на форму{% endif %}