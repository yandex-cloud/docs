# Визуализация геоданных из CSV-файла

В этом сценарии будут проанализированы открытые данные по дорожно-транспортным происшествиям на дорогах РФ. Помимо выявления фактов статистики ДТП в России, в процессе анализа вы научитесь:

- работать с основными сущностями {{ datalens-short-name }}: Подключения, Датасеты, Чарты, Дашборды;
- объединять несколько источников на уровне одного датасета;
- работать с типом данных `Дата и время`, изменять группировки на уровне чарта;
- работать с геоданными: геоточками и геополигонами;
- создавать публичные дашборды, которые будут доступны всем с любых устройств без аутентификации.

Для визуализации и исследования данных [подготовьте облако к работе](data-from-csv-geo-visualization.md#before-you-begin), затем выполните следующие шаги:

1. [Создайте подключение к CSV-файлу](data-from-csv-geo-visualization.md#step1).
1. [Создайте датасет и настройте его поля](data-from-csv-geo-visualization.md#step2).
1. [Создайте первый чарт — Тепловую карту](data-from-csv-geo-visualization.md#step3).
1. [Создайте второй чарт — Линейчатую диаграмму](data-from-csv-geo-visualization.md#step4).
1. [Создайте еще чарты — Линейные диаграммы](data-from-csv-geo-visualization.md#step5).
1. [Создайте дашборд](data-from-csv-geo-visualization.md#step6).
1. [Добавьте чарты на дашборд](data-from-csv-geo-visualization.md#step7).
1. [Добавьте селекторы и сформируйте дашборд](data-from-csv-geo-visualization.md#step8).
1. [Подключите дополнительный источник с геослоями регионов](data-from-csv-geo-visualization.md#step9).
1. [Добавьте новые поля в датасет](data-from-csv-geo-visualization.md#step10).
1. [Создайте чарт с использованием новых полей](data-from-csv-geo-visualization.md#step11).
1. [Добавьте новый чарт на дашборд](data-from-csv-geo-visualization.md#step12).
1. [Опубликуйте дашборд](data-from-csv-geo-visualization.md#step13).

## Подготовьте облако к работе {#before-you-begin}

Чтобы воспользоваться {{ datalens-short-name }}, нужно зарегистрироваться в {{ yandex-cloud }} и создать платежный аккаунт (без платежного аккаунта {{ datalens-short-name }} доступен только в демо-режиме):

1. Перейдите в [консоль управления]({{ link-console-main }}), затем войдите в {{ yandex-cloud }} или зарегистрируйтесь, если вы еще не зарегистрированы.

1. [На странице биллинга]({{ link-console-billing }}) убедитесь, что у вас подключен [платежный аккаунт](https://cloud.yandex.ru/docs/billing/concepts/billing-account), и он находится в статусе `ACTIVE` или `TRIAL_ACTIVE`. Если платежного аккаунта нет, [создайте его](https://cloud.yandex.ru/docs/billing/quickstart/#create_billing_account).

Когда вы активируете платежный аккаунт, вы автоматически переходите на тариф {{ datalens-short-name }} **Бесплатный**. По умолчанию вы можете создать экземпляр {{ datalens-short-name }} не более чем для 1 каталога. Если вы еще этого не сделали:

1. Выберите каталог [на странице облака](https://console.cloud.yandex.ru/cloud).
1. Выберите сервис **DataLens**.
1. Нажмите кнопку **Активировать DataLens**.

В выбранном каталоге будет создан экземпляр сервиса, и вы сможете перейти непосредственно в интерфейс {{ datalens-short-name }}.

[Подробнее об облаках и каталогах](https://cloud.yandex.ru/docs/resource-manager/concepts/resources-hierarchy).

## Шаг 1. Создайте подключение к CSV-файлу {#step1}

1. Скачайте [открытые данные статистики ДТП](https://xn--80abhddbmm5bieahtk5n.xn--p1ai/opendata) в формате CSV. На момент подготовки инструкции — февраль 2020 — самым актуальным был набор данных за 2018 год. Скачанный архив распакуйте. Также вы можете скачать [готовый файл](https://yadi.sk/d/zgo7RgjFWSMiyg) с данными за 2018 год.

   ![image](../../_assets/datalens/solution-07/01-files.png)

1. Откройте главную страницу [{{ datalens-short-name }}](https://datalens.yandex.ru/) и нажмите **Создать подключение**.

   ![image](../../_assets/datalens/solution-07/02-create-connection.png)

1. Выберите тип подключения **CSV**.

   ![image](../../_assets/datalens/solution-07/03-choose-csv.png)

1. Нажмите кнопку **Выбрать CSV-файл**, затем выберите скачанный ранее файл. Загрузка может занять до нескольких минут, в зависимости от скорости подключения к интернету.

   ![image](../../_assets/datalens/solution-07/04-choose-file.png)

   После успешной загрузки вы увидите превью данных файла. Для просмотра используйте полосы прокрутки справа и внизу.

   ![image](../../_assets/datalens/solution-07/05-preview.png)

1. В правом верхнем углу нажмите кнопку **Создать**.

   ![image](../../_assets/datalens/solution-07/06-create.png)

Подключение к CSV-файлу создано. Данные представлены в том же виде, что и в файле. Для дальнейшей работы с ними нужно создать датасет.

## Шаг 2. Создайте датасет и настройте его поля {#step2}

Датасет будет состоять из одного источника — файла CSV.

1. Нажмите кнопку **Создать датасет**.

   ![image](../../_assets/datalens/solution-07/07-create-dataset.png)

1. Перейдите на вкладку **Поля**.

   ![image](../../_assets/datalens/solution-07/08-dataset.png)

   Здесь есть возможность добавить [поля данных](https://cloud.yandex.ru/docs/datalens/concepts/dataset/data-model#field) и [вычисляемые поля](https://cloud.yandex.ru/docs/datalens/concepts/calculations), изменить тип данных поля, правила агрегации, переименовать поле.

   ![image](../../_assets/datalens/solution-07/09-rename.png)

1. Измените имена полей на русские, по порядку:

   - Код региона
   - Название региона
   - Код дороги
   - Название дороги
   - Тип дороги
   - ОКТМО
   - Адрес
   - Тип ДТП

   ![image](../../_assets/datalens/solution-07/10-rename-attributes.png)

1. Дата и время ДТП показаны в следующих полях:

   - crash_date — дата, записанная числом, вида `20190218`;
   - crash_time — время, записанное текстом, вида `19:34`.

   В таком виде они не будут использоваться в датасете. Скройте их, нажав значок видимости.

   ![image](../../_assets/datalens/solution-07/11-hide-attributes.png)

1. Для отображения сведений о дате и времени ДТП добавьте новое поле.

   1. Нажмите **Добавить поле**.

      ![image](../../_assets/datalens/solution-07/12-add-field.png)

   1. Укажите для него данные:

      - **Название поля**: Дата и время
      - **Формула**: `datetime_parse(str([crash_date])+'-'+str([crash_time]))`

      ![image](../../_assets/datalens/solution-07/13-tune-field.png)

      {% note tip %}

      Если хотите самостоятельно изучить документацию по этим функциям, нажмите слева внизу диалогового окна кнопку **Справочник**.

      {% endnote %}

   1. Нажмите **Создать**.

   В разделе предпросмотра появилось корректное отображение даты и времени ДТП в виде значения типа `Дата и время`. Новое поле **Дата и время** находится в таблице сверху. По значку ![image](../../_assets/datalens/formula-dataset.svg) доступно редактирование формулы поля.

   ![image](../../_assets/datalens/solution-07/14-date-and-time.png)
   
1. Продолжите переименование полей по порядку:

   - Причина ДТП
   - Кол-во погибших
   - Кол-во пострадавших
   - Кол-во ТС
   - Кол-во участников

   Для следующих полей установите тип агрегации **Сумма**:

   - Кол-во погибших
   - Кол-во пострадавших
   - Кол-во ТС
   - Кол-во участников

   ![image](../../_assets/datalens/solution-07/15-sum.png)

1. Добавьте поле для отображения геоточки.

   1. Справа вверху нажмите кнопку **Добавить поле**.

      ![image](../../_assets/datalens/solution-07/12-add-field.png)

   1. Введите данные для нового поля:

      - **Название поля**: Геоточка
      - **Формула**: `GEOPOINT([latitude],[longitude])`

      где [latitude] и [longitude] — поля датасета.

      ![image](../../_assets/datalens/solution-07/16-new-field-geopoint.png)

   1. Нажмите **Создать**.

      {% note info %}

      В примере используются готовые данные в формате координат. В других случаях для конвертации данных в формат координат вы можете воспользоваться функцией [геокодинга](https://cloud.yandex.ru/docs/datalens/function-ref/GEOCODE).

      {% endnote %}

   1. Убедитесь, что в таблице и превью появилось новое поле с типом `Геоточка`.

      ![image](../../_assets/datalens/solution-07/17-geopoint.png)

1. Добавьте поле для отображения количества ДТП.

   1. Нажмите **Добавить поле**.

      ![image](../../_assets/datalens/solution-07/12-add-field.png)

   1. Введите данные для нового поля:

      - **Название поля**: Кол-во ДТП
      - **Формула**: `SUM(1)`

      ![image](../../_assets/datalens/solution-07/18-new-field-count-DTP.png)

   1. Нажмите **Создать**. 

   Тип агрегации для этого поля устанавливать не нужно, {{ datalens-short-name }} при добавлении поля на чарт применит функцию агрегации автоматически.

1. Добавьте поле для данных о смертности в ДТП.

   1. Нажмите **Добавить поле**.

      ![image](../../_assets/datalens/solution-07/12-add-field.png)

   1. Введите данные для нового поля:

      - **Название поля**: Смертность в ДТП
      - **Формула**: `[Кол-во погибших]/[Кол-во ДТП]`

      ![image](../../_assets/datalens/solution-07/19-new-field-fatality.png)

   1. Нажмите **Создать**

   {% note info %}

   Вычисляемые поля можно создавать непосредственно в чарте. Однако удобнее сделать это на уровне датасета, чтобы они были доступны во всех чартах.

   {% endnote %}

1. Сохраните датасет, нажав справа вверху кнопку **Сохранить**.

   ![image](../../_assets/datalens/solution-07/20-save-dataset.png)

1. Укажите название датасета: **ДТП**. Нажмите **Создать**.

   ![image](../../_assets/datalens/solution-07/21-name-dataset.png)

Датасет создан.

## Шаг 3. Создайте первый чарт — Тепловую карту {#step3}

Приступайте к созданию первого [чарта](https://cloud.yandex.ru/docs/datalens/concepts/chart).

1. Нажмите **Создать чарт**.

   ![image](../../_assets/datalens/solution-07/22-create-chart.png)

1. В появившемся окне визарда нажмите на поле, в котором по умолчанию указано **Столбчатая диаграмма**, и выберите тип чарта **Карта**.

   ![image](../../_assets/datalens/solution-07/23-heatmap.png)

1. Выберите в разделе **Геоточки** тип слоя **Геоточки (тепловая карта)**.

   ![image](../../_assets/datalens/solution-07/23-1-heatmap-geopoint.png)

1. Перетащите поле **Геоточка** в раздел **Геоточки**.

   ![image](../../_assets/datalens/solution-07/24-drag-geopoint.png)

   Вы получили первый чарт на карте.

1. Для сохранения чарта сначала рядом с кнопкой **Сохранить** нажмите значок стрелки, затем выберите **Сохранить как**.

   ![image](../../_assets/datalens/solution-07/25-save-heatmap.png)

1. В диалоговом окне укажите название чарта: **Тепловая карта** и нажмите **Сохранить**.

   ![image](../../_assets/datalens/solution-07/26-name-heatmap.png)

## Шаг 4. Создайте второй чарт — Линейчатую диаграмму {#step4}

1. Проанализируйте количество ДТП по регионам. 

   1. В том же окне выберите тип чарта **Линейчатая диаграмма**.

      ![image](../../_assets/datalens/solution-07/27-choose-linely-diagram.png)

   1. Перетащите:

      - поле **Название региона** — в раздел **Y**;
      - поле **Кол-во ДТП** — в раздел **X**;
      - поле **Кол-во ДТП** — в раздел **Сортировка**.

      ![image](../../_assets/datalens/solution-07/28-drag-attributes.png)

      На диаграмме отобразилось количество ДТП по регионам. Больше всего ДТП в Московской области.

      {% note info %}

      Не все линии диаграммы подписаны. Если линия не подписана, наведите на нее указатель, и название региона отобразится в подсказке.

      {% endnote %}

   1. Сохраните диаграмму по кнопке **Сохранить как**. 

      ![image](../../_assets/datalens/solution-07/29-save-chart-as.png)

      Укажите название чарта: **Количество ДТП по регионам** и сохраните его.

      ![image](../../_assets/datalens/solution-07/30-save-linely-diagram.png)

1. Проанализируйте смертность в ДТП по регионам.

   1. Замените показатель **Кол-во ДТП** на **Смертность в ДТП** с помощью перетаскивания.

      ![image](../../_assets/datalens/solution-07/31-drag-attributes-2.png)

      На этот раз в лидерах с большим отрывом Ингушетия, затем Тыва и Калмыкия.

   1. Сохраните чарт по кнопке **Сохранить как**

      ![image](../../_assets/datalens/solution-07/29-save-chart-as.png)

      с названием **Смертность по регионам**.

      ![image](../../_assets/datalens/solution-07/32-save-linely-diagram-2.png)

## Шаг 5. Создайте еще чарты — Линейные диаграммы {#step5}

Посмотрите, как распределяется количество ДТП и смертность в них по неделям, дням недели и времени суток.

1. Проанализируйте количество ДТП и смертность по неделям.

   1. В том же окне выберите тип чарта **Линейная диаграмма**.

      ![image](../../_assets/datalens/solution-07/33-choose-line-diagram.png)

   1. В разделах управления чартом остались предыдущие значения. Удалите их с помощью значка ![image](../../_assets/datalens/cross.svg).

      ![image](../../_assets/datalens/solution-07/34-clean.png)

   1. Перетащите поле **Дата и время** в раздел **X** и нажмите зеленый значок календаря.

      ![image](../../_assets/datalens/solution-07/35-drag-date-and-time.png)

   1. В поле **Группировка** выберите **Часть даты** ⟶ **Неделя**, затем нажмите **Применить**.

      ![image](../../_assets/datalens/solution-07/36-choose-week.png)

   1. Перетащите:
      - поле **Кол-во ДТП** — в раздел **Y**;
      - поле **Смертность в ДТП** — в раздел **Y2**.

      ![image](../../_assets/datalens/solution-07/37-drag-attributes-3.png)

      Появилась диаграмма с двумя графиками — количества ДТП и смертности. Если навести указатель на точку графика, в подсказке отобразятся конкретные значения.

   1. Сохраните чарт по кнопке **Сохранить как**

      ![image](../../_assets/datalens/solution-07/29-save-chart-as.png)

      с названием **Кол-во ДТП и смертность по неделям**.

      ![image](../../_assets/datalens/solution-07/38-save-line-diagram-week.png)

1. Теперь проанализируйте количество ДТП и смертность по дням недели.

   1. Измените группировку по дате и времени на **Часть даты** ⟶ **День недели**.

      ![image](../../_assets/datalens/solution-07/39-choose-day.png)

      На этой диаграмме заметны более явные тенденции.

      ![image](../../_assets/datalens/solution-07/40-line-diagram-day.png)

   1. Сохраните чарт по кнопке **Сохранить как**

      ![image](../../_assets/datalens/solution-07/29-save-chart-as.png)

      с названием **Кол-во ДТП и смертность по дням недели**.

      ![image](../../_assets/datalens/solution-07/41-save-line-diagram-day.png)

1. Проанализируйте количество ДТП и смертность по часам суток.

   1. Измените группировку по дате и времени, укажите: **Часть даты** ⟶ **Час**.

      ![image](../../_assets/datalens/solution-07/42-choose-hour.png)

      Диаграмма показывает: ночью количество ДТП меньше, но среди них больше происшествий со смертельным исходом.

      ![image](../../_assets/datalens/solution-07/43-line-diagram-hour.png)

   1. Сохраните чарт по кнопке **Сохранить как**

      ![image](../../_assets/datalens/solution-07/29-save-chart-as.png)

      с названием **Кол-во ДТП и смертность по часам в течение дня**.

      ![image](../../_assets/datalens/solution-07/44-save-line-diagram-hour.png)

## Шаг 6. Создайте дашборд {#step6}

1. Откройте меню по значку слева от логотипа и выберите пункт **Дашборды**.

   ![image](../../_assets/datalens/solution-07/45-choose-menu-dashbords.png)

1. Нажмите кнопку **Создать**

   ![image](../../_assets/datalens/solution-07/46-create-dashbord.png)

   и выберите **Дашборд**.

   ![image](../../_assets/datalens/solution-07/47-choose-dashbord.png)

1. Введите название дашборда **ДТП в РФ** и нажмите **Создать**.

   ![image](../../_assets/datalens/solution-07/48-name-dashbord.png)
   
{% note info %}

Если это первый дашборд, созданный в каталоге, он откроется сразу после создания. Если в каталоге уже есть другие дашборды, то откроется их список. В этом случае нужно из списка открыть дашборд **ДТП в РФ**.

{% endnote %}

## Шаг 7. Добавьте чарты на дашборд {#step7}

1. Добавьте первый чарт.

   1. Нажмите **Добавить** и в выпадающем списке выберите **Чарт**.

      ![image](../../_assets/datalens/solution-07/49-add-chart.png)

   1. В поле **Чарт** выберите из списка чартов созданный ранее чарт **Тепловая Карта**.

      ![image](../../_assets/datalens/solution-07/50-choose-chart-to-dashbord.png)

   1. Нажмите кнопку **Добавить**.

      ![image](../../_assets/datalens/solution-07/51-add-chart-to-dashbord.png)

      Чарт появился на дашборде.

1. Повторите предыдущие три шага для чартов **Количество ДТП по регионам**, **Кол-во ДТП и смертность по неделям**, **Кол-во ДТП и смертность по дням недели**, **Кол-во ДТП и смертность по часам в течение дня**, добавив их на дашборд.

1. Создайте на дашборде переключатель чартов **Количество ДТП по регионам** и **Смертность по регионам**.

   1. Откройте настройки чарта **Количество ДТП по регионам** по значку.

      ![image](../../_assets/datalens/solution-07/52-1-tune-chart.png)

   1. В левой части окна нажмите **Добавить**.

      ![image](../../_assets/datalens/solution-07/52-2-add.png)

   1. В поле **Чарт** нажмите **Выбрать** и выберите чарт **Смертность по регионам**.

      ![image](../../_assets/datalens/solution-07/52-3-choose-chart.png)

   1. Нажмите **Сохранить**.

      ![image](../../_assets/datalens/solution-07/52-4-save-tab.png)


## Шаг 8. Добавьте селекторы и сформируйте дашборд {#step8}

[Селекторы](https://cloud.yandex.ru/docs/datalens/concepts/dashboard#selector) позволяют фильтровать данные по значениям.

1. Добавьте селектор для отбора по названию региона.

   1. Нажмите **Добавить** и выберите **Селектор**.

      ![image](../../_assets/datalens/solution-07/52-add-selector.png)

   1. Отметьте **На основе датасета**, затем нажмите **Выбрать** и выберите созданный ранее датасет **ДТП**.

      ![image](../../_assets/datalens/solution-07/53-choose-dataset-DTP.png)

   1. В реквизите **Поле** выберите **Название региона**, затем рядом с названием селектора поставьте отметку **Показывать**. Нажмите кнопку **Добавить**.

      ![image](../../_assets/datalens/solution-07/54-choose-field.png)

   Селектор появился на дашборде в виде прямоугольного элемента.

1. Повторите предыдущие три шага для полей:

   - Причина ДТП
   - Тип ДТП
   - Тип дороги
   - Название дороги

1. Элементы дашборда можно перетаскивать и менять их размер. Сформируйте расположение элементов в соответствии со скриншотом или любым другим удобным образом, затем сохраните дашборд по кнопке **Сохранить**.

   ![image](../../_assets/datalens/solution-07/55-dashbord-view.png)

Если в селекторах выбрать значения, на чартах отобразятся данные для этих значений.

Чарт **Количество ДТП по регионам** можно переключить на **Смертность по регионам**.

![image](../../_assets/datalens/solution-07/56-1-switch-chart.png)

## Шаг 9. Подключите дополнительный источник с геослоями регионов {#step9}

Тепловая карта не всегда является самой информативной. Загрузите справочник полигонов и добавьте чарт с цветовой заливкой регионов РФ.

1. Откройте меню по кнопке слева от логотипа и перейдите в раздел **Подключения**.

   ![image](../../_assets/datalens/solution-07/56-choose-connections.png)

1. Справа вверху нажмите кнопку **Создать** 
   
   ![image](../../_assets/datalens/solution-07/57-create.png)

   и выберите **Connection**.

   ![image](../../_assets/datalens/solution-07/58-choose-connection.png)

1. Выберите тип файла **CSV**.

   ![image](../../_assets/datalens/solution-07/03-choose-csv.png)

   Скачайте на свой компьютер файл [**Регионы.csv**](https://yadi.sk/d/ZTgPWnjdnTo43w). Затем в окне создания подключения загрузите его по кнопке **Выбрать CSV-файл**.

1. Просмотрите превью данных файла. Для параметра **Заголовок таблицы** установите значение **Есть**. Справа вверху нажмите кнопку **Создать**.

   ![image](../../_assets/datalens/solution-07/58-new-connection.png)

## Шаг 10. Добавьте новые поля в датасет {#step10}

Необходимо обогатить созданный ранее датасет **ДТП** новыми полями.

1. Через левое меню перейдите в раздел **Датасеты**.

   ![image](../../_assets/datalens/solution-07/59-choose-datasets.png)

1. Выберите датасет **ДТП**.

   ![image](../../_assets/datalens/solution-07/60-choose-dataset-dtp.png)

1. Перейдите на вкладку **Источники**.

   ![image](../../_assets/datalens/solution-07/61-choose-data.png)

1. Нажмите **Добавить**.

   ![image](../../_assets/datalens/solution-07/62-add.png)

1. Выберите **Подключения**, затем **Регионы**.

   ![image](../../_assets/datalens/solution-07/63-choose-regions.png)

   Поскольку данные подключений еще не объединены, может появиться сообщение об ошибке. Выполните последующие действия.

1. Нажмите значок объединения данных.

   ![image](../../_assets/datalens/solution-07/64-choice.png)

1. Нажмите кнопку **Добавить связь**.

   ![image](../../_assets/datalens/solution-07/65-relation.png)

1. Выберите поля, которые будут связаны: **reg_name** и **Регион ДТП**, затем нажмите **Сохранить**. 

   ![image](../../_assets/datalens/solution-07/66-choose-related-fields.png)

   Убедитесь, что превью данных отобразилось корректно.

   ![image](../../_assets/datalens/solution-07/67-preview.png)

1. Перейдите на вкладку **Поля**.

   ![image](../../_assets/datalens/solution-07/68-go-to-dataset.png)

1. Внизу списка появились новые поля. Для поля **Полигон** укажите тип данных **Геополигон**.

   ![image](../../_assets/datalens/solution-07/69-geopolygon.png)

1. Сохраните датасет по кнопке **Сохранить**.

   ![image](../../_assets/datalens/solution-07/70-save.png)

## Шаг 11. Создайте чарт с использованием новых полей {#step11}

1. Нажмите кнопку **Создать чарт**.

   ![image](../../_assets/datalens/solution-07/22-create-chart.png)

1. Выберите тип чарта **Карта**.

   ![image](../../_assets/datalens/solution-07/72-fon-map.png)

1. Добавьте полигоны на карту. Из раздела **Измерения** перетащите поле **Полигон** в секцию **Геополигоны**.

1. Измените цвета полигонов относительно показателя количества ДТП. Из раздела **Показатели** перетащите поле **Кол-во ДТП** в секцию **Цвета**.

1. Перетащите следующие поля в раздел **Тултипы**:

   - Название Региона;
   - Кол-во ДТП;
   - Кол-во погибших;
   - Кол-во пострадавших;
   - Кол-во ТС;
   - Кол-во участников;
   - Смертность в ДТП.

   На диаграмме отобразилась карта с заливкой регионов. Если навести указатель на регион, появятся сведения по этому региону.

   ![image](../../_assets/datalens/solution-07/73-geopolygons-map.png)

1. Сохраните чарт по кнопке справа вверху **Сохранить**.

   ![image](../../_assets/datalens/solution-07/73-save.png)

1. Введите название чарта: **Карта регионов** и снова нажмите **Сохранить**.

   ![image](../../_assets/datalens/solution-07/74-save-map.png)

## Шаг 12. Добавьте новый чарт на дашборд {#step12}

1. Через левое верхнее меню перейдите в раздел **Дашборды**.

   ![image](../../_assets/datalens/solution-07/45-choose-menu-dashbords.png)

1. Выберите ранее созданный дашборд с ДТП.

   ![image](../../_assets/datalens/solution-07/76-choose-dash-dtp.png)

1. Справа вверху нажмите кнопку **Редактировать**.

   ![image](../../_assets/datalens/solution-07/77-edit-dash.png)

1. Откройте  настройки **Тепловой карты** по значку.

   ![image](../../_assets/datalens/solution-07/78-tune-heatmap.png)

1. В левой части окна нажмите **Добавить**.

   ![image](../../_assets/datalens/solution-07/79-add.png)

1. В поле **Чарт** нажмите **Выбрать** и выберите последний чарт **Карта регионов**.

   ![image](../../_assets/datalens/solution-07/80-choose-map.png)

1. Нажмите **Сохранить**.

   ![image](../../_assets/datalens/solution-07/81-save-tab.png)

Появилась возможность переключать тип визуализации данных на карте: тепловая карта или заливка регионов.

![image](../../_assets/datalens/solution-07/82-switch-map.png)

## Шаг 13. Опубликуйте дашборд {#step13}

1. Чтобы настроить публичный доступ к дашборду, нажмите значок ![image](../../_assets/datalens/share.svg).

   ![image](../../_assets/datalens/solution-07/83-share.png)

1. Включите доступ по ссылке. Появившуюся ссылку можно скопировать и делиться ею. По ссылке дашборд будет доступен всем, с любых устройств и без аутентификации. Нажмите **Применить**.

   ![image](../../_assets/datalens/solution-07/84-link.png)

   {% note info %}

   Вы можете включить или выключить публичный доступ отдельно для каждого чарта и датасета, связанного с дашбордом.

   {% endnote %}