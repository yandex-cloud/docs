# Изменение кластера {{ dataproc-name }}

После создания кластера вы можете изменить его основные и дополнительные настройки.


Вы можете выключить передачу логов кластера в сервис {{ cloud-logging-full-name }}. Подробнее см. в разделе [Работа с логами](logging.md#disable-logs).


Если вы хотите переместить кластер в другую зону доступности, обратитесь к [инструкции](migration-to-an-availability-zone.md).

{% list tabs %}

- Консоль управления

    1. Перейдите на [страницу каталога]({{ link-console-main }}) и выберите сервис **{{ ui-key.yacloud.iam.folder.dashboard.label_data-proc }}**.
    1. Выберите кластер и нажмите кнопку **{{ ui-key.yacloud.mdb.cluster.overview.button_action-edit }}** на панели сверху.

    
    1. Чтобы изменить [лог-группу](../../logging/concepts/log-group.md), в которую отправляются логи кластера, выберите новую лог-группу из списка. При необходимости [создайте новую лог-группу](../../logging/operations/create-group.md).

        Для работы этой функции [назначьте сервисному аккаунту кластера](../../iam/operations/roles/grant.md#access-to-sa) роль `logging.writer`. Подробнее см. в [документации {{ cloud-logging-full-name }}](../../logging/security/index.md).


    1. Чтобы изменить [свойства компонентов](../concepts/settings-list.md) кластера, укажите в поле **{{ ui-key.yacloud.mdb.forms.config_field_properties }}** ключ компонента и его новое значение.

    1. Измените дополнительные настройки кластера:

        **{{ ui-key.yacloud.mdb.forms.label_deletion-protection }}** — управляет защитой кластера от непреднамеренного удаления пользователем.

        Включенная защита не помешает подключиться к кластеру вручную и удалить данные.

    1. Нажмите кнопку **{{ ui-key.yacloud.mdb.forms.button_edit }}**.

- CLI

    {% include [cli-install](../../_includes/cli-install.md) %}

    {% include [default-catalogue](../../_includes/default-catalogue.md) %}

    1. Посмотрите описание команды CLI для изменения кластера:

        ```bash
        {{ yc-dp }} cluster update --help
        ```

    
    1. Чтобы изменить [лог-группу](../../logging/concepts/log-group.md), в которую отправляются логи кластера, передайте идентификатор нужной лог-группы в параметре `--log-group-id`:

        ```bash
        {{ yc-dp }} cluster update <идентификатор или имя кластера> \
           --log-group-id=<идентификатор лог группы>
        ```

        Идентификатор лог-группы можно получить со [списком лог-групп в каталоге](../../logging/operations/list.md).


    1. Чтобы защитить кластер от непреднамеренного удаления пользователем вашего облака, задайте значение `true` для параметра `--deletion-protection`:

        ```bash
        {{ yc-dp }} cluster update <идентификатор или имя кластера> \
           --deletion-protection=<защита от удаления кластера: true или false>
        ```

        Включенная защита не помешает подключиться к кластеру вручную и удалить данные.

    1. Чтобы изменить [свойства компонентов](../concepts/settings-list.md), передайте необходимые свойства в параметре `--property`:

        ```bash
        {{ yc-dp }} cluster update <идентификатор или имя кластера> \
           --property "<префикс ключа 1>:<ключ 1>=<значение>", "<префикс ключа 2>:<ключ 2>=<значение>", ...
        ```

        {% note warning %}

        Использование параметра `--property` переопределит все свойства компонентов, которые не были явно переданы в параметре, на значения по умолчанию. Чтобы сохранить измененные ранее свойства, перечислите их в запросе наряду со свойствами, которые хотите изменить.

        {% endnote %}

    Идентификатор и имя кластера можно получить со [списком кластеров в каталоге](./cluster-list.md#list).

- {{ TF }}

    1. Откройте актуальный конфигурационный файл {{ TF }} с планом инфраструктуры.

        О том, как создать такой файл, см. в разделе [{#T}](cluster-create.md).

    1. Чтобы включить защиту от удаления кластера и доступ к [веб-интерфейсам компонентов](../concepts/interfaces.md) {{ dataproc-name }}, измените значения соответствующих полей в описании кластера {{ dataproc-name }}:

        ```hcl
        resource "yandex_dataproc_cluster" "<имя кластера>" {
          ...
          deletion_protection = true
          ui_proxy            = true
          ...
        }
        ```

    1. Проверьте корректность настроек.

        {% include [terraform-validate](../../_includes/mdb/terraform/validate.md) %}

    1. Подтвердите изменение ресурсов.

        {% include [terraform-apply](../../_includes/mdb/terraform/apply.md) %}

    Более подробную информацию о ресурсах, которые вы можете создать с помощью {{ TF }}, см. в [документации провайдера]({{ tf-provider-resources-link }}/dataproc_cluster).

{% endlist %}
