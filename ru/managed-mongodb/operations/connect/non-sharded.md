# Подключение к нешардированному {{ MG }}-кластеру

## Подключение из графических IDE {#connection-ide}

{% include [ide-environments](../../../_includes/mdb/mmg-ide-envs.md) %}

Подключаться из графических IDE можно только к хостам кластера в публичном доступе с использованием SSL-сертификата. Перед подключением [подготовьте сертификат](./index.md#get-ssl-cert).

{% list tabs %}

- DataGrip

  1. Создайте источник данных:
     1. Выберите в меню **File** → **New** → **Data Source** → **{{ MG }}**.
     1. На вкладке **General**:
        1. Укажите параметры подключения:
           * **User**, **Password** — имя и пароль пользователя БД;
           * **URL** — строка подключения:

                ```http
                mongodb://<FQDN хоста 1 {{ MG }}>:{{ port-mmg }},..,<FQDN хоста N {{ MG }}>:{{ port-mmg }}/<имя БД>
                ```

        1. Нажмите ссылку **Download**, чтобы загрузить драйвер соединения.
     1. На вкладке **SSH/SSL**:
        1. Включите настройку **Use SSL**.
        1. В поле **CA file** укажите путь к файлу [SSL-сертификата для подключения](./index.md#get-ssl-cert).
  1. Нажмите ссылку **Test Connection** для проверки подключения. При успешном подключении будет выведен статус подключения, информация о СУБД и драйвере.
  1. Нажмите кнопку **OK**, чтобы сохранить источник данных.

- DBeaver

  Поддержка подключения к {{ MG }}-кластеру доступна только в [коммерческих редакциях DBeaver](https://dbeaver.com/buy/).

  Чтобы подключиться к кластеру:

  1. Создайте новое соединение с БД:
     1. Выберите в меню **База данных** пункт **Новое соединение**.
     1. Выберите из списка БД **{{ MG }}**.
     1. Нажмите кнопку **Далее**.
     1. Настройте параметры подключения на вкладке **Главное**:
        1. В блоке **Адрес** переключите **Type** на `URL` и укажите строку подключения:

             ```http
             mongo://<FQDN хоста 1 {{ MG }}>:{{ port-mmg }},..,<FQDN хоста N {{ MG }}>:{{ port-mmg }}/<имя БД>
             ```

        1. В списке **Устройство** выберите значение `SCRAM-SHA-256` (тип шифрования пароля при подключении).
        1. В блоке **Полномочия** укажите имя и пароль пользователя БД.
     1. На вкладке **SSL**:
        1. Включите настройку **Использовать SSL**.
        1. В блоке **Параметры** в поле **Корневой сертификат** укажите путь к файлу [SSL-сертификата для подключения](./index.md#get-ssl-cert).
        1. В блоке **Настройки** включите **Пропустить валидацию имени хоста**.
  1. Нажмите кнопку **Тест соединения ...** для проверки подключения. При успешном подключении будет выведен статус подключения, информация о СУБД и драйвере.
  1. Нажмите кнопку **Готово**, чтобы сохранить настройки соединения с БД.

{% endlist %}

## Примеры строк подключения {#connection-string}

{% include [conn-strings-environment](../../../_includes/mdb/mdb-conn-strings-env.md) %}

{% include [see-fqdn-in-console](../../../_includes/mdb/see-fqdn-in-console.md) %}

В примерах ниже предполагается, что SSL-сертификат `root.crt` расположен в директории:

* `/home/<домашняя директория>/.mongodb/` для Ubuntu;
* `$HOME\.mongodb` для Windows.

При успешном подключении к кластеру и выполнении тестового запроса будут выведены:

* для примеров на PHP — результат выполнения команды `ping`;
* для других примеров — имя БД, к которой было выполнено подключение.

{% include [mmg-connection-strings](../../../_includes/mdb/mmg/conn-strings.md) %}
