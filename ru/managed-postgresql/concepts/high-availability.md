---
title: Высокая доступность кластера {{ mpg-full-name }}
description: Высокая доступность — это способность системы продолжать работу при отказе одного или нескольких компонентов. Высокая доступность кластера {{ mpg-name }} определяется количеством и расположением его хостов, настройками репликации и другими параметрами кластера.
---

# Высокая доступность кластера {{ mpg-name }}

[Высокая доступность кластера {{ mpg-name }}](../../architecture/fault-tolerance.md#mdb-ha) определяется количеством и расположением его хостов, настройками репликации и другими параметрами кластера.

## Количество и расположение хостов кластера {#host-configuration}

Кластер из одного хоста не обеспечивает высокую доступность. При выходе из строя виртуальной машины хоста-мастера кластер будет недоступен на чтение и запись до окончания работ по восстановлению ВМ. На кластер из одного хоста не распространяется [Соглашение об уровне обслуживания (SLA)](https://yandex.ru/legal/cloud_sla_mdb/).

Кластер с двумя хостами, расположенными в разных зонах доступности, считается высокодоступным и на него распространяется [SLA](https://yandex.ru/legal/cloud_sla_mdb/). Этот вариант подходит для среднеразмерных приложений в production-окружении.

Кластер с тремя и более хостами, расположенными в трех разных зонах доступности, считается высокодоступным и на него распространяется [SLA](https://yandex.ru/legal/cloud_sla_mdb/). Подходит для production-окружений, в которых предъявляются повышенные требования к доступности и производительности.

Подробнее см. в разделе [Планирование топологии кластера](planning-cluster-topology.md).

## Настройки репликации и переключения мастера {#replication-settings}

Высокая доступность обеспечивается механизмами [репликации и переключения мастера](replication.md), которые имеют следующие особенности:

* В кластере используется потоковая репликация. Каждый хост-реплика получает поток репликации от другого хоста (обычно это хост-мастер). {{ mpg-name }} управляет потоками репликации в кластере [автоматически](replication.md#replication-auto), но при необходимости ими можно [управлять вручную](../operations/hosts.md#update). Реплики, для которых вручную установлен источник репликации, [имеют ряд ограничений](replication.md#replication-manual).
* По умолчанию в кластере используется механизм автоматического выбора и переключения на новый мастер. Этот механизм можно отключить, при этом в случае отказа мастера необходимо вручную выбрать новый мастер и [переключиться на него](../operations/update#start-manual-failover).
* Если для хоста используется публичный доступ, то для реплик он также должен быть включен, иначе при переключении мастера кластер станет недоступен.

{% note warning %}

Использование [особого FQDN](../operations/connect.md#special-fqdns) упрощает написание приложений, но приводит к временной недоступности кластера при переключении на новый мастер. Для быстрого переключения на новый мастер необходимо реализовать на стороне приложения [отслеживание смены мастера](planning-cluster-topology.md#cluster-availability).

{% endnote %}

## Настройки обслуживания {#maintenance-settings}

В процессе [технического обслуживания](maintenance.md) кластер с двумя и более хостами может быть недоступен для записи до автоматического переключения мастера. Кластер из одного хоста полностью недоступен на время технического обслуживания. Поэтому рекомендуется выбирать предпочтительный [день недели и час обслуживания](maintenance#maintenance-window) с учетом предполагаемой нагрузки на кластер.

При [обновлении версии {{ PG }}](../operations/cluster-version-update.md) кластер с тремя и более хостами недоступен на запись, но минимум одна реплика доступна для чтения. Кластер, содержащий один или два хоста, полностью недоступен на время обновления версии {{ PG }}. Рекомендуется выбирать момент обновления кластера с учетом предполагаемой нагрузки на него.

## Прочие настройки {#other-settings}

На доступность кластера также могут влиять следующие настройки:

* [настройки резервного копирования](backup.md);
* выбранный [тип дисков хранилища](storage.md);
* [классы хостов](instance-types.md);
* режим работы и настройки [менеджера подключений](pooling.md);
* [квоты и лимиты](limits.md);
* [настройки журнала опережающей записи (WAL)](replication.md#write-sync-and-read-consistency).
