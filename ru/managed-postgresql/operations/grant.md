# Назначение прав и ролей пользователям

Пользователь, который создается вместе с кластером {{ mpg-name }}, автоматически получает роль владельца (`OWNER`) первой базы данных в кластере. После этого вы можете создавать других пользователей и настраивать их права по своему усмотрению.

Атомарные полномочия в {{ PG }} называются _привилегиями_, группы полномочий — _ролями_. Подробнее об организации прав доступа читайте в [документации {{ PG }}](https://www.postgresql.org/docs/current/user-manag.html).

Чтобы назначить **привилегию** определенному пользователю, [создайте](cluster-users.md) его с помощью консоли управления, CLI или API Яндекс.Облака, затем выполните команду `GRANT` от имени владельца базы, например:

```postgresql
GRANT SELECT ON DATABASE db1 TO user2;
```

Чтобы назначить **роль** пользователю, используйте CLI или API Яндекс.Облака: назначение роли запросом `GRANT` отменяется при следующей операции с базой.


## Изменить список ролей пользователя {#grant-role}

Таким образом, чтобы добавить роль, запросите список имеющихся ролей с [информацией о пользователе](cluster-users.md), добавьте нужную роль к списку и отправьте новый список в запросе. Аналогично, чтобы отозвать роль — отправьте запрос со списком ролей, в котором ненужной роли нет.

{% list tabs %}

- CLI

  {% include [cli-install](../../_includes/cli-install.md) %}

  {% include [default-catalogue](../../_includes/default-catalogue.md) %}

  Чтобы назначить роли пользователю кластера, передайте список нужных ролей в параметре `--grants`. Имеющиеся роли будут полностью перезаписаны: если вы хотите дополнить или уменьшить имеющийся список, сначала запросите текущие роли с информацией о пользователе командой `{{ yc-mdb-pg }} user get`.

  Чтобы назначить роли, выполните команду:

  ```
  $ {{ yc-mdb-pg }} user update <имя пользователя>
       --cluster-name <имя кластера>
       --grants="<роль1,роль2>"
  ```

  Имя кластера можно запросить со [списком кластеров в каталоге](cluster-list.md), имя пользователя — в [списке пользователей](../operations/cluster-users.md#list-users).

- API

  Передать список необходимых ролей для пользователя можно с помощью метода [update](../api-ref/User/update.md).
  
  Имеющиеся роли будут полностью перезаписаны: если вы хотите дополнить или уменьшить имеющийся список, сначала запросите текущие роли с информацией о пользователе методом [get](../api-ref/User/get.md).

{% endlist %}

## Пример

### Создание пользователя с правом только на чтение

Чтобы создать пользователя, который не может изменять данные в базе, но имеет доступ к данным:

1. [Создайте пользователя](cluster-users.md#adduser) в кластере.
2. От лица владельца БД выдайте новому пользователю привилегии `SELECT` и, при необходимости, `USAGE` на нужную базу данных или таблицу, например:

   ```postgresql
   GRANT SELECT ON ALL TABLES IN SCHEMA myschema TO user2;
   GRANT USAGE ON SCHEMA myschema TO user2;
   ```
