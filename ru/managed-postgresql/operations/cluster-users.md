# Управление пользователями БД

Вы можете добавлять и удалять пользователей, а также управлять их индивидуальными настройками.

{% note warning %}

С помощью команд SQL вы можете назначать пользователям привилегии, но не можете добавлять и изменять пользователей. Подробнее см. в разделе [{#T}](grant.md).

{% endnote %}

## Получить список пользователей {#list-users}

{% list tabs %}

- Консоль управления

  1. Перейдите на страницу каталога и выберите сервис **{{ mpg-name }}**.
  1. Нажмите на имя нужного кластера, затем выберите вкладку **Пользователи**.

- CLI

  {% include [cli-install](../../_includes/cli-install.md) %}

  {% include [default-catalogue](../../_includes/default-catalogue.md) %}

  Чтобы получить список пользователей кластера, выполните команду:

  ```
  $ {{ yc-mdb-pg }} user list
       --cluster-name <имя кластера>
  ```

  Имя кластера можно запросить со [списком кластеров в каталоге](cluster-list.md).

{% endlist %}

## Добавить пользователя {#adduser}

{% list tabs %}

- Консоль управления

  1. Перейдите на страницу каталога и выберите сервис **{{ mpg-name }}**.
  1. Нажмите на имя нужного кластера и выберите вкладку **Пользователи**.
  1. Нажмите кнопку **Добавить**.
  1. Введите имя пользователя базы данных и пароль (от 8 до 128 символов).
  1. Выберите одну или несколько баз данных, к которым должен иметь доступ пользователь:
     1. Выберите базу данных из выпадающего списка **База данных**.
     1. Нажмите кнопку **Добавить** справа от выпадающего списка.
     1. Повторите два предыдущих шага, пока не будут выбраны все требуемые базы данных.
     1. Чтобы удалить базу, добавленную по ошибке, нажмите значок ![image](../../_assets/cross.svg) справа от имени базы в перечне **Права**.
  1. Задайте [настройки СУБД](../concepts/settings-list.md#dbms-user-settings) для пользователя.
  1. Нажмите кнопку **Добавить**.

- CLI

  {% include [cli-install](../../_includes/cli-install.md) %}

  {% include [default-catalogue](../../_includes/default-catalogue.md) %}

  Чтобы создать пользователя в кластере, выполните команду:

  ```
  $ {{ yc-mdb-pg }} user create <имя пользователя>
       --cluster-name <имя кластера>
       --password=<пароль для пользователя>
       --permissions=<список баз, к которым пользователь должен иметь доступ>
       --conn-limit=<максимальное количество соединений для пользователя>
  ```

  В этой команде указаны только основные настройки пользователя.

  Чтобы задать настройки СУБД для пользователя, воспользуйтесь параметрами, описанными в разделе [Пользовательские настройки](../concepts/settings-list.md#dbms-user-settings).

  Имя кластера можно запросить со [списком кластеров в каталоге](cluster-list.md).

{% endlist %}

{% note info %}

Сразу после создания пользователь получает только привилегию `CONNECT` для выбранных баз данных, и не может выполнять никакие операции с базами данных. Чтобы дать пользователю доступ к базам, [назначьте](grant.md) ему нужные привилегии или роли.

{% endnote %}

## Изменить пароль {#updateuser}

{% list tabs %}

- Консоль управления

  Чтобы изменить пароль пользователя:
  1. Перейдите на страницу каталога и выберите сервис **{{ mpg-name }}**.
  1. Нажмите на имя нужного кластера и выберите вкладку **Пользователи**.
  1. Нажмите значок ![image](../../_assets/vertical-ellipsis.svg) и выберите пункт **Изменить пароль**.
  1. Задайте новый пароль и нажмите кнопку **Изменить**.

- CLI

  {% include [cli-install](../../_includes/cli-install.md) %}

  {% include [default-catalogue](../../_includes/default-catalogue.md) %}

  Чтобы изменить пароль пользователя, выполните команду:

  ```
  $ {{ yc-mdb-pg }} user update <имя пользователя>
       --cluster-name=<имя кластера>
       --password=<новый пароль>
  ```

  Имя кластера можно запросить со [списком кластеров в каталоге](cluster-list.md).

{% endlist %}

## Изменить настройки пользователя {#update-settings}

{% note info %}

Привилегии и роли {{ PG }} не затрагиваются этими настройками и настраиваются отдельно.

О том, как задать привилегии и роли для пользователя, читайте в разделе [{#T}](grant.md).

{% endnote %}

{% list tabs %}

- Консоль управления

  Чтобы изменить настройки пользователя:
  1. Перейдите на страницу каталога и выберите сервис **{{ mpg-name }}**.
  1. Нажмите на имя нужного кластера и выберите вкладку **Пользователи**.
  1. Нажмите значок ![image](../../_assets/vertical-ellipsis.svg) и выберите пункт **Настройки**.
  1. Настройте права пользователя на доступ к определенным базам данных:
     1. Чтобы предоставить доступ к требуемым базам данных:
        1. Выберите базу данных из выпадающего списка **База данных**.
        1. Нажмите кнопку **Добавить** справа от выпадающего списка.
        1. Повторите два предыдущих шага, пока не будут выбраны все требуемые базы данных.
     1. Чтобы отозвать доступ к определенной базе, удалите ее из перечня **Права**, нажав значок ![image](../../_assets/cross.svg) справа от имени базы.
  1. Измените [настройки {{ PG }}](../concepts/settings-list.md#dbms-user-settings) для пользователя в разделе **Настройки СУБД**.
  1. Нажмите кнопку **Сохранить**.

- CLI

  {% include [cli-install](../../_includes/cli-install.md) %}

  {% include [default-catalogue](../../_includes/default-catalogue.md) %}

  Из интерфейса командной строки можно изменить настройки пользователя:

  1. Чтобы настроить права пользователя на доступ к определенным базам данных, выполните команду, перечислив список имен баз данных с помощью параметра `--permissions`:

     ```
     $ {{ yc-mdb-pg }} user update <имя пользователя>
          --cluster-name=<имя кластера>
          --permissions=<список баз, к которым пользователь должен иметь доступ>
     ```

     Имя кластера можно запросить со [списком кластеров в каталоге](#list-clusters).

     Эта команда предоставляет пользователю доступ к базам данных, указанным в списке.

     Чтобы отозвать доступ к определенной базе, исключите ее имя из списка и передайте команде обновленный список.

  1. Чтобы изменить [настройки {{ PG }}](../concepts/settings-list.md#dbms-user-settings) для пользователя, передайте параметры, отвечающие за требуемые настройки, в команде:

     ```
     $ {{ yc-mdb-pg }} user update <имя пользователя>
          --cluster-name=<имя кластера>
          --<настройка 1>=<значение 1>
          --<настройка 2>=<значение 2>
          --<настройка 3>=<список значений>
          ...
     ```

     Имя кластера можно запросить со [списком кластеров в каталоге](#list-clusters).

{% endlist %}

## Удалить пользователя {#removeuser}

{% list tabs %}

- Консоль управления

  1. Перейдите на страницу каталога и выберите сервис **{{ mpg-name }}**.
  1. Нажмите на имя нужного кластера и выберите вкладку **Пользователи**.
  1. Нажмите значок ![image](../../_assets/vertical-ellipsis.svg) и выберите пункт **Удалить**.

- CLI

  {% include [cli-install](../../_includes/cli-install.md) %}

  {% include [default-catalogue](../../_includes/default-catalogue.md) %}

  Чтобы удалить пользователя, выполните команду:

  ```
  $ {{ yc-mdb-pg }} user delete <имя пользователя>
       --cluster-name <имя кластера>
  ```

  Имя кластера можно запросить со [списком кластеров в каталоге](cluster-list.md).

{% endlist %}

{% include [user-ro](../../_includes/mdb/mpg-user-examples.md) %}
