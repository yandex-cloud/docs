# Создание кластера {{ PG }} для «1С:Предприятия»

{{ mpg-name }} позволяет создавать отказоустойчивые кластеры {{ PG }}, оптимизированные для работы с системой «1С:Предприятие». Для этого в сервисе поддерживаются версии PostgreSQL 10-1с, 11-1с и 12-1c, в которых установлены все необходимые [расширения](#extensions) и изменена конфигурация пулера соединений.

{% note warning %}

Систему «1С:Предприятие» можно подключить только к кластерам версии 10-1с, 11-1с и 12-1c.

{% endnote %}

При выборе [класса хоста](../concepts/instance-types.md) ориентируйтесь на количество пользователей вашей инсталляции «1С:Предприятия». На хостах класса **s2.small** смогут одновременно работать до 50 пользователей. Класс **s2.medium** рекомендуется использовать, если с базой будут работать 50 и более пользователей. Размер хранилища следует выбирать исходя из размеров вашей информационной базы — учитывайте возможный рост объемов данных.

## Создайте кластер {{ PG }} {#create-cluster}

Чтобы создать кластер {{ mpg-name }} для 1С:

1. На странице каталога в [консоли управления]({{ link-console-main }}) нажмите кнопку **Создать ресурс** и выберите **Кластер PostgreSQL**.

1. В поле **Имя** введите имя кластера: `postgresql-1c`.

1. В поле **Окружение** выберите `PRODUCTION`.

1. В поле **Версия** выберите `12-1c`.

1. В блоке **Класс хоста** выберите **s2.small**.

1. В блоке **Размер хранилища** укажите 10 ГБ.

1. В блоке **База данных**:
    - В поле **Имя БД** введите `postgresql-1c`.
    - В поле **Имя пользователя** введите `user-1c`.
    - В поле **Пароль** введите пароль, который вы будете использовать для доступа к базе.

1. В блоке **Сеть** выберите из списка сеть, в которой будут находиться хосты кластера.

1. В блоке **Хосты** добавьте еще два хоста в других зонах доступности для обеспечения отказоустойчивости кластера. База автоматически [реплицируется](../concepts/replication.md).

1. В блоке **Дополнительные настройки** задайте время начала резервного копирования.

1. Нажмите кнопку **Создать кластер**.

Создание кластера БД может занять несколько минут.

## Подключите базу к «1С:Предприятию» {#connect-to-1c}

Подключите созданную базу в качестве информационной базы «1С:Предприятия». При добавлении базы используйте следующие параметры:

* **Защищенное соединение**: `Выключено`.
* **Тип СУБД**: `PostgreSQL`.
* **Сервер баз данных**: `<има хоста мастера>.{{ dns-zone }} port=6432`.
* **Имя базы данных**: `postgresql-1c`.
* **Пользователь базы данных**: `user-1c`.
* **Пароль пользователя**: `<пароль пользователя базы данных>`.
* **Создать базу данных в случае ее отсутствия**: отключено.

## Расширения {{ PG }} для поддержки системы «1С:Предприятие» {#extensions}

Список расширений, которые установлены в кластерах PostgreSQL версии 10-1с, 11-1с и 12-1c:

* [online_analyze](https://postgrespro.ru/docs/postgrespro/10/online-analyze)

* [plantuner](https://postgrespro.ru/docs/postgrespro/10/plantuner)

* [fasttrun](https://postgrespro.ru/docs/postgrespro/10/fasttrun)

* [fulleq](https://postgrespro.ru/docs/postgrespro/10/fulleq)

* [mchar](https://postgrespro.ru/docs/postgrespro/10/mchar)
