# Обработчик запросов

_Обработчик запросов_ — это метод, который используется для обработки каждого вызова функции. При создании версии функции необходимо указать точку входа, которая состоит из имени файла и имени обработчика запросов (например, `main.handler`).

{% note info %}

В каждый момент времени один экземпляр функции обрабатывает только один запрос. Это позволяет использовать глобальные переменные без необходимости обеспечивать контроль целостности данных.

{% endnote %}

При вызове обработчика среда выполнения передает следующие аргументы:
1. Тело запроса (параметр `event`):
    * Если тело запроса — [JSON-документ](../../concepts/function-invoke.md#request), то оно будет преобразовано в `dict` c помощью метода `json.loads`.
    * Если функция была вызвана с параметром строки запроса `integration=raw`, тело HTTP-запроса передается в функцию как есть, без обработки.
1. [Контекст вызова](context.md) (параметр `context`). 

    Контекст содержит необходимую информацию о версии функции. Структура этого объекта описана в разделе [{#T}](context.md).
    
## Виды обработчика {#type}

Функция может использовать как синхронный, так и асинхронный обработчик.

## Синхронный обработчик {#sync}

Чтобы вернуть результат выполнения, используйте оператор `return` или сигнализируйте об исключении с помощью оператора `raise`. Синхронная функция обязана возвращать результат или завершаться исключением.

## Асинхронный обработчик {#async}

Обработчик может быть асинхронной функцией `async def`. В этом случае вы можете использовать следующие операторы: 
* `return` — возвращает ответ функции.
* `raise` — сообщает среде выполнения об ошибке.
* `await` — отслеживает выполнение вызова асинхронных функций.

{% note info %}

В качестве среды исполнения асинхронных функций поддерживается только библиотека `asyncio`. 

{% endnote %}

Подробнее о разработке с помощью `async/await` читайте в [соответстующем разделе документации](https://docs.python.org/3.7/library/asyncio.html).

## Примеры {#examples}

### Вывод структуры HTTP-запроса {#http-req}

Следующая функция выводит структуру запроса и контекста вызова одновременно и в журнал выполнения, и в ответ функции:

```python
import json


def handler(event, context):
    return {
        'statusCode': 200,
        'body': json.dumps({
            'event': event,
        }),
    }
```
