# Политики проверки совместимости

_Политика проверки совместимости_ — это совокупность правил, по которым {{ schema-registry-full-name }} проверяет совместимость новой схемы с предыдущими на уровне [пространства имен](schema-registry.md#namespace).

Вы можете выбрать политику проверки совместимости схем при [создании](../operations/create-name-space.md) или [изменении](../operations/update-name-space.md) пространства имен. Политики проверки совместимости доступны для схем [Protobuf](https://protobuf.dev/) и [JSON Schema](https://json-schema.org/).

## Политики совместимости Protobuf-схем {#protobuf-compatibility-policy}

Для Protobuf-схем доступны следующие политики:

* Confluent — основывается на рекомендованных методах эволюции схем Protobuf. Подробнее об эволюции схем см. в [документации Protobuf](https://protobuf.dev/programming-guides/proto3/#updating).

* buf — основывается на стандартах Buf v1. Подробнее о применяемых проверках см. в [спецификации](https://github.com/bufbuild/buf/blob/main/private/bufpkg/bufcheck/bufcheckserver/bufcheckserver.go#L156).

## Политики совместимости JSON-схем {#json-compatibility-policy}

Для JSON-схем доступны следующие политики:

* Confluent — основывается на стандартах Confluent Schema Registry и реализует математически точную проверку совместимости. Такая политика не позволяет добавлять и удалять опциональные параметры в полях типа `object`. В отдельных случаях, например при работе с очередями, это ограничение может быть избыточным.

* Optional Friendly — основывается на [решении](#optional-parameters-compatibility-solution) с использованием разных контентных моделей для производителя и потребителя. В данном случае регистрируется только схема для производителя. Для проверки совместимости схема потребителя конвертируется из открытой контентной модели в закрытую и сравнивается с зарегистрированными схемами производителя. Это позволяет поддерживать добавление и удаление опциональных параметров, сохраняя полную транзитивную совместимость.
