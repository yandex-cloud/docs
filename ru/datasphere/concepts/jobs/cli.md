# {{ ds-cli }}

Для запуска заданий {{ ds-jobs }} используется утилита {{ ds-cli }}. 

Чтобы установить {{ ds-cli }}, в [виртуальном окружении Python](https://docs.python.org/3.10/library/venv.html) выполните команду:

```python
pip install datasphere
```

После завершения установки вы можете посмотреть справку, запустив команду с флагом `-h`:

```bash
datasphere -h
```

Результат выполнения команды:

```bash
usage: datasphere [-h] [-t TOKEN] [-l {ERROR,WARNING,INFO,DEBUG}] [--log-config LOG_CONFIG] {version,project} ...

positional arguments:
  {version,project}
    version             Show version

options:
  -h, --help            show this help message and exit
  -t TOKEN, --token TOKEN
                        YC OAuth token, see https://yandex.cloud/en/docs/iam/concepts/authorization/oauth-token
  -l {ERROR,WARNING,INFO,DEBUG}, --log-level {ERROR,WARNING,INFO,DEBUG}
                        Logging level
  --log-config LOG_CONFIG
                        Custom logging config
```

## Команды {{ ds-cli }} {#commands}

Для управления заданиями используются команды раздела `datasphere project job`:
* [запуск](#execute) и восстановление сессии задания;
* [просмотр](#list) информации о заданиях;
* [отмена](#cancel) задания.

### Запуск заданий {#execute}

Чтобы запустить задание, выполните команду:
  
```bash
datasphere project job execute -p <идентификатор_проекта> -c <файл_конфигурации>
```

Где:

* `<идентификатор_проекта>` — идентификатор проекта {{ ml-platform-name }}, в котором вы будете запускать задание.
* `<файл_конфигурации>` — путь к [файлу конфигурации задания](index.md#config).

Запуск задания блокирует сессию командной оболочки до завершения задания. Логи работы кода задания будут выведены в стандартные потоки вывода `stdout` и ошибок `stderr`. Системные логи выполнения задания будут записаны в отдельный файл в рабочей директории пользователя. 
  
Если в процессе выполнения задания сессия командной оболочки прервалась, задание продолжит выполняться в {{ ml-platform-name }}, однако логи выполнения не будут сохраняться. Чтобы возобновить запись логов, восстановите сессию, выполнив команду:

```bash
datasphere project job attach --id <идентификатор_задания>
```

Узнать идентификатор задания можно в интерфейсе {{ ml-platform-name }} в виджете заданий на странице проекта. 

Отслеживание и запись логов возобновятся после восстановления сессии задания.

### Просмотр информации о задании {#list}

Вы можете посмотреть все прошедшие и текущие задания проекта, выполнив команду:

```bash
datasphere project job list -p < идентификатор_проекта>
```

В ответ вернется таблица со следующими полями:
* идентификатор задания
* имя
* описание
* статус
* дата начала выполнения и окончания задания (если оно уже завершилось)
* имя пользователя, запустившего задание

Чтобы посмотреть информацию о конкретном задании, выполните команду:

```bash
datasphere project job get --id <идентификатор_задания>
```

### Отмена задания {#cancel}

Вы можете остановить и отменить выполнение задания двумя способами:

1. Если у вас запущенна сессия командной оболочки с заданием в процессе выполнения, нажмите **Ctrl** + **C**. 
1. Если вы хотите остановить выполнение задания, не связанного с активной сессией командной оболочки, выполните команду:

  ```bash
  datasphere project job cancel --id <идентификатор_задания>
  ```

Запущенное задание будет остановлено.
