# Docker-образы

Вы можете самостоятельно настроить окружение проекта {{ ml-platform-name }} с помощью [_Docker-образа_](https://docs.docker.com/engine/reference/commandline/image/), собрав в него произвольный набор ПО, библиотек, переменных окружения и конфигурационных файлов. Docker-образ, примененный для проекта, будет использоваться при запуске кода во всех его ноутбуках.

Созданные Docker-образы нельзя изменить.

{% note warning %}

С 31 января 2026 года все Docker-образы, созданные в {{ ml-platform-name }} до 3 декабря 2025 года, перестанут работать. Чтобы использовать их в проектах, создайте их заново или используйте инструмент миграции.

{% endnote %}

## Способы хранения Docker-образов {#storage}

Существует два способа хранения пользовательских образов:
* в [{{ container-registry-full-name }}](../../container-registry/);
* в {{ ml-platform-name }}.

### Хранение в {{ container-registry-name }} {#cr}

По умолчанию Docker-образы хранятся в {{ container-registry-name }}. Образ собирается на ВМ {{ ml-platform-name }} и в случае успеха загружается в реестр, указанный в настройках сообщества, а его версия фиксируется в соответствующем ресурсе {{ ml-platform-name }}. При каждом запуске проекта с таким образом {{ ml-platform-name }} будет скачивать эту версию из реестра. Если удалить эту версию образа из реестра, Docker-образ в проекте останется, но его больше нельзя будет оптимизировать, активировать и использовать в проекте.

Хранение образов в {{ container-registry-name }} обходится [дешевле](../../container-registry/pricing.md#prices-storage), но они увеличивают время запуска проекта. Кроме того, образом из реестра нельзя поделиться в сообществе.

Чтобы ускорить запуск проекта, вы можете создать оптимизированную копию Docker-образа, хранящегося в {{ container-registry-name }}. Оптимизированная копия хранится на отдельном диске в {{ ml-platform-name }} и значительно ускоряет запуск проекта, но ее хранение дополнительно [тарифицируется](../pricing.md#storage). Оптимизированный Docker-образ можно [опубликовать](../operations/user-images.md#share) в сообществе, чтобы использовать его в нескольких проектах. 

После создания оптимизированной копии вы можете удалить оригинальную версию образа из реестра, чтобы не платить за хранение оригинала и копии. Когда вы удалите оптимизированную копию Docker-образа, {{ ml-platform-name }} снова попробует скачать Docker-образ из {{ container-registry-name }} при запуске проекта. Если оригинальная версия в {{ container-registry-name }} сохранится, проект продолжит использовать ее. 

{% note tip %}

Чтобы пользователи проектов могли собирать и хранить Docker-образы в {{ container-registry-name }}, администратор сообщества должен указать нужный реестр в настройках сообщества и включить [сервисного агента](../operations/community/create-ssa.md).

{% endnote %}

### Хранение в {{ ml-platform-name }} {#datasphere}

Если при создании образа выбрать хранение в {{ ml-platform-name }}, после сборки Docker-образ останется храниться на выделенном диске в {{ ml-platform-name }} и не будет загружен в {{ container-registry-name }}. Такой образ сразу считается оптимизированным и тарифицируется соответственно.

Удаленный Docker-образ, хранящийся в {{ ml-platform-name }}, нельзя восстановить.

Docker-образ, хранящийся в {{ ml-platform-name }}, можно [опубликовать](../operations/user-images.md#share) в сообществе, чтобы использовать его в нескольких проектах. Для этого вам необходимы роли не ниже `Editor` в проекте и `Developer` в сообществе, в котором вы хотите его опубликовать. Открыть доступ можно на вкладке **{{ ui-key.yc-ui-datasphere.common.access }}** на странице просмотра Docker-образа. Ресурс, доступный для сообщества, появится на странице сообщества в разделе **{{ ui-key.yc-ui-datasphere.spaces-page.community-resources }}**. Пока образ опубликован, его нельзя удалить.

Подробнее о работе с Docker-образами см. на странице [{#T}](../operations/user-images.md).

## Требования к Docker-образу {#requirements}

Чтобы Docker-образ запускался и корректно работал в {{ ml-platform-name }}, он должен содержать:
* установку Python 3.8, 3.9, 3.10 или 3.11;
* установку pip;
* пользователя `--uid 1000 jupyter`.

{% include [Docker hub limits](../../_includes/datasphere/dockerhub-limits.md) %}

{% note info %}

Шаблоны Docker-образов, представленные в {{ ml-platform-name }}, уже удовлетворяют требованиям. Если вы загружаете образ из стороннего источника или пишете свой, добавьте в него необходимые команды.

{% endnote %}

#### См. также {#see-also}

[{#T}](../operations/user-images.md)
