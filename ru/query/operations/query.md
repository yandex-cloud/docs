# Работа с запросами


## Создание запроса {#create}

В {{yq-full-name}} можно исполнять [аналитические](../concepts/batch-processing.md) и [потоковые](../concepts/stream-processing.md) запросы. Для создания аналитического запроса нажмите кнопку **New analytical query**. Для создания потокового запроса нажмите **New streaming query**.


## Проверка запроса {#parse}

Для проверки текста запроса без его исполнения нажмите кнопку **Validate**. 

## Выполнение запроса {#run}

### Потоковые запросы
Потоковые запросы поддерживают сценарий запуска нового запроса или продолжение выполнения текущего. 

Для запуска нового запроса нажмите кнопку **Run**.

Для _продолжения_ выполнения потокового запроса выберите:
- **Continue** для продолжения обработки с последней [контрольной точки](../concepts/glossary.md#checkpoint).
- **Continue (force)** для продолжения обработки с места последней обработки в случае смены источника данных запроса.

{% note info %}

Потоковые запросы выполняются над потоками данными, которые не ограничены. Это означает, в отличие от аналитического запроса, потоковый запрос выполняется бесконечно. 

{% endnote %}

### Аналитические запросы
Аналитические запросы поддерживают только сценарий запуска запросов на исполнение. Для запуска запросов нажмите кнопку **Run**.

## Остановка запроса {#stop}

Для остановки выполнения запроса нажмите кнопку **Stop**.

### Просмотр результатов

Результаты исполнения запроса отображаются в разделе **Results**. 

{% note info %}

Для результатов исполнения запросов действуют следующие ограничения:
- Просмотр результатов доступен только для последнего исполнения запроса. 
- Результаты запросов удаляются по истечению времени жизни. Спустя 24 часа результаты исполнения запросов удаляются.

{% endnote %}

### Ошибки

Ошибки выполнения запросов отображаются в разделе **Errors**.

### План запроса

План запроса отображает [этапы исполнения запроса](../concepts/request-processing.md). 

### Метрики выполнения запроса

Метрики исполнения запроса позволяют детально диагностировать работу запросов под управлением {{yq-full-name}}. 
Метрики отображают информацию про:
- Входящие потоки данных;
- Используемые мощности для выполнения запроса;
- Объем использованной памяти;
- Объем выходных данных;

и другие метрики.

### Метаданные

В разделе **Meta** находится информация о метаданных запроса:
- Идентификатор запроса;
- Статус исполнения запроса;
- Дату создания, изменения, последнего исполнения запроса.

### Информация о выполненных запросах

Для каждого запроса {{yq-full-name}} сохраняет [историю исполнения](../concepts/glossary.md#job). 

История исполнения запроса доступна по нажатию кнопки **Show launches**.

## Переименование запроса {#update_query_name}

Для переименования запроса нажмите кнопку ![pencil](../../_assets/query/pensil.svg) рядом с именем запроса. 

Для сохранения имени запроса необходимо:
- Сохранить изменения, нажав кнопку **Save**,
- или запустить запрос кнопкой **Run**.

## Изменение запроса {#update}

Для изменения запроса введите новый текст запроса и нажмите кнопку **Run**.
Если запрос уже запущен, для изменения текста запроса, его нужно предварительно [остановить](#stop).

## Остановка запроса {#stop}

Для остановки исполнения аналитического запроса нажмите кнопку **Stop**.

Для остановки исполнения потокового запроса:
- Нажмите кнопку **Stop** для накопления необходимй информации для создания [контрольной точки](../concepts/glossary.md#checkpoint) и последующей остановки запроса.
- Нажмите кнопку **Force stop** для остановки исполнения запроса без создания контрольной точки.

## Клонирование запроса {#clone}

Для удобства разработки запросы можно клонировать в новый запрос с сохранением текста запроса. 

Любой запрос можно клонировать в запрос того же типа, что и оригинальный. За счет возможностей [единого анализа потоковых и аналитических данных](../concepts/unified-processing.md) любой запрос можно клонировать в запрос другого типа: 
- аналитический запрос можно клонировать в запрос потокового анализа;
- запрос потокового анализа можно клонировать в аналитический запрос.

## Удаление запроса {#delete}

1. В разделе **Queries** найдите нужный запрос.
1. Нажмите кнопку ![delete](../../_assets/query/delete.svg) для удаления запроса.
1. Подтвердите удаление запроса.
