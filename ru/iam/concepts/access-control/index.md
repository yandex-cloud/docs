# Как устроено управление доступом в Яндекс.Облаке

На этой странице можно узнать, как управлять доступом к ресурсам, и как {{ iam-short-name }} проверяет права доступа к ним.

## Как проверяются права доступа?

Все операции в Яндекс.Облаке предварительно отправляются на проверку в {{ iam-short-name }}, например:

1. Пользователь просит сервис Compute Cloud создать новый диск в каталоге <q>default</q>.
1. Сервис спрашивает {{ iam-short-name }}, можно ли этому пользователю создать диск в этом каталоге.
1. {{ iam-short-name }} проверяет, что пользователь — участник облака с каталогом <q>default</q> и имеет необходимые разрешения для создания диска в этом каталоге.
1. Если какого-то из разрешений у пользователя нет, операция не будет выполнена, и Яндекс.Облако сообщит об ошибке.
    Если все разрешения имеются, то {{ iam-short-name }} сообщает об этом сервису.
1. Сервис создает новый диск.

![checkPermissions.png](../../../_assets/checkPermissions.png)

## Как вы управляете доступом?

Управление доступом в Яндекс.Облаке построено на политике [Role Based Access Control](https://en.wikipedia.org/wiki/Role-based_access_control) (RBAC). Чтобы предоставить доступ к ресурсу, вы указываете, кому и какие [роли](roles.md) назначены на ресурс.

Чтобы назначить роль, вы [выбираете ресурс](#resource), [выбираете роль](#role) и [описываете субъект](#subject), которому назначается роль. Таким образом вы [привязываете права доступа](#access-bindings) к ресурсу.

Вы также можете назначить роль на родительский ресурс, от которого [наследуются права доступа](#inheritance), например назначить роль на каталог или облако.

{% note important %}

Изменение прав доступа обычно занимает до 5 секунд. Если после назначения роли все еще нет доступа, попробуйте выполнить операцию еще раз.

Например, вам разрешили создавать каталоги в облаке и вы уже создали один каталог, но не смогли создать второй. Это произошло потому, что еще не обновились права доступа на том сервере, где выполнялась вторая операция по созданию каталога. Попробуйте создать каталог еще раз.

{% endnote %}

### Ресурсы, на которые можно назначать роли {#resource}

Сейчас вы можете назначить роль [на облако](../../../resource-manager/operations/cloud/set-access-bindings.md), [каталог](../../../resource-manager/operations/folder/set-access-bindings.md) или [сервисный аккаунт](../../operations/sa/set-access-bindings.md).

Если вам необходимо предоставить доступ к другому ресурсу, например к виртуальной машине, назначьте роль на ресурс, от которого наследуются права доступа к виртуальной машине, например [на каталог](../../../resource-manager/operations/folder/set-access-bindings.md).

### Роль {#role}

Назначать роли на ресурс могут пользователи с ролью [администратора](roles.md#admin) на этот ресурс, а также владельцы облака, которому принадлежит ресурс.

Каждая роль состоит из набора разрешений, описывающих допустимые операции с ресурсом. Пользователь может назначить роли только с теми разрешениями, которые имеются у него самого. Например, чтобы назначить роль [владельца облака](roles.md#owner), пользователь должен сам обладать этой ролью, а роли администратора для этого недостаточно.

О том, какие есть роли и какие разрешения в них входят, читайте в разделе [{#T}](roles.md).

### Субъект, которому назначается роль {#subject}

Чтобы назначить роль, вы должны указать кому эта роль назначается. С точки зрения IAM роль назначается субъекту доступа.

Есть три типа субъектов:

* `userAccount` — аккаунт пользователя на Яндексе.
* `serviceAccount` — [сервисный аккаунт](../users/service-accounts.md), созданный в Яндекс.Облаке.
* `system` — [системная группа](system-group.md).

### Привязка прав доступа {#access-bindings}

Роли на ресурс назначаются в виде списка связей _роль-субъект_. Такие связи называются — _привязки прав доступа_ (access bindings). Вы можете добавлять и удалять эти связи, таким образом контролируя права доступа к ресурсу.

![accessBindings.png](../../../_assets/accessBindings.png)

Одна привязка — одно назначение роли субъекту. Чтобы назначить пользователю несколько ролей на ресурс, задайте отдельную привязку для каждой из ролей.

### Наследование прав доступа {#inheritance}

Если у ресурса есть дочерние ресурсы, то все разрешения от родительского ресурса будут унаследованы дочерними ресурсами. Например, если вы назначите пользователю роль на каталог, в котором лежит виртуальная машина, то все разрешения этой роли будут действовать и для виртуальной машины.

Если на дочерний ресурс тоже назначены роли, то список разрешений на этот ресурс будет объединен со списком разрешений на родительский ресурс. Нельзя ограничить список разрешений, унаследованных от родительского ресурса.

#### См. также

Вы можете найти подробную информацию об управлении доступом для конкретного сервиса Яндекс.Облака в разделе <q>Управление доступом</q> в документации соответствующего сервиса.

Пошаговые инструкции и примеры:

* [{#T}](../../operations/roles/grant.md)
* [{#T}](../../operations/roles/revoke.md)
* [{#T}](../../operations/sa/assign-role-for-sa.md)
* [{#T}](../../operations/sa/set-access-bindings.md)
* [{#T}](../../../resource-manager/operations/cloud/set-access-bindings.md)
* [{#T}](../../../resource-manager/operations/folder/set-access-bindings.md)
