---
title: "Обработка секретов, попавших в открытый доступ в {{ yandex-cloud }}"
description: "Из статьи вы узнаете, какие шаги предпринять в случае утечки секретов в открытый доступ." 
---

# Обработка секретов, попавших в открытый доступ

{{ yandex-cloud }} автоматически [ищет секреты в открытом доступе](../../security/operations/search-secrets.md). Чтобы обеспечить безопасность ваших данных и инфраструктуры, внимательно следите за использованием секретов. Если секреты были скомпрометированы:

1. [Отзовите и перевыпустите секреты](#revoke-credentials).
1. [Проверьте наличие несанкционированных действий](#searching-unauthorized-access).
1. [Удалите несанкционированные ресурсы](#delete-unauthorized-resources).
1. [Обратитесь в службу технической поддержки](#support).
1. [Выполните рекомендации по построению безопасной инфраструктуры](#recommendations).

## Отзовите и перевыпустите секреты {#revoke-credentials}

### IAM-токен {#iam-reissue}

Удалить IAM-токен нельзя. Если вы создадите новый IAM-токен, старый продолжит действовать.

Чтобы злоумышленник не смог использовать токен:

1. Выполните действия с аккаунтом, для которого выпущен IAM-токен:

    * Для сервисного аккаунта – [перевыпустите](#key-reissue) авторизованный ключ сервисного аккаунта, на который выдан токен, или удалите аккаунт.
    * Для аккаунта на Яндексе или федеративного аккаунта выполните одно из действий:

        * [исключите аккаунт](../../organization/operations/edit-account.md) из всех организаций на время действия токена;
        * отзовите права у аккаунта [в облаках](users/delete) и [организациях](../../organization/security/index.md#revoke) на время, пока действует токен.

            {% note info %}

            IAM-токен действует [не больше 12 часов](../concepts/authorization/iam-token.md#lifetime).

            {% endnote %}

2. Создайте новый IAM-токен:

    * [Инструкция для аккаунта на Яндексе](iam-token/create.md);
    * [Инструкция для сервисного аккаунта](iam-token/create-for-sa.md);
    * [Инструкция для федеративного аккаунта](iam-token/create-for-federation.md).

### OAuth-токен {#oauth-reissue}

OAuth-токен можно отозвать. При этом IAM-токен, для получения которого используется OAuth-токен, продолжит действовать.

Чтобы злоумышленник не смог использовать токен:

1. [Отзовите OAuth-токен](https://yandex.ru/dev/id/doc/dg/oauth/reference/token-invalidate.html).

1. Отзовите права у аккаунта, которому принадлежит OAuth-токен, одним из способов:

    * [исключите аккаунт](../../organization/operations/edit-account.md) из всех организаций на время, пока действует IAM-токен;
    * отзовите права у аккаунта [в облаках](users/delete) и [организациях](../../organization/security/index.md#revoke) на время, пока действует IAM-токен.

        {% note info %}

        IAM-токен действует не больше 12 часов. Подробнее о [времени жизни IAM-токена](../concepts/authorization/iam-token.md#lifetime).

        {% endnote %}

1. [Получите новый OAuth-токен]({{ link-cloud-oauth }}).

### Авторизованный ключ {#key-reissue}

Если вам нужно максимально быстро пресечь угрозы со стороны скомпрометированного ключа, [удалите](sa/delete.md) сервисный аккаунт.

Если для вас важнее непрерывность процесса, в котором участвует сервисный аккаунт, перевыпустите авторизованные ключи:

1. [Создайте новый авторизованный ключ](authorized-key/create.md) для сервисного аккаунта.
1. Предоставьте новый авторизованный ключ сервисам и пользователям, которые его используют.
1. [Получите IAM-токен](../../iam/operations/iam-token/create-for-sa.md) для нового авторизованного ключа.
1. [Удалите старый авторизованный ключ](./authorized-key/delete.md).

Когда вы удалите авторизованный ключ, соответствующий ему IAM-токен перестанет действовать. Этого достаточно, чтобы исключить угрозы со стороны скомпрометированного ключа.

### JWT {#jwt-reissue}

Выполните действия, описанные в разделе [Авторизованный ключ](#key-reissue).

### Статический ключ {#access-key-reissue}

1. [Создайте новый статический ключ](sa/create-access-key.md) для сервисного аккаунта.
1. Предоставьте новый статический ключ сервисам и пользователям, которые его используют.
1. [Удалите старый статический ключ](sa/delete-access-key.md).

### API-ключ {#api-key-reissue}

1. [Создайте новый API-ключ](api-key/create.md) для сервисного аккаунта.
1. Предоставьте новый API-ключ сервисам и пользователям, которые его используют.
1. [Удалите старый API-ключ](./api-key/delete.md).

### Серверный ключ {{ captcha-name }} {#captcha-server-key}

[Создайте новую капчу](../../smartcaptcha/quickstart.md#creat-captcha) и на странице сайта замените ей старую капчу, [серверный ключ](../../smartcaptcha/concepts/keys.md) которой попал в открытый доступ.

### Cookie {#cookie-invalidation}

Прекратите действие cookie:

1. [Измените пароль](https://yandex.ru/support/id/profile.html) Яндекс ID. 
1. [Авторизуйтесь в Яндекс ID](https://passport.yandex.ru/) с новым паролем.

## Проверьте наличие несанкционированных действий {#searching-unauthorized-access}

Проанализируйте доступ к вашим ресурсам {{ yandex-cloud }}:

1. [Изучите записи](../../logging/operations/read-logs.md) {{ cloud-logging-name }}.
1. Выполните [поиск событий в бакете](../../audit-trails/tutorials/search-bucket.md) и [поиск событий в лог-группе](../../audit-trails/tutorials/search-cloud-logging.md) {{ at-name }}.
1. Убедитесь, что все события, в том числе связанные с утечкой секретов, соответствуют ожиданиям.

{% note tip %}

Вы можете настроить [экспорт аудитных логов в SIEM](../../audit-trails/concepts/export-siem.md).

{% endnote %}

## Удалите несанкционированные ресурсы {#delete-unauthorized-resources}

1. Проверьте, не появились ли в {{ yandex-cloud }} ресурсы, которые вы не создавали, например [виртуальные машины](../../glossary/vm.md), хранилища данных, базы данных, [функции](../../functions/concepts/function.md), API-шлюзы и т. д.
1. Удалите несанкционированные ресурсы.

## Обратитесь в службу технической поддержки {#support}

Сообщите в [службу технической поддержки]({{ link-console-support }}) об инциденте. Эта информация поможет усовершенствовать защиту секретов в будущих релизах {{ yandex-cloud }}.

Подробнее о [порядке оказания технической поддержки](../../support/overview.md).

## Выполните рекомендации по построению безопасной инфраструктуры {#recommendations}

1. Отделите секреты от исходного кода, чтобы они не попали вместе с кодом в публичные репозитории, например на GitHub, и не стали уязвимыми.
1. Обеспечьте [управление секретами в облаке](../../security/domains/encryption.md#upravlenie-sekretami).
1. Обеспечьте [сбор, мониторинг и анализ аудитных логов](../../security/domains/audit-logs.md).
