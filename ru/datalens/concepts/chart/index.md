# Чарт

_Чарт_ — это визуализация данных из датасета в виде таблицы, диаграммы или картограммы.

В {{ datalens-short-name }} два вида чартов:

* [Чарты на основе датасета](#dataset-based-charts)
* [SQL-чарты](#sql-charts)

## Чарты на основе датасета {#dataset-based-charts}

Чарты создаются в визарде на основе данных из одного датасета или нескольких датасетов (см. [мультидатасетные чарты](#multi-dataset-charts)).
Вы можете создать неограниченное количество чартов на базе одного датасета.

Рабочая область в интерфейсе визарда разделена на три основные панели:
1. Панель датасета, где отображаются доступные поля: **Измерения** и **Показатели**. Вы можете добавить в список [вычисляемое поле](../calculations/index.md).
1. Панель настройки визуализации, где можно выбрать [тип чарта](types.md). Для каждого типа доступен свой набор секций (например, ось X, ось Y, фильтры и т. д.), куда можно перетаскивать поля. Подробнее в разделе [{#T}](settings.md).
1. Панель превью, где отображается визуализация.

Чарт позволяет провести быстрый анализ и проверить гипотезу. Также чарты можно сохранять и добавлять на дашборды в виде виджетов.

{% note warning %}

В {{ datalens-short-name }} существуют ограничения на количество строк данных, которое могут отобразить чарты. Ознакомьтесь с ними в разделе [{#T}](../limits.md).

{% endnote %}

### Мультидатасетные чарты {#multi-dataset-charts}

Мультидатасетные чарты — чарты, которые отображают данные из разных датасетов.

Запросы для каждого датасета отрабатываются независимо друг от друга. Вы не можете создавать вычисляемые поля над полями из нескольких датасетов.
При добавлении второго датасета {{ datalens-short-name }} автоматически устанавливается связь по первому совпадению имени полей и типа данных полей.

При этом вы можете:

* изменять связи;
* добавлять новые связи;
* удалять связи.

{% note info %}

  Датасеты в чарте могут быть не связаны.

{% endnote %}

Особенности работы со связанными датасетами в чарте, кроме случаев использования слоев в геочарте:

* в одном чарте могут быть использованы любые показатели из датасетов вне зависимости от связей;
* в одном чарте можно использовать только связанные измерения;
* фильтры по связанным измерениям применяются ко всем датасетам;
* фильтры по несвязанным измерениям применяются только к своему датасету.

Особенности работы со связанными датасетами в геовизуализациях на разных слоях:

* в одном геослое могут быть использованы любые показатели из датасетов вне зависимости от связей;
* в одном геослое можно использовать только связанные измерения;
* фильтры в секции **Общие фильтры** по связанным измерениям применяются ко всем датасетам во всех слоях;
* фильтры в секции **Общие фильтры** по несвязанным измерениям применяются только к своему датасету во всех слоях;
* фильтры в секции **Фильтры слоя** по связанным измерениям применяются ко всем датасетам в рамках текущего слоя;
* фильтры в секции **Фильтры слоя** по несвязанным измерениям применяются только к своему датасету в рамках текущего слоя;
* ограничения на использование несвязанных измерений в разных слоях не предусмотрены.

## SQL-чарты {#sql-charts}

_SQL-чарты_ — чарты, созданные на основе подключения, если источник подключения — БД. Для построения таких чартов используется SQL-запрос. Запрос выполняется на SQL-диалекте исходной БД, что позволяет расширить возможности визуализации с помощью специфических для этой БД операций.

При выполнении SQL-запроса отдельный объект [Датасет](../dataset/index.md) не создается, он генерируется сразу и отображается на панели превью.

В отличие от [обычных чартов](#dataset-based-charts), в SQL-чартах логика использования визарда смещена в сторону SQL-запроса, то есть визард только отображает данные из запроса.

Особенности SQL-чартов:
* уменьшают нагрузку на БД благодаря прямым запросам;
* подходят только для запросов `SELECT`;
* позволяют применять операторы `JOIN`, `GROUP BY`, `SORT BY` и функции агрегации в SQL-запросе;
* предоставляют возможность параметризации любой части SQL-запроса;
* поддерживают ограниченный набор [типов визуализаций](types.md);
* не поддерживают [материализацию](../dataset/settings.md#materializaton) {% if audience != "internal" %} и [публикацию](../datalens-public.md) {% endif %} данных ;
* не используют [RLS](../../security/row-level-security.md) и [вычисляемые поля](../calculations/index.md).

{% include [datalens-sql-ch-example](../../../_includes/datalens/datalens-sql-ch-example.md) %}

Чтобы создать SQL-чарт, перейдите к [инструкции](../../operations/chart/create-sql-chart.md).

{% if audience == "internal" %}

## Настройка алертов {#alerting}

{% note alert %}

  Сейчас алерты работают в режиме тестирования MVP:

  * Алерты можно создать только в чартах типа **Линейная диаграмма** (кроме чартов, созданных в **Old Wizard**).
  * В уведомлениях указано время по UTC.
  * Отключить уведомления нельзя.

{% endnote %}

Алерты — это уведомления о событиях в чартах.

Уведомления приходят, когда значение графика на момент проверки превышает установленный порог. Проверка состояния графика выполняется один раз в 15 минут. Если значение графика остается за пределами установленного порога несколько проверок подряд, то придет только одно уведомление. Проверку на отсутствие значения создать нельзя.

В чарте обязательно должен быть временной ряд. Используйте [относительные даты](../../editor/params.md#relativedate), чтобы график изменялся с течением времени. По умолчанию время на графике указано по UTC.

Вы можете настроить алерт на одну или несколько линий. Линии должны быть на одной оси Y. Для линий по второй оси Y нужно создать новый алерт. В качестве идентификатора линии используйте `id`, `name` или `title`. Если `name` или `title` динамические (например, зависят от даты), то добавьте `id` временного ряда для однозначной идентификации.

Подробнее о создании алерта читайте в [инструкции](../../operations/chart/create-alert.md).

{% endif %}

{% if audience != "internal" %}

## Публикация чарта {#public-access}

Вы можете предоставить доступ к чарту для любого пользователя в интернете с помощью [{{ datalens-public }}](../datalens-public.md). Такой чарт становится публичным, любой пользователь может просмотреть его без авторизации.

Чтобы предоставить публичный доступ к чарту:

{% include [share-note](../../../_includes/datalens/datalens-share-note.md) %}

{% include [publish-chart](../../../_includes/datalens/operations/datalens-public-chart.md) %}

{% endif %}

## Управление доступом {#access-management}

Вы можете настроить права доступа к чарту.

Чтобы настроить права доступа к чарту:

{% include [manage-access](../../../_includes/datalens/operations/datalens-chart-manage-access.md) %}

Подробнее о типах прав доступа в разделе [{#T}](../../security/index.md).

#### См. также {#see-also}
- [{#T}](../../operations/chart/create-line-chart.md)
- [{#T}](../../operations/chart/create-pivot-table.md)
- [{#T}](../../operations/chart/create-table.md)
- [{#T}](../../operations/chart/create-area-chart.md)
- [{#T}](../../operations/chart/create-column-chart.md)
- [{#T}](../../operations/chart/create-bar-chart.md)
- [{#T}](../../operations/chart/create-pie-chart.md)
- [{#T}](../../operations/chart/create-map-chart.md)
- [{#T}](../../operations/chart/create-sql-chart.md)
{% if audience == "internal" %}- [{#T}](../../operations/chart/create-alert.md){% endif %}
{% if audience != "internal" %}- [{#T}](../../operations/chart/publish.md){% endif %}
