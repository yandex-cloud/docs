# Создание подключения к Google Sheets

{% note warning %}


Перед созданием подключения ознакомьтесь с [ограничениями](#restrictions).

{% endnote %}

Чтобы создать подключение к Google Sheets:


1. Перейдите на [страницу подключений]({{ link-datalens-main }}/connections).


1. Нажмите кнопку **Создать подключение**.
1. Выберите подключение **Google Sheets**.


1. Добавьте файлы с учетом доступа:

   {% list tabs %}

   - Таблица в открытом доступе

     1. Нажмите кнопку **+ Добавить файл** и укажите ссылку на файл. Для этого в настройках доступа Google Sheets выберите `Разрешить доступ всем, у кого есть ссылка` (`Anyone with the link`), перейдите на нужный лист таблицы и скопируйте ссылку из адресной строки браузера. Если скопировать ссылку из диалогового окна выдачи прав таблицы Google Sheets, она будет вести на первый лист таблицы.
     1. Нажмите кнопку **Добавить**. Если в загружаемом файле несколько листов, в окне **Добавить листы** укажите листы, которые следует загрузить. Пустые листы недоступны для выбора. Включите опцию **Листы**, чтобы выбрать все доступные. Каждый лист загружается в отдельную таблицу. Нажмите кнопку **Добавить**.
     1. Информация о добавленном файле и загружаемые данные отобразятся в центральной области экрана.

   - Таблица с ограниченным доступом

     1. В верхней части экрана нажмите кнопку **Войти через Google**.
     1. Выберите аккаунт для перехода в приложение **{{ datalens-short-name }}**.
     1. Предоставьте приложению **{{ datalens-short-name }}** права доступа к вашему аккаунту Google. Нажмите **Продолжить**.
     1. Нажмите кнопку **+ Добавить файл** и укажите ссылку на файл.
     1. Нажмите кнопку **Добавить**. Если в загружаемом файле несколько листов, в окне **Добавить листы** укажите листы, которые следует загрузить. Пустые листы недоступны для выбора. Включите опцию **Листы**, чтобы выбрать все доступные. Каждый лист загружается в отдельную таблицу. Нажмите кнопку **Добавить**.
     1. Информация о добавленном файле и загружаемые данные отобразятся в центральной области экрана.

     Чтобы выйти из аккаунта Google, нажмите значок ![image](../../../_assets/datalens/exit.svg). Нажмите **Выход**. Листы из файлов с ограниченным доступом перестанут отображаться.

   {% endlist %}


   {% note info %}

   Для корректного определения типов данных в меню Google Sheets выберите **Формат** → **Числа** и укажите формат ячеек столбца.

   {% endnote %}

1. Установите переключатель **Показывать заголовки столбцов** в положение **Да** или **Нет**.
1. (Опционально) Включите автообновление данных в таблице. Для этого в правом верхнем углу экрана включите опцию **Обновлять автоматически**. Данные в таблицах будут обновляться не чаще, чем один раз в 30 минут. Чтобы обновить данные вручную, нажмите кнопку **Обновить данные**.
1. Нажмите **Создать подключение**.
1. Укажите название подключения и нажмите **Создать**. Подключение появится в списке.

В созданное подключение вы можете добавить новые файлы, а также переименовать или удалить уже добавленные.

{% cut "Что делать, если таблица из Google Sheets работает некорректно?" %}

Если в таблице Google Sheets присутствуют пустые ячейки, в {{ datalens-name }} могут некорректно отображаться названия столбцов и пропадать несколько первых строк.

Чтобы исправить ситуацию, нужно в таблице Google Sheets заполнить пустые ячейки любыми подходящими по смыслу значениями: `отсутствует`, `нет`, `неизвестно`.

Чтобы быстро заполнить пустые ячейки в таблице Google Sheets:
1\. Выделите всю таблицу Google Sheets.
2\. В меню таблицы выберите **Данные** → **Создать фильтр**.
3\. В правом углу верхней ячейки первого столбца нажмите значок фильтра.
4\. Нажмите **Сбросить**, а затем выберите значение **(Пустые)**.
5\. В верхней ячейке столбца введите желаемое значение, например: `0`, `отсутствует`, `нет` или любое другое.
6\. Протяните ячейку вниз, чтобы заполнить все пустые ячейки в столбце введенным значением.
7\. Снова нажмите значок фильтра и выберите значение **Выбрать всё**.
8\. Повторите все шаги, начиная с третьего, для остальных столбцов таблицы.

{% endcut %}

## Ограничения {#restrictions}

При создании подключения к Google Sheets учитывайте следующие ограничения:
* Максимальное количество листов Google Sheets в одном подключении — 10. При создании подключения загрузятся все листы, но для одновременной работы можно выбрать только 10 из них.
* Максимальный размер для каждого листа таблицы — 200 МБ.
* Максимальное количество столбцов на одном листе — 300.
* Минимальное количество строк в таблице — 2. В таблице с одной строкой невозможно определить типы столбцов, так как непонятно, заголовок это или строка с данными.