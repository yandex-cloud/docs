# Создание подключения к Google Sheets

{% if audience == "internal" %}

{% note warning %}

При использовании подключения к Google Sheets необходимо соблюдать NDA, а также обеспечить безопасность хранения данных.

{% endnote %}

{% endif %}

## Подключение к Google Sheets {#google-sheets-connection}

Чтобы создать подключение к Google Sheets:

{% if audience == "internal" %}

1. Перейдите на [страницу подключений](https://datalens.yandex-team.ru/connections).

{% else %}

1. Перейдите на [страницу подключений]({{ link-datalens-main }}/connections).

{% endif %}

1. Нажмите кнопку **Создать подключение**.
1. Выберите подключение **Google Sheets**.
1. Укажите параметры подключения:
    - **Название подключения**. Задайте имя подключения. Имя может быть произвольным.
    - **Ссылка**. Укажите ссылку на нужный лист таблицы из Google Sheets. Для этого в настройках доступа Google Sheets выберите `Разрешить доступ всем, у кого есть ссылка` (`Anyone with the link`), перейдите на нужный лист таблицы и скопируйте ссылку из адресной строки браузера. Если скопировать ссылку из диалогового окна выдачи прав таблицы Google Sheets, тогда она будет вести на первый лист таблицы.
     
1. Нажмите **Создать**. Подключение появится в списке.

{% note info %}

При загрузке данных из Google Sheets используется кеш с временем жизни до 5 минут, поэтому обновление данных в {{ datalens-short-name }} может происходить с задержкой.

{% endnote %}

{% cut "Что делать, если таблица из Google Sheets работает некорректно?" %}

Если в таблице Google Sheets присутствуют пустые ячейки, то в {{ datalens-short-name }} могут некорректно отображаться названия столбцов и пропадать несколько первых строк.

Чтобы исправить ситуацию, нужно в таблице Google Sheets заполнить пустые ячейки любыми подходящими по смыслу значениями: `отсутствует`, `нет`, `неизвестно`.

Чтобы быстро заполнить пустые ячейки в таблице Google Sheets:

1\. Выделите всю таблицу Google Sheets.
2\. В меню таблицы выберите **Данные** → **Создать фильтр**.
3\. В правом углу верхней ячейки первого столбца нажмите значок фильтра.
4\. Нажмите **Сбросить**, а затем выберите значение **(Пустые)**.
5\. В верхней ячейке столбца введите желаемое значение, например: `0`, `отсутствует`, `нет` или любое другое.
6\. Протяните ячейку вниз, чтобы заполнить все пустые ячейки в столбце введенным значением.
7\. Снова нажмите значок фильтра и выберите значение **Выбрать всё**.
8\. Повторите все шаги, начиная с третьего, для остальных столбцов таблицы.

{% endcut %}
