---
title: Как создать подключение к Яндекс Документам
description: Следуя данной инструкции, вы сможете создать подключение к Яндекс Документам.
---

# Создание подключения к Яндекс Документам


Чтобы создать подключение к Яндекс Документам:

1. Перейдите на [страницу создания нового подключения]({{ link-datalens-main }}/connections/new).
1. В разделе **Файлы и сервисы** выберите подключение **Яндекс Документы**.
1. Добавьте файлы с учетом доступа:

   {% list tabs %}

   - Публичный

     1. Нажмите кнопку **Добавить файл** и перейдите на вкладку `Публичный`.
     1. Перейдите на страницу [сервиса](https://docs.yandex.ru/docs?type=xlsx).
     1. Правой кнопкой мыши нажмите нужный файл и выберите **Поделиться**. Нажмите кнопку **Скопировать**.

        {% note info %}

        Ссылку на файл также можно получить в Яндекс Диске. Подробнее читайте в [документации](https://yandex.ru/support/disk/share/sharing.html#how-to-share).

        {% endnote %}

     1. Полученную ссылку вставьте в {{ datalens-short-name }} в поле `Ссылка на файл в Яндекс Документах` и нажмите кнопку **Добавить**.
     1. Если в загружаемом файле несколько листов, укажите среди них те, которые хотите загрузить, или выберите все доступные. Каждый лист загружается в отдельную таблицу.
     1. Нажмите кнопку **Добавить**. Информация о добавленном файле и загружаемые данные отобразятся в центральной области экрана.

   - Приватный

     {% note info %}
     
     Не поддерживается добавление приватных файлов, доступ к которым закрыт с помощью пароля. 

     {% endnote %}

     1. В {{ datalens-short-name }} на странице подключения нажмите кнопку **Добавить файл** и перейдите на вкладку `Приватный`.
     1. На вкладке вы увидите сообщение об авторизации в Яндекс Документах. Если вы авторизованы, переходите к следующему шагу инструкции. Если нет, выполните авторизацию:
         1. Нажмите **Войти**.
         1. Выберите аккаунт на Яндексе для входа в Яндекс Документы.
         1. Предоставьте приложению **{{ datalens-short-name }}** права доступа к вашему аккаунту на Яндексе. Нажмите кнопку **Продолжить**.
     1. Укажите **Путь до файла в Яндекс Документах** относительно корневого каталога. Путь указывается без `/disk` в начале. Размещение файла можно посмотреть в Яндекс Документах: откройте файл и перейдите в меню **Файл** → **Сведения о таблице**.
     1. Нажмите кнопку **Добавить**.
     1. Если в загружаемом файле несколько листов, укажите среди них те, которые хотите загрузить, или выберите все доступные. Каждый лист загружается в отдельную таблицу.
     1. Нажмите кнопку **Добавить**. Информация о добавленном файле и загружаемые данные отобразятся в центральной области экрана.

        Чтобы выйти из аккаунта на Яндексе, откройте страницу подключения и рядом с кнопкой **Вы авторизованы в Яндекс Документах** нажмите значок ![image](../../../_assets/console-icons/arrow-right-from-square.svg). Подтвердите отзыв токена. Листы из файлов с ограниченным доступом перестанут отображаться.

   {% endlist %}

1. Установите переключатель **Показывать заголовки столбцов** в положение **Да** или **Нет**.
1. (Опционально) Включите автообновление данных в таблице. Для этого в правом верхнем углу экрана включите опцию **Обновлять автоматически**. Данные в таблицах будут обновляться не чаще, чем один раз в 30 минут. Чтобы обновить данные вручную, нажмите кнопку **Обновить данные**.
1. Нажмите кнопку **Создать подключение**.


1. Выберите [воркбук](../../workbooks-collections/index.md), в котором сохранится подключение, или создайте новый. Если вы пользуетесь старой навигацией по папкам, выберите папку для сохранения подключения. Нажмите кнопку **Создать**.


1. Укажите название подключения и нажмите кнопку **Создать**.

В созданное подключение вы можете добавить новые файлы, а также переименовать или удалить уже добавленные.


## Ограничения {#restrictions}

При создании подключения к Яндекс Документам учитывайте следующие ограничения:

* В настоящее время доступна загрузка файлов только формата `xlsx`.
* Максимальное количество листов таблицы в одном подключении — 10. При создании подключения загрузятся все листы, но для одновременной работы можно выбрать только 10 из них.
* Максимальный размер для каждого листа таблицы — 200 МБ.
* Максимальное количество столбцов на одном листе — 300.
* Минимальное количество строк в таблице — 2. В таблице с одной строкой невозможно определить типы столбцов, так как непонятно, заголовок это или строка с данными.
* Ссылка на файл в Яндекс Документах должна быть в формате `https://disk.yandex.ru/i/id`. Если вместо `/i` в ссылке содержится `/d`, то возникнет ошибка. [Что делать, если возникла ошибка «Неверный формат ссылки»](../../qa/connections.md#yadocs-error-link)
