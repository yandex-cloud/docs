---
title: Сводная таблица в {{ datalens-full-name }}
description: Из статьи вы узнаете, как в {{ datalens-full-name }} создать и настроить тип визуализации Сводная таблица.
---

# Сводная таблица ![](../../_assets/datalens/pivot-table.svg) в {{ datalens-full-name }}

Таблица — это стандартный вид представления данных с максимальной детализацией.

{% note tip %}

Таблицы лучше всего располагать в самом конце дашборда.

Графику проще "читать", а для погружения в табличные данные нужно больше времени и внимания.

{% endnote %}

Таблицы подходят для детальной [аналитики](../../glossary/data-analytics) (глубокого погружения в цифры), помогают найти проблемы.

* [Особенности](#особенности)
* [Секции в визарде](#секции-в-визарде-wizard-sections)
* [Создать сводную таблицу](#создание-сводной-таблицы-create-diagram)
* [Дополнительные настройки](#дополнительные-настройки-additional-settings)

### Особенности

Отличия сводной таблицы от плоской [таблицы](table-chart.md):

- Категории могут располагаться как в столбцах, так и в строках.
- В строках и столбцах может находиться несколько категорий, а в ячейках на их пересечении — значения показателей.
- Подходит для больших объемов данных и анализа связей между показателями.

**Пример**
Продажи товаров в зависимости от типа доставки в разрезе брендов и категорий товаров за конкретный год:

{% list tabs %}

- Представление

  ![pivot-table-chart](../../_assets/datalens/visualization-ref/pivot-table-chart/pivot-table-chart.png)

- Исходная таблица

  {% include [pivot-table-1](../../_includes/datalens/visualization-ref/pivot-table-1.md) %}

{% endlist %}



<!--{% cut "Исходная таблица" %}

Категории |	Бренд товара |	Тип доставки |	2019 |	2020 |	2021 |	2022
---------|---------|---------|---------|---------|---------|---------
Бытовая химия |	БиоДом |	Доставка |	286 192 |	836 276 |	1 398 283 |	952 801
Бытовая химия |	Городской драйв |	Доставка |	248 020 |	699 284 |	1 074 216 |	705 072
Бытовая химия |	Мойдодыр |	Доставка |	199 737 |	532 997 |	1 090 102 |	807 578
Бытовая химия |	Чистый дом |	Доставка |	400 993 |	1 016 930 |	1 658 254 |	1 092 608
Бытовая химия |	БиоДом |	Самовывоз |	795 267 |	2 112 453 |	3 138 349 |	2 184 422
Бытовая химия |	Городской драйв |	Самовывоз |	574 643 |	1 665 665 |	2 544 045 |	1 843 545
Бытовая химия |	Мойдодыр |	Самовывоз |	503 241 |	1 455 449 |	2 441 103 |	1 632 025
Бытовая химия |	Чистый дом |	Самовывоз |	815 338 |	2 446 136 |	3 710 564 |	2 837 481
Бытовые товары |	1001 и одна нужная мелочь |	Доставка |	701 548 |	1 630 965 |	2 592 784 |	1 947 613
Бытовые товары |	Кедровый лес |	Доставка |	257 459 |	829 961 |	1 226 510 |	873 104
Бытовые товары |	Ростовская фабрика |	Доставка |	111 812 |	220 937 |	584 077 |	272 213
Бытовые товары |	Хлеб-соль |	Доставка |	557 311 |	1 273 523 |	2 394 572 |	1 615 675
Бытовые товары |	1001 и одна нужная мелочь |	Самовывоз |	1 499 384 |	3 880 210 |	6 257 665 |	4 351 725
Бытовые товары |	Кедровый лес |	Самовывоз |	703 202 |	1 922 952 |	2 935 546 |	2 323 846
Бытовые товары |	Ростовская фабрика |	Самовывоз |	215 243 |	619 117 |	1 078 515 |	780 640
Бытовые товары |	Хлеб-соль |	Самовывоз |	1 053 432 |	3 469 672 |	5 271 466 |	3 754 047
Техника для дома |	Kitchen&Food |	Доставка |	307 919 |	926 118 |	1 413 174 |	1 063 128
Техника для дома |	TechBeauty |	Доставка |	271 553 |	768 793 |	1 192 747 |	809 543
Техника для дома |	Разумный дом |	Доставка |	828 609 |	2 320 160 |	3 747 059 |	2 672 810
Техника для дома |	Фабрика комфорта |	Доставка |	364 309 |	1 103 700 |	1 674 297 |	1 146 209
Техника для дома |	Kitchen&Food |	Самовывоз |	803 667 |	2 254 885 |	3 065 383 |	2 243 507
Техника для дома |	TechBeauty |	Самовывоз |	623 684 |	1 675 606 |	2 891 334 |	2 029 385
Техника для дома |	Разумный дом |	Самовывоз |	1 917 822 |	5 520 617 |	8 538 419 |	6 468 868
Техника для дома |	Фабрика комфорта |	Самовывоз |	1 072 286 |	2 170 431 |	4 178 690 |	2 827 290

{% endcut %}-->

<!--При [создании сводной таблицы](#create-diagram) можно использовать дополнительные настройки:

* [Изменение названия столбцов и строк](#change-columns-names)
* [Добавление подсказки к заголовкам](#hint-column)
* [Настройка ширины столбцов и строк](#set-column-width)
* [Закрепление столбцов](#column-fixation)
* [Управление количеством строк](#pagination-limit)
* [Добавление строк с подытогами](#add-totals)
* [Настройка заливки полей](#set-field-color)
* [Добавление линейного индикатора в столбец с показателем](#add-linear-indicator)-->

## Секции в визарде {#wizard-sections}

Секция<br/> в визарде| Описание
----- | ----
Столбцы | Измерения.
Строки | Измерения.
Показатели | Показатели. При добавлении в секцию более одного показателя в секции **Столбцы** появится измерение [Measure Names](../concepts/chart/measure-values.md), которое определяет расположение заголовков показателей. `Measure Names` можно переносить в **Строки**.
Цвета | Показатель. Влияет на заливку всех ячеек с показателями. Может содержать не более одного показателя.
Сортировка | Измерения и показатели, которые указаны в секциях **Столбцы** и **Строки**. Может использоваться несколько измерений и показателей.<br/><br/>Направление сортировки отмечено значком рядом с полем: по возрастанию ![image](../../_assets/console-icons/bars-ascending-align-left.svg) или по убыванию ![image](../../_assets/console-icons/bars-descending-align-left.svg). Чтобы изменить направление сортировки, нажмите значок.<br/><br/>{{ datalens-short-name }} сначала группирует столбцы или строки в том порядке, как они перечислены в соответствующих секциях, и только потом сортирует группы в соответствии с секцией **Сортировка**.<br/>Порядок полей в секции влияет на порядок сортировки полей таблицы.<br/><br/>Сортировка по показателю влияет только на запрос в источник, но не на сводную таблицу.
Фильтры | Измерение или показатель. Используется в качестве фильтра.

## Создать сводную таблицу {#create-diagram}

{% note info %}

Не поддерживается в [QL-чартах](../concepts/chart/index.md#sql-charts).

{% endnote %}

Чтобы создать сводную таблицу:


{% include [datalens-workbooks-collections-note](../../_includes/datalens/operations/datalens-workbooks-collections-note-step4.md) %}


1. {% include [create-1](../../_includes/datalens/visualization-ref/create-1.md) %}
1. {% include [create-2](../../_includes/datalens/visualization-ref/create-2.md) %}
1. {% include [create-3](../../_includes/datalens/visualization-ref/create-3.md) %}
1. {% include [create-4](../../_includes/datalens/visualization-ref/create-4.md) %}
1. Выберите тип чарта **Сводная таблица**.
1. Перетащите измерение из датасета в секцию **Столбцы**.
1. Перетащите измерение из датасета в секцию **Строки**.

   {% note info %}

   В секциях **Столбцы** и **Строки** можно менять порядок измерений, перетаскивая их.

   {% endnote %}

1. Перетащите показатель из датасета в секцию **Показатели**. Значения отобразятся в ячейках таблицы.
1. Перетащите показатель из датасета в секцию **Цвета**. Ячейки с показателем градиентно раскрасятся в зависимости от значения показателя.

## Дополнительные настройки {#additional-settings}

{% cut "Восприятие" %}

#### Изменить названия столбцов и строк {#change-columns-names}

1. В секции **Столбцы** или **Строки** нажмите значок слева от названия измерения.
1. В открывшемся окне измените поле **Название** и нажмите кнопку **Применить**.

#### Добавить подсказки к заголовкам {#hint-column}

1. В секции **Строки** нажмите значок слева от названия измерения или показателя.
1. В открывшемся окне включите опцию **Подсказка**, в поле ниже введите текст и нажмите кнопку **Применить**. По умолчанию при включении опции текст подсказки подставляется из описания поля в [датасете](../dataset/index.md).

Когда опция включена, рядом с заголовком столбца таблицы появляется значок ![image](../../_assets/console-icons/circle-question.svg). При наведении курсора на значок отображается всплывающая подсказка.

#### Настроить заливку полей {#set-field-color}

1. В секции **Столбцы**, **Строки** или **Показатели** нажмите значок слева от названия поля.
1. В открывшемся окне включите опцию **Заливка столбца**.
1. В списке **По полю** выберите поле, на основе значений которого будет выполнена заливка.
1. Укажите **Тип заливки**:

   {% note info %}

   Для измерения доступен тип заливки **Палитра**, для показателя — **Градиент**.

   {% endnote %}

   {% list tabs group=fill %}

   - Для измерения {#measure}

     1. Нажмите на поле выбора цветовой схемы и укажите цвет для каждого значения измерения.
     1. Нажмите кнопку **Применить**.

   - Для показателя {#indicator}

     1. Нажмите на поле выбора градиента и настройте:

        {% include [color-setting](../../_includes/datalens/visualization-ref/color-setting.md) %}

     1. Нажмите кнопку **Применить**.

   {% endlist %}

1. Для типа заливки **Градиент** задайте, как окрашивать пустые (`null`) значения: `Не окрашивать` или `Окрашивать как 0`.
1. Нажмите кнопку **Применить**.

{% endcut %}

{% cut "Столбцы и строки" %}

#### Настроить ширину столбцов и строк {#set-column-width}

1. В правом верхнем углу секции **Столбцы** или **Строки** нажмите значок ![image](../../_assets/console-icons/gear.svg) (значок появляется при наведении указателя на секцию).
1. В блоке **Ширина** выберите значения для столбцов и строк:

   * `Авто` — автоматическая ширина столбца/строки;
   * `%` — ширина столбца/строки в процентах от общей ширины таблицы;
   * `px` — ширина столбца/строки в пикселях.

   Опции `%` и `px` позволяют делать переносы в ячейках таблицы (по словам). Таким образом, число строк в ячейке может расти.

   {% note info %}

   Общая ширина таблицы всегда занимает 100% доступного пространства вне зависимости от указанной ширины отдельных столбцов и строк.

   {% endnote %}

1. Нажмите кнопку **Применить**.

Чтобы установить значение `Авто` для ширины всех столбцов, нажмите кнопку **Сбросить**.

#### Закрепить столбцы {#column-fixation}

{% note info %}

Можно закрепить только столбцы, которые формируются из измерений в секции **Строки**.

{% endnote %}

1. В правом верхнем углу секции **Столбцы** или **Строки** нажмите значок ![image](../../_assets/console-icons/gear.svg) (значок появляется при наведении указателя на секцию).
1. В открывшемся окне в поле **Закрепление** укажите число столбцов для закрепления. Эти столбцы будут оставаться на месте при горизонтальной прокрутке.
1. Нажмите кнопку **Применить**.

#### Изменить количество строк {#pagination-limit}

{% include [change-rows-amount](../../_includes/datalens/visualization-ref/change-rows-amount.md) %}

{% endcut %}

#### Включить пагинацию {#pagination}

Если в таблице много строк, включите пагинацию:

1. В верхней части экрана напротив типа чарта нажмите значок ![image](../../_assets/console-icons/gear.svg).
1. Включите опцию **Пагинация** и нажмите кнопку **Применить**.

Опция недоступна, если отображается только одна страница или нет данных.

#### Добавить строки с подытогами {#add-totals}

1. В секции **Столбцы** или **Строки** нажмите значок перед названием поля.
1. В окне настроек поля включите опцию **Подытоги**.
1. Нажмите кнопку **Применить**.

В таблице отобразятся столбцы и/или строки **Итого <название_поля>**.

Чтобы вывести общую строку **Итого**, включите опцию **Подытоги** в настройках для первых полей в секциях **Столбцы** и **Строки**.

{% cut "Сводная таблица с подытогами" %}

![pivot-table-totals](../../_assets/datalens/visualization-ref/pivot-table-chart/pivot-table-totals.png)

{% endcut %}

{% note info %}

* Строка **Итого** не поддерживает фильтрацию по [показателям](../dataset/data-model.md#field). Строка **Итого** будет скрыта, если перенести показатель в секцию **Фильтры** или **Фильтры с дашборда**.
* В строке с итогами не отображаются расчеты с помощью [LOD-выражений](../concepts/lod-aggregation.md), [оконных функций](../function-ref/window-functions.md) и [функций для работы с временными рядами](../function-ref/time-series-functions.md).

{% endnote %}

{% endcut %}

#### Добавить линейный индикатор в столбец с показателем {#add-linear-indicator}

1. В секции **Показатели** нажмите значок слева от названия показателя.
1. В открывшемся окне включите опцию **Линейный индикатор**.
1. Укажите настройки индикатора:

   * **Тип заливки** — тип цветовой заливки для индикатора.
   * **Положительные значения** — цвет индикатора для положительных значений.
   * **Отрицательные значения** — цвет индикатора для отрицательных значений.
   * **Отображать значения** — опция включает отображение значений показателя в ячейке.
   * **Отображать в итогах** — опция включает отображение индикатора в ячейках с итоговыми значениями.
   * **Выравнивание** — выравнивание положения индикатора слева или справа в столбце. Применяется только в случаях, когда все числа в столбце положительные или отрицательные.
   * **Масштаб** — задает масштаб для индикатора. Если задавать масштаб вручную, то нужно указывать значения **мин** и **макс**. При этом значение **мин** должно быть меньше или равно `0` и значение **макс** должно быть больше или равно `0`.

   {% cut "Пример настроек линейного индикатора" %}

   ![image](../../_assets/datalens/operations/chart/table-linear-indicator-setting.png)

   {% endcut %}

1. Нажмите кнопку **Применить**.

## Рекомендации {#recomendations}

{% note tip %}

Используйте таблицы по назначению. Например, для отображения агрегированных данных в табличном формате.

Они не заменят все визуальные формы представления данных.

{% endnote %}

{% cut "Восприятие" %}

* Размещайте измерения слева, а показатели справа. Так легче "читать".
* Используйте короткие, просты и понятные названия столбцов.
* Ячейки таблицы можно раскрасить в зависимости от значений одного из показателей. Это поможет акцентировать внимание на величинах.

{% endcut %}

{% cut "Размеры" %}

* Ограничивайте размеры таблицы или воспользуйтесь фильтрами и сортировкой. Таблицы с большим количеством строк или столбцов сложно читать.
* При размещении таблицы на дашборде включайте автовысоту в настройках виджета. Таким образом можно сэкономить место на дашборде.

  {% list tabs radio %}

  - Настройка автовысоты

    ![pivot-table-auto-height](../../_assets/datalens/visualization-ref/pivot-table-chart/pivot-table-auto-height.png)  

  - Использование фильтра при включенной опции автовысоты

    При использовании фильтра высота таблицы будет автоматически подстраиваться под число строк.

    Если значение в фильтре не указано, таблица выводит все строки с учетом лимита количества строк на одной странице.
  
    ![pivot-table-auto-height-2](../../_assets/datalens/visualization-ref/pivot-table-chart/pivot-table-auto-height-2.png)

    Если при использовании фильтра количество выводимых строк сократится, высота таблицы уменьшится автоматически.

    ![pivot-table-auto-height-3](../../_assets/datalens/visualization-ref/pivot-table-chart/pivot-table-auto-height-3.png)

  {% endlist %}

  <!--{% cut "Настройка автовысоты" %}

  ![pivot-table-auto-height](../../_assets/datalens/visualization-ref/pivot-table-chart/pivot-table-auto-height.png)

  {% endcut %}

  При использовании фильтра высота таблицы будет автоматически подстраиваться под число строк.

  {% cut "Использование фильтра при включенной опции автовысоты" %}
  
  Если значение в фильтре не указано, таблица выводит все строки с учетом лимита количества строк на одной странице.
  
  ![pivot-table-auto-height-2](../../_assets/datalens/visualization-ref/pivot-table-chart/pivot-table-auto-height-2.png)

  Если при использовании фильтра количество выводимых строк сократится, высота таблицы уменьшится автоматически.

  ![pivot-table-auto-height-3](../../_assets/datalens/visualization-ref/pivot-table-chart/pivot-table-auto-height-3.png)

  {% endcut %}-->

{% endcut %}


* Формируйте итоги как столбец (или промежуточные итоги как столбец). Это можно сделать с помощью вычисляемых полей на основе [оконных функций](../concepts/window-function-tutorial.md) или [LOD-выражений](../concepts/lod-aggregation.md), например:

  * Промежуточная сумма продаж по категориям — показатель `CategorySales` с формулой `SUM(SUM([Sales]) WITHIN [ProductCategory])`.
  * Общая сумма продаж — показатель `TotalSales` с формулой `SUM(SUM([Sales]) TOTAL)`.

    {% cut "Пример таблицы" %}

    ![pivot-table-sum](../../_assets/datalens/visualization-ref/pivot-table-chart/pivot-table-sum.png)

    {% endcut %}
  
  * Максимальное число заказов в месяц с группировкой по категориям — показатель `MaxCountByCategory` с формулой `MAX(COUNTD([OrderID] INCLUDE [ProductCategory]))`.

    {% cut "Пример таблицы" %}

    ![pivot-table-count](../../_assets/datalens/visualization-ref/pivot-table-chart/pivot-table-count.png)

    {% endcut %}

* Используйте сортировку. Это упрощает восприятие информации.

* Используйте функцию [URL](../function-ref/URL.md) в ячейках таблицы для перехода по ссылке.

* При отображении численных данных указывайте размерность, количество знаков после запятой. 

  **Пример** 
  -> Если из выпадающего списка **Размерность** выбрать `Миллионы, M`, то вместо значения `10 345 234.23` будет показано значение `10,3 M`. 
  -> Если в поле `Знаков после запятой` указать `2`, то вместо значения `123.1234` будет показано значение `123.12`.

{% include [see-also](../../_includes/datalens/visualization-ref/see-also-sub.md) %}