# Точечная карта с кластеризацией ![](../../_assets/datalens/heatmap.svg)

Точечная диаграмма с кластеризацией отличается от [обычной точечной](point-map-chart.md) тем, что находящиеся рядом друг с другом точки объединяются в кластер. На карте кластер отображается в виде кольцевой диаграммы с числом точек в центре.

{% note info %}

В центре кластера отображается только число входящих в него точек. Выбрать другой показатель (например, сумму значений на всех точках) нельзя.

{% endnote %}

Поведение точек отличается в зависимости от масштаба карты:

* При уменьшении масштаба точки будут объединены в кластеры.
* При увеличении масштаба, если точки удаляются друг от друга, кластер автоматически разбивается на кластеры поменьше и/или на отдельные точки.

Если на карте в выбранном масштабе на месте есть только одна точка, то в кластер точка объединена не будет. В этом случае вместо кольцевой диаграммы будет отображена точка как в обычной точечной диаграмме.

Кластеризация на карте позволяет сделать визуализацию с большим количеством точек более наглядной. Например, если вы хотите показать на карте расположение всех магазинов в городе с помощью кластеризации, то точки на карте не перекроют друг друга.

![point-chart](../../_assets/datalens/visualization-ref/cluster-point-map/cluster-point-map.png)

## Секции в визарде {#wizard-sections}

Ограничения:

* Секции **Размер точек**, **Тултипы** и **Подписи** применимы только для отдельно взятых точек.
* В секцию **Цвета** можно добавить только измерение.

Секция<br/> в визарде| Описание
----- | ----
Точки с кластеризацией (Геоточки) | Измерение с типом [Геоточка](../dataset/data-types#geopoint).
Размер точек | Показатель. Задает размер точки в зависимости от значения показателя.
Цвета | Измерение. Задает разбиение диаграммы кластера на сегменты.
Подписи | Показатель. Отображается в виде подписи на точке. При использовании подписи блокируется управление размером точки.
Тултипы | Измерение или показатель. Подсказка, которая отобразится при наведении на точку. Для полей с типом `Строка` можно настроить использование базового синтаксиса [{#T}](../dashboard/markdown.md): нажмите на значок перед названием поля и включите опцию **Markdown**.
Фильтры слоя | Измерение или показатель. Используется в качестве фильтра текущего слоя.
Фильтры | Измерение или показатель. Используется в качестве фильтра всего чарта.

## Создание точечной карты с кластеризацией {#create-diagram}


{% include [datalens-workbooks-collections-note](../../_includes/datalens/operations/datalens-workbooks-collections-note-step4.md) %}


1. Перейдите на [главную страницу]({{ link-datalens-main }}) {{ datalens-short-name }}.
1. На панели слева выберите ![chart](../../_assets/console-icons/chart-column.svg) **Чарты**.
1. Нажмите кнопку **Создать чарт** → **Чарт**.
1. Слева вверху нажмите ![image](../../_assets/console-icons/circles-intersection.svg) **Выберите датасет** и укажите датасет для визуализации. Если у вас нет датасета, [создайте его](../dataset/create-dataset.md#create).
1. Выберите тип чарта **Карта**.
1. Выберите тип слоя **Точки с кластеризацией (Геоточки)**.
1. Перетащите измерение с типом [Геоточка](../dataset/data-types#geopoint) из датасета в секцию с выбором типа слоя.
1. Задайте размер отображаемых точек для точечной карты. Перенесите показатель в секцию **Размер точек** или нажмите значок ![image](../../_assets/console-icons/gear.svg) в строке с названием секции.
1. Закрасьте точки на карте. Перенесите измерение в секцию **Цвета**.
1. Добавьте тултипы из значений измерения и показателя, которые отображаются при наведении на точку.

{% include [datalens-map-scale-note](../../_includes/datalens/datalens-map-scale-note.md) %}

Дополнительно вы можете:

* добавить, переименовать, удалить слой;
* поменять слои местами в рамках их типа;
* применить фильтр ко всему чарту или к одному слою.

## Рекомендации {#recomendations}

* Используйте цветовые палитры, соответствующие целям и задачам визуализации.

#### См. также {#see-also}

* [{#T}](../operations/dashboard/create.md)
* [{#T}](../operations/dashboard/add-chart.md)
* [{#T}](../operations/dashboard/add-selector.md)