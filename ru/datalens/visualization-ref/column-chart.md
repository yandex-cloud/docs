# Столбчатая диаграмма ![](../../_assets/datalens/column.svg)

Диаграмма отображает значения одного показателя или нескольких показателей по периодам времени или по категориям. Высота столбика определяет значение показателя: чем выше столбец, тем больше его значение.
В отличие от линейного графика, эта диаграмма предполагает прямое сравнение между отдельными периодами, делая акцент на индивидуальных значениях, а не на общем тренде показателя.

![bar-chart](../../_assets/datalens/visualization-ref/bar-chart/bar-chart.png)

{% cut "Исходная таблица" %}

Год |	Продажа|	
-----|---------| 
2022|	6М |	
2021|	28М |	
2020|	18М |	
2019|	9М | 
2018|	1М |

{% endcut %}

## Типы столбчатых диаграмм {#types}

* [с группировкой](#groupped)
* [с накоплением](#stacked)

### С группировкой {#groupped}

Диаграмма с группировкой позволяет сравнивать два или несколько показателей, например количество доставленных товаров курьером или самовывоз. Высота столбца выражает величину показателя.

![bar-chart-groupped](../../_assets/datalens/visualization-ref/bar-chart/bar-chart-groupped.png)

{% cut "Исходная таблица" %}

Год |	Доставка|	Самовывоз
-----|---------| ----------|
2022|	2М |	4М
2021|	8М |	19М
2020|	5М |	13М
2019|	3М | 6М
2018|	331К |	918К

{% endcut %}

### С накоплением {#stacked}

Диаграмма показывает соотношение внутренних сегментов по периодам времени или категориям. При этом сегменты располагаются друг над другом – основанием для каждого следующего сегмента будет крайняя граница предыдущего.
Поскольку сумма всех сегментов выражается общей длиной столбца, то такую диаграмму используют, когда важна итоговая сумма столбца.

![bar-chart-stacked](../../_assets/datalens/visualization-ref/bar-chart/bar-chart-stacked.png)

{% cut "Исходная таблица" %}

Год |	Доставка|	Самовывоз
-----|---------| ----------|
2022|	2М |	4М
2021|	8М |	19М
2020|	5М |	13М
2019|	3М | 6М
2018|	331К |	918К

{% endcut %}

## Секции в визарде {#wizard-sections}

Секция<br/> в визарде| Описание
----- | ----
X | Измерения. Может быть указано одно или два измерения. Влияет на группировку значений по оси X. Порядок указанных измерений влияет на порядок группировок по оси X. Для типов `Дата` и `Дата и время`можно задать группировку по времени: минуты, часы, недели и др.
Y | Показатель. Может быть указано несколько показателей. При добавлении в секцию более одного показателя в секции **Цвета** появится измерение [Measure Names](../concepts/chart/measure-values.md). 
Цвета | Измерение, показатель, поле [Measure Names или Measure Values](../concepts/chart/measure-values.md). Влияет на цвет столбцов. `Measure Names` и `Measure Values` удаляются из секции нажатием на значок ![image](../../_assets/datalens/cross.svg) или путем удаления показателей с оси Y.
Сортировка | Измерение или показатель. Влияет на сортировку столбцов. В сортировку выносится только то измерение, которое участвует в построении чарта. Направление сортировки отмечено значком рядом с полем: по возрастанию ![image](../../_assets/console-icons/bars-ascending-align-left.svg) или по убыванию ![image](../../_assets/console-icons/bars-descending-align-left.svg). Чтобы изменить направление сортировки, нажмите значок.
Подписи | Показатель. Отображает значения показателя на диаграмме. При использовании нескольких показателей для подписи добавляйте [Measure Values](../concepts/chart/measure-values.md). Поддерживается использование [функций разметки](../function-ref/markup-functions.md). Для полей с типом `Строка` можно настроить использование базового синтаксиса [{#T}](../dashboard/markdown.md): нажмите на значок перед названием поля и включите опцию **Markdown**.
Сплит | Измерение. Разбивает чарт по горизонтали по значениям выбранного измерения. Максимальное количество сплитов в одном чарте — 25.
Фильтры | Измерение или показатель. Используется в качестве фильтра. Фильтр может быть переопределен селектором дашборда, если селектор будет построен на том же поле.

## Создание столбчатой диаграммы {#create-diagram}

Чтобы создать столбчатую диаграмму:


{% include [datalens-workbooks-collections-note](../../_includes/datalens/operations/datalens-workbooks-collections-note-step4.md) %}


1. Перейдите на [главную страницу]({{ link-datalens-main }}) {{ datalens-short-name }}.
1. На панели слева выберите ![chart](../../_assets/console-icons/chart-column.svg) **Чарты**.
1. Нажмите кнопку **Создать чарт** → **Чарт в Wizard**.
1. Слева вверху нажмите ![image](../../_assets/console-icons/circles-intersection.svg) **Выберите датасет** и укажите датасет для визуализации.
1. Выберите тип чарта **Столбчатая диаграмма**.
1. Перетащите измерение из датасета в секцию **X**. Значения отобразятся в нижней части графика по оси X.
1. Перетащите один или несколько показателей из датасета в секцию **Y**. Значения отобразятся по оси Y в виде столбцов.

По умолчанию отображается диаграмма с накоплением, если у вас больше одного показателя.

### Создание столбчатой диаграммы с группировкой {#grouped-column-chart}

Чтобы отобразить диаграмму с группировкой по оси X:

1. Откройте столбчатую диаграмму или [создайте](#create-diagram) новую.
1. В зависимости от количества показателей в секции **Y** выполните следующие действия:

   {% list tabs group=indicators_number %}

    - Один показатель {#one}

      1. Перетащите измерение, по которому хотите сгруппировать столбцы на диаграмме, в секцию **Цвета**.
      1. Продублируйте это измерение в секцию **Х**. Порядок измерений будет влиять на порядок группировки.

      ![one-measure](../../_assets/datalens/visualization-ref/bar-chart/one-measure.png)

    - Два и больше показателей {#more}

      1. Перетащите измерение `Measure Names` в секцию **Цвета**.
      1. Перетащите измерение `Measure Names` в секцию **X**. Порядок измерений будет влиять на порядок группировки.

      ![two-measures](../../_assets/datalens/visualization-ref/bar-chart/two-measures.png)

   {% endlist %}

### Добавление цвета столбцов по показателю {#column-colors}

Чтобы окрасить столбцы на диаграмме в зависимости от значений показателя:

1. Откройте столбчатую диаграмму или создайте новую.
1. В зависимости от количества показателей в секции **Y** выполните:

   {% list tabs group=indicators_number %}

   - Один показатель {#one}

     Продублируйте показатель из секции **Y** в секцию **Цвета**.

     Столбцы на диаграмме окрасятся в зависимости от значений показателя.

     ![image](../../_assets/datalens/operations/chart/column-colors-1.png)

   - Два и больше показателей {#more}

     Перетащите показатель `Measure Values` в секцию **Цвета**.

     Столбцы на диаграмме окрасятся в зависимости от значений всех показателей, указанных в секции **Y**.

     ![image](../../_assets/datalens/operations/chart/column-colors-2.png)

   {% endlist %}

1. Дополнительно настройте градиент цвета для показателя. Для этого в правом верхнем углу секции **Цвета** нажмите значок ![image](../../_assets/console-icons/gear.svg) (значок появляется при наведении указателя на секцию).
1. В настройках цвета укажите:

   * **Тип градиента** — выберите двухцветный или трехцветный.
   * Цвет градиента — выберите цветовую гамму градиента из списка.
   * Направление градиента — измените направление градиента с помощью значка ![image](../../_assets/console-icons/arrow-right-arrow-left.svg).
   * **Задать пороговые значения** — установите пороговые числовые значения, которые будут соответствовать каждому цвету. Работает, если в секции **Y** один показатель.

### Добавление сортировки столбцов по агрегированному значению {#column-aggregate-sorting}

В секции **Сортировка** нельзя использовать значение с [агрегацией](../dataset/data-model.md#aggregation). Чтобы отсортировать столбцы по агрегированному значению (например, по сумме, количеству или среднему), сначала создайте [вычисляемое поле](../concepts/calculations/index.md) в датасете или чарте с помощью [формулы агрегации](../function-ref/aggregation-functions.md). Затем используйте его для построения чарта и сортировки.

Например, чтобы отсортировать продажи по значению суммы:

1. Откройте столбчатую диаграмму или создайте новую.
1. В левой части экрана над списком измерений и показателей нажмите значок ![image](../../_assets/console-icons/plus.svg) и выберите **Поле**.
1. В окне **Настройка поля** введите:

   * название поля — `sum_Price`;
   * формулу — `SUM([Price])`.

1. Нажмите кнопку **Создать**.
1. Перетащите новое поле в секции **Y** и **Сортировка**. Столбцы отсортируются по значению суммы продаж. Чтобы изменить направление сортировки, в секции **Сортировка** нажмите ![image](../../_assets/console-icons/bars-descending-align-left.svg) или ![image](../../_assets/console-icons/bars-ascending-align-left.svg) справа от названия поля.

![image](../../_assets/datalens/operations/chart/column-sorting.png)

### Настройка отображения пустых (`null`) значений {#null-settings}

{% include [datalens-chart-null-settings](../../_includes/datalens/datalens-chart-null-settings.md) %}

## Рекомендации {#recomentations}

* Если значения категорий содержат большое количество текста, постарайтесь сокращать текст — подписи на диаграмме будут выглядеть аккуратнее. Можно использовать строковые функции в вычисляемых полях или условные операторы `CASE`.
* Если каждый столбец является категорией, а не временем, рассмотрите возможность сортировки столбцов по убыванию или возрастанию показателя. Это сделает график визуально более аккуратным и информативным. Сортировка может быть полезна и внутри подкатегорий каждого столбца.
* Столбчатая диаграмма рекомендуется для отображения изменения показателя(ей) во времени. В этом случае сортировку по оси Х используйте с осторожностью, так как обычно пользователь ожидает увидеть изменение во времени по оси X.
* При визуализации нескольких показателей внимательно подбирайте цвета. Они должны быть различимыми и контрастными. Рекомендуем не использовать больше 3-5 цветов на одном чарте. Если вам интересен один показатель среди всех – выделите его одним ярким цветом.
* Диаграмму можно разбить по измерению на несколько небольших диаграмм, которые удобно сравнивать между собой. Для этого перетащите измерение из датасета в секцию **Сплит**.

  {% cut "Пример чарта" %}

  ![bar-chart-split](../../_assets/datalens/visualization-ref/bar-chart/bar-chart-split.png)

  {% endcut %}

#### См. также {#see-also}

* [{#T}](../operations/dashboard/create.md)
* [{#T}](../operations/dashboard/add-chart.md)
* [{#T}](../operations/dashboard/add-selector.md)