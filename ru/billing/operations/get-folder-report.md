# Получать детализацию расходов по каталогам

Вы можете получать CSV-файл с общей детализацией расходов или поресурсной.

## Перед началом {#before-you-begin}

1. Если у вас еще нет разделения на [каталоги](../../resource-manager/concepts/resources-hierarchy.md#folder), [создайте каталог](../../resource-manager/operations/folder/create.md). В названии каталога укажите имя проекта или клиента, который будет использовать его.

1. [Создайте бакет](../../storage/operations/buckets/create.md) в сервисе {{ objstorage-full-name }}. В этом бакете {{ yandex-cloud }} будет сохранять файлы с детализацией. Вы можете сохранять детализацию в нескольких бакетах.

   {% note alert %}

   Не делайте бакет публичным, иначе любой сможет скачать вашу детализацию по ссылке на бакет.

   {% endnote %}

## Получите детализацию расходов {#download-detail}

{% list tabs %}

- Консоль управления

  1. В [консоли управления]({{ link-console-billing }}) выберите аккаунт, для которого хотите получить детализацию.
  1. На странице **Обзор** перейдите на вкладку **Экспорт детализации**.
  1. Нажмите кнопку **Создать**.
  1. В открывшемся окне **Создание регулярного экспорта** укажите:
     * В поле **Бакет** имя бакета, где будет храниться CSV-файл с детализацией.
     * В поле **Папка** название папки для файла. Последний символ должен быть `/`.
     * Выберите язык, на котором будут отображаться названия продуктов – английский или русский.
     * Выберите тип детализации – **Общая** или **Поресурсная**.
  1. Нажмите кнопку **Создать**.

{% endlist %}

Каждый день в бакете создается новый файл с детализацией. В имени файла указывается префикс и дата, за которую собрана детализация. Файл перезаписывается каждый час, дополняясь новыми данными.

Информация может быть обновлена в любом дневном файле в течение месяца.

{% note tip %}

Файлы с детализацией из бакета автоматически не удаляются, но вы можете настроить периодическое удаление файлов. Подробнее читайте в разделе [Жизненный цикл объектов](../../storage/concepts/lifecycles.md) (в терминах {{ objstorage-name }} файлы в бакете называются _объектами_).

{% endnote %}

## Формат файла с детализацией расходов {#format}

Выгружаемый файл с детализацией — это таблица в CSV-формате (столбцы разделены запятой). Каждая строка отражает потребление продукта за день для указанного каталога.

Таблица содержит следующие столбцы:

* `billing_account_id` — идентификатор [платежного аккаунта](../concepts/billing-account).
* `billing_account_name` — имя платежного аккаунта.
* `cloud_id` — идентификатор [облака](../../resource-manager/concepts/resources-hierarchy#cloud), для которого собрана детализация.
* `cloud_name` — имя облака.
* `folder_id` — идентификатор каталога.
* `folder_name` — имя каталога на момент выгрузки детализации.
* `resource_id` — идентификатор ресурса, имя ресурса или идентификатор подписки. Значение поля может быть пустым, если использование сервиса относится ко всему каталогу или не содержит ресурсов. Соответствие сервисов и значения столбца `resource_id`:
   * {{ compute-name }} и {{ marketplace-name }} — идентификатор виртуальной машины, снимка диска, образа диска или другого ресурса, установленного через {{ marketplace-name }}.
   * {{ objstorage-name }} — имя бакета.
   * {{ vpc-name }} — идентификатор ресурса, работающего с входящим или исходящим трафиком.
   * {{ kms-short-name }} — идентификатор ключа.
   * {{ network-load-balancer-name }} — идентификатор балансировщика.
   * {{ container-registry-short-name }} — идентификатор контейнера.
   * {{ k8s }} и {{ dataproc-name }} — идентификатор кластера.
   * {{ mpg-short-name }}, {{ mch-short-name }}, {{ mmg-short-name }}, {{ mmy-short-name }}, {{ mrd-short-name }} и {{ mkf-name }} — идентификатор хоста в кластере.
   * {{ message-queue-name }} — идентификатор запроса.
   * {{ sf-name }} — идентификатор функции.
   * {{ monitoring-short-name }}, {{ datalens-short-name }}, {{ iot-name }}, {{ speechkit-short-name }}, {{ translate-name }} и {{ vision-short-name }} — пустое значение.
   * Техническая поддержка — идентификатор подписки.
* `service_id` — идентификатор сервиса, которому принадлежит потребленный продукт.
* `service_name` — имя сервиса, которому принадлежит потребленный продукт.
* `sku_id` — идентификатор потребленного продукта.
* `sku_name` — имя продукта.
* `date` — дата, за которую начислена стоимость потребления.
* `currency` — валюта платежного аккаунта. Возможные значения: `RUB` и `USD`.
* `pricing_quantity` — количество потребленных единиц продукта. Десятичный разделитель — точка.
* `pricing_unit` — единица измерения потребления продукта.
* `cost` — общая стоимость потребления. Десятичный разделитель — точка.
* `credit` — сумма скидок. Десятичный разделитель — точка.
* `monetary_grant_credit` — скидка по гранту, в том числе по гранту на знакомство с платформой. Десятичный разделитель — точка.
* `volume_incentive_credit` — скидка за объем потребления продукта. Десятичный разделитель — точка.
* `cud_credit` — скидка за [резервированное потребление](../concepts/cvos.md) ресурса. Стоимость объема потребления сверх резервированного будет равна разнице между столбцами `cost` и `credit`. Десятичный разделитель — точка.
* `misc_credit` — остальные виды скидок, в том числе скидки за потребление ресурсов после окончания действия гранта на знакомство с платформой, но до перехода на платную версию. Десятичный разделитель — точка.
* `label.user_labels.<имя метки>` — метки, проставленные ресурсам. Как управлять метками описано в разделе [Метки ресурсов сервисов](../../overview/concepts/services.md#labels).
* `locale` — язык каждой строки в выгрузке. От значения поля зависит язык столбца `sku_name`. Возможные значения `en` и `ru`.
* `updated_at` — дата и время последнего изменения строки в формате [Unix Timestamp](https://www.unixtimestamp.com).
* `exported_at` — дата и время добавления строки в файл детализации.

{% cut "Устаревшие параметры" %}

* `created_at` — дата и время, в которое начислена указанная стоимость потребления. В формате [Unix Timestamp](https://www.unixtimestamp.com).
* `label.system_labels.folder_id` — идентификатор каталога. Теперь значение отображается в столбце `folder_id`.

{% endcut %}

##### См. также

* [Посмотреть детализацию для облака](check-charges.md)