---
title: "Шардирование и репликация в Elasticsearch"
description: "В кластере Elasticsearch с помощью шардирования можно обеспечить возможность масштабирования при росте объема данных в индексах. С помощью репликации можно повысить отказоустойчивость кластера и сохранность данных в индексах"
keywords:
  - шардирование Elasticsearch
  - репликация Elasticsearch
  - Elasticsearch
---

# Шардирование и репликация

{% include [Elasticsearch-end-of-service](../../_includes/mdb/mes/note-end-of-service.md) %}

В кластере {{ ES }}:
- С помощью [шардирования](../../glossary/sharding.md) можно обеспечить возможность масштабирования при росте объема данных в индексах.
- С помощью репликации можно повысить отказоустойчивость кластера и сохранность данных в индексах (только для многохостовых конфигураций кластера).

Подробнее о шардах, масштабировании и отказоусточивости см. в [документации {{ ES }}](https://www.elastic.co/guide/en/elasticsearch/reference/current/scalability.html).

## Шардирование индексов {#sharding}

{{ mes-full-name }} использует стандартный механизм шардирования индексов {{ ES }}. Для каждого индекса вы можете создать один или несколько первичных шардов (primary shards), между которыми распределяются запросы на запись в индекс. Количество первичных шардов можно задать только при создании индекса, потом их число нельзя будет изменить.

{{ ES }} равномерно распределяет первичные шарды по хостам кластера. Это снижает нагрузку на каждый отдельный хост и позволяет легко отмасштабировать кластер, если нагрузка вдруг возрастет.

## Репликация индексов {#replication}

{{ mes-full-name }} использует стандартный механизм репликации индексов {{ ES }}. Чтобы включить его, при создании индекса укажите фактор репликации — число реплик для каждого первичного шарда индекса. В результате будет создано нужное количество шардов-реплик (replica shard) для каждого первичного шарда. 

При настроенной репликации:
- Запись в индекс идет только через первичные шарды. 
- Чтение из индекса может выполняться одновременно и с первичных шардов, и с шардов-реплик.

{{ ES }} автоматически управляет шардами-репликами, перемещая их между хостами кластера при изменении размера кластера. 

Количество шардов-реплик можно регулировать: в отличие от первичных шардов, их количество не фиксируется при создании индекса.