# Изменение настроек кластера

После создания кластера вы можете:

* [Изменить класс хостов](#change-resource-preset).

* [Увеличить размер хранилища](#change-disk-size) (доступно только для стандартного `network-hdd` и быстрого сетевого `network-ssd` хранилищ).

* [{#T}](#update-additional-settings).

## Изменить класс хостов {#change-resource-preset}

{% list tabs %}

- Консоль управления

  1. Перейдите на страницу каталога и выберите сервис **{{ mes-name }}**.
  1. Выберите кластер и нажмите кнопку **Редактировать** на панели сверху.
  1. Чтобы изменить класс хостов {{ ES }} с ролью *Data node*:
     1. Выберите вкладку **Data node**.
     1. В блоке **Класс хоста** выберите нужный класс для хоста.
  1. Чтобы изменить класс хостов {{ ES }} с ролью *Master node*:
     1. Выберите вкладку **Master node**.
     1. В блоке **Класс хоста** выберите нужный класс для хоста.
  1. Нажмите кнопку **Сохранить**.

- API

  Чтобы изменить [класс хостов](../concepts/instance-types.md) кластера, воспользуйтесь методом [update](../api-ref/Cluster/update.md) и передайте в запросе:
  - Идентификатор кластера в параметре `clusterId`. Чтобы узнать идентификатор, [получите список кластеров в каталоге](cluster-list.md#list-clusters).
  - Класс хостов в параметрах:
    - `configSpec.elasticsearchSpec.dataNode.resources.resourcePresetId`  — для хостов с ролью *Data node*.
    - `configSpec.elasticsearchSpec.masterNode.resources.resourcePresetId` — для хостов с ролью *Master node*.
  - Список настроек, которые необходимо изменить, в параметре `updateMask`. Если не задать этот параметр, метод API сбросит на значения по умолчанию все настройки кластера, которые не были явно указаны в запросе.

  Список поддерживаемых значений запрашивайте методом [list](../api-ref/ResourcePreset/list.md) для ресурсов `ResourcePreset`.

{% endlist %}

## Увеличить размер хранилища {#change-disk-size}

{% list tabs %}

- Консоль управления

  1. Перейдите на страницу каталога и выберите сервис **{{ mes-name }}**.
  1. Выберите кластер и нажмите кнопку **Редактировать** на панели сверху.
  1. Чтобы увеличить размер диска для хостов {{ ES }} с ролью *Data node*:
     1. Выберите вкладку **Data node**.
     1. В блоке **Хранилище** укажите необходимый размер диска.
  1. Чтобы увеличить размер диска для хостов {{ ES }} с ролью *Master node*:
     1. Выберите вкладку **Master node**.
     1. В блоке **Хранилище** укажите необходимый размер диска.
  1. Нажмите кнопку **Сохранить**.

{% if api != "noshow" %}

- API

  Чтобы изменить размер диска для кластера, воспользуйтесь методом [update](../api-ref/Cluster/update.md) и передайте в запросе:
  - Идентификатор кластера в параметре `clusterId`. Чтобы узнать идентификатор, [получите список кластеров в каталоге](cluster-list.md#list-clusters).
  - Необходимый размер диска (в байтах) в параметрах:
    - `configSpec.elasticsearchSpec.dataNode.resources.diskSize`  — для хостов с ролью *Data node*.
    - `configSpec.elasticsearchSpec.masterNode.resources.diskSize` — для хостов с ролью *Master node*.
  - Список настроек, которые необходимо изменить, в параметре `updateMask`. Если не задать этот параметр, метод API сбросит на значения по умолчанию все настройки кластера, которые не были явно указаны в запросе.

{% endif %}

{% endlist %}

## Изменить дополнительные настройки кластера {#update-additional-settings}

{% list tabs %}

* Консоль управления

    1. Перейдите на страницу каталога и выберите сервис **{{ mes-name }}**.
    1. Выберите кластер и нажмите кнопку **Редактировать** на панели сверху.
    1. Чтобы изменить сервисный аккаунт, используемый для работы с кластером, выберите его из выпадающего списка.
    1. Нажмите кнопку **Сохранить**.

* CLI

    {% include [cli-install](../../_includes/cli-install.md) %}

    {% include [default-catalogue](../../_includes/default-catalogue.md) %}

    1. Посмотрите описание команды CLI для изменения кластера:

        ```bash
        {{ yc-mdb-es }} cluster update --help
        ```

    1. Чтобы изменить список [расширений {{ ES }}](../concepts/plugins.md), доступных в кластере, передайте их список в аргументе `--plugins` команды CLI. При этом расширения, не упомянутые в списке, будут выключены.

        ```bash
        {{ yc-mdb-es }} cluster update <имя кластера> \
           --plugins <список расширений>
        ```

* API

    Чтобы изменить дополнительные настройки кластера {{ ES }}, воспользуйтесь методом методом [update](../api-ref/Cluster/update.md) и передайте в запросе:
    * Идентификатор кластера в параметре `clusterId`. Чтобы узнать идентификатор, [получите список кластеров в каталоге](./cluster-list.md#list-clusters).
    * Список [расширений {{ ES }}](../concepts/plugins.md) в параметре `plugins`.
    * Идентификатор [сервисного аккаунта](../../iam/concepts/users/service-accounts.md), используемого для работы с кластером, в параметре `serviceAccountId`.
    * Список настроек, которые необходимо изменить, в параметре `updateMask`. Если не задать этот параметр, метод API сбросит на значения по умолчанию все настройки кластера, которые не были явно указаны в запросе.

{% endlist %}
