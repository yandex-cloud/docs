# Изменение настроек кластера

После создания кластера вы можете:

- [Изменить класс хостов](#change-resource-preset).
- [Увеличить размер хранилища](#change-disk-size) (доступно только для сетевого хранилища, `network-hdd` и `network-ssd`).
- [Изменить настройки](#change-sqlserver-config) {{ MS }} согласно документации {{ MS }}.
- [Переместить кластер](#move-cluster) в другой каталог.

{% note warning %}

Вы не можете с помощью команд SQL изменять настройки {{ MS }}, в том числе управлять объектами уровня сервера `Linked Server`, `Login`, `Credential`, `SQL Server Agent Job`, `Maintenance Plan`, `Audit`, `Polybase`, `Replication`, `Backup devices`, `Server Triggers`, `Extended events`.

{% endnote %}

## Изменить класс хостов {#change-resource-preset}

{% list tabs %}

- Консоль управления

  1. Перейдите на страницу каталога и выберите сервис **{{ mms-name }}**.
  1. Выберите кластер и нажмите кнопку **Изменить кластер** на панели сверху.
  1. Выберите новый [класс хостов](../concepts/instance-types.md). При изменении класса хостов для кластера меняются характеристики всех уже созданных хостов.
  1. Нажмите кнопку **Сохранить изменения**.

- API

  Чтобы изменить [класс хостов](../concepts/instance-types.md) кластера, воспользуйтесь методом [update](../api-ref/Cluster/update.md) и передайте в запросе:
  - Идентификатор кластера в параметре `clusterId`. Чтобы узнать идентификатор, [получите список кластеров в каталоге](cluster-list.md#list-clusters).
  - Новый класс хостов в параметре  `configSpec.resources.resourcePresetId`. Чтобы узнать список поддерживаемых значений, воспользуйтесь методом `list` для `ResourcePreset`.
  - Список полей конфигурации кластера подлежащих изменению (в данном случае — `configSpec.resources.resourcePresetId`) в параметре `updateMask`.

  {% note warning %}

  Этот метод API сбросит все настройки кластера, которые не были явно переданы в запросе, на значения по умолчанию. Чтобы избежать этого, перечислите настройки, которые вы хотите изменить, в параметре `updateMask` (одной строкой через запятую).

  {% endnote %}

{% endlist %}


## Увеличить размер хранилища {#change-disk-size}

{% list tabs %}

- Консоль управления

  1. Перейдите на страницу каталога и выберите сервис **{{ mms-name }}**.
  1. Выберите кластер и нажмите кнопку **Изменить кластер** на панели сверху.
  1. В разделе **Размер хранилища** укажите необходимое значение.
  1. Нажмите кнопку **Сохранить изменения**.

- API

  Чтобы изменить размер хранилища для кластера, воспользуйтесь методом [update](../api-ref/Cluster/update.md) и передайте в запросе:
  - Идентификатор кластера в параметре `clusterId`. Чтобы узнать идентификатор, [получите список кластеров в каталоге](cluster-list.md#list-clusters).
  - Необходимое значение размера хранилища (в байтах) в параметре `configSpec.resources.diskSize`.
  - Список полей конфигурации пользователя подлежащих изменению (в данном случае — `configSpec.resources.diskSize`) в параметре `updateMask`.

  {% note warning %}

  Этот метод API сбросит все настройки кластера, которые не были явно переданы в запросе, на значения по умолчанию. Чтобы избежать этого, перечислите настройки, которые вы хотите изменить, в параметре `updateMask` (одной строкой через запятую).

  {% endnote %}

{% endlist %}


## Изменить настройки {{ MS }} {#change-sqlserver-config}

{% list tabs %}

- Консоль управления

  1. Перейдите на страницу каталога и выберите сервис **{{ mms-name }}**.
  1. Выберите кластер и нажмите кнопку **Изменить кластер** на панели сверху.
  1. В блоке **Настройки СУБД** нажмите кнопку **Настроить**.
  1. Внесите необходимые изменения в настройки и нажмите кнопку **Сохранить**.
  1. Нажмите кнопку **Сохранить изменения**.

- API

  Воспользуйтесь методом [update](../api-ref/Cluster/update.md) и передайте в запросе:
  - Идентификатор кластера в параметре `clusterId`. Чтобы узнать идентификатор, [получите список кластеров в каталоге](cluster-list.md#list-clusters).
  - Необходимые значения в параметре `configSpec.sqlserverConfig_2016sp2`.
  - Список полей конфигурации пользователя подлежащих изменению (в данном случае — `configSpec.sqlserverConfig_2016sp2`) в параметре `updateMask`.

  {% note warning %}

  Этот метод API сбросит все настройки кластера, которые не были явно переданы в запросе, на значения по умолчанию. Чтобы избежать этого, перечислите настройки, которые вы хотите изменить, в параметре `updateMask` (одной строкой через запятую).

  {% endnote %}

{% endlist %}

## Переместить кластер {#move-cluster}

{% list tabs %}

- Консоль управления

  Чтобы переместить кластер в другой каталог:
  1. Перейдите на страницу каталога и выберите сервис **{{ mms-name }}**.
  1. Нажмите значок ![image](../../_assets/horizontal-ellipsis.svg) справа в строке кластера, который вы хотите переместить.
  1. Выберите пункт **Переместить**.
  1. Выберите каталог, в который вы хотите переместить кластер.
  1. Нажмите кнопку **Переместить**.

- API

  Чтобы переместить кластер в другой каталог, воспользуйтесь методом API [move](../api-ref/Cluster/move.md) и передайте в запросе:
  - Идентификатор кластера в параметре `clusterId`. Чтобы узнать идентификатор, [получите список кластеров в каталоге](cluster-list.md#list-clusters).
  - Идентификатор каталога назначения в параметре `destinationFolderId`.

{% endlist %}
