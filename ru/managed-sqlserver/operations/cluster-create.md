# Создание кластера {{ MS }}

Кластер {{ MS }} — это один или несколько хостов базы данных, между которыми можно настроить репликацию. Репликация работает по умолчанию в любом кластере из более чем 1 хоста: хост-мастер принимает запросы на запись, синхронно дублирует изменения в основной реплике и асинхронно — во всех остальных.

{% note info %}

Если хранилище баз данных заполнится на 95%, кластер перейдет в режим только чтения. Рассчитывайте и увеличивайте необходимый размер хранилища заранее.

{% endnote %}

## Как создать кластер {{ MS }} {#create-cluster}

{% list tabs %}

- Консоль управления

  1. В консоли управления выберите каталог, в котором нужно создать кластер баз данных.
  1. Выберите сервис **{{ mms-name }}**.
  1. Нажмите кнопку **Создать кластер**.
  1. Введите имя кластера в поле **Имя кластера**. Имя кластера должно быть уникальным в рамках каталога.
  1. Выберите окружение, в котором нужно создать кластер (после создания кластера окружение изменить невозможно):
      - `PRODUCTION` — для стабильных версий ваших приложений.
      - `PRESTABLE` — для тестирования, в том числе самого сервиса {{ mms-short-name }}. В Prestable-окружении раньше появляются новая функциональность, улучшения и исправления ошибок. При этом не все обновления обеспечивают обратную совместимость.
  1. Выберите версию СУБД. На текущий момент поддерживается версия `2016 ServicePack 2` следующих редакций:
     * Standard Edition.
     * Enterprise Edition.

     Подробнее см. в разделе [{#T}](../concepts/index.md).

  1. Выберите класс хостов — он определяет технические характеристики виртуальных машин, на которых будут развернуты хосты баз данных. Все доступные варианты перечислены в разделе [{#T}](../concepts/instance-types.md). При изменении класса хостов для кластера меняются характеристики всех уже созданных хостов.
  1. В блоке **Размер хранилища**:

      {% if audience != "internal" %}
      - Выберите тип хранилища — более гибкое сетевое (**network-hdd** или **network-ssd**) или более быстрое локальное хранилище (**local-ssd**). Размер локального хранилища можно менять только с шагом 100 ГБ.
      {% endif %}

      - Выберите объем, который будет использоваться для данных и резервных копий. Подробнее о том, как занимают пространство резервные копии, см. раздел [{#T}](../concepts/backup.md).
  1. В блоке **База данных** укажите атрибуты базы данных:

      - Имя базы данных. Это имя должно быть уникальным в рамках каталога и содержать только латинские буквы, цифры и подчеркивания.
      - Имя пользователя — владельца базы данных. Это имя должно содержать только латинские буквы, цифры и подчеркивания. По умолчанию новому пользователю выделяется 50 подключений к каждому хосту кластера.
      - Пароль пользователя, от 8 до 128 символов.

  1. В блоке **Хосты** выберите параметры хостов баз данных, создаваемых вместе с кластером. Вы можете добавить либо один, либо три и более хостов. По умолчанию каждый хост создается в отдельной подсети. Чтобы выбрать конкретную подсеть для хоста, нажмите значок ![image](../../_assets/pencil.svg) в строке этого хоста и выберите необходимые зону доступности и подсеть.

     {% note warning %}

     * Если вы выбрали редакцию **Standard Edition**, то вы можете создать кластер только из одного хоста. Такой кластер не обеспечивает отказоустойчивости. Подробнее см. в разделе [{#T}](../concepts/index.md).
     * На текущий момент вы можете создать кластер редакции **Enterprise Edition** либо из одного, либо из трех хостов.

     {% endnote %}

  1. При необходимости задайте [настройки СУБД](../concepts/settings-list.md).
  1. Нажмите кнопку **Создать кластер**.

- API

  Чтобы создать кластер, воспользуйтесь методом API [create](../api-ref/Cluster/create.md) и передайте в запросе:
  - Идентификатор каталога, в котором должен быть размещен кластер, в параметре `folderId`.
  - Имя кластера в параметре `name`.
  - Конфигурацию кластера в параметре `configSpec`.
  - Конфигурацию хостов кластера в одном или нескольких параметрах `hostSpecs`.
  - Конфигурацию баз данных кластера в одном или нескольких параметрах `databaseSpecs`.
  - Конфигурацию учетных записей баз данных кластера в одном или нескольких параметрах `userSpecs`.
  - Идентификатор сети в параметре `networkId`.

{% endlist %}
