# Управление пользователями

Вы можете добавлять и удалять пользователей, а также управлять их индивидуальными настройками.

{% note warning %}

С помощью команд SQL вы можете назначать пользователям привилегии, но не можете добавлять и изменять пользователей. Подробнее см. в разделе [{#T}](grant.md).

{% endnote %}

## Получить список пользователей {#list-users}

{% list tabs %}

- Консоль управления

  1. Перейдите на страницу каталога и выберите сервис **{{ mms-name }}**.
  1. Нажмите на имя нужного кластера, затем выберите вкладку **Пользователи**.

- API

  Воспользуйтесь методом API [list](../api-ref/User/list.md): передайте значение идентификатора требуемого кластера в параметре `clusterId` запроса.

  Чтобы узнать идентификатор кластера, [получите список кластеров в каталоге](cluster-list.md#list-clusters).

{% endlist %}

## Добавить пользователя {#adduser}

{% list tabs %}

- Консоль управления

  1. Перейдите на страницу каталога и выберите сервис **{{ mms-name }}**.
  1. Нажмите на имя нужного кластера и выберите вкладку **Пользователи**.
  1. Нажмите кнопку **Добавить**.
  1. Введите имя пользователя базы данных и пароль (от 8 до 128 символов).
  1. Выберите одну или несколько баз данных, к которым должен иметь доступ пользователь:
     1. Нажмите кнопку **Добавить базу данных**.
     1. Выберите базу данных из выпадающего списка.
     1. Повторите два предыдущих шага, пока не будут выбраны все требуемые базы данных.
     1. Чтобы удалить базу, добавленную по ошибке, нажмите значок ![image](../../_assets/cross.svg) справа от имени базы данных.
  1. [Задайте роли пользователя](grant.md#grant-role) для каждой из выбранных баз данных.
  1. Нажмите кнопку **Создать**.

- API

  Воспользуйтесь методом API [create](../api-ref/User/create.md) и передайте в запросе:
  - Идентификатор кластера, в котором вы хотите создать пользователя в параметре `clusterId`. Чтобы узнать идентификатор, [получите список кластеров в каталоге](cluster-list.md#list-clusters).
  - Имя пользователя в параметре `userSpec.name`.
  - Пароль пользователя в параметре `userSpec.password`.
  - Одну или несколько баз данных, к которым должен иметь доступ пользователь в одном или нескольких параметрах `userSpec.permissions.databaseName`.
  - [Роли пользователя](grant.md#predefined-db-roles) для каждой из выбранных баз данных в одном или нескольких параметрах `userSpec.permissions.roles`.

{% endlist %}

## Изменить пароль {#change-password}

{% list tabs %}

- Консоль управления

  Чтобы изменить пароль пользователя:
  1. Перейдите на страницу каталога и выберите сервис **{{ mms-name }}**.
  1. Нажмите на имя нужного кластера и выберите вкладку **Пользователи**.
  1. Нажмите значок ![options](../../_assets/horizontal-ellipsis.svg) и выберите пункт **Изменить пароль**.
  1. Задайте новый пароль и нажмите кнопку **Изменить**.

- API

  Воспользуйтесь методом API [update](../api-ref/User/update.md) и передайте в запросе:
  - Идентификатор кластера, в котором находится пользователь в параметре `clusterId`. Чтобы узнать идентификатор, [получите список кластеров в каталоге](cluster-list.md#list-clusters).
  - Имя пользователя в параметре `userName`. Чтобы узнать имя пользователя, [получите список пользователей в кластере](#list-users).
  - Новый пароль пользователя в параметре `password`.
  - Список полей конфигурации пользователя подлежащих изменению (в данном случае — `password`) в параметре `updateMask`.

  {% note warning %}

  Этот метод API сбросит все настройки пользователя, которые не были явно переданы в запросе, на значения по умолчанию.
  Чтобы избежать этого, обязательно передайте название поля пароля пользователя — `password` — в параметре `updateMask`.

  {% endnote %}

{% endlist %}

## Изменить настройки пользователя {#update-settings}

{% list tabs %}

- Консоль управления

  Чтобы изменить настройки пользователя:
  1. Перейдите на страницу каталога и выберите сервис **{{ mms-name }}**.
  1. Нажмите на имя нужного кластера и выберите вкладку **Пользователи**.
  1. Нажмите значок ![image](../../_assets/horizontal-ellipsis.svg) и выберите пункт **Настроить**.
  1. Настройте права пользователя на доступ к определенным базам данных:
     1. Чтобы предоставить доступ к требуемым базам данных:
        1. Нажмите кнопку **Добавить базу данных**.
        1. Выберите базу данных из выпадающего списка.
        1. Повторите два предыдущих шага, пока не будут выбраны все требуемые базы данных.
     1. Чтобы отозвать доступ к определенной базе, удалите ее из перечня, нажав значок ![image](../../_assets/cross.svg) справа от имени базы данных.
  1. Задайте нужные роли пользователя для каждой из выбранных баз данных.
  1. Нажмите кнопку **Сохранить**.

- API

  Воспользуйтесь методом API [update](../api-ref/User/update.md) и передайте в запросе:
  - Идентификатор кластера, в котором находится пользователь в параметре `clusterId`. Чтобы узнать идентификатор, [получите список кластеров в каталоге](cluster-list.md#list-clusters).
  - Имя пользователя в параметре `userName`. Чтобы узнать имя пользователя, [получите список пользователей в кластере](#list-users).
  - Новые значения настроек пользователя.
  - Список полей конфигурации пользователя подлежащих изменению в параметре `updateMask`.

  {% note warning %}

  Этот метод API сбросит все настройки пользователя, которые не были явно переданы в запросе, на значения по умолчанию.
  Чтобы избежать этого, перечислите настройки, которые вы хотите изменить, в параметре `updateMask` (одной строкой через запятую).

  {% endnote %}

{% endlist %}

## Удалить пользователя {#removeuser}

{% list tabs %}

- Консоль управления

  1. Перейдите на страницу каталога и выберите сервис **{{ mms-name }}**.
  1. Нажмите на имя нужного кластера и выберите вкладку **Пользователи**.
  1. Нажмите значок ![image](../../_assets/horizontal-ellipsis.svg) и выберите пункт **Удалить**.
  1. Подтвердите удаление пользователя.

- API

  Воспользуйтесь методом API [delete](../api-ref/User/delete.md) и передайте в запросе:
  - Идентификатор кластера, в котором находится пользователь в параметре `clusterId`. Чтобы узнать идентификатор, [получите список кластеров в каталоге](cluster-list.md#list-clusters).
  - Имя пользователя в параметре `userName`. Чтобы узнать имя пользователя, [получите список пользователей в кластере](#list-users).

{% endlist %}

{% include [user-ro](../../_includes/mdb/mms-user-examples.md) %}