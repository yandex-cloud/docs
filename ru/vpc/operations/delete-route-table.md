# Удалить таблицу маршрутизации

Если таблица маршрутизации вам больше не нужна, вы можете ее [удалить](#delete-route-table). Перед удалением таблицы [отвяжите ее](#unlink-route-table) от всех подсетей, к которым она привязана. 

## Отвязать таблицу маршрутизации от подсети {#unlink-route-table}

{% list tabs group=instructions %}

- Консоль управления {#console}

  1. В [консоли управления]({{ link-console-main }}) перейдите в каталог, где требуется отвязать таблицу маршрутизации.
  1. В списке сервисов выберите **{{ ui-key.yacloud.iam.folder.dashboard.label_vpc }}**.
  1. Перейдите в облачную сеть, в которой создана таблица маршрутизации.

     {% note info %}

     Если вы не знаете, в какой сети создана таблица маршрутизации, на панели слева выберите ![image](../../_assets/console-icons/route.svg) **{{ ui-key.yacloud.vpc.network.switch_route-table }}**. Вам откроется список с таблицами маршрутизации. В колонке **Сеть** напротив имени таблицы маршрутизации будет указана нужная сеть. Чтобы перейти в облачную сеть, нажмите на ее название.

     {% endnote %}

  1. В списке подсетей найдите подсеть, к которой привязана таблица маршрутизации.
  1. Отвяжите таблицу маршрутизации от подсети любым из следующих способов:
     * В строке с информацией о подсети нажмите на значок ![image](../../_assets/console-icons/xmark.svg) рядом с названием таблицы маршрутизации.
     * В строке с информацией о подсети нажмите на значок ![image](../../_assets/console-icons/ellipsis.svg) и выберите **Редактировать**. В открывшемся окне нажмите на значок ![image](../../_assets/console-icons/xmark.svg) в строке с названием таблицы маршрутизации и сохраните изменения.
     * Откройте информацию о подсети и нажмите на значок ![image](../../_assets/console-icons/xmark.svg) рядом с названием таблицы маршрутизации.
     * Откройте информацию о подсети и в правом верхнем углу нажмите **Редактировать**. В открывшемся окне нажмите на значок ![image](../../_assets/console-icons/xmark.svg) в строке с названием таблицы маршрутизации и сохраните изменения.

- CLI {#cli}

  {% include [include](../../_includes/cli-install.md) %}

  {% include [default-catalogue](../../_includes/default-catalogue.md) %}

  Чтобы отвязать таблицу маршрутизации от подсети:

  1. Посмотрите описание команды CLI для изменения параметров подсети:

      ```bash
      yc vpc subnet update --help
      ```

  1. Узнайте имя или идентификатор подсети, к которой привязана таблица маршрутизации:

      ```bash
      yc vpc subnet list
      ```
      Результат:
      ```text
      +----------------------+----------------------------+----------------------+----------------------+---------------+-----------------+
      |          ID          |            NAME            |      NETWORK ID      |    ROUTE TABLE ID    |     ZONE      |      RANGE      |
      +----------------------+----------------------------+----------------------+----------------------+---------------+-----------------+
      | e9b4vdgv0v1n******** | default-ru-central1-a      | enptgj64mv2r******** |                      | ru-central1-a | [10.128.0.0/24] |
      | e2lp11c4o77d******** | default-ru-central1-b      | enptgj64mv2r******** | enpcaaqahk3c******** | ru-central1-b | [10.129.0.0/24] |
      +----------------------+----------------------------+----------------------+----------------------+---------------+-----------------+

      ```
  1.  Отвяжите таблицу маршрутизации от подсети:
      ```bash
      yc vpc subnet update <имя_или_идентификатор_подсети> --disassociate-route-table
      ```
      Используйте либо параметр `--id`, либо параметр `--name`.

- {{ TF }} {#tf}

  {% include [terraform-install](../../_includes/terraform-install.md) %}

  {% include [terraform-definition](../../_tutorials/_tutorials_includes/terraform-definition.md) %}

  Чтобы отвязать таблицу маршрутизации от подсети в инфраструктуре, созданной в {{ TF }}:

  1. Откройте файл конфигурации {{ TF }} и найдите фрагмент с описанием подсети, к которой привязана таблица маршрутизации.

     {% cut "Пример описания подсети в конфигурации {{ TF }}" %}

     ```hcl
     ...
     resource "yandex_vpc_subnet" "subnet" {
       folder_id      = "<идентификатор_каталога_пользователя>"
       name           = "<название_подсети>"
       v4_cidr_blocks = ["10.20.30.0/24"]
       zone           = "<зона_доступности>"
       network_id     = "<идентификатор_подсети>"
       route_table_id = "<идентификатор_таблицы_маршрутизации>"
     }
     ...
     ```

     {% endcut %}

  1. Удалите из этого фрагмента строку с описанием таблицы маршрутизации:

     ```hcl
     route_table_id = "<идентификатор_таблицы_маршрутизации>"
     ```

  1. В командной строке перейдите в папку, где расположен файл конфигурации {{ TF }}.

  1. Проверьте конфигурацию командой:

     ```bash
     terraform validate
     ```

     Если конфигурация является корректной, появится сообщение:

     ```
     Success! The configuration is valid.
     ```

  1. Выполните команду:

     ```bash
     terraform plan
     ```
  
     В терминале будет выведен список ресурсов с параметрами. На этом этапе изменения не будут внесены. Если в конфигурации есть ошибки, {{ TF }} на них укажет.

  1. Примените изменения конфигурации:

     ```bash
     terraform apply
     ```

  1. Подтвердите изменения: введите в терминал слово `yes` и нажмите **Enter**.

     Проверить изменения можно в [консоли управления]({{ link-console-main }}) или с помощью команды [CLI](../../cli/quickstart.md):

     ```bash
     yc vpc subnet get <имя_или_идентификатор_подсети>
     ```
     Используйте либо параметр `--id`, либо параметр `--name`.

- API {#api}

  Чтобы отвязать таблицу маршрутизации от подсети, воспользуйтесь методом REST API [update](../api-ref/Subnet/update.md) для ресурса [Subnet](../api-ref/Subnet/index.md) или вызовом gRPC API [SubnetService/Update](../api-ref/grpc/subnet_service.md#Update) и передайте в запросе пустую строку в параметре:
    * `routeTableId` для REST API;
    * `route_table_id` для gRPC API.
  
  {% include [Note API updateMask](../../_includes/note-api-updatemask.md) %}

{% endlist %}

## Удалить таблицу маршрутизации {#delete-route-table}

Перед удалением таблицы [отвяжите ее](#unlink-route-table) от всех подсетей, к которым она привязана. 

{% list tabs group=instructions %}

- Консоль управления {#console}

  Чтобы удалить таблицу маршрутизации: 
  1. В [консоли управления]({{ link-console-main }}) перейдите в каталог, где требуется удалить таблицу маршрутизации.
  1. В списке сервисов выберите **{{ ui-key.yacloud.iam.folder.dashboard.label_vpc }}**.
  1. На панели слева выберите ![image](../../_assets/console-icons/route.svg) **{{ ui-key.yacloud.vpc.network.switch_route-table }}**.
  1. Нажмите на значок ![image](../../_assets/console-icons/ellipsis.svg) в строке с именем нужной таблицы и выберите **Удалить**.
  1. В открывшемся окне нажмите кнопку **Удалить**.  

- CLI {#cli}

  {% include [include](../../_includes/cli-install.md) %}

  {% include [default-catalogue](../../_includes/default-catalogue.md) %}

  Чтобы удалить таблицу маршрутизации:

  1. Посмотрите описание команды CLI для удаления таблицы маршрутизации:

      ```bash
      yc vpc route-table delete --help
      ```

  1. Узнайте имя или идентификатор таблицы маршрутизации, которую требуется удалить:

      ```bash
      yc vpc route-table list
      ```
      Результат:
      ```text
      +----------------------+---------+-------------+----------------------+
      |          ID          |  NAME   | DESCRIPTION |      NETWORK-ID      |
      +----------------------+---------+-------------+----------------------+
      | enpd3s8svtkd******** | table-1 |             | enptgj64mv2r******** |
      +----------------------+---------+-------------+----------------------+
      ```
  1. Удалите таблицу маршрутизации:
      ```bash
      yc vpc route-table delete <имя_или_идентификатор_таблицы_маршрутизации>
      ```
      Используйте либо параметр `--id`, либо параметр `--name`.

- {{ TF }} {#tf}

  {% include [terraform-install](../../_includes/terraform-install.md) %}

  {% include [terraform-definition](../../_tutorials/_tutorials_includes/terraform-definition.md) %}

  Чтобы удалить таблицу маршрутизации, созданную с помощью {{ TF }}:

  1. Откройте файл конфигурации {{ TF }} и удалите фрагмент с описанием таблицы маршрутизации.

     {% cut "Пример описания таблицы маршрутизации в конфигурации {{ TF }}" %}

     ```hcl
     ...
     resource "yandex_vpc_route_table" "route_table" {
       folder_id  = "<идентификатор_каталога_пользователя>" 
       name       = "<имя_таблицы_маршрутизации>"
       network_id = "<идентификатор_сети>"
       static_route {
         destination_prefix = "10.2.0.0/16"
         next_hop_address   = "172.16.10.10"
       }
     }
     ...
     ```

     {% endcut %}

  1. В командной строке перейдите в папку, где расположен файл конфигурации {{ TF }}.

  1. Проверьте конфигурацию командой:

     ```bash
     terraform validate
     ```

     Если конфигурация является корректной, появится сообщение:

     ```
     Success! The configuration is valid.
     ```

  1. Выполните команду:

     ```bash
     terraform plan
     ```
  
     В терминале будет выведен список ресурсов с параметрами. На этом этапе изменения не будут внесены. Если в конфигурации есть ошибки, {{ TF }} на них укажет.

  1. Примените изменения конфигурации:

     ```bash
     terraform apply
     ```

  1. Подтвердите изменения: введите в терминал слово `yes` и нажмите **Enter**.

     Проверить изменения можно в [консоли управления]({{ link-console-main }}) или с помощью команды [CLI](../../cli/quickstart.md):

     ```bash
     yc vpc subnet list
     ```

- API {#api}

  Чтобы удалить таблицу маршрутизации, воспользуйтесь методом REST API [delete](../api-ref/RouteTable/delete.md) для ресурса [RouteTable](../api-ref/RouteTable/index.md) или вызовом gRPC API [RouteTableService/Delete](../api-ref/grpc/route_table_service.md#Delete) и передайте в запросе идентификатор удаляемой таблицы маршрутизации в параметре:
    * `routeTableID` для REST API;
    * `route_table_id` для gRPC API.

  Чтобы узнать идентификатор таблицы маршрутизации, воспользуйтесь методом REST API [list](../api-ref/RouteTable/list.md) для ресурса [RouteTable](../api-ref/RouteTable/index.md) или вызовом gRPC API [RouteTableService/List](../api-ref/grpc/route_table_service.md#List) и передайте в запросе идентификатор каталога в параметре:
    * `folderID` для REST API;
    * `folder_id` для gRPC API.

{% endlist %}
