# Создать подсеть

[Подсети](../concepts/network.md#subnet) создаются в облачных сетях. Созданная подсеть размещается в одной из зон доступности. К подсети можно подключить ресурсы из той же зоны, где находится подсеть.

{% list tabs %}

- Консоль управления

  Чтобы создать подсеть:
  1. В [консоли управления]({{ link-console-main }}) перейдите в каталог, где требуется создать подсеть.
  1. В списке сервисов выберите **{{ vpc-name }}**.
  1. Нажмите на имя облачной сети.
  1. Нажмите кнопку **Добавить подсеть**.
  1. Укажите название подсети.

     {% include [name-format](../../_includes/name-format.md) %}
	 
  1. (опционально) Укажите описание.
  1. Выберите зону доступности из выпадающего списка.
  1. Введите CIDR подсети: IP-адрес и маску подсети. Подробнее про диапазоны IP-адресов в подсетях читайте в разделе [Облачные сети и подсети](../concepts/network.md). 
     Если нужно указать еще один или несколько CIDR, нажмите кнопку **Добавить CIDR**.
  1. (опционально) Выберите опцию **NAT для доступа в интернет**, чтобы подсеть получила доступ в интернет без резервирования внешнего IP-адреса. 
  1. (опционально) Задайте **Настройки DHCP**. Для этого:
      1. Укажите домен DNS для поиска неквалифицированных имен.
      1. В поле **DNS-серверы** нажмите кнопку **Добавить DNS-сервер** и укажите адрес вашего DNS-сервера. Можно указать несколько DNS-серверов.
      1. В поле **NTP-серверы** нажмите кнопку **Добавить NTP-сервер** и укажите адрес вашего NTP-сервера. Можно указать несколько NTP-серверов.
 

  1. Нажмите кнопку **Создать подсеть**.

- CLI

  {% include [include](../../_includes/cli-install.md) %}

  {% include [default-catalogue](../../_includes/default-catalogue.md) %}

  Чтобы создать подсеть:

  1. Посмотрите описание команды CLI для создания подсети:

      ```
      yc vpc subnet create --help
      ```

  1. Получите список облачных сетей в требуемом каталоге:

      ```
      yc vpc network list --folder-id b1g6ci08ma55klukmdjs
      ```

      Результат:

      ```
      +----------------------+----------------+
      |          ID          |      NAME      |
      +----------------------+----------------+
      | enpavfmgapumnl7cqin8 | test-network-1 |
      | enplom7a98s1t0lhass8 | default        |
      +----------------------+----------------+
      ```

  1. Выберите `NAME` или `ID` требуемой облачной сети. Создайте подсеть в каталоге по умолчанию:

      ```
      yc vpc subnet create \
        --name test-subnet-1 \
        --description "My test subnet" \
        --network-id enplom7a98s1t0lhass8 \
        --zone {{ region-id }}-a \
        --range 192.168.0.0/24
      ```

      Где:

      * `--network-id` – идентификатор облачной сети. Также можно выбрать облачную сеть, указав ее имя с помощью флага `--network-name`. При создании подсети указывается имя облачной сети, в которой создается подсеть, и CIDR.
      * `--zone` – зона доступности, в которой создается подсеть. Если флаг не указан, подсеть будет создана в зоне доступности по умолчанию.
      
      {% include [name-format](../../_includes/name-format.md) %}

      ```
      yc vpc subnet create \
        --name test-subnet-1 \
        --description "My test subnet" \
        --network-name test-network-1 \
        --zone {{ region-id }}-a \
        --range 192.168.0.0/24
      ```

      Флаги `--name` и `--description` необязательные — можно создать подсеть без имени и описания и обращаться к ней по идентификатору.

  1. Получите список всех подсетей в каталоге по умолчанию:

      ```
      yc vpc subnet list
      ```

      Результат:

      ```
      +----------------------+-----------------------+------------------------+
      |          ID          |         NAME          | ... |       RANGE      |
      +----------------------+-----------------------+------------------------+
      ...
      | e2l0psbfoloefpjb1rau | test-subnet-1         | ... | [192.168.0.0/24] |
      ...
      +----------------------+-----------------------+-----+------------------+
      ```

      Получите тот же список c большим количеством деталей в формате YAML:

      ```
      yc vpc subnet list --format yaml
      ```

      Результат:
      
      ```
      ...

      - id: e2l0psbfoloefpjb1rau
        folder_id: b1g6ci08ma55klukmdjs
        created_at: "2018-10-24T12:25:58Z"
        name: test-subnet-1
        description: My test subnet
        network_id: enplom7a98s1t0lhass8
        zone_id: {{ region-id }}-a
        v4_cidr_blocks:
        - 192.168.0.0/24

      ...
      ```

- {{ TF }}

  {% include [terraform-definition](../../_tutorials/terraform-definition.md) %}

  Если у вас ещё нет {{ TF }}, [установите его и настройте провайдер {{ yandex-cloud }}](../../tutorials/infrastructure-management/terraform-quickstart.md#install-terraform).

  1. Опишите в конфигурационном файле параметры подсети:

     * `name` — имя подсети. Формат имени:

        {% include [name-format](../../_includes/name-format.md) %}

     * `description` — описание подсети.
     * `v4_cidr_blocks` — список IPv4-адресов, откуда или куда будет поступать трафик. Например, `10.0.0.0/22` или `192.168.0.0/16`. Адреса должны быть уникальными внутри сети. Минимальный размер подсети - /28, а максимальный размер подсети - /16. Поддерживается только IPv4.
     * `zone` — [зона доступности](../../overview/concepts/geo-scope.md).
     * `network_id` — идентификатор сети, в которой создается подсеть.

     Пример структуры конфигурационного файла:

     ```hcl
     resource "yandex_vpc_subnet" "lab-subnet-a" {
       name           = "<имя подсети>"
	   description    = "<описание подсети>"
       v4_cidr_blocks = ["<IPv4-адрес>"]
       zone           = "<зона доступности>"
       network_id     = "<идентификатор сети>"
     }
     ```

     Чтобы добавить, изменить или удалить подсеть, используйте ресурс `yandex_vpc_subnet` с указанием на сеть в поле `network_id` (см. [пример](#examples)).

     Более подробную информацию о параметрах ресурса `yandex_vpc_subnet` в {{ TF }} см. в [документации провайдера]({{ tf-provider-link }}/vpc_subnet).

  1. Проверьте корректность конфигурационных файлов.

     1. В командной строке перейдите в папку, где вы создали конфигурационный файл.
     1. Выполните проверку с помощью команды:

        ```
        terraform plan
        ```

     Если конфигурация описана верно, в терминале отобразится список создаваемых ресурсов и их параметров. Если в конфигурации есть ошибки, {{ TF }} на них укажет. 

  1. Разверните облачные ресурсы.

     1. Если в конфигурации нет ошибок, выполните команду:

        ```
        terraform apply
        ```

     1. Подтвердите создание ресурсов: введите в терминал слово `yes` и нажмите **Enter**.

        После этого в указанном каталоге будут созданы все требуемые ресурсы. Проверить появление ресурсов и их настройки можно в [консоли управления]({{ link-console-main }}) или с помощью команд [CLI](../../cli/quickstart.md):

        ```
        yc vpc subnet list
        ```

{% endlist %}

## Примеры {#examples}

{% list tabs %}

- CLI

  Создайте подсеть с именем и описанием в выбранном каталоге:

    ```
    yc vpc subnet create \
      --name test-subnet-1 \
      --description "My test subnet" \
      --folder-id b1g6ci08ma55klukmdjs \
      --network-id enplom7a98s1t0lhass8 \
      --zone {{ region-id }}-a \
      --range 192.168.0.0/24
    ```

    Создайте подсеть с настройками DHCP:
    ```
    yc vpc subnet create \
      --name test-subnet-1 \
      --description "My test subnet" \
      --folder-id b1g6ci08ma55klukmdjs \
      --network-id enplom7a98s1t0lhass8 \
      --zone {{ region-id }}-a \
      --range 192.168.0.0/24 \
      --domain-name test.domain \
      --domain-name-server 192.168.0.100 \
      --ntp-server 192.168.0.101
    ```

- {{ TF }}

  1. Опишите в конфигурационном файле параметры ресурса `yandex_vpc_subnet`:

     ```hcl
     resource "yandex_vpc_network" "lab-net" {
       name        = "network-1"
       description = "My first network"
     }

     resource "yandex_vpc_subnet" "lab-subnet-a" {
       name           = "subnet-1"
       description    = "My first subnet"
       v4_cidr_blocks = ["10.2.0.0/16"]
       zone           = "{{ region-id }}-a"
       network_id     = "${yandex_vpc_network.lab-net.id}"
     }
     ```

     Более подробную информацию о параметрах ресурсов в {{ TF }} см. в [документации провайдера]({{ tf-provider-link }}/vpc_subnet).

  1. Проверьте корректность конфигурационных файлов.

     1. В командной строке перейдите в папку, где вы создали конфигурационный файл.
     1. Выполните проверку с помощью команды:

        ```
        terraform plan
        ```

     Если конфигурация описана верно, в терминале отобразится список создаваемых ресурсов и их параметров. Если в конфигурации есть ошибки, {{ TF }} на них укажет. 

  1. Разверните облачные ресурсы.

     1. Если в конфигурации нет ошибок, выполните команду:

        ```
        terraform apply
        ```

     1. Подтвердите создание ресурсов: введите в терминал слово `yes` и нажмите **Enter**.

        После этого в указанном каталоге будут созданы все требуемые ресурсы. Проверить появление ресурсов и их настройки можно в [консоли управления]({{ link-console-main }}) или с помощью команд [CLI](../../cli/quickstart.md):

        ```
        yc vpc subnet list
        ```

{% endlist %}
