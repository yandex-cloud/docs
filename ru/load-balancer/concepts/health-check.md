# Проверка состояния ресурсов

*Проверка состояния* используется балансировщиком для получения сведений о состоянии ресурсов подключенной целевой группы. В ответ на запрос состояния ресурсы сообщают, что они готовы принимать трафик или вышли из строя. Проверка проводится по протоколу TCP или HTTP через указанные в конфигурации промежутки времени. 

Для каждой проверки указываются:

* Интервал выполнения проверок, от 1 до 300 секунд.
* Таймаут проверки, от 1 до 60 секунд. Таймаут — это время, которое отводится ресурсу на то, чтобы ответить на проверку. Если ресурс не ответил вовремя, проверка считается не пройденной и ресурсу присваивается статус `UNHEALTHY`.
* Показатели состояния ресурса: пороги количества удачных или неудачных результатов проверок, при превышении которых проверка будет считаться пройденной или непройденной.

Для HTTP-проверок указывается URL, на который будет отправлен запрос проверки. 

## Состояния целевых ресурсов {#target-statuses}

Целевой ресурс может находиться в одном из следующих состояний:

* `INITIAL` — для ресурса настраивается проверка состояния.
* `HEALTHY` — ресурс работает и готов принимать трафик.
* `UNHEALTHY` — ресурс не готов принимать трафик.
* `DRAINING` — ресурс удаляется и с него снимается трафик. Балансировщик перестает передавать трафик этому ресурсу.
* `INACTIVE` — ресурс подключен к остановленному балансировщику или к балансировщику без обработчиков.

Между назначением ресурсу состояния `UNHEALTHY` и остановкой передачи трафика на ресурс есть задержка, которая требуется балансировщику для обработки результата проверки.

Проверки состояния передаются целевым ресурсам с IP-адресов из диапазонов `198.18.235.0/24` и `198.18.248.0/24`. Настройки правил фильтрации трафика у целевых ресурсов должны разрешать прием трафика с адресов этого диапазона, иначе проверки не будут выполняться — целевые ресурсы не получат статус `HEALTHY` и не смогут принимать трафик.

При выполнении HTTP-проверки, ресурс получает статус `HEALTHY` только при ответе с кодом `200`.