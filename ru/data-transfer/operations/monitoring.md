# Мониторинг состояния трансфера

Данные о состоянии трансфера доступны в консоли управления. Их можно посмотреть на вкладке **Мониторинг** страницы управления трансфером или в сервисе [{{ monitoring-full-name }}](../../monitoring/concepts/index.md).

Диагностическая информация о состоянии трансфера представлена в виде графиков.

Вы можете [настроить алерты](#monitoring-integration) в сервисе {{ monitoring-full-name }} для получения уведомлений о сбоях в работе трансфера. В {{ monitoring-full-name }} используются два порога срабатывания алерта: `Warning` и `Alarm`. При превышении заданного порога вы получите оповещения через настроенные [каналы уведомлений](../../monitoring/concepts/alerting.md#notification-channel).

## Мониторинг состояния трансфера {#monitoring}

Для просмотра информации о состоянии трансфера:

1. Перейдите на страницу каталога и выберите сервис **{{ data-transfer-name }}**.
1. Выберите вкладку **Трансферы**.
1. Нажмите на имя нужного трансфера и выберите вкладку **Мониторинг**.
1. Чтобы перейти к работе с метриками, дашбордами или алертами в сервисе {{ monitoring-full-name }}, нажмите кнопку **Открыть в мониторинге** на панели сверху.

На странице появятся графики:

* **Data upload lag (histogram by seconds)** — отставание данных (в секундах).
* **Successfully pushed rows** — количество строк, записанных в приемник.
* **Maximum lag on delivery** — максимальное отставание данных (в секундах).
* **Successfully pushed rows by tables (top-50 tables)** — ТОП-50 таблиц с максимальным количеством записанных в приемник строк.
* **Read buffer size** — объем буфера или журнала опережающей записи (там, где он поддерживается) в источнике (в байтах).
* **Read bytes from source (top-50 workers)** — объем считанных из источника данных (в байтах).
* **Sink response time (histogram by seconds)** — время ответа приемника (в секундах).
* **Read rows (parsed/unparsed)** — количество считанных из источника строк.
* **Snapshot task progress (top-50 tables)** — количество строк, ожидающих переноса.
* **Snapshot task status** — выполняющаяся операция (`0` — репликация, `1` — копирование).

## Интеграция с {{ monitoring-full-name }} {#monitoring-integration}

Чтобы настроить алерты показателей состояния трансфера:

1. В консоли управления выберите каталог с трансфером, для которого нужно настроить алерты.
1. В списке сервисов выберите раздел **Monitoring**.
1. В блоке **Сервисные дашборды** выберите **{{ data-transfer-name }}**.
1. На нужном графике с показателями нажмите на значок ![options](../../_assets/horizontal-ellipsis.svg) и выберите пункт **Создать алерт**.
1. Если на графике больше одного показателя, создайте запрос данных для формирования метрики.{% if audience == "external" %} Подробнее о языке запросов [см. в документации {{ monitoring-full-name }}](../../monitoring/concepts/querying.md).{% endif %}
1. Задайте значения порогов `Alarm` и `Warning` для оповещения.
1. Нажмите **Создать алерт**.

Рекомендуемые значения порогов для некоторых метрик:

| Метрика                               | Обозначение                          | `Alarm` | `Warning`                                                                             |
|---------------------------------------|:------------------------------------:|:-------:|:-------------------------------------------------------------------------------------:|
| Максимальная задержка передачи данных | `sinker.pusher.time.row_max_lag_sec` | `15`    | —                                                                                     |
| Объем буфера в источнике              | `publisher.consumer.log_usage_bytes` | —       | Не ниже максимального объема данных, поступающих в источник в рамках одной транзакции |
|                                       |                                      |         |                                                                                       |
