# Настройка эндпоинта-источника Logbroker

При [создании](../index.md#create) или [изменении](../index.md#update) эндпоинта задайте настройки подключения к Logbroker.

## Настройки {#settings}

{% list tabs %}

- Консоль управления
    
    * **Тип подключения** — выберите **Кластер** или **Инстанс**, затем выберите из списка имя кластера или инстанса источника YT, например, "HAHN", "ARNOLD" или "FREUD".
  
    * **Консьюмер** — имя Logbroker-консьмера.

    * **Топик** — имя топика.

    * **Правила парсинга** — тип обработки данных. Для типов `Универсальный парсер`, `YQL-парсинг` и `Logbroker-парсинг` можно задать параметры парсинга. 
  
      * **Универсальный парсер:**

        * **Формат данных** — формат `JSON` или `TSKV`.
        
        * **Схема данных** — может задаваться списком полей, с помощью JSON-файла или одной из доступных схем Logfeller. 

          {% include notitle[Пример схемы](../../../../_includes/data-transfer/fields/common/ui/json-schema-sample.md) %}
      
        * **Пользовательские ключевые столбцы** — опция позволяет исключить ключи дедупликации Logbroker из перечня пользовательских ключевых столбцов.
        
        * **Столбец, содержащий дату-время** — определяет имя столбца и правило парсинга даты в [формате Golang](https://pkg.go.dev/time#Parse).
        
        * **Значения NULL в ключевых столбцах** — разрешает использовать значения NULL в ключевых столбцах.
        
        * **Добавление системных столбцов Logbroker** — определяет добавлять ли столбцы `СreateTime` (`_lb_ctime`), `WriteTime` (`_lb_wtime`) и все столбцы `ExtraFields` с префиксом `_lb_extra_`.

      * **YQL-парсинг:**    

        * **YQL-скрипт** — скрипт для парсинга.

        * **Схема данных** — может задаваться списком полей, с помощью JSON-файла или одной из доступных схем Logfeller. 

            {% include notitle[Пример схемы](../../../../_includes/data-transfer/fields/common/ui/json-schema-sample.md) %}

        * **Ключевые столбцы результата** — один или несколько ключевых столбцов для записи результата.

        * **Синтетические ключи** — добавляет в ключ столбцы `_partition`, `_offset` и `_idx`.

      * **Парсинг Logfeller**
      
        * **Имя парсера** — имя парсера Logfeller.

        * **Схема данных** — может задаваться списком полей, с помощью JSON-файла или одной из доступных схем Logfeller.

          {% include notitle[Пример схемы](../../../../_includes/data-transfer/fields/common/ui/json-schema-sample.md) %}

        * **Добавление системных столбцов Logbroker** — определяет добавлять ли столбцы `СreateTime` (`_lb_ctime`), `WriteTime` (`_lb_wtime`) и все столбцы `ExtraFields` с префиксом `_lb_extra_`.

    * **Настройки чтения**

      * **Максимальная задержка данных** — значение в секундах до начала потребления данных. Значение по умолчанию: `0 с` - потреблять все данные.

      * **Размер буфера чтения** — максимальное количество прочитанных данных перед добавлением. Значение по умолчанию: 52 МБ.
      
      * **Продолжать работу при превышении по TTL** — если опция включена, трансфер продолжится с потерей данных. В противном случае трансфер будет остановлен с ошибкой.      
      
      * **Маскировать секреты** — если опция используется, секреты вида `AQAD-...` будут заменены символами `XXXXX`.

    * **Делить на подтаблицы** — один или несколько столбцов, по значению которых входной поток будет разбиваться на подтаблицы. Порядок указания столбцов важен.

{% endlist %}
