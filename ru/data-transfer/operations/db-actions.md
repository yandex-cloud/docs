# Работа с базами данных во время трансфера

В процессе работы трансфера [с репликацией данных](../concepts/index.md#transfer-type) (типы трансфера «{{ dt-repl }}» и «{{ dt-copy-repl }}») согласованность данных не гарантируется. Это означает, что данные на источнике и на приемнике могут различаться, пока работает трансфер. [После деактивации трансфера](transfer.md#deactivate-transfer) данные на приемнике будут находиться в согласованном состоянии (так называемая отложенная согласованность, eventual consistency). Учитывайте это, если ваши приложения читают из базы на приемнике во время трансфера.

## MySQL {#mysql}

Если трансфер находится в [статусе](../concepts/transfer-lifecycle.md) **Копирование**, любые изменения схемы данных (`ALTER`) на источнике или приемнике прервут трансфер.

В остальных случаях при трансфере можно изменять схему данных на источнике. Все операции `ALTER`, попавшие в бинарный лог (binlog) на источнике, автоматически применяется на приемнике. Изменения схемы данных в базе источника могут замедлить трансфер из-за того, что они могут долго применяться в базе приемника.

## PostgreSQL {#postgresql}

1. Для трансферов типа «{{ dt-copy }}» и «{{ dt-copy-repl }}» запрещено изменять базы данных, если трансфер находится в статусе **Копирование**.

1. Для трансферов типа «{{ dt-copy }}» и «{{ dt-copy-repl }}» в статусе **Репликация** не рекомендуется изменять схему данных на источнике. Если сделать это, то трансфер не сможет выполнить вставку данных на приемнике из-за особенностей реализации протокола репликации для {{ PG }}. В этом случае необходимо вручную выполнить аналогичный запрос на изменение схемы данных для приемника.

   Например, пусть в таблицу `test_table` источника добавили новый столбец:

    ```sql
    ALTER TABLE test_table ADD COLUMN val2 TEXT;
    ```

    Если запись в эту таблицу продолжается, трансфер не сможет выполнить вставку данных на приемнике. Чтобы репликация продолжилась, выполните аналогичный запрос на изменение схемы данных на приемнике:

    ```sql
    ALTER TABLE test_table ADD COLUMN val2 TEXT;
    ```

   После этого трансфер сможет продолжить работу.

{% note tip %}

Избегайте изменения схемы данных в базах источника и приемника во время трансфера. Если избежать этого невозможно, проведите явные проверки на приемнике.

{% endnote %}
