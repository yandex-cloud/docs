# Формат ответа при поиске по картинкам

В ответ на поисковый запрос по картинкам {{ search-api }} возвращает XML-файл в кодировке [UTF-8](https://ru.wikipedia.org/wiki/UTF-8), содержащий результаты поиска.

XML-файлы состоят из группирующих тегов [request](#request-el) (обобщенная информация о параметрах запроса) и [response](#response-el) (результаты обработки поискового запроса).

Ниже приведена общая структура результирующего XML-документа с примерами значений.

## Структура ответа {#response-format}

```xml
<?xml version="1.0" encoding="utf-8"?>
<yandexsearch version="1.0">
<request>
   <query>cats</query>
   <page>2</page>
   <sortby order="descending" priority="no">rlv</sortby>
   <maxpassages>1</maxpassages>
   <groupings>
      <groupby attr="ii" mode="deep" groups-on-page="1" docs-in-group="1" curcateg="-1"/>
   </groupings>
</request>
<response date="20240414T091102">
   <reqid>1713085862371215-3284531111984749627-balancer-l7leveler-kubr-yp-vla-25-BAL</reqid>
   <found priority="phrase">11132</found>
   <found priority="strict">11132</found>
   <found priority="all">11132</found>
   <found-human>Нашлось 11 тыс. ответов</found-human>
   <results>
      <grouping attr="ii" mode="deep" groups-on-page="1" docs-in-group="1" curcateg="-1">
         <page first="1" last="1">2</page>
         <group>
            <categ attr="ii" id="3166497932182189502"/>
            <doccount>1</doccount>
            <relevance priority="all"/>
            <doc id="Z37E83657D25C5DED">
               <relevance priority="all"/>
               <url>https://***.*****.**/big3/989/426616-Kycb.jpg</url>
               <domain>***.*****.**</domain>
               <modtime>20170920T100608</modtime>
               <size>0</size>
               <charset>utf-8</charset>
               <image-properties>
                  <id>63966cd66b86c8e11bf80c4c7dc5e431c5cd1b5d-8971534-images-thumbs</id>
                  <shard>0</shard>
                  <thumbnail-link>http://avatars.mds.yandex.net/i?id=63966cd66b86c8e11bf80c4c7dc5e431c5cd1b5d-8971534-images-thumbs</thumbnail-link>
                  <thumbnail-width>480</thumbnail-width>
                  <thumbnail-height>272</thumbnail-height>
                  <original-width>480</original-width>
                  <original-height>272</original-height>
                  <html-link>https://****.*********.ru/download/kot-kotyara-usy-lapy-hvost-2399/480x272/</html-link>
                  <image-link>https://****.*********.ru/original/480x272/8/d3/kot-kotyara-usy-lapy-hvost-2399.jpg</image-link>
                  <file-size>57435</file-size>
                  <mime-type>jpg</mime-type>
               </image-properties>
               <mime-type>text/html</mime-type>
               <properties/>
            </doc>
         </group>
         <found priority="phrase">8432</found>
         <found priority="strict">8432</found>
         <found priority="all">8432</found>
         <found-docs priority="phrase">8432</found-docs>
         <found-docs priority="strict">8432</found-docs>
         <found-docs priority="all">8432</found-docs>
         <found-docs-human>нашёл 8 тыс. ответов</found-docs-human>
      </grouping>
   </results>
</response>
</yandexsearch>
```


## Параметры ответа {#response-parameters}

Обобщенная информация о параметрах запроса. Может отсутствовать, если ответ содержит ошибки.

### request {#request-el}

#|
|| **Теги группы request** | **Описание** | **Атрибуты** ||
|| query | Текст переданного поискового запроса | Отсутствуют. ||
|| page | Номер возвращенной страницы результатов поиска. Нумерация начинается с нуля (первой странице соответствует значение `0`). | Отсутствуют. ||
|| sortby | 
Параметры сортировки результатов. Служебный тег, принимает значение `rlv` — сортировка по релевантности.
| 
* `order` — порядок сортировки. Служебный атрибут, принимает значение `descending` (прямой порядок сортировки).
* `priority` — служебный атрибут. Принимает значение `no`.
||
|| maxpassages | Максимальное количество текстовых сниппетов, формируемых для каждой картинки. Служебный тег, принимает значение `1`. | Отсутствуют.||
|| groupings | 
Группирующий тег.

Содержит параметры группировок в теге `groupby`. 
| Отсутствуют. ||
|| groupby | Параметры группировки найденных результатов поиска. | 
* `attr` — служебный атрибут, принимает значение `ii`;
* `mode` — метод группировки. Служебный атрибут, принимает значение `deep`;
* `groups-on-page` — максимальное количество групп с результатами поиска, которые могут быть возвращены на одной странице результатов. Если атрибут не задан, значение по умолчанию — `20`;
* `docs-in-group` — максимальное количество картинок, которые могут быть возвращены в одной группе. Служебный атрибут, принимает значение `1`;
* `curcateg` — служебный атрибут. Принимает значение `-1`.
||
|#

### response {#response-el}

Результаты обработки поискового запроса, информация о котором представлена в теге [request](#request-el).

Содержит атрибут `date` — дата и время запроса в формате `<год><месяц><день>Т<час><минута><секунда>` по UTC.

Состоит из следующих блоков:

* [Общая информация о результатах поиска](#basic-search-info).
* [Блок results](#results-block).

#### Общая информация о результатах поиска {#basic-search-info}

Теги блока с общей информацией о результатах поиска представлены в таблице ниже.

#|
|| **Теги общей информации о результатах поиска** | **Описание** | **Атрибуты** ||
|| error |
Описание ошибки. 

Присутствует только в случае некорректной обработки поискового запроса (например, при пустом запросе, некорректных параметрах и т.п.).

В некоторых случаях является взаимоисключающим с прочими тегами группирующего тега `response`.
| `code` — [код](../reference/error-codes.md) ошибки. ||
|| reqid | Уникальный идентификатор запроса. | Отсутствуют. ||
|| found | Приблизительная оценка количества картинок, найденных по запросу.
| 
`priority` — служебный атрибут. Возможные значения:

* `phrase`;
* `strict`;
* `all`.
||
|| found-human | Строка на языке, соответствующем выбранному [типу поиска](../operations/registration.md). Содержит сведения о количестве найденных картинок и сопутствующую информацию. | Отсутствуют. ||
|#


#### Блок results {#results-block}

Опциональный. Присутствует, если по запросу найдены результаты.

Теги блока представлены в таблице ниже.

#|
|| **Теги блока results** | **Описание** | **Атрибуты**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ||
|| results | Группирующий тег. Дочерние теги содержат сведения о параметрах поиска и найденных картинках. | Отсутствуют. ||
|| grouping | 

Группирующий тег. Дочерние теги содержат сведения о параметрах поиска и найденных картинках.

| 
Атрибуты отражают правила группировки найденных картинок.

* `attr` — служебный атрибут, принимает значение `ii`;
* `mode` — метод группировки. Служебный атрибут, принимает значение `deep`;
* `groups-on-page` — максимальное количество групп с результатами поиска, которые могут быть возвращены на одной странице результатов. Если параметр не задан, значение по умолчанию — `20`;
* `docs-in-group` — максимальное количество картинок, которые могут быть возвращены в одной группе. Служебный атрибут, принимает значение `1`;
* `curcateg` — служебный атрибут. Принимает значение `-1`.
||
|| page | Номер возвращенной страницы результатов поиска. Нумерация начинается с нуля (первой странице соответствует значение `0`).
| 
* `first` — порядковый номер первой группы с результатами поиска, отображаемой на странице;
* `last` — порядковый номер последней группы с результатами поиска, отображаемой на странице.
||
|| group | 
Группирующий тег.

Каждый тег `group` содержит информацию об одной найденной группе картинок. Так как каждая группа картинок содержит одну картинку, то в теге приведена информация об одной картинке.
| Отсутствуют.
||
|| categ | Описание найденной картинки. | 
* `attr` — название группировки. Совпадает со значением атрибута `attr` тега `groupby` элемента `request`;
* `id` — идентификатор хоста, на котором хранится картинка.
||
|| doccount | Служебный тег. | Отсутствуют. ||
|| relevance | Служебный тег. | `priority` — служебный атрибут. ||
|| doc | 
Группирующий тег.

Каждый тег `doc` содержит информацию об одной найденной картинке.

| `id` — уникальный идентификатор найденной картинки.
||
|| relevance | Служебный тег. | `priority` — служебный атрибут. ||
|| url | Адрес, по которому доступна картинка. | Отсутствуют. ||
|| domain | Домен, на котором расположен документ, содержащий картинку. | Отсутствуют. ||
|| modtime | Дата и время изменения картинки в формате `<год><месяц><день>Т<час><минута><секунда>` по UTC. | Отсутствуют. ||
|| size | Размер картинки в байтах. | Отсутствуют. ||
|| charset | Кодировка документа, содержащего картинку. | Отсутствуют. ||
|| image-properties | 
Группирующий тег.

Содержит информацию о свойствах картинки, которую следует отдавать в поисковую выдачу.

| Отсутствуют.
||
|| id | Идентификатор уменьшенной копии картинки (thumbnail). | Отсутствуют. ||
|| shard | Номер шарда, содержащего информацию о картинке. | Отсутствуют. ||
|| thumbnail-link | Адрес, по которому доступна уменьшенная копия картинки. | Отсутствуют. ||
|| thumbnail-width | Ширина уменьшенной копии картинки в пикселях. | Отсутствуют. ||
|| thumbnail-height | Высота уменьшенной копии картинки в пикселях. | Отсутствуют. ||
|| original-width | Ширина исходной картинки (оригинала). | Отсутствуют. ||
|| original-height | Высота исходной картинки (оригинала). | Отсутствуют. ||
|| html-link | Адрес страницы, на которой опубликована картинка. | Отсутствуют. ||
|| image-link | Адрес, по которому доступна картинка. | Отсутствуют. ||
|| file-size | Размер картинки в байтах. | Отсутствуют. ||
|| mime-type | Формат картинки (JPG, GIF или PNG). | Отсутствуют. ||
|| mime-type | Формат документа, содержащего картинку. | Отсутствуют. ||
|| found | Приблизительная оценка количества сформированных групп. | 
`priority` — служебный атрибут. Возможные значения:

* `phrase`;
* `strict`;
* `all`.
||
|| found-docs | 

Приблизительная оценка количества картинок, найденных по запросу.

Является более точной оценкой по сравнению со значением, передаваемым в теге `found` блока с [общей информацией о результатах поиска](#basic-search-info).

| 
`priority` — служебный атрибут. Возможные значения:

* `phrase`;
* `strict`;
* `all`.
||
|| found-docs-human | 
Строка на языке, соответствующем выбранному [типу поиска](../operations/registration.md). Содержит сведения о количестве найденных картинок и сопутствующую информацию.

Передаваемое значение должно использоваться при оформлении результатов поиска.

| Отсутствуют.
||
|#

#### См. также {#see-also}

* [{#T}](./pic-search.md)
* [{#T}](../operations/searching.md)