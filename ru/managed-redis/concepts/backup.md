---
title: Резервные копии {{ VLK }}
description: '{{ mrd-short-name }} обеспечивает автоматическое и ручное резервное копирование баз данных {{ VLK }}. Резервная копия всех данных кластера (снимок в формате RDB) автоматически создается раз в день. Время начала резервного копирования задается при создании или изменении кластера {{ VLK }}.'
keywords:
  - бэкап
  - бекап
  - backup
  - резервное копирование
  - резервное копирование Valkey
  - backup Valkey
  - Valkey
---

# Резервные копии в {{ mrd-name }}

{{ mrd-short-name }} обеспечивает автоматическое и ручное резервное копирование баз данных.

{{ mrd-short-name }} использует AOF (append-only file) с форсированной записью на диск каждую секунду — выставлен параметр [appendfsync everysec](https://github.com/valkey-io/valkey/blob/unstable/valkey.conf).

Резервная копия всех данных кластера (снимок в формате RDB) автоматически создается раз в день и хранится 7 дней. Отключить автоматическое создание резервных копий и изменить их срок хранения нельзя.

Чтобы восстановить кластер из резервной копии, [следуйте инструкциям](../operations/cluster-backups.md).

## Создание резервной копии {#size}

Резервные копии могут быть созданы автоматически и вручную, в обоих случаях используется следующая схема:

* Первая и каждая седьмая резервные копии — полные резервные копии всех баз данных.
* Остальные резервные копии — инкрементные, хранится только разница с предыдущей резервной копией, что позволяет экономить место в хранилище.

После создания резервная копия сжимается для дальнейшего хранения. Отображение точного размера резервной копии недоступно.

Время начала резервного копирования задается при [создании](../operations/cluster-create.md) или [изменении](../operations/update.md#change-additional-settings) кластера. По умолчанию время начала — 22:00 UTC (Coordinated Universal Time). Резервное копирование начнется в течение получаса от указанного времени.

{% note alert %}

При интенсивной записи данных во время резервного копирования кластер может стать недоступен из-за исчерпания памяти хостов. Подробнее см. в разделе [Управление памятью](memory-management.md). 

Чтобы избежать сбоев:
* [выберите](../operations/update.md#change-additional-settings) такое время начала резервного копирования, когда кластер наименее нагружен;
* увеличьте объем оперативной памяти, [повысив класс хостов](../operations/update.md#change-resource-preset).

{% endnote %}

Резервные копии создаются только на работающих кластерах. Если вы используете кластер {{ mrd-short-name }} не круглосуточно, проверьте [настройки времени начала резервного копирования](../operations/update.md#change-additional-settings).

О том, как вручную создать резервную копию, читайте в разделе [Управление резервными копиями](../operations/cluster-backups.md).

## Хранение резервной копии {#storage}

Особенности хранения резервных копий в {{ mrd-name }}:

* Резервные копии хранятся во внутреннем хранилище {{ yandex-cloud }} в виде логических дампов и шифруются с помощью [GPG](https://ru.wikipedia.org/wiki/GnuPG). У каждого кластера свои ключи шифрования.

* Все резервные копии (автоматические и созданные вручную) хранятся 7 дней.

* {% include [no-quotes-no-limits](../../_includes/mdb/backups/no-quotes-no-limits.md) %}

* {% include [using-storage](../../_includes/mdb/backups/storage.md) %}

    Подробнее см. в разделе [Правила тарификации для {{ mrd-name }}](../pricing.md#rules-storage).

## Проверка восстановления из резервной копии {#capabilities}

Для проверки возможностей резервного копирования [восстановите кластер из резервной копии](../operations/cluster-backups.md) и проверьте целостность ваших данных.