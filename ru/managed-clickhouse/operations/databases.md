# Управление базами данных

{{ mch-name }} позволяет управлять базами данных кластера двумя способами:

- С помощью стандартных интерфейсов {{ yandex-cloud }} (CLI, API, консоль управления). Способ подходит, если вы хотите воспользоваться всеми возможностями managed-сервиса {{ yandex-cloud }}.
- С помощью SQL-запросов к кластеру. Способ подходит, если вы хотите использовать уже существующее у вас решение для создания и управления базами данных или если вам требуется поддержка {{ MY }} баз данных в {{ mch-name }}.

## Управление базами данных через SQL {#sql-database-management}

Чтобы управлять базами данных через SQL, [создайте кластер](cluster-create.md) с включенными настройками:

- **Управление пользователями через SQL**.
- **Управление базами данных через SQL**.

В кластере с включенным управлением базами данных через SQL:

- Базами данных и [пользователями](cluster-users.md#sql-user-management) можно управлять только через SQL.
- Невозможно включить управление пользователями и базами данных с помощью стандартных интерфейсов {{ yandex-cloud }} (CLI, API, консоль управления).
- Управление осуществляется с помощью учетной записи `admin`. Пароль для нее задается при создании кластера.

{% include [sql-db-and-users-alert](../../_includes/mdb/mch-sql-db-and-users-alert.md) %}

## Получить список баз данных в кластере {#list-db}

{% list tabs %}

- Консоль управления

  1. Перейдите на страницу каталога и выберите сервис **{{ mch-name }}**.
  1. Нажмите на имя нужного кластера, затем выберите вкладку **Базы данных**.


- CLI

  {% include [cli-install](../../_includes/cli-install.md) %}

  {% include [default-catalogue](../../_includes/default-catalogue.md) %}

  Чтобы получить список баз данных в кластере, выполните команду:

  ```
  $ {{ yc-mdb-ch }} database list
       --cluster-name=<имя кластера>
  ```

  Имя кластера можно запросить со [списком кластеров в каталоге](#list-clusters).


- API

  Получить список баз данных кластера можно с помощью метода [list](../api-ref/Database/list.md).

- SQL

  1. [Подключитесь](connect.md) к кластеру, используя [учетную запись `admin`](#sql-database-management).
  1. Получите список баз данных:

      ```sql
      SHOW DATABASES;
      ```

{% endlist %}

## Создать базу данных {#add-db}

Количество баз данных в кластере неограниченно.

{% list tabs %}

- Консоль управления

  1. Перейдите на страницу каталога и выберите сервис **{{ mch-name }}**.
  1. Нажмите на имя нужного кластера.
  1. Выберите вкладку **Базы данных**.
  1. Нажмите кнопку **Добавить**.
  1. Введите имя для базы данных и нажмите кнопку **Добавить**.
     
  {% note info %}
  
    Имя базы может состоять из букв латинского алфавита, цифр, символов тире и подчеркивания. Максимальная длина имени 63 символа. Запрещено создание базы данных с именем `default`.
  
  {% endnote %}
 
- CLI

  {% include [cli-install](../../_includes/cli-install.md) %}

  {% include [default-catalogue](../../_includes/default-catalogue.md) %}

  Выполните команду создания БД, задав имя новой базы:

  ```
  $ {{ yc-mdb-ch }} database create <имя базы данных>
      --cluster-name <имя кластера>
  ```

  {{ mch-short-name }} запустит операцию создания базы данных.
  
  {% note info %}
  
    Имя базы может состоять из букв латинского алфавита, цифр, символов тире и подчеркивания. Максимальная длина имени 63 символа. Запрещено создание базы данных с именем `default`.
  
  {% endnote %}

  Имя кластера можно запросить со [списком кластеров в каталоге](#list-clusters).

- API

  Создать новую базу данных в кластере можно с помощью метода [create](../api-ref/Database/create.md).

- SQL

  1. [Подключитесь](connect.md) к кластеру, используя [учетную запись `admin`](#sql-database-management).
  1. Создайте базу данных:

      ```sql
      CREATE DATABASE <имя базы данных>;
      ```

  Подробнее о создании баз данных см. [в документации {{ CH }}](https://clickhouse.tech/docs/ru/sql-reference/statements/create/database/).

{% endlist %}

## Удалить базу данных {#remove-db}

{% list tabs %}

- Консоль управления

  1. Перейдите на страницу каталога и выберите сервис **{{ mch-name }}**.
  1. Нажмите на имя нужного кластера и выберите вкладку **Базы данных**.
  1. Нажмите значок ![image](../../_assets/vertical-ellipsis.svg) в строке нужной БД и выберите пункт **Удалить**.


- CLI

  {% include [cli-install](../../_includes/cli-install.md) %}

  {% include [default-catalogue](../../_includes/default-catalogue.md) %}

  Чтобы удалить базу данных, выполните команду:

  ```
  $ {{ yc-mdb-ch }} database delete <имя базы данных>
       --cluster-name=<имя кластера>
  ```

  Имя кластера можно запросить со [списком кластеров в каталоге](#list-clusters).


- API

  Удалить базу данных можно с помощью метода [delete](../api-ref/Database/delete.md).

- SQL

  1. [Подключитесь](connect.md) к кластеру, используя [учетную запись `admin`](#sql-database-management).
  1. Удалите базу данных:

      ```sql
      DROP DATABASE <имя базы данных>;
      ```

  Подробнее об удалении объектов см. [в документации {{ CH }}](https://clickhouse.tech/docs/ru/sql-reference/statements/drop/).

{% endlist %}

{% note warning %}

Прежде чем создать новую базу с тем же именем, дождитесь завершения операции удаления, иначе будет восстановлена удаляемая база. Статус операции можно получить вместе со [списком операций в кластере](cluster-list.md#list-operations).

{% endnote %}
