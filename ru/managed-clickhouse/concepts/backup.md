# Резервные копии

{{ mch-short-name }} обеспечивает автоматическое и ручное резервное копирование баз данных. Резервные копии занимают место в объеме хранилища, выделенном для кластера. {% if audience != "internal" %} Если суммарный объем данных и резервных копий превышает объем хранилища, превышение [тарифицируется](../pricing.md). {% endif %}

Резервные копии автоматически создаются раз в день и хранятся в течение {{ mch-backup-retention }} дней. Отключить автоматическое создание резервных копий или изменить срок хранения невозможно.

Время начала резервного копирования задается при создании или изменении кластера. Резервное копирование начнется в течение получаса от указанного времени. По умолчанию начало резервного копирования устанавливается на 22:00 UTC (Coordinated Universal Time). 

Чтобы восстановить кластер из резервной копии, [следуйте инструкциям](../operations/cluster-backups.md).

## Создание резервной копии {#size}

Резервные копии могут быть автоматическими и ручными. Вне зависимости от типа, резервные копии создаются по инкрементальной схеме:
- При создании очередной резервной копии [куски данных](https://clickhouse.tech/docs/ru/engines/table-engines/mergetree-family/mergetree/#mergetree-data-storage) проверяются на уникальность.
- Если идентичные [куски данных](https://clickhouse.tech/docs/ru/engines/table-engines/mergetree-family/mergetree/#mergetree-data-storage) уже есть хотя бы в одной из существующих резервных копий и они не старше {{ mch-dedup-retention }} дней, то они не дублируются.

В резервной копии хранятся данные только для движков семейства `MergeTree`. Для остальных движков в бэкапе хранятся только схемы таблиц. Подробнее про движки см. в [документации {{ CH }}](https://clickhouse.tech/docs/ru/engines/table-engines/).

## Хранение резервной копии {#storage}

Резервные копии хранятся во внутреннем хранилище Яндекса в виде бинарных файлов и шифруются с помощью [GPG](https://ru.wikipedia.org/wiki/GnuPG). У каждого кластера свои ключи шифрования.

Все резервные копии (автоматические и ручные) хранятся {{ mch-backup-retention }} дней.

## Проверка резервной копии {#verify}

### Проверка целостности резервной копии {#integrity}

Целостность резервных копий проверяется на синтетических данных интеграционными тестами сервиса. Резервные копии пользовательских кластеров на текущий момент не проверяются. 

### Проверка восстановления из резервной копии {#capabilities}

Для проверки возможностей резервного копирования [восстановите кластер из резервной копии](../operations/cluster-backups.md) и проверьте целостность ваших данных.
