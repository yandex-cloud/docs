# Отобрать записи по параметрам

Запрос позволяет выбрать данные о времени, затраченном конкретным пользователем или в определенный промежуток времени. Вы можете использовать запрос с методом `GET` или с методом `POST`.

## Формат GET запроса {#section_nvm_kth_jfb}

Чтобы получить записи о затраченном времени, используйте HTTP-запрос с методом `GET`:

```json
GET /{{ ver }}/worklog?createdBy=<идентификатор или имя пользователя>&createdAt=from:<начало временного диапазона>&createdAt=to:<окончание временного диапазона>
Host: {{ host }}
Authorization: OAuth <токен>
{{ org-id }}
```

{% include [headings](../../../_includes/tracker/api/headings.md) %}

#### Параметры запроса {#req-get-params}

Параметр | Описание | Тип данных
-------- | -------- | ----------
createdBy | Идентификатор или логин автора записи. Необязательный параметр. | Строка.
createdAt=from | Начало временного диапазона, в который созданы записи. Формат: ```YYYY-MM-DDThh:mm:ss.sss±hhmm```</br>Необязательный параметр. | Строка.
createdAt=to | Окончание временного диапазона, в который созданы записи. Формат: ```YYYY-MM-DDThh:mm:ss.sss±hhmm```</br>Необязательный параметр. | Строка.

## Формат POST запроса {#section_shz_tqb_kfb}

Чтобы получить записи о затраченном времени, используйте HTTP-запрос с методом `POST`:

```json
POST /{{ ver }}/worklog/_search
Host: {{ host }}
Authorization: OAuth <токен>
{{ org-id }}

{
  "createdBy": "veikus",
  "createdAt": {
    "from": "2018-06-06T08:42:15.258",
    "to": "2018-06-06T08:42:20.258"
  }
}
```

#### Заголовки {#req-post-headers}

- **Host**

    Адрес узла, предоставляющего API:
    ```
    {{ host }}
    ```

- **Authorization**

    OAuth-токен в формате `OAuth <значение токена>`, например:
    ```
    OAuth 0c4181a7c2cf4521964a72ff57a34a07
    ```

- **X-Org-ID**

    Идентификатор организации.

#### Тело запроса {#req-post-body-params}

Параметр | Описание | Тип данных
-------- | -------- | ----------
createdBy | Идентификатор или логин автора записи. Необязательный параметр. | Строка.
[createdAt](#createdAt) | Объект с информацией о времени и дате создания записей. Необязательный параметр. | Объект.

**Поля объекта** `createdAt` {#createdAt}

Параметр | Описание | Тип данных
-------- | -------- | ----------
from | Начало временного диапазона, в который созданы записи. Формат: ```YYYY-MM-DDThh:mm:ss.sss±hhmm``` | Строка.
to | Окончание временного диапазона, в который созданы записи. Формат: ```YYYY-MM-DDThh:mm:ss.sss±hhmm``` | Строка.

## Формат ответа {#section_x4q_jcc_kfb}

{% list tabs %}

- Запрос выполнен успешно

    В случае успешного выполнения запроса API возвращает ответ с кодом 200. Тело ответа содержит JSON-массив с записями о затраченном времени, которые были отобраны по заданным параметрам (пользователь, дата и время).

    #### Тело ответа {#answer-body}

    ```json
    [
    {
      "self": "https://st-api.yandex-team.ru/v2/issues/TEST-324/worklog/1",
      "id": 1,
      "version": 1402121720882,
      "issue": {
        "self": "https://st-api.yandex-team.ru/v2/issues/TEST-324",
        "id": "515ec9eae4b09cfa984e2047",
        "key": "TEST-324",
        "display": "важная задача"
      },
      "comment": "важный комментарий",
      "createdBy": {
        "self": "https://st-api.yandex-team.ru/v2/users/1120000000014909",
        "id": "veikus",
        "display": "Artem Veikus"
      },
      "updatedBy": {
        "self": "https://st-api.yandex-team.ru/v2/users/1120000000014909",
        "id": "veikus",
        "display": "Artem Veikus"
      },
      "createdAt": "2018-06-06T08:42:06.258+0000",
      "updatedAt": "2018-06-06T08:42:06.258+0000",
      "start": "2018-06-06T08:41:58.000+0000",
      "duration": "P3W"
     }, 
      ... 
    ]
    ```

    #### Параметры ответа {#answer-params}

    Параметр | Описание | Тип данных
    -------- | -------- | ----------
    self | Адрес ресурса API, который содержит запись о затраченном времени. | Строка.
    id | Идентификатор записи о затраченном времени. | Строка.
    version | Версия записи. Каждое изменение записи увеличивает номер версии. | Строка.
    [issue](#issue) | Блок с информацией о задаче. | Объект.
    comment | Текст комментария к записи. Комментарий сохранится в Отчёте по затратам времени. | Строка.
    [createdBy](#createdBy) | Объект с информацией об авторе записи. | Объект.
    [updatedBy](#updatedBy) | Объект с информацией об авторе последнего изменения записи. | Объект.
    createdAt | Дата и время создания записи в формате: ```YYYY-MM-DDThh:mm:ss.sss±hhmm``` | Строка.
    updatedAt | Дата и время обновления записи в формате: ```YYYY-MM-DDThh:mm:ss.sss±hhmm``` | Строка.
    start | Дата и время начала работы над задачей в формате: ```YYYY-MM-DDThh:mm:ss.sss±hhmm``` | Строка.
    duration | Затраченное время в формате ```PnYnMnDTnHnMnS, PnW``` в соответствии с [ISO 8601]({{ link-iso-8601 }}). | Строка.

    ##### Поля объекта `issue` {#issue}

    Параметр | Описание | Тип данных
    -------- | -------- | ----------
    self | Адрес ресурса API, который содержит информацию о задаче. | Строка.
    id | Идентификатор задачи. | Строка.
    key | Ключ задачи. | Строка.
    display | Отображаемое название задачи. | Строка.

    **Поля объекта** `createdBy` {#createdBy}

    Параметр | Описание | Тип данных
    -------- | -------- | ----------
    self | Адрес ресурса API, который содержит информацию о пользователе. | Строка.
    id | Идентификатор пользователя. | Строка.
    display | Отображаемое имя пользователя. | Строка.

    **Поля объекта** `updatedBy` {#updatedBy}

    Параметр | Описание | Тип данных
    -------- | -------- | ----------
    self | Адрес ресурса API, который содержит информацию о пользователе. | Строка.
    id | Идентификатор пользователя. | Строка.
    display | Отображаемое имя пользователя. | Строка.

- Запрос выполнен с ошибкой

    Если запрос не был успешно обработан, ответное сообщение содержит информацию о возникших ошибках:

    HTTP-код ошибки | Описание ошибки
    --------------- | ---------------
    400 Bad Request | Один из параметров запроса имеет недопустимое значение или формат данных.
    403 Forbidden | У пользователя или приложения нет прав на доступ к ресурсу, запрос отклонен.
    404 Not Found | Запрашиваемый ресурс не найден.
    500 Internal Server Error | Внутренняя ошибка сервиса. Попробуйте повторно отправить запрос через некоторое время.
    503 Service Unavailable | Сервис API временно недоступен.

{% endlist %}
