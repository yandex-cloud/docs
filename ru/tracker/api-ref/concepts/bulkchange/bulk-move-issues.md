# Массовый перенос задач в другую очередь

Запрос позволяет переместить в другую очередь одновременно несколько задач.

Перед выполнением запроса убедитесь, что пользователь имеет доступ к редактированию переносимых задач и их созданию в новой очереди.

{% note warning %}

Если переносимая задача имеет тип и статус, которые не существуют в новой очереди, перенос не будет выполнен. Чтобы при переносе сбросить статус задачи в начальное значение, используйте параметр `InitialStatus`. 

По умолчанию при переносе очищаются значения компонентов, версий и проектов задачи. Если в новой очереди настроены аналогичные значения для этих полей, для переноса компонентов, версий и проектов используйте параметр `MoveAllFields`.

{% endnote %}

## Формат запроса {#section_rnm_x4j_p1b}

Перед выполнением запроса [получите доступ к API](../access.md).

Чтобы перенести задачи в другую очередь, используйте HTTP-запрос с методом `POST`:

```json
POST /{{ ver }}/bulkchange/_move
Host: {{ host }}
Authorization: OAuth <OAuth-токен>
{{ org-id }}

{
  "queue": "<ключ очереди>",
  "issues": ["TEST-1, TEST-2, TEST-3"]
}
```

{% include [headings](../../../_includes/tracker/api/headings.md) %}

#### Параметры запроса {#req-params}

**Дополнительные параметры**

Параметр | Описание | Тип данных
-------- | -------- | ----------
notify | Признак уведомления об изменении задачи:<ul><li>`true` — пользователи, указанные в полях задачи, получат уведомления;</li><li>`false` — (по умолчанию) пользователи не получат уведомления.</li></ul> | Логический.

#### Параметры тела запроса {#req-body-params}

**Обязательные параметры**

Параметр | Описание | Тип данных
-------- | -------- | ----------
queue | [Ключ очереди](../../manager/create-queue.md#key), в которую планируется перенести задачи. | Строка.
issues | Идентификаторы задач, которые необходимо перенести. | Строка.

**Дополнительные параметры**

Параметр | Описание | Тип данных
-------- | -------- | ----------
values | Параметры задач, которые будут изменены при переносе. Используйте параметры, доступные при [редактировании задачи](../issues/patch-issue.md#req-get-params). | Строка.
moveAllFields | Перенос версий, компонентов и проектов задачи в новую очередь:<ul><li>`true` — перенести, если в новой очереди существуют соответствующие версии, компоненты, проекты;</li><li>`false` (по умолчанию) — очистить версии, компоненты, проекты.</li></ul> | Логический.
initialStatus | Сброс статуса задачи в начальное значение. Статус необходимо сбросить, если задача переносится в очередь с другим [воркфлоу](../../manager/add-workflow.md):<ul><li>`true` — статус будет сброшен;</li><li>`false` (по умолчанию) — статус останется без изменений.</li></ul> | Логический.

> Пример: Перенести задачи.
> 
> - Используется HTTP-метод POST.
>
> - Задачи <q>TEST-1</q>, <q>TEST-2</q>, <q>TEST-3</q> перемещаются в очередь <q>CHECK</q>.
>
> - Каждой перемещенной задаче присваивается тег <q>перемещено</q>.
>
> ```
> POST /{{ ver }}/bulkchange/_move
> Host: {{ host }}
> Authorization: OAuth <OAuth-токен>
> {{ org-id }}
> {
>   "queue": "CHECK",
>   "issues": ["TEST-1","TEST-2","TEST-3"],
>   "values": {
>     "tags": {
>       "add": ["перемещено"]
>     }
>   },
>   "moveAllFields": true
> }
> ```

## Формат ответа {#answer}

{% list tabs %}

- Запрос выполнен успешно

    В случае успешного выполнения запроса API возвращает ответ с кодом `201 Created`.

    Тело ответа содержит информацию об операции массового переноса в формате JSON.

    ```json
    {
        "id": "1ab23cd4e56789012fg345h6",
        "self": "https://api.tracker.yandex.net/v2/bulkchange/1ab23cd4e56789012fg345h6",
        "createdBy": {
            "self": "https://api.tracker.yandex.net/v2/users/1234567890",
            "id": "1234567890",
            "display": "Имя Фамилия"
        },
        "createdAt": "2020-12-15T11:52:53.665+0000",
        "status": "CREATED",
        "statusText": "Операция массового редактирования задач создана.",
        "executionChunkPercent": 0,
        "executionIssuePercent": 0
    }
    ```

    #### Параметры ответа {#answer-params}

    Параметр | Описание | Тип данных
    -------- | -------- | ----------
    id | Идентификатор операции массового редактирования. | Строка.
    self | Адрес ресурса API, который содержит информацию о массовом редактировании. | Строка.
    [createdBy](#createdBy) | Объект с информацией об инициаторе массового редактирования. | Объект.
    createdAt | Дата и время создания операции массового редактирования. | Строка.
    status | Статус операции массового редактирования. | Строка.
    statusText | Описание статуса операции массового редактирования. | Строка.
    executionChunkPercent | Служебный параметр. | Число.
    executionIssuePercent | Служебный параметр. | Число.

    **Поля объекта** `createdBy` {#createdBy}

    Параметр | Описание | Тип данных
    -------- | -------- | ----------
    self | Адрес ресурса API, который содержит информацию о пользователе. | Строка.
    id | Идентификатор пользователя. | Число.
    display | Отображаемое имя пользователя. | Строка.

- Запрос выполнен с ошибкой

    Если запрос не был успешно обработан, API возвращает ответ с кодом ошибки:

    400
    :   Один или несколько параметров запроса имеют недопустимое значение.

    401
    :   Пользователь не авторизован. Проверьте, были ли выполнены действия, описанные в разделе [{#T}](../access.md).

    403
    :   У вас не хватает прав на выполнение этого действия. Наличие прав можно перепроверить в интерфейсе {{ tracker-name }} — для выполнения действия при помощи API и через интерфейс требуются одинаковые права.

    422
    :   Ошибка валидации. Возможно, тело запроса содержит недопустимый или несуществующий параметр.

{% endlist %}
