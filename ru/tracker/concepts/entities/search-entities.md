---
sourcePath: ru/tracker/api-ref/concepts/entities/search-entities.md
---
# Получить список сущностей

Запрос позволяет получить список сущностей, удовлетворяющих заданному критерию. 

Запрос представляет унифицированный метод получения списка проектов и портфелей, более гибкий и функциональный, чем API [получения списка проектов](../projects/get-projects.md).

## Формат запроса {#query}

Перед выполнением запроса [получите доступ к API](../access.md).

Чтобы получить список сущностей, используйте HTTP-запрос с методом `POST`. Параметры запроса передаются в его теле в формате JSON.

```json
POST /{{ ver }}/entities/{entityType}/_search?fields=entityStatus
Host: {{ host }}
Authorization: OAuth <OAuth-токен>
{{ org-id }}

{
   "filter": 
   {
      "author": "<логин_пользователя>"
   }   
}
```

{% include [headings](../../../_includes/tracker/api/headings.md) %}

{% cut "Ресурс" %}

**Ресурс**

Параметр | Описание | Тип данных
-------- | -------- | ----------
\<тип_сущности> |Тип сущности:<ul><li>project — проект;</li><li>portfolio — портфель.</li></ul>| Строка

{% endcut %}  

{% cut "Параметры запроса" %}

**Дополнительные параметры**

Параметр | Описание | Тип данных
----- | ----- | -----
[fields](./about-entities.md#query-params) |  Дополнительные поля, которые будут включены в ответ. | Строка
perPage | Количество задач на странице ответа. Значение по умолчанию — 50. | Число
page | Страница выдачи. Значение по умолчанию — 1. | Число

{% note warning %}

Ключи полей сущностей не всегда совпадают с аналогичными ключами задач.

{% endnote %}

{% endcut %}

{% cut "Параметры тела запроса" %}

Тело запроса содержит информацию, необходимую для поиска сущностей:

**Дополнительные параметры**

Параметр | Описание | Тип данных
-------- | -------- | ----------
input | Подстрока в названии сущности. | Строка
filter | Параметры фильтрации задач. В параметре можно указать ключ любого поля и значение, по которому будет производиться фильтрация. | Объект
orderBy | Параметры сортировки задач. В параметре можно указать ключ любого поля, по которому будет производиться сортировка. | Строка
orderAsc | Направление сортировки. | Логический
rootOnly | Выводить только не вложенные сущности. | Логический

{% note warning %}

Ключи полей и ключи значений (например, статусов) сущностей не всегда совпадают с аналогичными ключами задач.

{% endnote %}

{% endcut %}

> Пример 1: Получить список сущностей с помощью фильтра с расширенным списком полей в выдаче
> 
> - Используется HTTP-метод POST.
> - Ответ должен содержать только взятые в работу проекты с непустым списком наблюдателей.
> - В ответе включено отображение полей `Статус`, `Автор` и `Наблюдатели`.
> 
> ```
> POST /v2/entities/project/_search?fields=entityStatus&author&followers HTTP/1.1
> Host: {{ host }}
> Authorization: OAuth <OAuth-токен>
> {{ org-id }}
> 
> {
>   "filter": {
>     "followers": "notEmpty()",
>     "entityStatus": "in_progress"
>   },
> }
> ```

> Пример 2: Получить сортированный список всех сущностей
> 
> - Используется HTTP-метод POST.
> - Ответ должен содержать все портфели, отсортированные по статусам.
> - Результаты отсортированы в убывающем порядке.
> - В ответе включено отображение полей `Статус` и `Автор`.
> 
> ```
> POST /v2/entities/project/_search?fields=entityStatus&author HTTP/1.1
> Host: {{ host }}
> Authorization: OAuth <OAuth-токен>
> {{ org-id }}
> 
> {
>   "orderBy": "entityStatus", 
>   "orderAsc":true
> }
> ```

> Пример 3: Получить для указанного портфеля список вложенных проектов с помощью фильтра
> 
> - Используется HTTP-метод POST.
> - Ответ должен содержать только вложенные проекты для родительского портфеля с указанным идентификатором.
> 
> ```
> POST /v2/entities/project/_search HTTP/1.1
> Host: {{ host }}
> Authorization: OAuth <OAuth-токен>
> {{ org-id }}
> 
> {
>   "filter": {
>     "parentEntity": "65868add99a40477********"
>   },
> }
> ```

## Формат ответа {#section_xc3_53j_p1b}

{% list tabs %}

- Запрос выполнен успешно

   {% include [answer-200](../../../_includes/tracker/api/answer-200.md) %}

   Тело ответа содержит результаты в формате JSON.

   ```json
   {
      "hits": 8,
      "pages": 1,
      "values": [
        {
            "self": "https://{{ host }}/{{ ver }}/entities/project/655f8ce5d6a39833********",
            "id": "655f8ce5d6a39833********",
            "version": 7,
            "shortId": 8,
            "entityType": "project",
            "createdBy": { "self": "https://{{ host }}/{{ ver }}/users/11********", "id": "11********", "display": "Имя Фамилия", "cloudUid": "ajevuhegoggf********", "passportUid": 11******** },
            "createdAt": "2023-11-23T17:33:25.427+0000",
            "updatedAt": "2023-11-24T12:21:43.838+0000",
            "fields": {
                "entityStatus": "in_progress",
                "followers": [{ "self": "https://{{ host }}/{{ ver }}/users/22********", "id": "22********", "display": "Имя Наблюдателя", "cloudUid": "ajeprm0fjnql********", "passportUid": 22******** }]
            }
        },
        {
            "self": "https://{{ host }}/{{ ver }}/entities/project/655f3815a834c763********",
            "id": "655f3815a834c763********",
            "version": 4,
            "shortId": 3,
            "entityType": "project",
            "createdBy": { "self": "https://{{ host }}/{{ ver }}/users/11********", "id": "11********", "display": "Имя Фамилия", "cloudUid": "ajevuhegoggf********", "passportUid": 11******** },
            "createdAt": "2023-11-23T11:31:33.874+0000",
            "updatedAt": "2023-11-23T21:52:10.863+0000",
            "fields": {
                "entityStatus": "draft",
                "followers": [{ "self": "https://{{ host }}/{{ ver }}/users/22********", "id": "22********", "display": "Имя Наблюдателя", "cloudUid": "ajeprm0fjnql********", "passportUid": 22******** }]
            }
        }
      ],
      "orderBy": "entityStatus"
   }
   ```

   {% cut "Параметры ответа" %}

   Параметр | Описание | Тип данных
   -------- | -------- | ----------
   hits | Количество результатов в выдаче. | Число
   pages | Количество страниц в выдаче. | Число
   values | Результаты. Объекты сущностей. | Массив объектов

   **Поля объектов сущностей**

   Параметр | Описание | Тип данных
   -------- | -------- | ----------
   self | Адрес ресурса API, который содержит информацию о проекте. | Строка
   id | Идентификатор сущности. | Строка
   version | Версия сущности. Каждое изменение параметров увеличивает номер версии. | Число
   shortId | Идентификатор проекта или портфеля. | Строка
   entityType | Тип сущности. | Строка
   createdBy | Блок с информацией о создателе сущности. | Объект
   createdAt | Дата создания сущности в формате `YYYY-MM-DDThh:mm:ss.sss±hhmm`. | Строка
   updatedAt | Дата последнего обновления сущности в формате `YYYY-MM-DDThh:mm:ss.sss±hhmm`. | Строка
   fields | Объект с дополнительными полями. | Объект
   
   **Поля объекта** `createdBy`
    
   Параметр | Описание | Тип данных
   -------- | -------- | ----------
   self | Адрес ресурса API, который содержит информацию о создателе сущности. | Строка
   id | Идентификатор пользователя. | Число
   display | Отображаемое имя пользователя. | Строка
   cloudUid | Уникальный идентификатор пользователя в {{ org-full-name }}. | Строка
   passportUid | Уникальный идентификатор аккаунта пользователя в организации {{ ya-360 }} и Яндекс ID. | Строка

   {% endcut %}

- Запрос выполнен с ошибкой

   Если запрос не был успешно обработан, API возвращает ответ с кодом ошибки:

   {% include [answer-error-400](../../../_includes/tracker/api/answer-error-400.md) %}

   {% include [answer-error-401](../../../_includes/tracker/api/answer-error-401.md) %}

   {% include [answer-error-403](../../../_includes/tracker/api/answer-error-403.md) %}

   {% include [answer-error-404](../../../_includes/tracker/api/answer-error-404.md) %}

{% endlist %}
