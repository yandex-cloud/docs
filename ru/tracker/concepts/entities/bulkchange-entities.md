---
sourcePath: ru/tracker/api-ref/concepts/entities/bulkchange-entities.md
---
# Массовое редактирование сущностей

Запрос позволяет массово обновить сущности — [проекты](../../manager/project-new.md) или [портфели проектов](../../manager/portfolio.md).

## Формат запроса {#query}

Перед выполнением запроса [получите доступ к API](../access.md).

Для пакетного изменения нескольких сущностей используйте HTTP-запрос с методом `POST`. Параметры запроса передаются в его теле в формате JSON.

```
POST /{{ ver }}/entities/<тип_сущности>/bulkchange/_update
Host: {{ host }}
Authorization: OAuth <OAuth-токен>
{{ org-id }}

{
   "metaEntities":[ "<идентификатор_сущности_1>","<идентификатор_сущности_2>", ...], 
   "values":
   {
      "fields":
      {
         "<ключ_поля>":"<значение>",
         ...
      },
      "comment":"<комментарий>"
   }
}
```

{% note info %}

Вместо идентификатора сущности можно использовать идентификатор проекта или портфеля — значение поля `shortId`.

{% endnote %}

{% include [headings](../../../_includes/tracker/api/headings.md) %}

{% cut "Ресурс" %}

Параметр | Описание | Тип данных
-------- | -------- | ----------
\<тип_сущности> | Тип сущности:<ul><li>project — проект;</li><li>portfolio — портфель.</li></ul>| Строка

{% endcut %}

{% cut "Параметры тела запроса" %}

**Обязательные параметры**

Параметр | Описание | Тип данных
-------- | -------- | ----------
metaEntities | Список идентификаторов сущностей. | Массив строк
values | Объект с настройками для пакетного обновления сущностей. | Объект

**Поля объекта** `values`

Параметр | Описание | Тип данных
-------- | -------- | ----------
fields | Объект с парами поле-значение. | Объект
comment | Комментарий. | Строка
links | Массив объектов с настройками связей с другими сущностями. | Массив объектов

**Поля объектов массива** `links`

Параметр | Описание | Тип данных
-------- | -------- | ----------
relationship | Тип связи. Например:<ul><li>`relates`;</li><li>`is dependent by`;</li><li>`depends on`.</li></ul> | Строка
entity | Идентификатор связанной сущности. | Строка

{% endcut %}

> Пример: Для нескольких проектов изменить статус, назначить наблюдателя и оставить комментарий
> 
> - Используется HTTP-метод POST.
> - Статус проектов меняется на `Есть риски`.
> - Назначается наблюдатель.
> - В комментарии проекта добавляется новая запись.
> 
> ```
> POST /v2/entities/project/bulkchange/_update HTTP/1.1
> Host: {{ host }}
> Authorization: OAuth <OAuth-токен>
> {{ org-id }}
> 
> {
>    "metaEntities":[ "655f3be523db2132********","655f383923db2132********"], 
>    "values":
>    {
>       "fields":
>       {
>          "entityStatus":"at_risk",
>          "followers":"agent007",
>       },
>       "comment":"Проект в зоне риска"
>    }
> }
> ```

## Формат ответа {#answer}

{% list tabs %}

- Запрос выполнен успешно

   {% include [answer-200](../../../_includes/tracker/api/answer-200.md) %}

   Тело ответа содержит информацию о пакетном запросе в формате JSON.

   ```json
   {
      "id": "6560c6f59b0b1e76********",
      "self": "https://{{ host }}/{{ ver }}/bulkchange/6560c6f59b0b1e76********",
      "createdBy": { "self": "https://{{ host }}/{{ ver }}/users/11********", "id": "11********", "display": "Имя Фамилия", "cloudUid": "ajevuhegoggf********", "passportUid": 11******** },
      "createdAt": "2023-11-24T15:53:25.122+0000",
      "status": "CREATED",
      "statusText": "Операция массового редактирования задач создана.",
      "executionChunkPercent": 0,
      "executionIssuePercent": 0
   }
   ```

   {% cut "Параметры ответа" %}

   Параметр | Описание | Тип данных
   -------- | -------- | ----------
   id | Идентификатор пакетного запроса. | Строка
   self | Адрес ресурса API, который содержит информацию о пакетном запросе. | Строка
   createdBy | Блок с информацией о создателе пакетного запроса. | Объект
   createdAt | Дата создания сущности в формате `YYYY-MM-DDThh:mm:ss.sss±hhmm`. | Строка
   status | Статус пакетного запроса. | Строка
   statusText | Расшифровка статуса пакетного запроса. | Строка
   
   **Поля объекта** `createdBy`
    
   Параметр | Описание | Тип данных
   -------- | -------- | ----------
   self | Адрес ресурса API, который содержит информацию о создателе сущности. | Строка
   id | Идентификатор пользователя. | Число
   display | Отображаемое имя пользователя. | Строка
   cloudUid | Уникальный идентификатор пользователя в {{ org-full-name }}. | Строка
   passportUid | Уникальный идентификатор аккаунта пользователя в организации {{ ya-360 }} и Яндекс ID. | Строка

   {% endcut %}

- Запрос выполнен с ошибкой

    Если запрос не был успешно обработан, API возвращает ответ с кодом ошибки:

    {% include [answer-error-400](../../../_includes/tracker/api/answer-error-400.md) %}

    {% include [answer-error-401](../../../_includes/tracker/api/answer-error-401.md) %}

    {% include [answer-error-403](../../../_includes/tracker/api/answer-error-403.md) %}
    
    {% include [answer-error-412](../../../_includes/tracker/api/answer-error-412.md) %}

    {% include [answer-error-428](../../../_includes/tracker/api/answer-error-428.md) %}


{% endlist %}
