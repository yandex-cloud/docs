# Подготовка и загрузка данных для {{ brand-voice-core }}

С помощью сервиса [{{ brand-voice-core }}](index.md#ss) можно создать уникальный голос на основе записанных аудио. Голос используется для синтеза речи на основе произвольного текста или [текста по шаблону](../templates.md).

Для создания своего голоса {{ brand-voice-core }}:

1. [Подготовьте текстовые данные](#prepare-dataset).
1. [Запишите аудиофайлы](#record-audio).
1. [Загрузите данные](#upload).

{% note info %}

Чтобы подготовить модель {{ brand-voice-core }} по загруженным данным, требуется до 1 месяца.

{% endnote %}

## Подготовьте текстовые данные {#prepare-dataset}

Чтобы создать голос {{ brand-voice-core }}, необходимо 5 часов аудиоданных с текстовыми расшифровками. Определите объем текстов по скорости речи вашего диктора (количество слов в минуту).

>Пример:
>
>Скорость речи диктора — 120 слов в минуту. Необходимый объем текстов для построения модели составляет `120 x 60 x 5 = 36000` слов.

Если вы планируете использовать синтез по шаблонам, распределите объем текстов:

* Для полнотекстового синтеза — 3 часа речи.
* Для синтеза по шаблонам — 2 часа речи.

Подготовьте текстовые расшифровки аудиозаписей в кодировке UTF-8 в виде таблицы [TSV](https://ru.wikipedia.org/wiki/TSV). Таблица должна быть без заголовка и состоять из двух столбцов:

1. `recording` — имя файла с аудиозаписью, на которой диктор произносит текст.
1. `text`  — строка, содержащая текст аудиозаписи.

>Пример:
>
>Заголовок таблицы приведен для наглядности, в файле для загрузки он должен отсутствовать.
>
>| recording | text |
>|---|---|
>| 0.wav | \*\*Кот\*\* пошел {place=в школу}? |
>| 1.wav | \*\*Кот\*\* пошел {place=за колбасой}? |
>| 2.wav | Мы предлагаем вам подписаться на рассылку, чтобы своевременно получать информацию о новинках нашего магазина. |
>| 3.wav | Мы предлагаем вам замечательную книгу {book_name=Приключения Алисы в Стране чудес} всего за \{price=двести тридцать пять рублей}. |
>| 4.wav | Мы предлагаем вам замечательную книгу {book_name=Евгений Онегин} всего за \{price=пятьсот рублей сорок восемь копеек}.  |
>| 5.wav | Вы записаны на {date=завтра} в \{time=пятнадцать ноль ноль}. |
>| 6.wav | Вы записаны на {date=четвёртое октября} в \{time=девять утра}. |

### Требования к текстам {#text-technical-requirements}

{% note info %}

Результат обучения голосовой модели {{ brand-voice-core }} напрямую зависит от обучающих данных. Выполняйте приведенные требования и рекомендации к текстам, чтобы получить качественный голос {{ brand-voice-core }}.

{% endnote %}

* Количество терминов предметной области в текстах должно составлять 20–30%, но не в ущерб лингвистическому разнообразию.
* Количество текстов в вопросительной форме должно быть не менее 30%.
* Рекомендуемая длина фразы — не более {{ tts-v3-count }}.
* Тексты не должны содержать грамматических ошибок.
* Текст должен совпадать с озвученным в аудио.
* Если в текстах есть однообразные фразы, выделите их в шаблоны.

{% include [text requirements](../../../_includes/speechkit/tts-text-requirements.md) %}

### Требования к шаблонам {#pattern-requirements}

* Длина фразы вместе с переменной частью не должна превышать {{ tts-v3-count }}.
* В шаблоне должна быть одна фраза и одна или несколько переменных для замены.
* Переменные должны быть размечены.

   > Фраза для шаблона: `Ваш рейс восьмого сентября в одиннадцать двадцать по маршруту Москва Санкт-Петербург.`
   > Список переменных: `variable_name = '{date}', variable_value = 'восьмого сентября в одиннадцать двадцать'`, `variable_name = '{route}', variable_value = 'Москва Санкт-Петербург'`.
   > Размеченный текст шаблона должен выглядеть так: `Ваш рейс {date = 'восьмого сентября в одиннадцать двадцать'} по маршруту {route = 'Москва Санкт-Петербург'}.`
* Для каждого шаблона должно быть представлено не менее 10 значений переменных, различных по длительности произношения.
    >Пример:
    >
    >Здравствуйте, меня зовут **Анастасия**, компания **Яндекс Облако**.
    >
    >Здравствуйте, меня зовут **Анна**, компания **Яндекс**.
* Имена переменных не должны меняться в рамках одного шаблона.

## Запишите аудиофайлы {#record-audio}

{% include notitle [tips](../../../_includes/speechkit/audio-tips.md) %}

### Требования к аудиозаписям {#requirements-audio}

| Требование | Значение |
| --- | --- |
| Частота дискретизации | 48 кГц |
| Глубина аудио (audio bit depth) |  16 бит PCM |
| Количество каналов |  1 (моно) |
| Формат | [WAV](https://ru.wikipedia.org/wiki/WAV) |

Длительность тишины в начале и в конце аудиозаписи шаблона — не более 1 секунды.

Сохраните все аудиозаписи в ZIP-архив для загрузки.

## Загрузите данные {#upload}

Текстовые данные и аудиофайлы загружаются через интерфейс [{{ ml-platform-full-name }}](../../../datasphere/index.yaml). Для получения подробной инструкции по загрузке [заполните форму](#contact-form).

## Часто задаваемые вопросы {#faq}

#### Можно ли загрузить аудиоданные с другими характеристиками? {#audio-non-standard}

Аудиоданные, не соответствующие [требованиям](#requirements-audio), загрузить нельзя.

#### Где будет доступен голос? {#where-to-get-voice}

В {{ yandex-cloud }} по заранее предоставленному `voice_id`. Голос может быть предоставлен в формате решения {{ sk-hybrid-name }}.

#### Можно ли загрузить большее количество часов? {#more-hours}

Да. Потенциально это даже может улучшить качество.

#### Можно ли загрузить менее 5 часов аудио? {#less-hours}

Не рекомендуем, иначе обучение голоса {{ brand-voice-core }} будет неполным и речь с ним будет синтезироваться хуже.
