# Формат входных данных {{ brand-voice-full-name }} Adaptive

{{ brand-voice-name }} Adaptive — это платформа для построения диалоговых роботов. Она синтезирует фразы на основе записей голоса диктора по шаблонам.

Ниже описаны требования к данным для обучения модели синтеза по технологии {{ brand-voice-full-name }} Adaptive.

## Требования к записи {#recording}

| Требование | Значение |
| --- | --- |
| Частота дискретизации | 48 кГц |
| Глубина аудио (audio bit depth) |  16 бит PCM |
| Количество каналов |  1 (моно) |
| Формат | [WAV](https://ru.wikipedia.org/wiki/WAV) |

Также должны соблюдаться следующие условия:

* Отсутствие эха.
* Отсутствие посторонних шумов.
* Минимальная постобработка.
* Длительность тишины в начале и в конце записи — не более 1 секунды.

### Требования к оборудованию и процессу записи {#hardware}

Посторонние шумы и эхо при записи напрямую влияют на результирующее качество синтеза. Комната, оборудованная акустическими панелями, будет отличным местом для записи. Если запись происходит в бытовых условиях, снизить эхо помогут мягкие поверхности и мебель, например ковер, мягкий диван и т.д.

Рекомендуется проводить все записи в одних и тех же условиях, в одном и том же помещении. Это касается как исходных записей диктора, необходимых для обучения голосовой модели, так и последующих записей шаблонов.

### Требования к диктору {#dictor}

* Громкость голоса на всех записях должна быть одинаковой.
* Все фразы должны быть произнесены в одном стиле и настроении.

**Рекомендации:**

* Если диктор не является профессионалом, мы рекомендуем не производить записи дольше 2 часов в день.
* Если фраза вызывает у диктора непонимание или отторжение — ее стоит пропустить.
* Если диктор не уверен в правильности произнесения фразы или считает, что произносит неестественно — ее стоит пропустить.

## Требования к итоговым данным {#data}

Для обучения голосовой модели необходимы:
* ZIP-архив аудиозаписей в формате WAV, в котором содержатся:
   1. Основной набор (базовая корзина). Базовая корзина состоит из фраз, специально подготовленных командой {{ yandex-cloud }}, которые нужно проговорить и записать. Его изменение невозможно, допускается только пропуск фраз.
   1. Набор для построения фраз (специфичная корзина). В качестве текстов нужны записи шаблонов, которые потом необходимо синтезировать, с учетом переменных. Этот набор формируется на основе пользовательских данных и должен пройти рецензирование перед началом записи.

* Текстовые расшифровки аудиозаписей в виде таблицы [TSV](https://ru.wikipedia.org/wiki/TSV). Таблица с текстами должна состоять из двух колонок:
   1. `recording` — имя файла с аудиозаписью, на которой диктор произносит текст — шаблон с подставленной переменной.
   1. `text`  — строка, содержащая дословную расшифровку аудиозаписи. Переменная часть шаблона должна быть представлена в формате `{variable_name = variable_value}`. Имена переменных не должны меняться в рамках одного шаблона.

Текстовая расшифровка должна быть в кодировке UTF-8, у таблицы не должно быть заголовка.

### Основные требования к наборам данных {#dataset-requirements}

* Одна фраза — одна запись (файл).
* Неточности, микроповторы, оговорки и замены слов недопустимы.
* Каждая запись должна сопровождаться абсолютно точной текстовой расшифровкой.
* Расшифровки не должны содержать грамматических ошибок.
* Для наименования файлов необходимо использовать номер фразы.
* Обязательным условием является явное указание буквы <q>ё</q>. Использование буквы <q>е</q> вместо <q>ё</q> недопустимо.
* Аббревиатуры должны быть денормализованы (ВТБ → <q>вэтэбэ</q>) или развернуты.

### Требования к шаблонам {#pattern-requirements}

* Шаблон должен соответствовать желаемому скрипту.
* В шаблоне должна быть одна или несколько переменных для замены.
* Длительность звучания переменной части должна соответствовать образцу в шаблоне. В случае если переменные сильно различаются по длине, рекомендуем записать несколько шаблонов с примерами разной длины.
* Длинные реплики диктора необходимо разбить на самостоятельные предложения и разные шаблоны.
* Для каждого шаблона должно быть представлено не менее 10 вариантов переменных, различных по длительности произношения.
    Например:    
    >Здравствуйте, меня зовут **Анастасия**, компания **Яндекс Облако**.
    >
    >Здравствуйте, меня зовут **Анна**, компания **Яндекс**.

### Требования к текстам {#text-requirements}

1. Все данные должны быть нормализованы, то есть строки текста для синтеза не могут содержать цифр и сокращений вида <q>ул. Строителей, кв.15 к.3</q> или <q>13 руб 10 коп</q>. Цифры и числа необходимо записать прописью, сокращения — полностью раскрыть. 
   
1. В словах-омографах, где ударение может быть поставлено неоднозначно, необходимо явно указать ударную гласную знаком `+`.
   > _<q>Он вставил ключ в зам+ок.</q>_, ударение падает на второй слог.
   > _<q>Михайловский з+амок — главный корпус Пушкинского музея.</q>_, ударение падает на первый слог.

1. Обязательно явно указывать букву <q>ё</q>.

1. В вопросительных предложениях необходимо указать, на какое слово приходится \*\*логическое ударение\*\* — вопросительная интонация предложения. 

   {% note warning %}

   Логическое ударение не должно падать на переменную часть фразы.

   {% endnote %}

   > Предложение <q>Кот пошел в лес?</q> можно прочитать тремя разными способами:
   > * \*\*Кот\*\* пошел в лес? — со смыслом <q>Кто пошел в лес? Это был действительно кот?</q>
   > * Кот \*\*пошел\*\* в лес? — со смыслом <q>Кот пошел или побежал?</q> или <q>Было ли совершено само действие? Кот ушел или нет?</q>
   > * Кот пошел \*\*в лес\*\*? — со смыслом <q>Куда или за чем пошел кот? В лес, в школу, за колбасой?</q>
   >
   > Во всех предложениях логическое ударение выделяет основной смысл предложения.
   
1. Длина фразы целиком не должна превышать {{ tts-v3-count }} символов, включая переменную часть.

### Пример сводной текстовой таблицы {#example}

Заголовок таблицы приведен для примера, в файле загрузки он должен отсутствовать.
Кодировка файла — UTF-8.

| recording | text |
|---|---|
| 0.wav | \*\*Кот\*\* пошел {place=в школу}? |
| 1.wav | \*\*Кот\*\* пошел {place=за колбасой}? |
| 2.wav | Мы предлагаем вам замечательную книгу {book_name=Русские народные сказки} всего за \{price=тысяча сто один рубль одиннадцать копеек}. |
| 3.wav | Мы предлагаем вам замечательную книгу {book_name=Приключения Алисы в Стране чудес} всего за \{price=двести тридцать пять рублей}. |
| 4.wav | Мы предлагаем вам замечательную книгу {book_name=Евгений Онегин} всего за \{price=пятьсот рублей сорок восемь копеек}.  |
| 5.wav | Вы записаны на {date=завтра} в \{time=пятнадцать ноль ноль}. |
| 6.wav | Вы записаны на {date=четвёртое октября} в \{time=девять утра}. |

#### Что дальше {#what-is-next}

* [API {{ brand-voice-name }} (англ.)](../../tts-v3/api-ref/grpc/)