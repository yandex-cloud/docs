# Настройка алертов в {{ monitoring-full-name }}

Подробная информация о порядке [создания алерта](../../monitoring/operations/alert/create-alert.md) и о [параметрах алерта](../../monitoring/concepts/alerting.md) приведена в документации {{ monitoring-full-name }}.

## Перед началом работы {#before-you-begin}

Создайте канал уведомлений в {{ monitoring-name }}. Подробнее про создание канала уведомлений написано в [документации {{ monitoring-full-name }}](../../monitoring/operations/alert/create-channel.md).

## Переход трейла в неактивное состояние {#deactivating-trail}

Этот сценарий описывает параметры алерта, который отправляет уведомления о том, что указанный в его параметрах трейл переходит в неактивный статус.

1. Перейдите на страницу [создания нового алерта](../../monitoring/operations/alert/create-alert.md) {{ monitoring-name }} в консоли {{ yandex-cloud }}.
1. В поле **Название** введите название алерта. 
1. В области **Метрики** укажите значения:
    1. `service = Audit Trails`. 
    1. `name = trail.status`.
    1. `status != ACTIVE`.
    1. `trail = <имя трейла>`.
1. В области **Настройки алерта** укажите значения:
    1. **Условие срабатывания** — `Не равно`.
    1. **Alaram** — `0`.
1. В области **Каналы уведомлений** выберите канал уведомления.
1. Нажмите кнопку **Создать алерт**.

Алерт создан.

## Прекращение доставки аудитных логов в объект назначения {#stopping-logs}

Алерт отправит уведомление о том, что указанный в его параметрах трейл прекратил загружать аудитные логи в объект назначения, например по причине нехватки свободного места в бакете.

Параметр "Окно вычисления" зависит от конкретного трейла, так как в зависимости от типа и количества ресурсов, находящихся в области сбора аудитных логов трейла, частота загрузки аудитных логов в объект назначения будет варьироваться. 

1. Перейдите на страницу [создания нового алерта](../../monitoring/operations/alert/create-alert.md) {{ monitoring-name }} в консоли {{ yandex-cloud }}.
1. В поле **Название** введите название алерта. 
1. В области **Метрики** укажите значения:
    1. `service = Audit Trails`. 
    1. `name = trail.delivered_events_count`.
    1. `trail = <имя трейла>`.
1. В области **Настройки алерта** укажите значения:
    1. **Условие срабатывания** — `Равно`.
    1. **Alaram** — `0`.
    1. **Окно вычисления** — `<значение для трейла>`.
1. В области **Каналы уведомлений** выберите канал уведомления.
1. Нажмите кнопку **Создать алерт**.

Алерт создан.

## Изменение числа трейлов {#number-trails}

Алерт отправит уведомление о том, что число трейлов в облаке изменилось.

1. Перейдите на страницу [создания нового алерта](../../monitoring/operations/alert/create-alert.md) {{ monitoring-name }} в консоли {{ yandex-cloud }}.
1. В поле **Название** введите название алерта. 
1. В области **Метрики** укажите значения:
    1. `service = Audit Trails`. 
    1. `name = trail.quota_usage_count`.
1. В области **Настройки алерта** укажите значения:
    1. **Условие срабатывания** — `Не равно`.
    1. **Alaram** — `<количество трейлов>`.
1. В области **Каналы уведомлений** выберите канал уведомления.
1. Нажмите кнопку **Создать алерт**.

Алерт создан.

## Израсходование квоты трейлов на облако {#trail-quota}

Алерт отправит уведомление о том, что количество трейлов в облаке стало менее 80% от квоты.
   
1. Перейдите на страницу [создания нового алерта](../../monitoring/operations/alert/create-alert.md) {{ monitoring-name }} в консоли {{ yandex-cloud }}.
1. В поле **Название** введите название алерта. 
1. В области **Метрики** укажите значения:
    1. `service = Audit Trails`. 
    1. `name = trail.quota_usage_count`.
1. В области **Настройки алерта** укажите значения:
    1. **Условие срабатывания** — `Больше`.
    1. **Alaram** — `<число, равное 80% от квоты>`.
1. В области **Каналы уведомлений** выберите канал уведомления.
1. Нажмите кнопку **Создать алерт**.

Алерт создан.

## Попытки неавторизованного доступа {#unauthorized-access}

Алерт отправит уведомление о том, что к одному из ресурсов, которые находятся в его области сбора аудитных логов, был отправлен неавторизованный запрос.

1. Перейдите на страницу [создания нового алерта](../../monitoring/operations/alert/create-alert.md) {{ monitoring-name }} в консоли {{ yandex-cloud }}.
1. В поле **Название** введите название алерта. 
1. В области **Метрики** укажите значения:
    1. `service = Audit Trails`. 
    1. `name = trail.unauthorized_events_count`.
1. В области **Настройки алерта** укажите значения:
    1. **Условие срабатывания** — `Больше`.
    1. **Alaram** — `0`.
1. В области **Каналы уведомлений** выберите канал уведомления.
1. Нажмите кнопку **Создать алерт**.

Алерт создан.