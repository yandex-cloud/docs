# Технические меры защиты на стороне провайдера

## Безопасность инфраструктуры облачной платформы {#infr-sec}

### Разделение и изоляция ресурсов {#sep-res}

Изоляция ресурсов административной и пользовательских полезных нагрузок в Яндекс.Облаке происходит следующим образом:
- Физическая изоляция с помощью групп хостов. Критичные с точки зрения безопасности сервисы запускаются в виртуальных машинах на отдельной группе физических хостов, на которой не запускаются пользовательские виртуальные машины.
- Логическая изоляция на уровне гипервизора и отдельных ядер. Иногда административная нагрузка может запускаться на хостах, на которых располагаются виртуальные машины пользователей. В таких случаях изоляция осуществляется на уровне гипервизора и физических ядер.
- Логическая изоляция с помощью сервиса Identity and Access Management (IAM). Все административные операции проводятся через IAM. Для их выполнения нужны специальные права, недоступные пользователям Яндекс.Облака. 
- Изоляция на уровне сети. Все административные виртуальные машины запускаются в физически или логически изолированных сетях. Корпоративная сеть провайдера отделена от сети облачной платформы. Доступ контролируется автоматически с помощью динамических и хостовых межсетевых экранов и списков управления доступа на маршрутизаторах.
- В мультитенантных системах изоляция реализуется на уровне приложения, а также при помощи проверки прав доступа к облаку и каталогу у пользователя, осуществляющего операцию над ресурсами.

### Безопасность машин облачной платформы {#mach-sec}

Безопасность физических машин и сервисных виртуальных машин обеспечивается на нескольких уровнях.
- На уровне сети используются несколько типов межсетевых экранов:
   - фильтры пакетов на границах внутренних подсетей;
   - простой фильтр пакетов на уровне Top-of-Rack коммутатора;
   - аппаратный межсетевой экран на границе инфраструктуры Яндекса и инфраструктуры Облака;
   - программный межсетевой экран, установленный на всех физических хостах и виртуальных машинах.
- Используются дополнительные средства защиты:
   - AppArmor и Seccomp — формирует среду изоляции (песочницу) для приложений. Все виртуальные машины на уровне хостовой операционной системы работают под AppArmor.
   - Osquery 4 — доработанная версия Osquery, которая реализует функционал Host-based Intrusion Detection System, собирает телеметрию с хоста, включая логи AppArmor и Seccomp, обогащает их и отправляет в систему Security Information and Event Management (SIEM).
   - Система мониторинга и оповещения о подозрительном поведении.
   - Конфигурации операционных систем описаны кодом и хранятся в репозитории. Все изменения конфигураций проходят обязательную проверку в тестовых средах перед переносом в продуктивную среду.
   - Контроль доступа администраторов и разработчиков к продуктивной среде обеспечивается с помощью бастионного хоста, который записывает сессию пользователя. Информация из записанных сессий обрабатывается и попадает в SIEM-систему. Сотрудники службы информационной безопасности регулярно ее анализируют.
- Доступ к кластеру по SSH происходит с использованием аппаратных ключей YubiKey, на которых хранятся аутентификационные данные сотрудников. Это снижает риски, связанные с кражей учетных данных сотрудников с доступом в продуктивную среду.
- Все установленные в продуктивном окружении пакеты регулярно проверяются на наличие уязвимостей и обновляются до последних версий.

### Защита от атак на цепочку поставок (supply chain attacks) {#sup-ch-att}

В Яндексе есть отдел Research and Development (RnD). Он занимается проектированием и организацией производства серверного оборудования, которое используется в компании. 

Все серверное оборудование проходит тестирование перед вводом в эксплуатацию. Пакеты с кодом, которые внедряются в продуктивную среду, содержат криптографическую подпись. Пакетный менеджер проверяет ее перед установкой. Все пакеты сторонних производителей ПО с открытым исходным кодом переподписываются перед добавлением в репозиторий пакетов компании. 

Релиз обновлений происходит со специальных серверов управления, доступ к которым возможен только через описанный выше бастион. Лог обновления продуктивной среды сохраняется и анализируется релиз-инженером. Все изменения в приложениях и конфигурации проходят обязательную проверку. 

Конфигурации всех компонентов продуктивной среды собираются отдельно при помощи Osquery. Представители службы информационной безопасности анализируют их с помощью SIEM-системы.


## Защита учетных данных сотрудников {#empl-cred-sec}

Процесс аутентификации на корпоративных ресурсах, не связанных с объектами облачной инфраструктуры, выстроен на основе лучших мировых практик:
- Все события аутентификации собираются и анализируются на предмет возможной кражи учетных данных.
- В Яндексе внедрены меры противодействия фишингу.
- В компании существует парольная политика.
- Для внешнего доступа к ресурсам требуется VPN-соединение или двухфакторная аутентификация. 
- Стойкость паролей регулярно проверяется.
Процесс аутентификации на ресурсах, связанных с облачной инфраструктурой, строже:
- Право доступа отдельно запрашивается и подтверждается руководителем подразделения и представителем отдела безопасности.
- Для доступа к продуктивной среде необходимо использовать аппаратный токен.
- Аутентификация на веб-ресурсах продуктивной среды организована с использованием протокола WebAuthn. При аутентификации по SSH используются сертификаты.
- Приватный ключ, связанный с сертификатом, не покидает аппаратного токена.
- Аппаратный токен дополнительно защищен пин-кодом или биометрией пользователя.
- Доступ в продуктивную среду организован через бастион. Все сессии пользователей записываются и сохраняются.

Строгие меры аутентификации с использованием аппаратных токенов позволяют повысить защиту учетных данных. Даже в случае компрометации машины сотрудника злоумышленник не сможет украсть и переиспользовать учетные данные пользователя. Компрометация аккаунта с помощью фишинга маловероятна.

## Защита данных {#data-sec}

- Владельцем данных всегда является пользователь облачной платформы. Яндекс.Облако использует информацию клиента, размещенную на платформе, только для выполнения целей договора и уведомляет клиента об инцидентах, затрагивающих пользовательские данные. Шифрование на уровне Storage
- Storage — мультенантная система и шифрует свои данные отдельным набором ключей перед записью данных на физический диск. Ключи шифрования хранятся на физических хостах, на которых работает Storage. Шифрование на уровне баз данных Yandex Database (YDB)
- В YDB дополнительно реализовано шифрование на уровне баз данных. Данные шифруются непосредственно перед отправкой в Storage. Шифрование на уровне баз данных происходит в системах, построенных на базе YDB (например, Yandex Message Queue), и других сервисах платформы, которые используют YDB для хранения данных.Шифрование резервных копий данных в Managed Services for Databases (MDB)
- Все резервные копии, создаваемые сервисами MDB, шифруются перед отправкой в постоянное хранилище. Для каждого пользователя генерируется пара ключей ассиметричного шифрования, которая хранится в сервисе MDB.Шифрование данных при передаче.

Для шифрования данных при передаче используется протокол TLS. Ключи для работы протокола TLS хранятся на хостах, на которых он используется.

В сценариях, указанных выше, используются следующие криптографические алгоритмы:
- симметричные: AES, ChaCha;
- ассиметричные: RSA, Ed25519.

Минимальная длина ключа, используемая в симметричных алгоритмах — 128 бит, в ассиметричных — 2048 бит.

### Удаление данных {#data-del}

- Удаление ресурса при получении запроса через API сервиса. Если сервис получает запрос на удаление ресурса через API, ресурс немедленно помечается как удаляемый и не может быть восстановлен. Фактически удаление производится в течение 72 часов.
- При автоматической блокировке облака. По истечению 60 дней (при блокировке облака из-за нарушения условий использования — 7 дней) Облако может пометить ресурсы как удаляемые и безвозвратно удалить их вместе с данными в течение 72 часов
- Удаление логов запросов к ресурсам. Записи о запросах к ресурсам пользователя через API хранятся в течение года для анализа инцидентов информационной безопасности и противодействия мошенничеству. По истечении года записи безвозвратно удаляются.
- При удалении облака пользователя. Если облако не было восстановлено в течение 30 дней, ресурсы во всех сервисах помечаются как удаляемые и удаляются в течение 72 часов. При разрыве контракта все облака пользователя и ресурсы в них немедленно помечаются как удаляемые и удаляются в течение 72 часов
- При удалении платежного аккаунта. После запроса пользователя платежный аккаунт помечается как удаляемый и в течение 72 часов перестает быть доступен пользователю. Информация о платежном аккаунте может использоваться для формирования финансовой отчетности. Поэтому эта информация хранится до истечения срока исковой давности и срока, установленного применимым финансовым законодательством. По истечении указанных сроков платежный аккаунт удаляется без возможности восстановления.

### Раскрытие данных третьей стороне {#data-disclose}

Яндекс.Облако не раскрывает информацию третьим лицам, за исключением тех случаев, когда это предусмотрено действующим законодательством или положениями договора. Всегда, когда это возможно, Яндекс.Облако перенаправляет запрос третьей стороны клиенту.

## Защита информации о пользователе {#user-info-sec}

Информация о пользователях доступна сотрудникам Облака на основе принципа минимальной необходимости, то есть эту информацию получают только те подразделения, которым она необходима для выполнения своих обязанностей. В системах обработки и хранения данной информации используется аутентификация, авторизация и учет действий над записями. 

Информация о пользователях включает в себя:
- логи действий пользователей (операции);
- логи доступа для API и консоли;
- техническую информацию о состоянии сервисов пользователя;
- финансовую информацию и информацию о потреблении.

Права на доступ к информации выше по умолчанию ограничены и регулярно пересматриваются сотрудниками службы ИБ. Системы, в которых хранится и обрабатывается данная информация, создаются с использованием процесса безопасной разработки (Security Development Lifecycle, SDL) и регулярно проходят внутренний тест на проникновение. Информация о пользователях по возможности шифруется при хранении и передаче.

## Мониторинг {#monit}

Для сбора и обработки событий безопасности в Яндекс.Облаке используется SIEM-система. События доставляются в SIEM-систему из различных источников, в основном по протоколам HTTPS и syslog. 
Собранные в SIEM-системе события анализируются и коррелируют между собой. 

В случае обнаружения признаков атаки или нарушения политик ИБ команда безопасности получает оповещение. Вместе с этим регистрируется сигнал о срабатывании средств защиты. Сигнал появляется в системе в виде задачи, в которой указана необходимая информация и инструкция о том, как действовать дальше. В зависимости от критичности сигнала ответственный получит письмо или СМС.

У каждого сигнала указан тип, который определяет приоритет сигнала и ответственного за его обработку. Часть сигналов разбирают дежурные по соответствующим сервисам, часть — служба информационной безопасности. 

В случае если сигнал признается инцидентом информационной безопасности, в действие приводится регламент, в котором прописаны шаги по обработке такого инцидента.
