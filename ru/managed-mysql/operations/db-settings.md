# Настройка базы данных

Вы можете управлять некоторыми настройками ваших баз данных с помощью интерфейсов {{ mmy-name }}.

## Установить режим SQL (sql_mode) {#sql-mode}

Вы можете задать или изменить значение переменной [sql_mode](https://dev.mysql.com/doc/refman/5.7/en/sql-mode.html), которая определяет режим SQL для базы данных. Эта операция вызовет перезапуск хостов кластера.

{% list tabs %}

- Консоль управления

  1. Перейдите на страницу каталога и выберите сервис **{{ mmy-name }}**.
  1. Выберите кластер и нажмите кнопку **Изменить кластер** на панели сверху.
  1. В блоке **Настройки СУБД** нажмите кнопку **Настроить**.
  1. В списке настроек найдите параметр **Sql mode**.
  1. Задайте набор режимов SQL с помощью выпадающего списка. Чтобы вернуть настройки по умолчанию, нажмите кнопку **Сбросить**.
  1. Нажмите кнопку **Сохранить** в диалоговом окне настроек СУБД.
  1. Нажмите кнопку **Сохранить изменения**.

- CLI

  {% include [cli-install](../../_includes/cli-install.md) %}

  {% include [default-catalogue](../../_includes/default-catalogue.md) %}

  Задайте нужные режимы SQL в значении параметра `--set`, например:

  ```bash
  $ {{ yc-mdb-my }} cluster update-config
       --cluster-name=<имя кластера>
       --set '"sql_mode=NO_KEY_OPTIONS,NO_TABLE_OPTIONS"'
  ```

  Обратите внимание на кавычки: значением параметра должна стать вся строка, включая часть `sql_mode=`.

  Имя кластера можно получить при запросе [списка кластеров в каталоге](cluster-list.md).

- API

  Передайте массив `sqlMode` в новой конфигурации {{ MY }}, отправляя запрос [update](../api-ref/Cluster/update.md).

{% endlist %}

## Изменить набор символов и правила их сравнения (CHARACTER SET, COLLATE) {#charset-collate}

Настройки символов можно установить для базы данных командой [ALTER DATABASE](https://dev.mysql.com/doc/refman/5.7/en/charset-database.html). Для этого нужно выполнить запрос от лица пользователя с привилегией `ALL` или `ALTER` для нужной БД, например:

```sql
ALTER DATABASE dbname CHARACTER SET = 'utf8mb4' COLLATE = 'utf8mb4_unicode_ci';
```

Чтобы настройки изменились не только для самой базы данных, но и для таблиц в ней, сконвертируйте таблицы с теми же настройками:

```sql
ALTER TABLE dbname.tablename CONVERT TO CHARACTER SET 'utf8mb4' COLLATE 'utf8mb4_unicode_ci';
```
