---
title: "Управление правами пользователей MySQL"
description: "Вы можете управлять правами пользователей MySQL на уровне отдельной базы данных, изменяя роли пользователей. Пользователи могут иметь разные наборы ролей для разных баз данных. Чтобы узнать подробнее про поддерживаемые роли, см. описание ролей."
---
# Управление правами пользователей

Вы можете управлять правами пользователей на уровне отдельной базы данных, изменяя [роли пользователей](../concepts/user-rights.md).

{% include [mmy-no-sql-user-rights](../../_includes/mdb/mmy-no-sql-user-rights.md) %}

## Изменить роли пользователя {#grant-role}

{% list tabs %}

- Консоль управления

  1. Перейдите на страницу каталога и выберите сервис **{{ mmy-name }}**.
  1. Нажмите на имя нужного кластера и выберите вкладку **Пользователи**.
  1. Нажмите значок ![image](../../_assets/horizontal-ellipsis.svg) и выберите пункт **Настроить**.
  1. При необходимости добавьте пользователю нужные базы данных:
     1. Нажмите кнопку **Добавить базу данных**.
     1. Выберите базу данных из выпадающего списка.
     1. Повторите два предыдущих шага, пока не будут выбраны все требуемые базы данных.
     1. Чтобы отозвать доступ к определенной базе, удалите ее из перечня, нажав значок ![image](../../_assets/cross.svg) справа от имени базы данных.
  1. Задайте нужные роли пользователя для каждой из баз данных пользователя:
     1. Нажмите значок ![image](../../_assets/plus-sign.svg) в столбце **Роли**.
     1. Выберите роль, которую вы хотите добавить пользователю из выпадающего списка.
     1. Повторите два предыдущих шага, пока не будут добавлены все требуемые роли.
  1. Чтобы отозвать роль, нажмите значок ![image](../../_assets/cross.svg) справа от ее имени.
  1. Нажмите кнопку **Сохранить**.

- CLI

  {% include [cli-install](../../_includes/cli-install.md) %}

  {% include [default-catalogue](../../_includes/default-catalogue.md) %}

  * Добавить роли пользователю:

      ```bash
      {{ yc-mdb-my }} user grant-permission <имя пользователя> \
        --cluster-name <имя кластера> \
        --database <имя базы данных> \
        --permissions <набор ролей через запятую>
      ```

      Имя кластера можно запросить со [списком кластеров в каталоге](cluster-list.md), имя базы данных — со [списком баз данных в кластере](databases.md#list-db), имя пользователя — со [списком пользователей в кластере](cluster-users.md#list-users).

  * Отозвать роли у пользователя:

      ```bash
      {{ yc-mdb-my }} user revoke-permission <имя пользователя> \
        --cluster-name <имя кластера> \
        --database <имя базы данных> \
        --permissions <набор ролей через запятую>
      ```

      Чтобы добавить или отозвать роль `ALL_PRIVILEGES`, передайте в качестве названия роли синоним `ALL`.

- API

  Воспользуйтесь методом API [update](../api-ref/User/update.md) и передайте в запросе:
  - Идентификатор кластера, в котором находится пользователь в параметре `clusterId`. Чтобы узнать идентификатор, [получите список кластеров в каталоге](cluster-list.md#list-clusters).
  - Имя пользователя в параметре `userName`. Чтобы узнать имя, [получите список пользователей в кластере](cluster-users.md#list-users).
  - Имя базы данных, для которой вы хотите изменить список ролей пользователя в параметре `permissions.databaseName`. Чтобы узнать имя, [получите список баз данных в кластере](databases.md#list-db).
  - Массив нового списка ролей пользователя в параметре `permissions.roles`.
  - Список полей конфигурации пользователя подлежащих изменению (в данном случае — `permissions`) в параметре `updateMask`.

  {% note warning %}

  Этот метод API сбросит все настройки пользователя, которые не были явно переданы в запросе, на значения по умолчанию. Чтобы избежать этого, обязательно передайте название поля подлежащего изменению (в данном случае — `permissions`) в параметре `updateMask`.

  {% endnote %}

- Terraform

  1. Откройте актуальный конфигурационный файл {{ TF }} с планом инфраструктуры.

      О том, как создать такой файл, см. в разделе [{#T}](cluster-create.md).

  1. В описании кластера найдите блок `user` с описанием нужного пользователя и измените список его ролей для требуемой БД в параметре `roles`:

      ```hcl
      resource "yandex_mdb_mysql_cluster" "<имя кластера>" {
        ...
        user {
          name     = "<имя пользователя>"
          password = "<пароль>"
          permission {
            database_name = "<имя БД, к которой пользователь должен иметь доступ>"
            roles         = [<список ролей пользователя по отношению к БД>]
            ...
          }
          ...
        }
      }
      ```

  1. Проверьте корректность настроек.

      {% include [terraform-validate](../../_includes/mdb/terraform/validate.md) %}

  1. Подтвердите изменение ресурсов.

      {% include [terraform-apply](../../_includes/mdb/terraform/apply.md) %}

  Подробнее см. в [документации провайдера {{ TF }}]({{ tf-provider-mmy }}).

{% endlist %}

{% include [user-ro](../../_includes/mdb/mmy-user-examples.md) %}
