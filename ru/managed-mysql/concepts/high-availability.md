---
title: Высокая доступность кластера {{ mmy-full-name }}
description: Высокая доступность — это способность системы продолжать работу при отказе одного или нескольких компонентов. Высокая доступность кластера {{ mmy-name }} определяется количеством и расположением его хостов, настройками репликации и другими параметрами кластера.
---

# Высокая доступность кластера {{ mmy-name }}

[Высокая доступность кластера {{ mmy-name }}](../../architecture/fault-tolerance.md#mdb-ha) определяется количеством и расположением его хостов, настройками репликации и другими параметрами кластера.

## Количество и расположение хостов кластера {#host-configuration}

Кластер может состоять из одного или нескольких хостов.

Кластер из одного хоста не обеспечивает высокую доступность. При выходе из строя виртуальной машины хоста-мастера кластер будет недоступен на чтение и запись до окончания работ по восстановлению ВМ. На кластер из одного хоста не распространяется [Соглашение об уровне обслуживания (SLA)](https://yandex.ru/legal/cloud_sla_mdb/).

{% note warning %}

Создавать кластер из одного хоста не рекомендуется.

{% endnote %}

Кластер с двумя хостами, расположенными в разных зонах доступности, считается высокодоступным, и на него распространяется [SLA](https://yandex.ru/legal/cloud_sla_mdb/). Этот вариант подходит для среднеразмерных приложений в production-окружении. Конфигурация кластера по умолчанию, предлагаемая в консоли управления, включает два хоста.

Кластер с тремя и более хостами, расположенными в трех разных зонах доступности, считается высокодоступным, и на него распространяется [SLA](https://yandex.ru/legal/cloud_sla_mdb/). Подходит для production-окружений, в которых предъявляются повышенные требования к доступности и производительности.

{% note info %}

Если для хоста [вручную установлен источник репликации](replication.md#manual-source), такой хост не учитывается при расчете минимального числа хостов, обеспечивающих высокую доступность кластера.

{% endnote %}

## Настройки репликации и переключения мастера {#replication-settings}

Высокая доступность обеспечивается механизмами [репликации и переключения мастера](replication.md), которые имеют следующие особенности:
* В кластере используется механизм автоматического выбора и переключения на новый мастер. При выходе из строя хоста-мастера одна из реплик становится новым мастером. Также можно вручную выбрать новый мастер и [переключиться на него](../operations/update.md#start-manual-failover).
* Для любой реплики можно [вручную выбрать](replication.md#manual-source) хост в качестве источника репликации. Такая реплика не будет задействована в механизме выбора и переключения мастера.
* Если для хоста используется публичный доступ, то для реплик он также должен быть включен, иначе при переключении мастера кластер станет недоступен.
* Использование [FQDN текущего мастера](../operations/connect.md#fqdn-master) упрощает написание приложений, но приводит к временной недоступности кластера при переключении на новый мастер. Для быстрого переключения на новый мастер необходимо реализовать на стороне приложения определение нового мастера.
* В кластерах {{ mmy-name }} используется [полусинхронная репликация](https://dev.mysql.com/doc/refman/5.7/en/replication-semisync.html): по умолчанию мастер ожидает завершения транзакции хотя бы на одной реплике. Минимальное количество реплик, которые должны подтвердить транзакцию, можно увеличить с помощью настройки {{ MY }} [Rpl semi sync master wait for slave count](settings-list.md#setting-rpl-wait-slave-count). Для **Rpl semi sync master wait for slave count** рекомендуется задавать значение не меньше, чем максимальное число хостов в одной зоне, без учета хостов, для которых вручную выбран источник репликации.

## Настройки хранилища {#storage-settings}

Если хранилище баз данных заполнится на 95%, кластер перейдет в режим **Только чтение**. Чтобы кластер оставался доступным на запись, рекомендуется регулярно [проверять свободное место в хранилище](../qa/monitoring.md#disk-space-percentage) или [создать алерт](../qa/read-write.md#write-failure). 

## Настройки обслуживания {#maintenance-settings}

В процессе [технического обслуживания](maintenance.md) кластера и [обновления версии {{ MY }}](../operations/cluster-version-update.md) возможно временное снижение производительности операций чтения и временная недоступность кластера на запись. Поэтому рекомендуется выбирать предпочтительный [день недели и час обслуживания](maintenance.md#maintenance-window), а также момент обновления версии {{ MY }} с учетом предполагаемой нагрузки на него.

## Прочие настройки {#other-settings}

На доступность кластера также могут влиять следующие настройки:

* [настройки резервного копирования](backup.md);
* выбранный [тип дисков хранилища](storage.md);
* [классы хостов](instance-types.md);
* [квоты и лимиты](limits.md);
* [настройка групп безопасности](../operations/connect.md#configuring-security-groups);
* Настройки {{ MY }} [Max connections](settings-list.md#setting-max-connections) и [Sync binlog](settings-list.md#setting-sync-binlog).
