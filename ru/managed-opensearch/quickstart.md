# Как начать работать с {{ mos-name }}

Чтобы начать работу с сервисом:
1. [{#T}](#create-cluster).
1. [{#T}](#configure-security-groups).
1. [{#T}](#connect).
1. [{#T}](#dashboards-connect).

## Перед началом работы {#before-you-begin}

1. Войдите в [консоль управления]({{ link-console-main }}) или зарегистрируйтесь, если вы еще не зарегистрированы.

1. Если у вас еще нет каталога, создайте его:

   {% include [create-folder](../_includes/create-folder.md) %}

1. Подключитесь к кластеру {{ OS }}. Это можно сделать как из {{ yandex-cloud }}, так и из интернета:

   * Чтобы подключиться изнутри {{ yandex-cloud }}, [создайте виртуальную машину](../compute/quickstart/quick-create-linux.md) на основе Linux в той же сети, что и кластер.

   
   * Чтобы подключиться к кластеру из интернета, запросите публичный доступ к хостам с ролью _Data node_ при создании кластера.


{% note info %}

Эта инструкция предполагает, что подключение к кластеру производится из интернета.

{% endnote %}

## Создайте кластер {#create-cluster}

1. В [консоли управления]({{ link-console-main }}) выберите каталог, в котором нужно создать кластер.
1. Выберите сервис **{{ mos-name }}**.
1. Нажмите кнопку **Создать кластер**. 
1. Задайте параметры кластера.

   Чтобы получить доступ к веб-интерфейсу {{ OS }} Dashboards, запросите публичный доступ — для этого в блоке **Ресурсы** → **Data node** выберите опцию **Публичный доступ**.

   {% include [mos-tip-public-dashboards](../_includes/mdb/mos/tip-connecting-to-public-dashboards.md) %}

1. Нажмите кнопку **Создать**.
1. Дождитесь, когда кластер будет готов к работе: его статус на панели {{ mos-name }} сменится на **Creating** и далее — на **Alive**. Это может занять некоторое время.

## Настройте группы безопасности {#configure-security-groups}


Настройте группы безопасности для облачной сети так, чтобы был разрешен весь необходимый трафик между кластером и хостом, с которого выполняется подключение.


Настройки правил будут различаться в зависимости от выбранного способа подключения:

{% list tabs %}

- Через интернет

  [Настройте все группы безопасности](../vpc/operations/security-group-add-rule.md) кластера так, чтобы они разрешали входящий трафик с любых IP-адресов на порты 443 (Dashboards) и 9200 ({{ OS }}). Для этого создайте следующие правила для входящего трафика:

   - Диапазон портов — `443`, `9200`.
   - Протокол — `TCP`.
   - Источник — `CIDR`.
   - CIDR-блоки — `0.0.0.0/0`.

  На каждый порт создается отдельное правило.

- С ВМ в Облаке

   1. [Настройте все группы безопасности](../vpc/operations/security-group-add-rule.md) кластера так, чтобы они разрешали входящий трафик из группы безопасности, в которой находится ВМ, на порты 443 (Dashboards) и 9200 ({{ OS }}). Для этого создайте в этих группах следующие правила для входящего трафика:

        - Протокол — `TCP`.
        - Диапазон портов — `443`, `9200`.
        - Источник — `Группа безопасности`.
        - Группа безопасности — если кластер и ВМ находятся в одной и той же группе безопасности, выберите значение `Текущая` (`Self`). В противном случае укажите группу безопасности ВМ.

        На каждый порт создается отдельное правило.

   1. [Настройте все группы безопасности](../vpc/operations/security-group-add-rule.md), в которых находится ВМ так, чтобы можно было подключаться к ВМ и был разрешен трафик между ней и хостами кластера.

        Пример правил для ВМ:

        - Для входящего трафика:

            - Диапазон портов — `22`, `443`, `9200`.
            - Протокол — `TCP`.
            - Источник — `CIDR`.
            - CIDR-блоки — `0.0.0.0/0`.

            На каждый порт создается отдельное правило.

        - Для исходящего трафика:

            - Диапазон портов — `{{ port-any }}`.
            - Протокол — `Любой` (`Any`).
            - Назначение — `CIDR`.
            - CIDR-блоки — `0.0.0.0/0`.

            Это правило разрешает любой исходящий трафик, что позволяет не только подключаться к кластеру, но и устанавливать на ВМ необходимые для этого сертификаты и утилиты.

{% endlist %}

{% note info %}

Вы можете задать более детальные правила для групп безопасности, например, разрешающие трафик только в определенных подсетях.

Группы безопасности должны быть корректно настроены для всех подсетей, в которых будут размещены хосты кластера. При неполных или некорректных настройках групп безопасности можно потерять доступ к кластеру.

{% endnote %}


## Подключитесь к кластеру {#connect}

Предполагается, что все перечисленные ниже шаги выполняются на Linux.

Чтобы подключиться к кластеру:

1. Установите SSL-сертификат:

   {% include [install-certificate](../_includes/mdb/mos/install-certificate.md) %}

1. Подключитесь к кластеру с помощью утилиты [cURL](https://curl.haxx.se/):

   {% include [default-connstring](../_includes/mdb/mos/default-connstring.md) %}

   Для подключения нужно использовать имя пользователя и пароль, которые были заданы при [создании кластера](#create-cluster).

   При успешном подключении будет выведено похожее сообщение:

   ```bash
   {
     "name" : "....{{ dns-zone }}",
     "cluster_name" : "...",
     "cluster_uuid" : "...",
     ...
     "tagline" : "You Know, for Search"
   }
   ```

## Подключитесь к {{ OS }} Dashboards {#dashboards-connect}

1. Подключитесь с помощью браузера к веб-интерфейсу [{{ OS }} Dashboards]({{ os.docs }}/dashboards/index/):

   1. Установите [SSL-сертификат](https://{{ s3-storage-host }}{{ pem-path }}) в хранилище доверенных корневых сертификатов браузера ([инструкция](https://wiki.mozilla.org/PSM:Changing_Trust_Settings#Trusting_an_Additional_Root_Certificate) для Mozilla Firefox).
   1. Перейдите в браузере по адресу `https://<FQDN публично доступного хоста {{ OS }} с ролью Data node>`.
   1. Введите имя пользователя и пароль, которые были заданы при [создании кластера](#create-cluster).

1. Исследуйте набор тестовых данных:

   1. На приветственном экране {{ OS }} Dashboards нажмите кнопку **Add sample data**.
   1. Нажмите кнопку **View data** для интересующего набора данных.

Подробнее о работе с {{ OS }} Dashboards см. в [документации {{ OS }}]({{ os.docs }}/dashboards/index/).

