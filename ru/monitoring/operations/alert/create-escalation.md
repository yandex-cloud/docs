---
title: Как создать политику эскалаций
description: В этой статье вы узнаете, как создать и настроить политику эскалаций для своевременного оповещения пользователей о критических событиях.
---

# Создание политики эскалаций

{% include [escalations-preview](../../../_includes/monitoring/escalations-preview.md) %}


@[youtube](https://youtu.be/iAGfn-I0CtY)


{% include [escalations-definition](../../../_includes/monitoring/escalation-definition.md) %}

## Предварительные действия {#before-you-begin}

Убедитесь, что вы добавили [получателей](../../concepts/alerting/notification-channel.md#channel-parameters) и они имеют нужные роли.

## Создание политики {#create-escalation}

1. На странице сервиса {{ monitoring-name }} на панели слева выберите **{{ ui-key.yacloud_monitoring.aside-navigation.menu-item.escalations.title }}**.
1. Нажмите кнопку **{{ ui-key.yacloud.common.create }}**.
1. Укажите **Имя** и **Описание** (опционально).

1. Выберите расписание эскалации:
 
   * **24/7** — отправка уведомлений каждый день в любое время.

   * **Рабочие часы** — отправка уведомлений в рабочие дни с 10:00 до 21:00 по Московскому времени (часовой пояс UTC+3). Выходные и праздничные дни определяются производственным календарем РФ.

   * **Пользовательская настройка** — отправка уведомлений по индивидуальному расписанию:

      * **Страна** — будет учитываться производственный календарь выбранной страны.

        {% note info %}

        Чтобы учитывать разные наборы выходных и праздничных дней в распределенных командах, создайте несколько эскалаций для разных стран.

        {% endnote %}

      * **Часовой пояс** — может не соответствовать выбранной стране.
      * **Не уведомлять в выходные и праздники** — выходные и праздничные дни будут соответствовать производственному календарю выбранной страны.
      * **Часы отправки** — время начала и окончания интервала отправки уведомлений в выбранном часовом поясе. Чтобы отправлять уведомления круглосуточно, нажмите ![image](../../../_assets/console-icons/xmark.svg) напротив этой настройки.
      * **Дни отправки** — дни недели, в которые эскалация будет отправлять уведомления. Чтобы отправлять уведомления каждый день, отметьте все дни или удалите эту настройку.

        {% note info %}

        У настройки **Не уведомлять в выходные и праздники** приоритет выше, чем у **Дни отправки**. Поэтому в выходные и праздничные дни уведомления отправляться не будут независимо от выбранных дней отправки.

        {% endnote %}

1. Настройте шаги эскалации — последовательность каналов и параметры отправки уведомлений:

    * **Начальная задержка** — задержка первой итерации при запуске эскалации, по умолчанию — 2 минуты. Чтобы начать эскалацию без задержки, удалите значение из этого поля.
    * Укажите параметры первого шага эскалации: 
      * **Метод** — [метод уведомления](../../concepts/alerting/notification-channel.md#channel-parameters):
       
          {% include [escalation-channels](../../../_includes/monitoring/escalation-channels.md) %}

      * **Задержка после шага** — задержка перед переходом к следующему шагу, если уведомление успешно доставлено, но эскалация не остановлена. Задержку можно установить в секундах или минутах. Например: `30s`, `10m` или `3m30s`.
      
        Задержка по умолчанию — `30m`. Чтобы отправлять уведомление следующего шага без задержки, удалите значение из поля.

        {% note warning %}

        Для телефонных звонков, независимо от настроек шага эскалации и начальной задержки, будет применяться минимальный период задержки — 1 минута.

        {% endnote %}

        {% note info %}

        Если шаг неуспешный, то переход к следующему шагу будет без задержки. Для последнего шага в итерации задержка перед переходом к следующей итерации сработает независимо от успешности шага.

        {% endnote %}

      * **Игнорировать при повторе** — опция, позволяющая отправить уведомление на этом шаге эскалации только один раз и при последующих повторах игнорировать этот шаг. Например, если вы хотите отправить только одно письмо о случившейся проблеме.
      * **Получатель** — список получателей уведомления.
        
        В качестве получателя нужно указать аккаунт в {{ yandex-cloud }}. Это может быть аккаунт владельца или [дополнительный аккаунт](../../../iam/concepts/users/accounts.md), например федеративный аккаунт или Яндекс ID.
    * Чтобы добавить еще одно уведомление, нажмите кнопку **Добавить шаг** и укажите параметры уведомления.
        
      Количество шагов эскалации не ограничено.

1. Перетаскивайте шаги, чтобы выстроить нужный порядок эскалации.
1. Нажмите **{{ ui-key.yacloud_monitoring.actions.common.create }}**.

На странице справа появится созданная политика эскалаций.

## Добавление политики в алерт {#add-to-alert}

1. На странице сервиса [{{ monitoring-name }}]({{ link-monitoring }}) на панели слева выберите **{{ ui-key.yacloud_monitoring.aside-navigation.menu-item.alerts.title }}**.
1. Откройте для редактирования или [создайте алерт](create-alert.md).
1. Добавьте [способ уведомления](../../operations/alert/create-alert.md) и выберите в списке политику эскалаций.

Когда алерт перейдет в статус **Alarm**, эскалация запустится. У всех получателей в интерфейсе сервиса {{ monitoring-short-name }} появится всплывающее окно, а также начнут приходить уведомления согласно настроенной политике. Если алерт перейдет в любой другой статус, эскалация остановится.

## Просмотр уведомлений {#view-notifications}

Чтобы отслеживать отправку уведомлений по эскалациям: 
* Добавьте виджет на [дашборд](../dashboard/add-widget.md#escalation).
* Перейдите в раздел **{{ ui-key.yacloud_monitoring.aside-navigation.menu-item.notification-feed.title }}**.

## Обновление политики эскалаций {#escalation-update}

1. На странице сервиса {{ monitoring-name }} на панели слева выберите **{{ ui-key.yacloud_monitoring.aside-navigation.menu-item.escalations.title }}**.
1. Напротив политики эскалации нажмите ![image](../../../_assets/console-icons/ellipsis.svg) и выберите **{{ ui-key.yacloud.common.edit }}**.
1. Укажите новые параметры политики.
1. Нажмите **{{ ui-key.yacloud_monitoring.actions.common.save }}**.

При редактировании уже запущенной эскалации изменения будут учтены в следующей итерации.