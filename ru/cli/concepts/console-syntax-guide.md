# Управление ресурсами {{yandex-cloud}} с помощью командной строки в операционной системе Windows

Управление ресурсами и сервисами в {{yandex-cloud}} может осуществляться как интерактивно, из [консоли управления]({{ link-console-main }}) {{yandex-cloud}} (в браузере), так и программно, через [API](../../api-design-guide/concepts/general.md) или командную строку, например, с помощью [интерфейса командной строки {{ yandex-cloud }}](../../cli/quickstart.md) CLI. В справке {{yandex-cloud}} команды CLI и другие системные команды часто приводятся только в синтаксисе командной оболочки Bash, доступной в Unix-подобных операционных системах (Linux, macOS и т. п.). 
Если вы для управления ресурсами {{yandex-cloud}} используете рабочие станции с операционной системой Windows, необходимо установить программное обеспечение, поддерживающее интерфейс командной оболочки Bash, либо адаптировать команды под синтаксис интерфейса командной строки, который вы используете (cmd, PowerShell и т. п.).

## Установите программное обеспечение с поддержкой Bash {#soft-bash}

Для того, чтобы использовать командные оболокчки с синтаксисом Bash, на рабочей станции с ОС Windows должна быть установлена [Windows Subsystem for Linux](https://ru.wikipedia.org/wiki/Windows_Subsystem_for_Linux).

1. Проверьте, установлена ли WSL на вашей рабочей станции, выполнив в терминале cmd или PowerShell команду:

   ```
   wsl -u root
   ```

   Ожидаемый результат:

   ```
   root@<имя_компьтера>:/mnt/c/Users/<имя_пользователя>#
   ```

   В этом случае, WSL установлена и командная строка переведена в режим командной оболочки Bash.

1. Если WSL не установлена, [установите](https://learn.microsoft.com/en-us/windows/wsl/install) ее.
1. Дополнительно можно установить терминал командной строки, например, [Ubuntu on WSL](https://ubuntu.com/wsl). 
1. Также существуют эмуляторы оболочки Bash, такие как [Git Bash](https://www.atlassian.com/git/tutorials/git-bash), однако они имеют ограниченную функциональность. 

## Адаптируйте код для нативных командных оболочек Windows {#adapt-commands}

Если вы хотите использовать код, записанный в синтаксисе Bash, в нативной командной оболочке, приведите его к соответствующему виду:

1. [Замените элементы базового синтаксиса](#basic-syntax).
1. [Проверьте формат одноименных команд](#basic-syntax).
1. [Замените прочие команды на аналоги](#replace-analogs).
1. [Проверьте имена системных переменных и вспомогательный синтаксис](#replace-analogs).

### Замените элементы базового синтаксиса {#basic-syntax}

1. Поменяйте разделитель каталогов в путях файлов, в Linux для этого служит прямая косая черта `/`, в Windows - обратная `\`.
1. Поменяйте символы переноса строки (вместо принятой в Linux обратной косой черты в cmd используется символ карет `^`, а в PowerShell - обратный апостроф  `` ` ``).
1. Проверьте правила использования всех видов кавычек. Для примера сравните [правила использования кавычек в Linux](http://mywiki.wooledge.org/Quotes) и [правила использования кавычек в PowerShell](https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_quoting_rules?view=powershell-7).
1. Проверьте синтаксис использования переменных. 

   {% cut "Пример синтаксиса использования переменных" %}

      | Linux | Windows cmd | Windows PowerShell | Описание |
      |-------|-------|-------|--------|
      |`export VAR="1"`|`set VAR="1"`|`$Env:VAR="1"`|запись переменной|
      |`${VAR}`|`%VAR%`|`$Env:VAR`|чтение переменной|

   {% endcut %}

### Проверьте формат одноименных команд {#check-format}

У многих команд оболочек cmd и PowerShell есть псевдонимы, одноименные командам Bash. Например, к команде оболочки PowerShell `Set-Location` (перейти в другой каталог) можно обратиться привычным `cd`.
Если код отрабатывает с ошибками:

1. Проверьте, что у команды в оболочке Bash есть одноименная команда в вашей командной оболочке. Например, в PowerShell выполните:

   ```
   alias
   ```

   Результат:

   ```
   CommandType     Name                            Version    Source
   -----------     ----                            -------    ------
   Alias           % -> ForEach-Object
   Alias           ? -> Where-Object
   Alias           ac -> Add-Content
   Alias           asnp -> Add-PSSnapin
   Alias           cat -> Get-Content
   Alias           cd -> Set-Location
   Alias           CFS -> ConvertFrom-String       3.1.0.0    Microsoft.PowerShell.Utility
   Alias           chdir -> Set-Location
   Alias           clc -> Clear-Content
   Alias           clear -> Clear-Host

   ...

   ```

   Видно, что у команд оболочки Bash `cd`, `cat`, `clear` и т. д. есть одноименные псевдонимы команд в оболочке PowerShell.

1. Убедитесь, что команда в вашей командной оболочке выполняет ту же функцию, что и одноименная команда в оболочке Bash.
1. Проверьте формат команды: часто аргументы команды передаются с помощью различающихся ключей. Например, команда `ls` имеет одноименный псевдоним в оболочке PowerShell, однако ключи аргументов не совпадают.

### Замените прочие команды на аналоги {#replace-analogs}

1. Если команда не имеет одноименного псевдонима, найдите ее аналог.

   {% cut "Примеры соответствий имен команд в Linux, cmd и PowerShell" %}

      | Linux | Windows cmd | Windows PowerShell | описание |
      |-------|------|------|-------|
      | `ls -s` | `dir` | `dir`, `ls`, `Get-ChildItem` | содержимое каталога |
      | `ls -R` | `tree` | `ls`, `Get-ChildItem` | вывод содержимого каталога с рекурсией |
      | `touch` | `copy nul > `| `New-Item` | создание файла |
      | `mv` | `ren` | `ren`, `Rename-Item` | переименование файла |
      | `cp` | `copy` | `copy`, `Copy-Item` | копирование файла |
      | `mv` | `move` | `move`, `Move-Item` | перемещение файла |
      | `rm` | `del` | `del`, `Remove-Item` | удаление файла |
      | `diff` | `fc` | `diff`, `Get-Content`, `Compare-Object` | сравнение содержимого файлов |
      | `grep` | `find` | `Select-String`, `Where-Object` | поиск строки в файле, свойства объекта |
      | `man <команда>` | `<команда> /?` | `Get-Help <команда>` |справка по команде |
      | `pwd` | `cd` | `$PWD` | имя текущего каталога |
      | `mkdir` | `md` | `mkdir`, `New-Item` | создание каталога |
      | `date` | `time` | `Get-Date` | текущая дата и время |
      | `mke2fs`, `mformat` | `format` | `New-Partition`, `Format-Custom` | форматирование раздела или диска |
      | `kill` | `taskkill` | `taskkill`, `Stop-Process` | удаление задания |
      | `ps x` | `tasklist` | `tasklist`, `Get-Process` | список задач |
      | `chown`, `chmod` | `attrib` | `attrib`, `Set-XFileOwner` | установка разрешений доступа к файлу |
      | `cron` | `at` | `schtasks`, `Register-ScheduledJob` | выполнение команд и управление заданиями по таймеру |
      | `wget` | `wget` | `Invoke-WebRequest` | обращение HTTP к веб-ресурсу |

   {% endcut %}

1. Если прямого аналога команды нет, то возможно действие выполнимо комбинацией команд или другими методами. Например, вместо утилиты Linux `Base64.exe` в PowerShell нужно использовать статический метод класса Convert: `[Convert]::ToBase64String([IO.File]::ReadAllBytes(''имяфайла''))`.
1. Учитывайте специфику вашей командной оболочки. Например, PowerShell работает не с текстом, а с объектами и их свойствами, поэтому вместо поиска по строке `grep` в большинстве случаев используется команда PowerShell `Where-Object`, позволяющая отобрать объекты с нужными значениями свойств. Если же нужно осуществить именно поиск в строке, то используйте команду PowerShell `Select-String`.

### Проверьте имена системных переменных и вспомогательный синтаксис {#replace-analogs}

1. Проверьте имена переменных среды. Например, вместо переменной среды Linux `USER` в Windows используется переменная `USERNAME`. 
1. Если код содержит операторы сравнения, ветвления или циклы, измените синтаксис в соответствии с требованиями вашей командной оболочки. Например, подробнее о разнице вспомогательного синтаксиса оболочек Bash и PowerShell см. [здесь](https://blog.ironmansoftware.com/daily-powershell/bash-powershell-cheatsheet).

