---
title: Диагностика медленной записи в {{ yds-full-name }}
description: В этом руководстве описан пошаговый процесс поиска проблем с квотами на запись в {{ yds-full-name }} и их решения.
---

# Диагностика медленной записи в {{ yds-full-name }}

Если вы заметили, что скорость записи в {{ yds-full-name }} снизилась, то причиной чаще всего является достижение [лимита](../concepts/limits.md#yds-limits) на запись.

**Есть два основных лимита, из-за которых может замедляться запись:**
* Максимальная скорость записи данных в один [сегмент](../concepts/glossary.md#shard) по умолчанию составляет 1 МБ/с.
* Максимальный объем занимаемого топиком места - зависит от лимитов базы данных {{ ydb-short-name }}.

## Лимит на запись в сегмент

### Диагностика

{% list tabs group=instructions %}

- Консоль управления {#console}

    1. В [консоли управления](https://console.yandex.cloud/) выберите каталог, в котором хотите изменить настройки потока данных.
    1. Выберите сервис **Data Streams**.
    1. Выберите поток данных, по которому вы хотите проверить использование лимитов.
    1. Перейдите на вкладку **Мониторинг**.
    1. Выберите вкладку **Quota Usage**.
    1. Посмотрите на первый график - **Partition write quota usage max**.

{% endlist %}

Если видите на графике, что использование квоты записи приближается к 100%, значит поток данных ограничивается именно этим лимитом — система намеренно замедляет запись, чтобы не превышать максимальное разрешённое значение.

### Решение

Увеличить лимит на запись в одном сегменте невозможно. Если вы достигли этого предела, решением будет увеличение количества сегментов в топике. В результате данные будут записываться параллельно в несколько сегментов, и общая пропускная способность возрастет.

Чтобы увеличить количество сегментов следуйте шагам в [инструкции по изменению потока данных](../operations/manage-streams.md#edit-data-stream).

## Лимит на объем занимаемого места в базе {{ ydb-short-name }}

### Диагностика

{% list tabs group=instructions %}

- Консоль управления {#console}

    1. В [консоли управления](https://console.yandex.cloud/) выберите каталог, в котором хотите изменить настройки потока данных.
    1. Выберите сервис **Data Streams**.
    1. Выберите поток данных, по которому вы хотите проверить использование лимитов.
    1. Перейдите на вкладку **Мониторинг**.
    1. Выберите вкладку **Quota Usage**.
    1. Посмотрите на второй график - **Storage usage**.

{% endlist %}

Если на графике занятое место близко к 100%, то запросы на запись скорее всего падают с ошибками из-за недостатка места.

### Решение

Чтобы освободить место и восстановить возможность записывать данные, выполните одно из следующих действий:

* Удалите ненужные данные из базы {{ ydb-short-name }} вручную.
- [Уменьшите срок хранения сообщений в вашем дата-стриме](../operations/manage-streams.md#edit-data-stream) — это приведет к автоматическому удалению старых данных;
* Увеличьте лимит на объем хранимых данных в {{ ydb-short-name }}, чтобы расширить доступное пространство для записи. Для этого необходимо:
    1. В [консоли управления](https://console.yandex.cloud/) выберите каталог, в котором хотите изменить настройки потока данных.
    1. Выберите сервис **Data Streams**.
    1. Выберите поток данных, по базе которого вы хотите увеличить лимит на объём хранимых данных.
    1. Перейдите на страницу **Обзор** потока данных.
    1. В разделе **Доступ** кликните на ссылку в поле **База данных**.
    1. Увеличьте объем по [инструкции](../../ydb/operations/manage-databases.md).