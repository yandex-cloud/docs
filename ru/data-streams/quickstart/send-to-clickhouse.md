# Сохранение данных в {{ CH }}

Чтобы сохранять данные из {{ yds-full-name }} в {{ CH }}, создайте:
* [кластер {{ mch-full-name }}](../../managed-clickhouse/operations/cluster-create.md);
* [эндпоинт для источника](#source);
* [эндпоинт для приемника](#destination);
* [трансфер](#transfer).

## Создать эндпоинт для источника {#source}

{% list tabs %}

- Консоль управления

  1. В [консоли управления]({{ link-console-main }}) выберите каталог, в котором находится поток данных.
  1. Выберите сервис **{{ yds-full-name }}**.
  1. Выберите поток данных.
  1. Нажмите кнопку **Действия**, выберите пункт **Создать трансфер данных**.
  1. На странице **Создание эндпойнта**, в поле **Направление**, выберите значение **Источник**.
  1. Введите имя и описание источника. Требования к имени:

      {% include [name-format](../../_includes/name-format.md) %}

  1. Выберите тип базы данных **Yandex Data Stream**.
  1. Выберите базу данных {{ ydb-short-name }}, в которой был создан поток данных.
  1. Введите имя потока данных, из которого будут читаться данные.
  1. Укажите сервисный аккаунт, который будет использоваться для чтения данных.
  1. В блоке **Правила конвертации** настройте схему данных:
      * Укажите формат данных **JSON**.
      * Выберите схему данных **Список полей**.
      * Добавьте поля `user_id` и `score`. Тип полей — `UINT32`.
  1. Нажмите кнопку **Создать**.

{% endlist %}

## Создать эндпоинт для приемника {#destination}

{% list tabs %}

- Консоль управления

  1. В [консоли управления]({{ link-console-main }}) выберите каталог, в котором находится поток данных.
  1. Выберите сервис **{{ yds-full-name }}**.
  1. Выберите поток данных.
  1. Нажмите кнопку **Действия**, выберите пункт **Создать трансфер данных**.
  1. На странице **Создание эндпойнта**, в поле **Направление**, выберите значение **Приемник**.
  1. Введите имя и описание приемника. Требования к имени:

      {% include [name-format](../../_includes/name-format.md) %}

  1. Выберите тип базы данных **{{ CH }}**.
  1. Выберите тип подключения **MDB кластер**.
  1. Укажите имя {{ CH }}-кластера, пользователя, пароль и базу данных.
  1. Нажмите кнопку **Создать**.

{% endlist %}

## Создать трансфер {#transfer}

{% list tabs %}

- Консоль управления

  1. В [консоли управления]({{ link-console-main }}) выберите каталог, в котором находится поток данных.
  1. Выберите сервис **{{ data-transfer-full-name }}**.
  1. Перейдите на вкладку **Трансферы**.
  1. Нажмите кнопку **Создать трансфер**.
  1. Введите имя и описание трансфера. Требования к имени:

      {% include [name-format](../../_includes/name-format.md) %}

  1. Выберите эндпоинты для источника и приемника.
  1. Нажмите кнопку **Создать**.

  В списке трансферов, справа от имени трансфера, нажмите значок ![horizontal-ellipsis](../../_assets/horizontal-ellipsis.svg) и выберите **Активировать**. Статус трансфера изменится на `Создается`.

{% endlist %}

Через некоторое время трансфер перейдет в статус `Реплицируется`. В базе данных {{ CH }} появится таблица с тем же именем, что и поток данных {{ yds-name }}. В ней будут перенесенные данные.
