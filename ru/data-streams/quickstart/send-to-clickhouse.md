# Сохранение данных в {{ CH }}

В этом разделе вы узнаете, как настроить сохранение данных из {{ yds-full-name }} в [{{ CH }}](https://clickhouse.tech/).

## Создайте кластер {{ mch-full-name }} {#cluster-create}

[Создайте кластер {{ mch-full-name }}](../../managed-clickhouse/operations/cluster-create.md), в который будут сохраняться данные из потоков передачи {{yds-name}}.

## Создайте эндпоинт-источник {#source}

{% list tabs %}

- Консоль управления

  1. В [консоли управления]({{ link-console-main }}) выберите каталог, в котором находится поток данных.
  1. В списке сервисов выберите **{{ yds-full-name }}**.
  1. Нажмите на имя созданного ранее потока данных.
  1. Нажмите кнопку **Действия**, выберите пункт **Создать трансфер данных**.
  1. В разделе **Создание эндпойнта** выберите в поле **Направление** значение **Источник**.
  1. Введите имя источника, например `yds-example-source`.
  1. Выберите тип источника **YDS**.
  1. Выберите базу данных {{ ydb-short-name }}, в которой был создан поток данных {{ yds-name }}.
  1. Введите имя [созданного ранее потока данных](create-stream.md) {{ yds-name }}, из которого будут читаться данные.
  1. Укажите [созданный ранее сервисный аккаунт](aws.md#sa), который будет использоваться для чтения данных из {{ yds-name }}.
  1. В блоке **Правила конвертации** настройте схему данных:
     * Укажите формат данных **JSON**.
     * Выберите схему данных **Список полей**.
     * Добавьте новое поле с именем `user_id` и типом `UINT32`.
     * Добавьте новое поле с именем `score` и типом `UINT32`.
  1. Нажмите кнопку **Создать**.

{% endlist %}

## Создайте эндпоинт-приемник {#destination}

{% list tabs %}

- Консоль управления

  1. Нажмите кнопку **Создать эндпоинт**.
  1. В поле **Направление** выберите **Приемник**.
  1. Введите имя приемника, например `ch-example-destination`.
  1. Выберите тип базы данных **{{ CH }}**.
  1. Выберите тип подключения **MDB кластер**.
  1. В поле **MDB кластер** введите имя созданного ранее {{ CH }}-кластера.
  1. В полях **Пользователь**, **Пароль** и **База данных** укажите атрибуты, которые вы вводили при создании {{ CH }}-кластера.
  1. Нажмите кнопку **Создать**.

{% endlist %}

## Создайте трансфер {#transfer}

{% list tabs %}

- Консоль управления

  1. В [консоли управления]({{ link-console-main }}) выберите каталог, в котором находится поток данных.
  1. В списке сервисов выберите **{{ data-transfer-full-name }}**.
  1. Перейдите на вкладку **Трансферы**.
  1. Нажмите кнопку **Создать трансфер**.
  1. Введите имя трансфера, например `yds-to-ch-example`.
  1. Выберите эндпоинт-источник, например `yds-example-source`.
  1. Выберите эндпоинт-приемник, например `ch-example-destination`.
  1. Нажмите кнопку **Создать**.
  1. В списке трансферов найдите созданный трансфер, справа от имени трансфера нажмите значок ![horizontal-ellipsis](../../_assets/horizontal-ellipsis.svg) и выберите **Активировать**. Статус трансфера изменится на **Создается**.

{% endlist %}

В случае правильного указания всех параметров, трансфер через некоторое время перейдет в состояние **Реплицируется**. В базе данных {{ CH }} появится таблица с тем же именем, что и поток данных {{ yds-name }}, в которой будут перенесенные данные.