---
title: "{{ mpg-name }}. Ответы на вопросы"
description: "Что такое {{ mpg-name }}? Для каких задач стоит использовать {{ mpg-name }}, а для каких — виртуальные машины с базами данных? Какую часть работы по управлению и сопровождению баз данных берет на себя {{ mpg-name }}? Ответы на эти и другие вопросы в данной статье."
---

# Общие вопросы про {{ mpg-name }}

#### Что такое {{ mpg-short-name }}? {#what-is}

{{ mpg-short-name }} — это сервис, который помогает вам создавать, эксплуатировать и масштабировать базы данных {{ PG }} в облачной инфраструктуре.

С {{ mpg-short-name }} вы можете:
* создавать базы данных с необходимыми параметрами производительности;
* масштабировать вычислительные мощности и выделенный объем хранилища для баз данных по мере необходимости;
* получать журналы работы баз данных.

{{ mpg-short-name }} берет на себя трудоемкие задачи администрирования инфраструктуры {{ PG }}:
* предоставляет мониторинг потребляемых ресурсов;
* автоматически создает резервные копии баз данных;
* обеспечивает отказоустойчивость за счет автоматического переключения на резервные реплики;
* своевременно обновляет программное обеспечение СУБД.

Вы взаимодействуете с кластером БД в {{ mpg-short-name }} как с обычной базой данных в вашей локальной инфраструктуре. Благодаря этому вы можете управлять внутренними настройками БД в соответствии с требованиями вашего приложения.

#### Какую часть работы по управлению и сопровождению баз данных берет на себя {{ mpg-short-name }}? {#services}

При создании кластеров {{ mpg-short-name }} выделяет ресурсы, устанавливает СУБД и создает базы данных.

Для созданных и запущенных баз данных {{ mpg-short-name }} автоматически создает резервные копии, а также устанавливает исправления и обновления СУБД.

Также {{ mpg-short-name }} обеспечивает репликацию данных между хостами БД (как внутри, так и между зонами доступности) и автоматически переключает нагрузку на резервную реплику в случае аварии.

#### Для каких задач стоит использовать {{ mpg-short-name }}, а для каких — виртуальные машины с базами данных? {#mdb-advantage}

{{ yandex-cloud }} предлагает два варианта работы с базами данных:
* {{ mpg-short-name }} позволяет вам эксплуатировать шаблонные базы данных, не заботясь об администрировании.
* Виртуальные машины {{ compute-full-name }} позволяют вам создавать и настраивать собственные базы данных. Такой подход позволяет использовать любые СУБД, подключаться к базам данных по [SSH](../../glossary/ssh-keygen.md) и так далее.

#### Что такое хост базы данных и кластер базы данных? {#what-is-cluster}

_Хост БД_ — это изолированная среда базы данных в облачной инфраструктуре с выделенными вычислительными ресурсами и зарезервированным объемом хранилища данных.

_Кластер БД_ — это один или более хостов БД, между которыми можно настроить репликацию.

#### Как начать работу с {{ mpg-short-name }}? {#quickstart}

{{ mpg-short-name }} доступен всем зарегистрированным пользователям {{ yandex-cloud }}.

Чтобы создать кластер базы данных в {{ mpg-short-name }}, необходимо определиться с его характеристиками:
* [Класс хостов](../../managed-postgresql/concepts/instance-types.md) (характеристики производительности — процессоры, память и т. п.).
* Объем хранилища (резервируется в полном объеме при создании кластера).
* Сеть, к которой будет подключен ваш кластер.
* Количество хостов для кластера и зона доступности для каждого хоста вы можете выбрать зону доступности.

Подробные инструкции см. в разделе [{#T}](../../managed-postgresql/quickstart.md).

#### Сколько хостов БД может содержать кластер? {#how-many-hosts}

Минимальное количество хостов зависит от типа используемого [хранилища](../../managed-postgresql/concepts/storage.md):
* при использовании хранилища на нереплицируемых SSD-дисках (`network-ssd-nonreplicated`) или на локальных SSD-дисках (`local-ssd`) — не менее 3;
* при использовании хранилища на сетевых SSD-дисках (`network-ssd`) или на сетевых HDD-дисках (`network-hdd`) допускается создание кластера из одного хоста.



Максимальное количество хостов в кластере ограничено только запрошенными вычислительными ресурсами и объемом хранилища для кластера.

Подробнее см. в разделе [{#T}](../../managed-postgresql/concepts/limits.md).

#### Как получить доступ к запущенному хосту базы данных? {#db-access}

Вы можете подключаться к базам данных {{ mpg-short-name }} способами, стандартными для СУБД.

[Подробнее о подключении к кластерам](../../managed-postgresql/operations/connect.md).

#### Сколько кластеров можно создать в рамках одного облака? {#db-limit}

Технические и организационные ограничения MDB приведены в разделе [{#T}](../../managed-postgresql/concepts/limits.md).

#### Как происходит обслуживание кластеров БД? {#service-window}

Под обслуживанием в {{ mpg-short-name }} понимается:

* автоматическая установка обновлений и исправлений СУБД для хостов БД (в т. ч. для выключенных кластеров);
* изменение класса хостов и объема хранилища;
* другие сервисные работы {{ mpg-short-name }}.

Подробнее в разделе [{#T}](../../managed-postgresql/concepts/maintenance.md).

#### Какую версию {{ PG }} использует {{ mpg-short-name }}? {#dbms-version}

{{ mpg-short-name }} поддерживает {{ PG }} 11, 12, 13 и 14, а также PostgreSQL 11, 12, 13 и 14 для 1C.

#### Какую версию {{ PG }} и какие настройки лучше использовать при создании базы данных для 1С? {#1c-version}

Рекомендуется использовать {{ PG }} версии 12-1c (актуально на март 2022 года). Проверка работы этой версии была выполнена с версией 1С 8.3.18 — работа с более ранними версиями 1С не гарантирована.

Нужные для оптимизации работы настройки кластера уточняйте в службе поддержки 1С.

#### Что происходит, когда выпускается новая версия СУБД? {#new-version}

Программное обеспечение баз данных обновляется при выходе новых минорных версий. Владельцы затронутых кластеров БД получают предварительное оповещение о сроках проведения работ и доступности баз данных.

#### Что происходит, когда версия СУБД становится неподдерживаемой (deprecated)? {#dbms-deprecated}

Через месяц после того, как версия СУБД становится неподдерживаемой, {{ mpg-short-name }} автоматически оповещает владельцев кластеров БД, созданных с этой версией, по электронной почте.

Создание новых хостов с СУБД неподдерживаемых версий становится невозможным. Через 7 дней после оповещения для минорных версий и через 1 месяц для мажорных версий проводится автоматическое обновление кластеров БД до следующей поддерживаемой версии. Обновление неподдерживаемых мажорных версий происходит даже если у вас отключено автоматическое обновление.

#### Как рассчитывается стоимость потребления для хоста базы данных? {#db-cost}

В {{ mpg-short-name }} стоимость потребления рассчитывается исходя из следующих параметров:

* Выбранный класс хостов.
* Объем хранилища, зарезервированного для хоста БД.
* Объем резервных копий кластера БД. Объем резервных копий, равный объему хранилища, не тарифицируется. Хранение резервных копий сверх этого объема оплачивается по [тарифам](../../managed-postgresql/pricing.md).
* Количество часов работы хоста БД. Неполные часы округляются до целого значения. Стоимость часа работы для каждого класса хостов приведена в разделе [{#T}](../../managed-postgresql/pricing.md).

#### Как изменить вычислительные ресурсы и объем хранилища для кластера БД? {#resources-change}

Вы можете изменять вычислительные ресурсы и объем хранилища в консоли управления — просто выберите другой класс хостов для нужного кластера.

Характеристики кластера изменяются в течение 30 минут. В этот период также могут быть включены другие сервисные работы по кластеру, например, установка обновлений.

#### Включено ли резервное копирование хостов БД по умолчанию? {#default-backup}

Да, по умолчанию резервное копирование включено. Для {{ PG }} выполняется полное резервное копирование один раз в сутки, и сохраняются все журналы транзакций кластера БД. Это позволяет восстановить состояние кластера на любой момент времени в пределах периода хранения резервных копий, за исключением последних 30 секунд.

По умолчанию резервные копии хранятся 7 дней.

#### Когда выполняется резервное копирование? Доступен ли кластер БД во время резервного копирования? {#backup-window}

Окно резервного копирования — это интервал времени, в течение которого выполняется ежедневное полное резервное копирование кластера БД. Окно резервного копирования — 01:00−05:00 по московскому времени.

Во время окна резервного копирования кластеры остаются полностью доступными.

#### Шифруется ли соединение с кластером БД {{ PG }}? {#encryption}

Соединение между кластером БД и приложением всегда шифруется с использованием SSL. Отключить шифрование соединений с кластером нельзя.

#### Что такое реплика для чтения в {{ PG }}? {#read-only-instance}

Реплика для чтения — это доступный только для чтения хост в кластере БД {{ PG }}, данные на котором синхронизируются с хостом-мастером (применимо только если в кластере работает более 1 хоста). Вы можете использовать реплику для чтения для снижения нагрузки на мастер в базах данных с большим объемом запросов на чтение.

#### За какими метриками и процессами можно следить с помощью мониторинга? {#monitoring}

Для всех типов СУБД можно отслеживать:
* загрузку процессора, памяти, сети, дисков в абсолютных величинах;
* объем данных кластера БД и остаток свободного места в хранилище данных.

Для всех хостов БД можно отслеживать метрики, специфические для типа соответствующей СУБД. Например для {{ PG }} можно отслеживать:
* среднее время выполнения запроса;
* количество запросов в секунду;
* количество ошибок в журналах и т. д.

Мониторинг можно осуществлять с минимальной гранулярностью в 5 секунд.

{% include [logs](../logs.md) %}

#### Какие ограничения накладываются на кластеры БД {{ PG }}? {#instance-limitations}

Подробнее об ограничениях {{ mpg-short-name }} см. раздел [{#T}](../../managed-postgresql/concepts/limits.md). В разделе [{#T}](../../managed-postgresql/concepts/instance-types.md) приведены характеристики кластеров, которые можно создать с помощью {{ mpg-short-name }}.

#### Какие расширения для {{ PG }} поддерживаются в {{ mpg-short-name }}? {#pg-extension}

Список поддерживаемых расширений для {{ PG }} приведен в разделе [{#T}](../../managed-postgresql/operations/extensions/cluster-extensions.md).

#### В каком дата-центре хранятся резервные копии кластера {{ PG }}? {#data-center}

Резервные копии кластера хранятся и доступны сразу во всех трех дата-центрах.


{% include [fz-152.md](../../_qa/fz-152.md) %}


#### Могу ли я получить права суперпользователя в {{ PG }}? {#superuser}

Нет, права суперпользователя недоступны пользователям {{ mpg-name }}. Максимальные привилегии при работе с кластером имеет пользователь с [ролью `mdb_admin`](../../managed-postgresql/concepts/roles#mdb-admin).

#### Есть ли какие-то особенности или ограничения работы сборщика мусора в кластере {{ mpg-name }}? {#vacuum}

В кластере {{ mpg-name }} поддерживаются все параметры [команды VACUUM](https://www.postgresql.org/docs/current/sql-vacuum.html), но при их использовании учитывайте, что:

* Для выполнения полной очистки (`VACUUM FULL`) пользователю должна быть назначена [роль `mdb_admin`](../../managed-postgresql/concepts/roles#mdb-admin). Полная очистка не затронет служебные таблицы.
* В {{ PG }} версии 14 расширена функциональность параметра `INDEX_CLEANUP`: теперь по умолчанию он имеет значение `AUTO`. Это означает, что команда `VACUUM` пропускает очистку индекса, если считает ее нецелесообразной. Если вы хотите обеспечить обратную совместимость с предыдущими версиями {{ PG }}, установите параметр `INDEX_CLEANUP` в значение `ON`.

#### Почему кластер работает медленно, хотя вычислительные ресурсы использованы не до предела? {#throttling}

{% include [throttling](../throttling.md) %}

Чтобы увеличить максимальные значения IOPS и bandwidth и снизить вероятность троттлинга, расширьте размер хранилища при [изменении кластера](../../managed-postgresql/operations/update.md#change-disk-size).

Если вы используете хранилище с типом диска `network-hdd`, рассмотрите возможность перехода на `network-ssd` или `network-ssd-nonreplicated` путем [восстановления кластера](../../managed-postgresql/operations/cluster-backups.md#restore) из резервной копии.
