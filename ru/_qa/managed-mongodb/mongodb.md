#### Почему стоит использовать {{ MG }} в {{ mmg-short-name }}, а не собственную установку на виртуальной машине? {#mongodb-advantages-vm}

{{ mmg-short-name }} автоматизирует рутинное обслуживание БД:

- быстрое развертывание БД с необходимыми доступными ресурсами;
- резервное копирование данных;
- регулярное обновление ПО;
- обеспечение отказоустойчивости кластеров БД;
- мониторинг и статистика использования БД.


#### Что случится с кластером, если выйдет из строя один из хостов? {#node-out}

Если в кластере БД больше 1 реплики, при потере одного хоста кластер продолжит работу.

Данные могут потеряться только если вышел из строя единственный хост в кластере.


#### Можно ли развернуть кластер {{ MG }} в нескольких зонах доступности? {#multiple-az}

Да. Кластер БД может состоять из хостов, расположенных как в разных зонах, так и в разных регионах доступности.


#### Как проводится резервное копирование для кластеров {{ MG }}? {#backup}

Резервные копии создаются каждые 24 часа и хранятся 7 дней после создания. Восстановить данные можно только на момент создания копии.


#### Как устроена репликация для {{ MG }}? {#replication}

{{ mmg-short-name }} использует стандартный механизм репликации {{ MG }}: если в кластере есть больше 1 активного хоста, среди них автоматически выбирается первичный сервер, обрабатывающий запросы на запись.

Подробнее о том, как организована репликация в {{ MG }}, читайте в [документации СУБД](https://docs.mongodb.com/manual/replication/).


#### Какие ограничения накладываются на кластеры БД {{ MG }}? {#cluster-limitations}

Для кластеров {{ MG }} установлены следующие ограничения:

- В каждом кластере может быть не больше 5 хостов.
- Максимальный объем хранилища для каждого кластера {{ MG }} — 605 ГБ.

Подробнее об ограничениях сервиса {{ mmg-short-name }} см. в разделе [Квоты и лимиты](../../managed-mongodb/concepts/limits.md).

#### Почему кластер работает медленно, хотя вычислительные ресурсы использованы не до предела? {#throttling}

{% include [throttling](../throttling.md) %}

Чтобы увеличить максимальные значения IOPS и bandwidth и снизить вероятность троттлинга, расширьте размер хранилища при [изменении кластера](../../managed-mongodb/operations/update.md#change-disk-size).

Если вы используете хранилище с типом диска `network-hdd`, рассмотрите возможность перехода на `network-ssd` или `network-ssd-nonreplicated` путем [восстановления кластера](../../managed-mongodb/operations/cluster-backups.md#restore) из резервной копии.

#### Как получить доступ к служебной коллекции local.oplog.rs? {#oplog-permission}

Чтобы предоставить пользователю доступ к чтению `oplog`, выдайте ему роль `mdbReplication` в БД `admin`. Для этого выполните команду в интерфейсе командной строки {{ yandex-cloud }}:

```bash
{{ yc-mdb-mg }} user update <имя_пользователя> \
  --cluster-name <имя_кластера> \
  --permission database=admin,role=mdbReplication,role=<другая_роль>,... \
  --permission database=<имя_другой_БД>,role=<роль>,...
```

Чтобы избежать удаления уже назначенных ролей пользователя, в команде перечислите как существующие, так и добавляемые роли.
