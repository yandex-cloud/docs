# Топик

_Топик_ — тема сообщения, которая позволяет классифицировать данные для их выборочной отправки и получения устройствами и реестрами.

В сервисе реализованы два типа топиков: топики устройства и топики реестра.

## Топики устройства {#devices-topic}

Топики устройства, доступные в сервисе:
- `$devices/<ID устройства>/events` — топик для отправки телеметрических данных.

    Устройство может писать в этот топик, а реестр — читать из него. Реестр, подписанный на данный топик, будет знать, какое именно устройство отправило данные, так как в топике присутствует уникальный идентификатор устройства.
- `$devices/<ID устройства>/commands` — топик для получения команд.

    Реестр может писать в этот топик, а устройство — читать из него. В данный топик реестр отправляет команды, предназначенные конкретному устройству.

## Топики реестра {#registries-topic}

Топики реестра, доступные в сервисе: 
- `$registries/<ID реестра>/events` — топик для получения телеметрических данных.

    Устройство может писать в этот топик, а реестр — читать из него. Реестр, подписанный на данный топик, не будет знать, какое именно устройство отправило данные, так как в топике отсутствует уникальный идентификатор устройства.
- `$registries/<ID реестра>/commands` — топик для отправки команд.

    Реестр может писать в этот топик, а устройство — читать из него. В данный топик реестр отправляет команды, предназначенные всем устройствам в реестре.

## Сабтопик {#subtopic}

_Сабтопик_ — это пользовательский топик, созданный в рамках существующих в сервисе топиков устройств и реестров. Создавать сабтопик отдельно не требуется, достаточно начать отправлять в него сообщения.

Сабтопиком считается все, что указано после топика устройства или реестра и отделено символом `/`:  

```
<топик устройства или реестра>/<имя сабтопика>
```

Примеры сабтопиков: 
- `$devices/<ID устройства>/events/bedroom/temperature` — это сабтопик для получения данных о температуре в спальне.
- `$registry/<ID реестра>/commands/bedroom` — это сабтопик для отправки команд всем устройствам в спальне.

Для сабтопиков действуют те же [принципы работы](#usage) и [ограничения](limits.md), что и для топиков.

## Использование топиков {#usage}

{% include [registry-and-device-topic-note.md](../../_includes/iot-core/registry-and-device-topic-note.md) %}

В таблице описаны действия, которые устройства и реестры совершают с топиками:

Топик | Устройство | Реестр 
----|----|----
`$devices/<ID устройства>/events` | Отправляет телеметрические данные. | Получает телеметрические данные. <br/>Устройство известно.
`$devices/<ID устройства>/commands` | Получает команды. | Отправляет команды определенному устройству.
`$registries/<ID реестра>/events` | Отправляет телеметрические данные. | Получает телеметрические данные от всех устройств в реестре.<br/>Устройство неизвестно.
`$registries/<ID реестра>/commands` | Получает команды. | Отправляет команды всем устройствам в реестре. 

## Уровни качества обслуживания (QoS) {#qos}

При обмене сообщениями сервис {{ iot-name }} поддерживает следующие уровни качества обслуживания (QoS) для MQTT:

- `QoS 0: At most once`. Сообщение отправляется не более одного раза и без гарантии доставки.

- `QoS 1: At least once`. Сообщение гарантированно доставляется хотя бы один раз. Есть вероятность получения дубликатов сообщения.

Подробнее об ограничениях сервиса {{ iot-name }} читайте в разделе [{#T}](limits.md).

