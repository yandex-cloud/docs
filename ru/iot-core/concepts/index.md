---
title: "Взаимосвязь ресурсов сервиса {{ iot-full-name }}"
description: "Основными элементами сервиса {{ iot-full-name }} являются устройство, реестр и брокер, которые могут обмениваться различными данными и командами с помощью MQTT-сервера. Обмен данными происходит по протоколу MQTT версии 3.1.1. Это упрощенный сетевой протокол для взаимодействия между устройствами по принципу издатель-подписчик."
---

# Взаимосвязь ресурсов в {{ iot-name }}

Сервис предоставляет две модели управления ресурсами: брокеры и реестры устройств. Основными элементами сервиса являются [устройство](index.md#device), [реестр](index.md#registry) и [брокер](index.md#broker), которые могут обмениваться различными данными и командами с помощью [MQTT-сервера](index.md#mqtt-server). 

Реестры и устройства связаны между собой, устройства могут обмениваться данными с реестром, в котором они созданы. Брокер не связан с реестрами и устройствами и реализует отдельную модель управления процессом обмена сообщениями.

Обмен данными происходит по протоколу [MQTT](https://mqtt.org) версии  3.1.1. Это упрощенный сетевой протокол для взаимодействия между устройствами по принципу издатель-подписчик. 

Чтобы начать обмен данными и командами между устройствами и реестрами, необходимо [авторизоваться](../concepts/authorization.md). Это можно сделать с помощью X.509-сертификатов или по логину и паролю.

## Устройство {#device}

_Устройство_ — экземпляр физического устройства, например, датчика температуры, представленный в сервисе в виде имени устройства и его сертификата.

 Устройство создается в реестре, может отправлять телеметрические данные, получать команды и взаимодействовать с другими устройствами в реестре.

## Реестр {#registry}

_Реестр_ — набор устройств, логически связанных между собой. Реестр может читать телеметрические данные устройств и отправлять им команды.

## Брокер {#broker}

{% include [note-pp](../../_includes/iot-core/note-pp.md) %}

_Брокер_ — виртуальный MQTT-сервер, позволяющий MQTT-клиентам обмениваться сообщениями в изолированном пространстве топиков. Брокер накладывает меньше ограничений на способы обмена сообщениями, чем модель реестров устройств.

## MQTT-сервер {#mqtt-server}

_MQTT-сервер_ — это центральный узел для обмена MQTT-сообщениями между устройствами и реестрами. Обмен данными происходит только через сервер. Он отвечает за получение и обработку сообщений, а также контролирует их доставку MQTT-клиентам (устройствам или реестрам), обеспечивая необходимый [уровень качества обслуживания (QoS)](#qos).

_MQTT-клиенты_ — это устройства, реестры и клиенты брокера, которые обмениваются сообщениями с данными или командами. Каждое сообщение содержит _топик_ — тему сообщения, которая позволяет классифицировать данные и определить, какому клиенту они предназначаются.

Чтобы устройства, реестры и клиенты брокера получали сообщения друг от друга через MQTT-сервер, [подпишите их на нужные топики](../operations/subscribe).

Если у вас есть устройства, на показания датчиков которых нужно оперативно реагировать, а в вашей сети возможны перебои со связью и разрыв соединения между устройствами и MQTT-сервером, вы можете подписать устройства и реестры на [перманентные топики](./topic/index.md).
Например, используйте перманентные топики для датчиков температуры на устройствах, которые нужно оперативно отключить при нагревании до определенной температуры.  

## Уровни качества обслуживания (QoS) {#qos}

При обмене сообщениями сервис {{ iot-name }} поддерживает следующие уровни качества обслуживания (QoS) для MQTT:

* `QoS 0: At most once`. Сообщение отправляется не более одного раза и без гарантии доставки.

* `QoS 1: At least once`. Сообщение гарантированно доставляется хотя бы один раз. Есть вероятность получения дубликатов сообщения.

Подробнее об ограничениях сервиса {{ iot-name }} читайте в разделе [{#T}](limits.md).