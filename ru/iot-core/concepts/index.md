# Взаимосвязь ресурсов сервиса

Основными элементами сервиса являются [устройство](index.md#device) и [реестр](index.md#registry), которые могут обмениваться различными данными и командами с помощью [MQTT-брокера](index.md#mqtt-broker).

Обмен данными происходит по протоколу [MQTT](https://mqtt.org) версии  3.1.1. Это упрощенный сетевой протокол для взаимодействия между устройствами по принципу издатель-подписчик. 

Чтобы начать обмен данными и командами между устройствами и реестрами, необходимо [авторизоваться](../concepts/authorization.md). Это можно сделать с помощью X.509-сертификатов или по логину и паролю.

## Устройство {#device}

_Устройство_ — экземпляр физического устройства, например, датчика температуры, представленный в сервисе в виде имени устройства и его сертификата.

 Устройство создается в реестре, может отправлять телеметрические данные, получать команды и взаимодействовать с другими устройствами в реестре.

## Реестр {#registry}

_Реестр_ — набор устройств, логически связанных между собой. Реестр может читать телеметрические данные устройств и отправлять им команды.

## MQTT-брокер {#mqtt-broker}

_MQTT-брокер_ — это центральный узел для обмена MQTT-сообщениями между устройствами и реестрами. Обмен данными происходит только через брокер. Он отвечает за получение и обработку сообщений, а также контролирует их доставку клиентам (устройствам или реестрам), обеспечивая необходимый [уровень качества обслуживания (QoS)](#qos).

Внутри сервиса устройства и реестры обмениваются данными и командами, представленными в виде сообщений c определенными [топиками](topic.md).

{% include [mqtt-note](../../_includes/iot-core/mqtt-note.md) %}

## Уровни качества обслуживания (QoS) {#qos}

При обмене сообщениями сервис {{ iot-name }} поддерживает следующие уровни качества обслуживания (QoS) для MQTT:

- `QoS 0: At most once`. Сообщение отправляется не более одного раза и без гарантии доставки.

- `QoS 1: At least once`. Сообщение гарантированно доставляется хотя бы один раз. Есть вероятность получения дубликатов сообщения.

Подробнее об ограничениях сервиса {{ iot-name }} читайте в разделе [{#T}](limits.md).
