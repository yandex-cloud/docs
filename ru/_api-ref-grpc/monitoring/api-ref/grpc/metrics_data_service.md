---
editable: false
---

# MetricsDataService

Набор методов для управления данными метрик.

| Вызов | Описание |
| --- | --- |
| [Read](#Read) | Возвращает данные метрик. |
| [Write](#Write) | Записывает данные метрик. |

## Вызовы MetricsDataService {#calls}

## Read {#Read}

Возвращает данные метрик.

**rpc Read ([ReadDataRequest](#ReadDataRequest)) returns ([ReadDataResult](#ReadDataResult))**

### ReadDataRequest {#ReadDataRequest}

Поле | Описание
--- | ---
cloud_id | **string**<br>Обязательное поле. Идентификатор облака, которому принадлежит метрика. Максимальная длина строки в символах — 50.
folder_id | **string**<br>Обязательное поле. Идентификатор каталога, которому принадлежит метрика. Максимальная длина строки в символах — 50.
query | **[DataQuery](#DataQuery)**<br>Обязательное поле. Параметры запроса. 


### DataQuery {#DataQuery}

Поле | Описание
--- | ---
program | **string**<br>Обязательное поле. Текст запроса. 
from_time | **int64**<br>Обязательное поле. Начальная точка интервала. Строка в формате [ISO8601](https://ru.wikipedia.org/wiki/ISO_8601). 
to_time | **int64**<br>Обязательное поле. Конечная точка интервала. Строка в формате [ISO8601](https://ru.wikipedia.org/wiki/ISO_8601). 
downsampling | **Downsampling**<br>Параметры прореживания. 


### Downsampling {#Downsampling}

Поле | Описание
--- | ---
max_points | **int64**<br>Максимальное количество точек, которое будет получено в ответе на запрос. Допустимые значения — от 10 до 10000 включительно.
grid_millis | **int64**<br>Ширина временного окна (сетка) в миллисекундах. Используется для прореживания. Точки внутри окна объединяются в одну при помощи функции агрегации. Значение должно быть больше 0.
aggregation | enum **GridAggregation**<br>Функция агрегации, которая используется для прореживания. <ul><li>`MAX`: Максимум.</li><li>`MIN`: Минимум.</li><li>`SUM`: Сумма.</li><li>`AVG`: Среднее значение. Значение по умолчанию.</li><li>`LAST`: Последнее значение.</li><li>`COUNT`: Количество точек.</li><ul/>
fill | enum **FillGap**<br>Параметры заполнения пропусков в данных. <ul><li>`NULL`: Возвращает `null` в качестве значения метрики и `timestamp` в качестве временной метки. Значение по умолчанию.</li><li>`NONE`: Не возвращает значений.</li><li>`PREVIOUS`: Возвращает значение из предыдущей временной точки.</li><ul/>


### ReadDataResult {#ReadDataResult}

Поле | Описание
--- | ---
vector[] | **[Timeseries](#Timeseries)**<br>Список метрик. 


### Timeseries {#Timeseries}

Поле | Описание
--- | ---
kind | enum **MetricKind**<br>string alias = 1; Тип метрики. <ul><li>`DGAUGE`: Числовой показатель. Задается дробным числом.</li><li>`IGAUGE`: Числовой показатель. Задается целым числом.</li><li>`COUNTER`: Счетчик.</li><li>`RATE`: Производная.</li><ul/>
name | **string**<br>Имя метрики. 
labels | **map<string,string>**<br>Список меток метрики в формате `ключ:значение`. 
timestamps[] | **int64**<br>Список временных точек метрики в формате `timestamp`. 
values[] | **double**<br>Список значений метрики. 


## Write {#Write}

Записывает данные метрик.

**rpc Write ([WriteDataRequest](#WriteDataRequest)) returns ([WriteDataResponse](#WriteDataResponse))**

### WriteDataRequest {#WriteDataRequest}

Поле | Описание
--- | ---
cloud_id | **string**<br>Обязательное поле. Идентификатор облака, которому принадлежит метрика. Максимальная длина строки в символах — 50.
folder_id | **string**<br>Обязательное поле. Идентификатор каталога, которому принадлежит метрика. Максимальная длина строки в символах — 50.
service | **string**<br>Обязательное поле. Идентификатор сервиса, которому принадлежит метрика. Для пользовательских метрик `service=custom`. 
content | **[JsonFormat](#JsonFormat)**<br>Обязательное поле. Содержимое запроса. 


### JsonFormat {#JsonFormat}

Поле | Описание
--- | ---
ts | **int64**<br>Общая временная метка для всех метрик. 
labels | **map<string,string>**<br>Список меток общих для всех передаваемых метрик в формате `ключ:значение`. 
metrics[] | **[Metric](./#Metric)**<br>Список метрик. 


### Point {#Point}

Поле | Описание
--- | ---
ts | **int64**<br>Временная точка в формате `timestamp`. 
value | **double**<br>Значение метрики в указанной точке. 


### Metric {#Metric}

Поле | Описание
--- | ---
name | **string**<br>Обязательное поле. Имя метрики. 
labels | **map<string,string>**<br>Список меток метрики в формате `ключ:значение`. 
kind | enum **MetricKind**<br>Тип метрики. Значение по умолчанию — `DGAUGE`. <ul><li>`DGAUGE`: Числовой показатель. Задается дробным числом.</li><li>`IGAUGE`: Числовой показатель. Задается целым числом.</li><li>`COUNTER`: Счетчик.</li><li>`RATE`: Производная.</li><ul/>
ts | **int64**<br>Временная метка в формате `timestamp`. Если не указано, будет использовано текущее время. 
value | **double**<br>Обязательное поле. Значение метрики в указанной точке. 
timeseries[] | **Point**<br>Список из нескольких точек. 


### WriteDataResponse {#WriteDataResponse}

Поле | Описание
--- | ---
metrics_pushed | **int64**<br>Количество успешно записанных метрик. 
errors | **string**<br>Сообщение об ошибке, если запись завершилась неуспешно. 


