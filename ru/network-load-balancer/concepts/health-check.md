# Проверка состояния ресурсов

*Проверка состояния* используется сетевым балансировщиком для получения сведений о состоянии ресурсов подключенной целевой группы. В ответ на запрос состояния ресурсы сообщают, что они готовы принимать трафик или вышли из строя. Проверка проводится по протоколу TCP или HTTP через указанные в конфигурации промежутки времени. 

Для каждой проверки указываются:

* Тип проверки — HTTP или TCP.
* Путь, на который будут отправлены запросы. Указывается только для проверок HTTP.
* Порт, от 1 до 32767.
* Время ожидания, от 1 до 60 секунд. Это время, которое отводится ресурсу на то, чтобы ответить на проверку. Если ресурс не ответил вовремя, проверка считается непройденной и ресурсу присваивается статус `UNHEALTHY`.
* Интервал выполнения проверок, от 1 до 60 секунд.
* Пороги работоспособности и неработоспособности — число последовательных удачных или неудачных проверок, по достижении которого ресурс будет считаться доступным либо недоступным.

## Состояния целевых ресурсов {#target-statuses}

Целевой ресурс может находиться в одном из следующих состояний:

* `INITIAL` — для ресурса настраивается проверка состояния.
* `HEALTHY` — ресурс работает и готов принимать трафик.
* `UNHEALTHY` — ресурс не готов принимать трафик.
* `DRAINING` — ресурс удаляется и с него снимается трафик. Балансировщик перестает передавать трафик этому ресурсу.
* `INACTIVE` — ресурс подключен к остановленному балансировщику или к балансировщику без обработчиков.

Между назначением ресурсу состояния `UNHEALTHY` и остановкой передачи трафика на ресурс есть задержка, которая требуется сетевому балансировщику для обработки результата проверки.

Проверки состояния передаются целевым ресурсам с IP-адресов из диапазонов `198.18.235.0/24` и `198.18.248.0/24`. Настройки правил фильтрации трафика у целевых ресурсов должны разрешать прием трафика с адресов этого диапазона, иначе проверки не будут выполняться — целевые ресурсы не получат статус `HEALTHY` и не смогут принимать трафик.

При выполнении HTTP-проверки, ресурс получает статус `HEALTHY` только при ответе с кодом `200`.
