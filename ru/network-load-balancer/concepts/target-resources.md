# Целевые группы и ресурсы

*Целевая группа* — это набор ресурсов, которые получают трафик от обработчика. Фактически это список IP-адресов сетевых интерфейсов [виртуальных машин](../../compute/concepts/vm.md) в {{ yandex-cloud }}.

Для создания целевой группы необходимо указать ее имя и список ресурсов (IP-адресов) которые будут включены а эту группу.

Одну целевую группу можно подключить к нескольким балансировщикам.

Если на одном балансировщике используется несколько обработчиков трафика, то трафик, поступающий на эти обработчики, будет одновременно распределяться по всем целевым группам, подключенным к этому балансировщику.

Каждый ресурс в целевой группе определяется парой из [внутреннего IPv4-адреса](../../vpc/concepts/address.md) сетевого интерфейса ВМ и идентификатора [подсети](../../vpc/concepts/network.md#subnet). Ресурсы одной группы должны находиться в одной [облачной сети](../../vpc/concepts/network.md). Подключить в целевую группу ресурсы из разных сетей или за пределами {{ yandex-cloud }} не получится. В пределах одной зоны доступности ресурсы в целевой группе должны находиться в одной подсети.

Сетевой интерфейс ВМ можно подключить только к одной целевой группе. Подключить сетевой интерфейс ВМ одновременно в несколько целевых групп не получится.

При необходимости включения одной ВМ в несколько целевых групп, можно создать ВМ с несколькими сетевыми интерфейсами и включить каждый из них в свою целевую группу.

## Распределение нагрузки {#distribution}

Размещение ресурсов в разных зонах доступности обеспечивает отказоустойчивость сервису, который использует сетевой балансировщик. Если ресурсы есть во всех зонах доступности и они готовы принимать трафик, то трафик распределяется по всем зонам. Если все ресурсы одной из зон выйдут из строя, то трафик больше не будет направляться в эту зону, а будет распределяться по оставшимся ресурсам в оставшихся зонах.

Трафик всегда распределяется примерно поровну между зонами доступности. Если количество целевых ресурсов за сетевым балансировщиком в разных зонах будет отличаться, то нагрузка на отдельный ресурс в каждой из зон также будет различна. 

Например, если в одной группе целевых ресурсов в зоне A будет 2 ресурса, а в зоне B - 4 ресурса, то нагрузка на каждый ресурс в зоне A составит примерно 25% (50%/2) от общего трафика, а нагрузка на каждый ресурс в зоне B примерно 12,5% (50%/4). 

{% note alert %}

Следует помнить, что распределение нагрузки по целевым ресурсам это сложный процесс, который зависит от множества факторов. Алгоритм распределения трафика по целевым ресурсам может измениться в будущем, поэтому рекомендуется строить свои решения без зависимостей от реализации алгоритма распределения и следовать [рекомендации](./best-practices.md#create-reserves).

{% endnote %}

## Комбинации обработчиков и целевых групп {#lsn-group}

На одном сетевом балансировщике можно реализовать следующие сценарии:

1. Один обработчик и одна целевая группа. Минимально возможный вариант. Ресурсы в целевой группе могут располагаться в одной или нескольких зонах доступности.
2. Один обработчик и несколько целевых групп. В разные группы можно собрать ресурсы из разных зон доступности.
3. Несколько обработчиков и одна целевая группа. Каждый из обработчиков принимает трафик только на "свой" порт.
4. Несколько обработчиков и несколько целевых групп:
    * Для каждого обработчика свой набор целевых групп (одна или несколько).
    * Для всех обработчиков общие группы узлов (одна или несколько).
