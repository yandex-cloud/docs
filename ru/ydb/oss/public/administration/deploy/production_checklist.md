# Подготовка

На данной странице представлены рекомендации для развертывания кластера {{ ydb-short-name }}.

## Топология

Для того, чтобы хранить данные надежно и отказоустойчиво, {{ ydb-short-name }} избыточно записывает данные на несколько блочных устройств c топологией, которая позволяет переживать потерю двух узлов или потерю зоны доступности и узла в зависимости от режима хранения данных.

{{ ydb-short-name }} поддерживает следующие режимы хранения данных:

* **block-4-2** — работает в 1 зоне доступности. Данные разбиваются на 4 фрагмента и дополняются 2 фрагментами избыточности. Фрагменты записываются на разные диски (расположенные на разных узлах). При этом восстановление возможно при одновременной потере не более чем 2 фрагментов. Для успешной записи данных необходима запись всех 6 фрагментов, поэтому для обеспечения возможности успешной записи при отказе 2 дисков необходимо 2 дополнительных диска, то есть всего требуется 8 узлов.

* **mirror-3-dc** — работает в 3 зонах доступности. Данные могут храниться либо в виде 3 реплик, по одной в каждой зоне доступности, либо в виде 4 реплик, по две в двух зонах доступности. Реплики в каждой зоне доступности записываются на разные диски (расположенные на разных узлах). Работоспособность в этом режиме сохраняется при потере 1 зоны доступности и 1 узла в одной из оставшихся двух зон доступности. Для работы необходимо 9 узлов, по 3 в каждой зоне доступности.

Под потерей узла здесь подразумевается как полная так и частичная недоступность, например потеря одного диска на узле.

## Программное обеспечение

Для корректной работы {{ ydb-short-name }} рекомендуется использовать операционную систему [Ubuntu](https://ubuntu.com/) версии 16.04 или новее.

## Блочные устройства

Минимальный размер диска должен быть не менее 80 ГБ, при меньшем размере, узел не сможет использовать устройство. Корректная и бесперебойная работа с дисками минимального размера не гарантируется. Использовать такие диски рекомендуется исключительно в тестовых целях.

Для корректной работы {{ ydb-short-name }} рекомендуется использовать настоящие блочные устройства размером более 800 ГБ.

{{ ydb-short-name }} не использует файловую систему для хранения данных и работает с устройством напрямую. Поэтому не следует монтировать файловую систему или выполнять другие операции с разделом, который использует {{ ydb-short-name }}.

Так же не рекомендуется делить блочное устройство с другими процессами. Это может приводить к существенному ухудшению производительности.

## Оперативная память

{{ ydb-short-name }} не обеспечивает защиты от ошибок памяти, поэтому рекомендуется использовать ECC-память.

## Средства интроспекции

Для обеспечения бесперебойной работы {{ ydb-short-name }} важно выполнять своевременную замену выходящих из строя дисков и узлов. Следить за состоянием кластера можно при помощи [средств интроспекции](../monitoring/overview.md).
