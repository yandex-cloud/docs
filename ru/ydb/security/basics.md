# Описание системы разграничения прав доступа в YDB

## Аутентификация {#authentication}
В YDB используется аутентификация на основе токенов, которые пересылаются пользователем вместе с запросом.
На данный момент поддерживаются следующие типы токенов:

* OAuth (обычный OAuth токен, привязка к приложению на текущий момент не проверяется - подходит любой, проверка через blackbox).
* Session_id (сессионная кука пользователя в домене yandex-team.ru, проверка через blackbox).
* TVM2 (offline аутентификация)

После успешной аутентификации из токена получается идентификатор пользователя (кроме TVM2), по которому, по возможности, получается список групп пользователя (из Staff). Вся полученная информация используется в дальнейшей авторизации.

## Авторизация {#login}

В YDB права настраиваются на каждом элементе схемы и автоматически наследуются вниз по дереву. Права можно выдать любому пользователю или группе (субъекту доступа). Он записывается в виде <login>@<subsystem>. Например, для пользователей, полученных от Staff он будет выглядеть в виде имени логин@staff.

На текущий момент к настройке доступны следующие права:

* ydb.generic.read - чтение данных и атрибутов схемы.
* ydb.generic.write - запись данных и атрибутов схемы.
* ydb.access.grant - возможность выдачи прав доступа другим пользователям.
* ydb.generic.use - чтение, запись и выдача прав (read + write + grant).
* ydb.generic.manage - управление сервисом баз данных. Доступно только администраторам сервиса.
* ydb.generic.full - полный, неограниченный доступ к сервису (use + manage).

## Создание БД {#db-creation}

При создании через [веб-интерфейс YDB](https://ydb.yandex-team.ru/), базы данных для пользователя создаются пользователем `robot-kikimr`. Пользователь `robot-kikimr` получает права **full** на БД. Пользователю, инициировавшему создание БД выдаются права **use**.

Права use дают возможность:

* создавать и удалять таблицы и директории в БД;
* выполнять операции чтения и записи;
* выдавать права доступа другим пользователям, но только в рамках перечисленных выше прав use.

Пользователь не может самостоятельно изменять параметры БД или удалять БД.

Для изменения параметров БД заполните, пожалуйста, [форму](https://st.yandex-team.ru/createTicket?template=1918&queue=YDBREQUESTS).

Для удаления БД заполните, пожалуйста, [форму](https://st.yandex-team.ru/createTicket?template=1919&queue=YDBREQUESTS).