---
editable: false
---

# Правила тарификации для бессерверного режима {{ ydb-name }}

{% include [currency-choice](../_includes/pricing/currency-choice.md) %}

При использовании бессерверного режима {{ ydb-name }} плата взимается за каждый выполненный к базе данных запрос. Указывать, какие ресурсы требуются для работы, нет необходимости, база данных оперативно адаптируется к изменению пользовательской нагрузки в рамках выделенных пользователю [квот](../concepts/limits.md). Помимо запросов пользователь оплачивает хранимые в {{ ydb-name }} данные на почасовой основе. Дополнительно тарифицируются другие операции, такие как восстановление из резервной копии.


## Из чего складывается стоимость использования бессерверного режима {{ ydb-name }} {#rules}

При работе {{ ydb-name }} с бессерверном режиме вы оплачиваете:

* операции с данными;
* объем хранимых данных, включая служебные данные, например, индексы;
* дополнительные пользовательские операции, такие как восстановление данных из резервной копии.

Дополнительно оплачиваются иные потребляемые ресурсы:

* место, занятое в сервисе {{ objstorage-name }} для хранения резервных копий по требованию;
* объем исходящего трафика из {{ yandex-cloud }} в интернет.

{% include [pricing-gb-size](../_includes/pricing/pricing-gb-size.md) %}

### Операции с данными и единица запроса {#rules-ru}


Бессерверный режим работы {{ ydb-full-name }} поддерживает несколько способов работы с данными:
* Document API — HTTP API, совместимое с Amazon DynamoDB. С помощью этого API можно выполнять операции над документными таблицами.
* YDB API и его реализации в виде [YDB CLI](../quickstart/examples-ydb-cli.md) и [YDB SDK](../sdk/index.md) для [Java](https://github.com/yandex-cloud/ydb-java-sdk), [Python](https://github.com/yandex-cloud/ydb-python-sdk), [Node.js](https://github.com/yandex-cloud/ydb-nodejs-sdk), [PHP](https://github.com/yandex-cloud/ydb-php-sdk) и [Go](https://github.com/yandex-cloud/ydb-go-sdk). С помощью этого API можно выполнять операции над YDB-таблицами.

Для расчета стоимости запросов в {{ ydb-short-name }} используется понятие **единица запроса** (**RU** — request unit). Каждый выполненный запрос в зависимости от его типа, сложности и размера данных приводит к потреблению определенного количества RU. Итоговая стоимость всех выполненных запросов к {{ ydb-short-name }} складывается из стоимости каждого запроса, выраженной в RU.

####  Document API


Стоимость запросов к Document API зависит от типа операций с базой, которые выполняются в рамках запроса, и объема данных, над которыми выполняется операция. Если запрос состоит из нескольких операций (например BatchWriteItem), его стоимость складывается из стоимости операций.

Тип операции                                | Размер данных | Стоимость в единицах запросов (RU)
------------------------------------------ | ------------- | -------------------
Операция чтения строки (методы GetItem, BatchGetItem, Query, Scan)                     | 4 КБ          | 1
Операция чтения строки в рамках транзакции (TransactGetItems) | 4 КБ          | 2
Операция записи строки (PutItem, BatchWriteItem, UpdateItem)                    | 1 КБ          | 2
Операция записи строки в рамках транзакции (TransactWriteItems) | 1 КБ          | 4
Операция удаления строки (DeleteItem)                    | не учитывается          | 2
Операция со схемой базы данных (CreateTable, DeleteTable, DescribeTable, ListTables) | не тарифицируется          | не тарифицируется

При оценке стоимости запроса:

* запрос на чтение, который не вернул результатов, всегда оценивается в 1 RU;
* запрос на запись строки, который не вернул результатов, всегда оценивается в 2 RU;
* запрос на запись строки в рамках транзакции, который не вернул результатов, всегда оценивается в 4 RU;
* запросы на чтение округляются в большую сторону до значения, кратного 4 КБ;
* запросы на запись округляются в большую сторону до значения, кратного 1 КБ.

#### YDB API


Стоимость запроса к YDB API складывается из нескольких частей:

* **Процессорное время**

   Учитывается процессорное время, потраченное на разбор и компилирование запроса. Процессорное время округляется в меньшую сторону до значения, кратного 1,5 мс.

* **Операции чтения**

   Стоимость операций чтения оценивается тремя способами:
   * Суммарный объем прочитанных данных. Объем округляется в большую сторону до значения, кратного 4 КБ.
   * Число прочитанных строк.
   * Процессорное время, потраченное на операции чтения. Процессорное время округляется в меньшую сторону до значения, кратного 1,5 мс.

   Все величины переводятся в единицы RU. Итоговая стоимость операций чтения принимается равной наибольшей из этих величин.

* **Операции записи**

   Стоимость операций записи оценивается тремя способами:
   * Суммарный объем записанных данных. Объем округляется в большую сторону до значения, кратного 1 КБ.
   * Число записанных строк.
   * Процессорное время, потраченное на операции записи. Процессорное время округляется в меньшую сторону до значения, кратного 1,5 мс.

   Все величины переводятся в единицы RU. Итоговая стоимость операций записи принимается равной наибольшей из этих величин.

* **Операции удаления**

   Стоимость операций удаления оценивается тремя способами:
   * Суммарный объем удаленных данных. Объем округляется в большую сторону до значения, кратного 1 КБ.
   * Число удаленных строк.
   * Процессорное время, потраченное на операции удаления. Процессорное время округляется в меньшую сторону до значения, кратного 1,5 мс.

Итоговая стоимость запроса вычисляется как сумма всех составных частей.

Оцениваемый параметр                       | Единичный размер | Стоимость в единицах запросов (RU)
------------------------------------------ | ----------------- | -------------------
Объем прочитанных данных                   | 4 КБ              | 1
Объем записанных данных                    | 1 КБ              | 2
Объем удаленных данных                    | 1 КБ              | 2
Операция чтения строки                     | 1 строка          | 1
Операция записи строки                     | 1 строка          | 2
Операция удаления строки                   | 1 строка          | 2
Процессорное время                         | 1,5 мc            | 4
Создание, изменение, удаление схем таблиц, получение описания таблицы, получение списка таблиц, создание и удаление директорий | не тарифицируется | не тарифицируется


##### Особенности расчета стоимости некоторых операций

* **ReadTable**
   Операция ReadTable позволяет эффективно вычитывать большие диапазоны данных таблицы. Стоимость запроса зависит только от объема прочитанных данных и составляет 128 RU за 1 МБ. При расчете стоимости объем округляется в большую сторону до значения, кратного 1 МБ.

* **BulkUpsert**
   BulkUpsert позволяет эффективно загружать данные в базу. Стоимость записи строки в рамках операции BulkUpsert составляет 0,5 RU за 1 КБ записанных данных. При расчете стоимости объем данных округляется в большую сторону до значения, кратного 1 КБ. Итоговая стоимость операции рассчитывается как сумма стоимости всех записанных строк с округлением до ближайшего большего целого.

   **Пример расчета стоимости**

   Например, в рамках операции BulkUpsert вы записываете четыре строки данных объемом 2500 байт, 100 байт, 1200 байт и 1024 байта.

   Стоимость такой операции составит:
   > 0,5 RU × 3 + 0,5 RU × 1 + 0,5 RU × 2 + 0,5 RU × 1 = 3,5 RU
   >
   > Итого, после округления в большую сторону: 4 RU

   Где:
   * 0,5 — стоимость в единицах запросов за 1 КБ записанных данных.
   * 3 — объем первой строки в КБ после округления в большую сторону (2500 байт = 1024 байта + 1024 байта + 452 байта).
   * 1 — объем второй строки в КБ после округления в большую сторону.
   * 2 — объем третьей строки в КБ после округления в большую сторону (1200 байт = 1024 байта + 176 байт).
   * 1 — объем четвертой строки в КБ.

* **Построение вторичного индекса**
   Стоимость построения индекса складывается из стоимости операции ReadTable оригинальной таблицы и BulkUpsert в индексную таблицу. Тарифицируется объем проделанной работы — количество строк и их размер, который был прочитан из оригинальной таблицы и записан в индексную таблицу. Процесс построения индекса может быть отменен пользователем. Отмененные операции построения индекса также тарифицируются за объем проделанной работы до отмены операции.


### Объем хранимых данных {#rules-storage}


В бессерверном режиме мощности для хранения данных выделяются автоматически. Объем хранимых данных при этом рассчитывается как совокупный объем пользовательских и служебных данных, которые хранятся в БД. Например, создание глобального индекса приводит к увеличению размера хранилища на размер такого индекса.

### Создание резервных копий {#rules-backup-storage}


#### Автоматические резервные копии {#rules-auto-backup-storage}

{{ ydb-name }} автоматические создает и бесплатно хранит 2 полные резервные копии ваших баз за два последних дня. Плата за хранение автоматических резервных копий не взимается.

#### Резервные копии по требованию {#rules-auto-backup-storage}

Вы можете принудительно выполнить резервное копирование базы данных с сохранением копии в сервисе {{ objstorage-full-name }}. Стоимость такой операции зависит от объема скопированных данных. При расчете стоимости фактический объем округляется в большую сторону до значений, кратных 1 ГБ.

{% note warning %}

В случае выгрузки данных при помощи утилиты ```ydb tools dump``` тарификация производится по тарифам операции ReadTable.

{% endnote %}

### Восстановление из резервной копии {#rules-backup-restore}


Вы можете восстанавливать базы и/или отдельные таблицы из резервных копий, которые хранятся в сервисе {{ objstorage-name }}. Стоимость такой операции зависит от объема восстановленных данных. При расчете стоимости фактический объем округляется в большую сторону до значения, кратного 1 ГБ.

{% note warning %}

В случае восстановления данных при помощи утилиты ```ydb tools restore``` тарификация производится по цене записи строки в базу данных для каждой восстановленной строки.

{% endnote %}

## Скидка за резервируемый объем ресурсов {#cvos}


Вы можете получить гарантированную скидку за потребление ресурсов сервиса, запланированное на месяц, на год или на три года вперед.

Бессерверный режим {{ ydb-name }} предоставляет [CVoS](../../billing/concepts/cvos.md) на определенное количество запросов, выраженных в единицах RU, в секунду. Вы можете выбирать размер резерва с шагом 100 RU/с.

При вычислении реального объема потребления количество запросов усредняется каждые пять минут. То есть, например, при резерве 100 RU/с не обязательно потреблять каждую секунду 100 RU. На протяжении интервала усреднения нагрузка может изменяться и составлять в один момент 150 RU/с, в другую — 50 RU/с.

## Цены {#prices}


{% include notitle [rub-serverless](../../_pricing/ydb/rub-serverless.md) %}




{% include notitle [rub-egress-traffic.md](../../_pricing/rub-egress-traffic.md) %}




