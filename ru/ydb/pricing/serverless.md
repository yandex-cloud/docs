# Правила тарификации для бессерверного режима {{ ydb-name }}



{% include [use-calculator](../../_includes/pricing/use-calculator.md) %}

{% include [link-to-price-list](../../_includes/pricing/link-to-price-list.md) %}

{% include [currency-choice](../_includes/pricing/currency-choice.md) %}

При использовании бессерверного режима {{ ydb-name }} плата взимается за каждый выполненный к базе данных запрос. Указывать, какие ресурсы требуются для работы, нет необходимости, база данных оперативно адаптируется к изменению пользовательской нагрузки. Помимо запросов пользователь оплачивает хранимые в {{ ydb-name }} данные на почасовой основе. Дополнительно тарифицируются другие операции, такие как восстановление из резервной копии.

## Из чего складывается стоимость использования бессерверного режима {{ ydb-name }} {#rules}

При работе {{ ydb-name }} в бессерверном режиме вы оплачиваете:
* Операции с данными.
* Объем хранимых данных, включая служебные данные, например, индексы.
* Дополнительные пользовательские операции, такие как восстановление данных из резервной копии.

Дополнительно оплачиваются иные потребляемые ресурсы:

* Место, занятое в сервисе {{ objstorage-full-name }} для хранения резервных копий по требованию.
* Объем исходящего трафика из {{ yandex-cloud }} в интернет.

{% include [pricing-gb-size](../_includes/pricing/pricing-gb-size.md) %}

### Операции с данными и единица запроса {#rules-ru}

Бессерверный режим работы Yandex {{ ydb-name }} поддерживает несколько способов работы с данными:
* YQL - диалект SQL для работы с реляционными таблицами, поддерживаемый в [SDK](https://ydb.tech/docs/ru/reference/ydb-sdk/), [CLI](https://ydb.tech/docs/ru/reference/ydb-cli/) и консоли управления {{ ydb-short-name }}.
* Document API — HTTP API, совместимый с Amazon DynamoDB. С помощью этого API можно выполнять операции над документными таблицами.

Кроме этого, к базе данных могут быть сделаны запросы через специализированные API, доступные в виде отдельных функций в SDK, CLI или консоли управления {{ ydb-short-name }}.

Для расчета стоимости запросов в {{ ydb-short-name }} используется понятие _единица запроса (RU — Request Unit)_. Каждый выполненный запрос, в зависимости от его типа, сложности и размера данных приводит к потреблению определенного количества RU. Итоговая стоимость всех выполненных запросов к {{ ydb-short-name }} складывается из стоимости каждого запроса, выраженной в RU.

Правила расчета стоимости запросов к {{ ydb-short-name }} в Request Units:
* [YQL](ru-yql.md).
* [Document API](ru-docapi.md).
* [Специальные API](ru-special.md).
* [Операции с топиками](ru-topics.md).

#### Тарифы на потребление Request Units {#prices-ru}

* **За фактическое потребление (on-demand)**. Стоимость использования {{ ydb-short-name }} за некоторый период будет равна сумме потраченных Request Units, умноженной на цену 1 Request Unit, за вычетом предоставляемого ежемесячно [бесплатного пакета](../../billing/concepts/serverless-free-tier.md#ydb). Если запросов к базе данных не было, или количество потраченных в текущем месяце Request Units меньше бесплатного пакета, плата за фактическое потребление Request Units не взимается.
* **Выделенная пропускная способность (provisioned capacity)**. Если ваша нагрузка носит предсказуемый характер и имеет постоянную составляющую, вы можете сократить стоимость использования {{ ydb-short-name }} за счет оплаты части (или всех) потраченных Request Units по почасовому тарифу. Для этого нужно установить отличное от нуля значение параметра базы данных «Выделенная пропускная способность, RU/с». Вам начнут делаться начисления по специальному тарифу, ставка которого задается за RU/с×час, тарификация посекундная. Потребление Request Units в пределах заданной пропускной способности не будет учитываться в трате Request Units по тарифу on-demand.

### Объем хранимых данных {#rules-storage}

В бессерверном режиме мощности для хранения данных выделяются автоматически. Объем хранимых данных при этом рассчитывается как совокупный объем пользовательских и служебных данных, которые хранятся в БД. Например, создание глобального индекса приводит к увеличению размера хранилища на размер такого индекса.

Для работающих в режиме тарификации по фактическому использованию топиков также тарифицируется фактически используемое дисковое пространство. Оно занимается в момент публикации каждого сообщения в топик, и освобождается в момент истечения Retention Period, настроенного в данном топике.

### Создание резервных копий {#rules-backup-storage}

#### Автоматические резервные копии {#rules-auto-backup-storage}

{{ ydb-name }} автоматически создает и бесплатно хранит 2 полные резервные копии ваших баз за два последних дня. Плата за хранение автоматических резервных копий не взимается.

#### Резервные копии по требованию {#rules-auto-backup-storage}

Вы можете принудительно выполнить резервное копирование базы данных с сохранением копии в сервисе [{{ objstorage-name }}](../../storage/). Стоимость такой операции зависит от объема скопированных данных и рассчитывается как для операции [ReadTable](ru-special.md#readtable). При расчете стоимости фактический объем округляется в большую сторону до значений, кратных 1 ГБ.

{% note warning %}

В случае выгрузки данных при помощи утилиты `ydb tools dump` тарификация производится по тарифам операции `ReadTable`.

{% endnote %}

#### Пример расчета стоимости создания резервной копии по требованию {#example-of-cost-calculation-backup-storage}

Рассмотрим расчеты стоимости создания резервных копий БД объемом 1 ГБ и 10 ГБ.

**Расчет стоимости для БД объемом 1 ГБ**

Фактическое потребление RU в месяц составит:

> 128 RU × 1 024 = 131 072 RU

Где:

* 128 — стоимость запроса за 1 МБ данных.
* 1 024 — объем скопированных данных в МБ.

Потраченное количество RU 131 072 [меньше 1 000 000](#prices), следовательно, создание резервной копии будет бесплатным.

**Расчет стоимости для БД объемом 10 ГБ**

Фактическое потребление RU в месяц составит:


{% list tabs group=pricing %}

- Расчет в рублях {#prices-rub}

  {% include [rub-storage](../../_pricing_examples/ydb/rub-storage.md) %}

- Расчет в тенге {#prices-kzt}

  {% include [kzt-storage](../../_pricing_examples/ydb/kzt-storage.md) %}

{% endlist %}



### Восстановление из резервной копии {#rules-backup-restore}

Вы можете восстанавливать базы и/или отдельные таблицы из резервных копий, которые хранятся в сервисе {{ objstorage-name }}. Стоимость такой операции зависит от объема восстановленных данных и рассчитывается как для операции [BulkUpsert](ru-special.md#bulkupsert). При расчете стоимости фактический объем округляется в большую сторону до значения, кратного 1 ГБ.

{% note warning %}

В случае восстановления данных при помощи утилиты `ydb tools restore` тарификация производится по цене записи строки в базу данных для каждой восстановленной строки.

{% endnote %}

#### Пример расчета стоимости восстановления из резервной копии {#example-of-cost-calculation-backup-restore}

Рассмотрим расчеты стоимости восстановления из резервной копии БД объемом 1 ГБ и 10 ГБ.

**Расчет стоимости для БД объемом 1 ГБ**

Фактическое потребление RU в месяц составит:

> 0,5 RU × 1 024 × 1 024 = 524 288 RU

Где:

* 0,5 — стоимость запроса за 1 КБ данных.
* 1 024 × 1 024 — объем восстанавливаемых данных в КБ.

Потраченное количество RU 524 288 [меньше 1 000 000](#prices), следовательно, восстановление из резервной копии будет бесплатным.

**Расчет стоимости для БД объемом 10 ГБ**

Фактическое потребление RU в месяц составит:


{% list tabs group=pricing %}

- Расчет в рублях {#prices-rub}

  {% include [rub-restore](../../_pricing_examples/ydb/rub-restore.md) %}

- Расчет в тенге {#prices-kzt}

  {% include [kzt-restore](../../_pricing_examples/ydb/kzt-restore.md) %}

{% endlist %}



## Цены для региона Россия {#prices}

{% include [pricing-diff-regions](../../_includes/pricing-diff-regions.md) %}


{% list tabs group=pricing %}

- Цены в рублях {#prices-rub}

  {% include [rub-serverless](../../_pricing/ydb/rub-serverless.md) %}

- Цены в тенге {#prices-kzt}

  {% include [kzt-serverless](../../_pricing/ydb/kzt-serverless.md) %}

{% endlist %}



{% include [egress-traffic-pricing](../../_includes/egress-traffic-pricing.md) %}

