---
sourcePath: overlay/internals/tablet_followers.md
---
#### Для чего нужны tablet followers
Хотя у таблетки должно существовать не более одного активного лидера, иногда полезно поддерживать дополнительно несколько реплик-фолловеров. Этим можно решить одну из нескольких задач:
  * уменьшить время переподъема таблетки (при переключении на тёплую реплику понадобится только перерегистрировать лидера и накатить изменения, не успевшие доехать асинхронной доставкой).
  * в случае, когда допустимы "отстающие" чтения
    * вынести обработку читающих транзакций с лидера - увеличив пропускную способность системы.
    * читать с локальных реплик в меж-ДЦ инсталляциях.
    * сохранять доступность на чтение во время рестарта лидера.

#### Реализация на системного уровне 
При запуске таблетки (либо явной командой с **[Hive'a](tablet_hive.md)**, либо указав возможность запуска фолловеров в **[bootstrapper](glossary.md#bootstrapper)**) можно назначить новый инстанс таблетки не кандидатом, а фолловером.

  * Инстанс фолловера находит текущий лидер и регистрирует себя как нового фолловера.
  * Следующий после этого снапшот лога будет отправлен лидером на фолловер (рекомендуется принудительно сбрасывать снапшот лога таблеткой при подключении нового фолловера).
  * Получив снапшот лога фолловер осуществляет стандартную процедуру загрузки, но не фиксирует состояние в сторадже, вместо этого регистрирует себя как активного фолловера в стейт-сторадже (необходимо для работы пайпов).
  * Весь дальнейший лог транслируется лидером на фолловеров, а фолловеры применяют изменения к состоянию в памяти.

Логи перестают отгружаться при разрыве линка между лидером и фолловером, в этом случае фолловер пытается перерегистрировать себя на лидере (не делая различия между новым и старым) и проходит процедуру загрузки снашпота лога с начала. На время перерегистрации фолловер может сохранять накопленный стейт и обслуживать запросы базируясь на нём.

При обслуживании чтений фолловерам может понадобиться загрузить данные с диска, полученные фрагменты складываются в локальном кеше и могут быть переиспользованы при апгрейде фолловера до лидера. Альтернативно профиль запросов может отгружаться с лидера на фолловеров для синхронизации состояния кеша (полезно при использовании фолловера как hot-standby).

Обращения к фолловерам происходят тем же механизмом таблеточных пайпов, что и к лидеру, но с включенной опцией разрешения/требования доступа к фолловерам.

#### Реализация на уровне PQ-топиков 
Не поддерживается.

#### Реализация на уровне таблиц 
Должно поддерживаться даташардами с настройкой на уровне таблиц.
