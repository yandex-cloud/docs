# Производительность
## Почему так долго работает запрос с JOIN? {#why-does-the-join-query-take-so-long}
Все основные виды JOIN (кроме SEMI/ONLY) строят декартово произведение строк по совпадающим значениям ключей. Если одно или несколько значений ключа является особенным, то по нему может оказаться большое число строк с каждой из сторон и, как следствие, гигантское декартово произведение. В большинстве случаев JOIN работает медленно именно из-за этого, а такие особые значение с прикладной точки зрения оказываются не так интересны и достаточно их исключить в WHERE.

Найти аномально часто встречающиеся значения можно с помощью двух запросов по каждой из таблиц с GROUP BY по тем же ключам, что и у JOIN, используя агрегатную функцию COUNT и убывающую сортировку по её результату. Ещё можно добавить LIMIT 100, чтобы отработало ещё быстрее.

Также бывают запросы, где на самом деле декартово произведение в JOIN не нужно, т.к. потом всё равно от значений тем или иным способом оставляют только уникальные значения. В этом случае стоит убрать дубли в подзапросе через [GROUP BY](../syntax/basic.md#group-by) или [SELECT DISTINCT](./syntax/basic.mddistinct) ещё до JOIN, а также рассказать о своём сценарии в комментариях к тикету [Свертка по payload в JOIN](https://st.yandex-team.ru/YQL-668).