---
sourcePath: overlay/internals/tablets.md
---
Основным строительным блоком KiKiMR является примитив "таблетка". Вокруг него построен весь дизайн системы. Если кратко, каждая таблетка – это маленькая распределённая стейт-машина с надёжным хранилищем. Это полезный примитив сам по себе. Развернув поверх таблеток инфраструктуру межтаблеточных транзакций, получаем надёжное распределенное хранилище. А добавив инфраструктуру адресации таблеток по задаваемой пользователем схеме и язык описания транзакций, получаем универсальную базу данных.

В отличие от некоторых классических решений, KiKiMR полагается на хранение всех данных системы в популяции таблеток: и системных, и метаинформации, и непосредственно данных. Такой экстремальный подход заставил построить все внутренние интерфейсы от требований таблетки и местами срезать углы для непессимизации характеристик производительности по горячему пути. Например, отказались от схемы с репликацией состояния таблетки по нескольким репликам с локальным хранилищем, вместо этого применив хранение разделяемого лога в специализированном dfs-like сервисе (см. блобсторадж), что позволяет относительно свободно перемещать реплики по кластеру, варьировать по необходимости количество реплик (в том числе с типичным минимальным набором в одну реплику-лидер), варьировать схему кодирования хранения блобов (в качестве базовых выбраны схемы 4+2 (1.5х избыточность при минимальных потерях на задержки репликации) и mirror-3 (3х избыточность при минимальном влиянии задержек записи).

Встраивание таблетки возможно на разных уровнях. Можно использовать только системный слой (так, например, сделан RTMR), можно встроиться на уровне локальной базы (используется generic-решение для организации локального хранилища таблетки, пользовательский код пишется в терминах локальных транзакций) - так сделаны системные таблетки и решение для хранения данных Cоломона (см. [KV-таблетка](tablet_key_value.md)). Рекомендуемый способ – использовать KiKiMR как универсальную базу данных, описывая пользовательские операции как транзакции на MiniKQL или операции на YQL.

Адресуются таблетки по своему tablet-id (уникальное 64-битное число, назначаемое при создании таблетки). Основной способ отправки сообщений таблеткам - таблеточные пайпы.
