# Аппаратный модуль безопасности (HSM)

Функциональность находится на стадии [Preview](../../overview/concepts/launch-stages.md) и не тарифицируется.

Аппаратный модуль безопасности ([HSM](https://en.wikipedia.org/wiki/Hardware_security_module)) – это специализированное вычислительное устройство, которое предназначено для выполнения криптооперацией с высоким быстродействием. 

Традиционно HSM используются в сценариях, когда криптосредство должно обеспечивать такой уровень защиты, при котором стоимость и сложность реализации успешной атаки ограничивают круг потенциальных злоумышленников до небольшого числа высококвалифицированных специалистов.

## HSM в {{ kms-name }}

HSM, которые используются в {{ yandex-cloud }} – специализированные защищенные физические серверы, которые поставляются производителем средств криптографической защиты информации – ООО "КриптоПро". 

В устройствах реализован комплекс решений по защите криптосредства на всех этапах его жизненного цикла, включая следующие решения:
* доверенная операционная система;
* защита от физического вскрытия корпуса;
* защита от перепадов напряжения питания и температуры среды;
* надежные датчики случайных чисел;
* защита от «человеческого фактора» (вероятность неверной конфигурации устройства сведена к минимуму);
* доверенная загрузка операционной системы.

### Порядок работы с HSM 

В {{ kms-name }} вы можете создать ключ, все криптооперации с которым будут выполняться только внутри HSM. Cам ключ также будет создан в HSM. В этом случае ключ пользователя хранится в базе данных сервиса {{ kms-name }}, но исключительно в зашифрованном виде. Ключ пользователя шифруется на мастер-ключе HSM, который никогда не покидает HSM.  

Для выполнения всех криптоопераций ключ будет передаваться в HSM. Все криптооперации с ключом пользователя выполняются только внутри HSM, в {{ kms-name }} возвращаются только результаты криптоопераций.  

Криптооперация с использованием HSM включает следующие шаги:

1. Из базы данных {{ kms-name }} извлекается ключ пользователя в зашифрованном виде.
1. Зашифрованный ключ вместе с данными пользователя отправляется в HSM.
1. Внутри HSM происходит расшифровка ключа пользователя на мастер-ключе HSM. 
1. Внутри HSM на расшифрованном ключе производится криптооперация на данных пользователя.
1. Внутри HSM расшифрованный ключ уничтожается.
1. Данные возвращаются пользователю.

### Включение HSM для ключа

Чтобы использовать HSM, при создании ключа выберите тип алгоритма `AES-256 HSM`. Все операции с этим ключом будут выполняться внутри HSM, дополнительные действия не требуются.
