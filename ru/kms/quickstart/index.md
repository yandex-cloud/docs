# Как начать работать c {{ kms-name }}

{% note info %}

Сервис доступен только по заявке: чтобы запросить доступ, заполните [заявку](https://cloud.yandex.ru/services/kms#request-access).

{% endnote %}

В этой инструкции вы создадите свой первый [ключ](../concepts/index.md), а также зашифруете и расшифруете текст с помощью REST API сервиса {{ kms-short-name }}. 


## Подготовка к работе {#before-you-begin}

Чтобы начать работать с {{ kms-name }}:

* Настройте Яндекс.Облако:
  1. Войдите в [консоль управления]({{link-console-main}}). Если вы еще не зарегистрированы, перейдите в консоль управления и следуйте инструкциям.
  1. [На странице биллинга](https://console.cloud.yandex.ru/billing) убедитесь, что у вас подключен [платежный аккаунт](../../billing/concepts/billing-account.md), и он находится в статусе `ACTIVE` или `TRIAL_ACTIVE`. Если платежного аккаунта нет, [создайте его](../../billing/quickstart/index.md#create_billing_account).
  1. Убедитесь, что в нужном облаке у вас есть роль `owner` или `editor`.
* Настройте локальную среду (вам понадобится командная оболочка Bash):
  1. {% include [cli-install](../../_includes/cli-install.md) %}
  1. Скачайте скрипты с командами обращения к API сервиса: [kms-encrypt.sh, kms-decrypt.sh, kms-client.sh](https://github.com/yandex-cloud/examples/tree/master/kms/quickstart).
  1. Установите утилиту [jq](https://stedolan.github.io/jq/download/), которая используется в скриптах для работы с JSON-ответом сервиса.


## Создайте ключ симметричного шифрования {#create-key}

Ключ можно создать в консоли управления:

1. Перейдите в [консоль управления]({{link-console-main}}), выберите сервис {{ kms-name }}.
1. На вкладке **Ключи** нажмите кнопку **Создать** и задайте атрибуты ключа:
   * Имя, например, <q>myFirstKey</q>.
   * Алгоритм шифрования, например AES-256.
   * Период ротации оставьте со значением <q>Нет ротации</q>.
   * Нажмите кнопку **Создать**.
1. Нажмите на строку с именем ключа и убедитесь, что в блоке **Версии** есть первая версия ключа.


## Зашифруйте текст с помощью ключа {#encrypt}

Придумайте секретный текст, например <q>Запуск состоится 42 мартобря.</q>. Размер текста не должен превышать 32 КБ, для шифрования больших объемов данных используйте схему [двойного шифрования](../concepts/encryption.md#envelope-encryption).

Зашифруйте текст:

1. Скопируйте идентификатор (ID) созданного ключа из консоли управления.
1. Перейдите в каталог со скриптами `kms-encrypt.sh`, `kms-decrypt.sh` и `kms-client.sh`.
1. Выполните команду шифрования (`"foo=bar"` — это [AAD-контекст](../concepts/encryption.md#aad), дополнительная проверка при расшифровке):
   ```bash
   $ echo "Запуск состоится 42 мартобря." > plaintext.txt
   $ ./kms-encrypt.sh <ID вашего ключа> "foo=bar" `cat plaintext.txt | base64` > ciphertext.txt
   ```
1. Результат работы команды — файл `ciphertext.txt`, с зашифрованным текстом в кодировке BASE64.


## Расшифруйте текст {#decrypt}

Для расшифровки нужно иметь доступ к ключу {{ kms-short-name }}, и знать AAD-контекст, если он был задан при шифровании.

1. Скопируйте идентификатор (ID) нужного ключа из консоли управления.
1. Перейдите в каталог со скриптами `kms-encrypt.sh`, `kms-decrypt.sh` и `kms-client.sh`.
1. Выполните команду расшифровки (расшифрованный текст будет выведен в терминале):
   ```bash
   $ ./kms-decrypt.sh <ID вашего ключа> "foo=bar" `cat ciphertext.txt` | base64 --decode
   Запуск состоится 42 мартобря.
   ```

#### См. также {#see-also}

- [Ротация ключа](../operations/key.md#rotate)
- [Сменить версию ключа по умолчанию](../operations/version.md#make-primary)
