# Создание кластера

Кластер {{ mkf-name }} — это один или несколько хостов-брокеров, на которых размещены топики и соответствующие топикам разделы. Производители и потребители могут работать с этими топиками, подключившись к хостам кластера. Репликация работает по умолчанию в любом кластере из более чем одного хоста при настройке фактора репликации более "1".

{% note info %}

Если хранилище баз данных заполнится на 95%, кластер перейдет в режим только чтения. Рассчитывайте и увеличивайте необходимый размер хранилища заранее.

{% endnote %}

Хосты {{ KF }}-кластера будут равномерно расположены в выбранных зонах доступности. Количество зон и хостов следует выбирать исходя из требуемой модели отказоустойчивости и нагрузки на кластер. Так, например, для устойчивости к отказу N хостов следует размещать минимум 2*N+1 хостов.

{% include [mkf-zookeeper-hosts](../../_includes/mdb/mkf-zk-hosts.md) %}

{% list tabs %}

- Консоль управления
  

  Чтобы создать кластер, выполните следующие действия: 
  1. В консоли управления выберите каталог, в котором нужно создать кластер.
  1. Выберите сервис **{{ mkf-name }}**.
  1. Нажмите кнопку **Создать кластер**.
  
  1. В блоке **Базовые параметры**:
     1. Введите имя кластера и, при необходимости, его описание. Имя кластера должно быть уникальным в рамках каталога.
     1. Выберите окружение, в котором нужно создать кластер (после создания кластера окружение изменить невозможно):
        - `PRODUCTION` — для стабильных версий ваших приложений.
        - `PRESTABLE` — для тестирования, в том числе самого сервиса {{ mkf-name }}. Prestable-окружение обновляется чаще, из-за чего в нем раньше исправляются уже известные проблемы, но могут происходить обратно несовместимые изменения.
     1. Выберите версию {{ KF }}. На текущий момент поддерживается версия `2.1`.
     
  1. В блоке **Класс хоста** выберите платформу, тип хостов и класс хостов.
  
     Класс хостов определяет технические характеристики виртуальных машин, на которых будут развернуты [брокеры {{ KF }}](../concepts/brokers.md). Все доступные варианты перечислены в разделе [Классы хостов](../concepts/instance-types.md). 
     При изменении класса хостов для кластера меняются характеристики всех уже созданных экземпляров.
     
  1. В блоке **Хранилище**:
     1. Выберите [тип хранилища](../concepts/storage.md) — стандартное сетевое хранилище (**network-hdd**) или быстрое сетевое хранилище (**network-ssd**).
     1. Выберите объем хранилища, который будет использоваться для данных.
     
  1. В блоке **Сетевые настройки**:
     1. Выберите одну или несколько [зон доступности](../../overview/concepts/geo-scope.md), в которых нужно разместить брокеры {{ KF }}.
     1. Выберите [сеть](../../vpc/concepts/network.md). Если в сети нет подсетей для выбранных зон доступности — [создайте их](../../vpc/operations/subnet-create.md).
     
  1. В блоке **Хосты** укажите количество хостов-брокеров {{ KF }} для размещения в каждой выбранной зоне доступности.
  1. Нажмите кнопку **Создать кластер**.

- API
  
  Чтобы создать кластер, воспользуйтесь методом API [create](../api-ref/Cluster/create.md) и передайте в запросе:
  - Идентификатор каталога, в котором должен быть размещен кластер, в параметре `folderId`.
  - Имя кластера в параметре `name`.
  
{% endlist %}
