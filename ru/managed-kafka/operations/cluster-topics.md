# Работа с топиками и разделами

В кластере {{ KF }} вы можете:
- [Создать топик и разделы для него](#create-topic).
- [Изменить настройки топика и его разделов](#update-topic).
- [Удалить топик](#delete-topic).
- [Получить список топиков в кластере](#list-topics).
- [Получить детальную информацию о топике](#get-topic).

## Создать топик {#create-topic}

{% list tabs %}

- Консоль управления

  Чтобы создать топик, выполните следующие действия:
  1. Перейдите на страницу каталога и выберите сервис **{{ mkf-name }}**.
  1. Нажмите на имя нужного кластера, затем выберите вкладку **Топики**.
  1. Нажмите кнопку **Создать топик**.
  1. В блоке **Базовые параметры** задайте:
     - Имя топика (должно быть уникально в пределах кластера {{ mkf-name }}).
     - Количество разделов в топике (Partitions).
     - Фактор репликации (Replication factor). Значение этого параметра не может превышать количество брокеров в кластере.
  1. В блоке **Настройки топика** задайте требуемые [настройки](#topic-settings).
  1. Нажмите кнопку **Создать**.

- API
  
  Воспользуйтесь методом API [create](../api-ref/Topic/create.md) и передайте в запросе:
  - Идентификатор кластера, в котором нужно создать топик, в параметре `cluster_id`. Чтобы узнать идентификатор, [получите список кластеров в каталоге](cluster-list.md#list-clusters). 
  - Настройки топика в параметре `topic_spec`.

{% endlist %}

## Изменить настройки топика {#update-topic}

{% list tabs %}

- Консоль управления

  Чтобы изменить настройки топика, выполните следующие действия:
  1. Перейдите на страницу каталога и выберите сервис **{{ mkf-name }}**.
  1. Нажмите на имя нужного кластера, затем выберите вкладку **Топики**.
  1. Нажмите значок ![image](../../_assets/options.svg) для нужного топика и выберите пункт **Изменить**.
  1. Измените нужные [настройки топика](#topic-settings).
  1. Нажмите кнопку **Сохранить изменения**.

- API

  Воспользуйтесь методом API [update](../api-ref/Topic/update.md) и передайте в запросе:
  - Идентификатор кластера, в котором находится топик, в параметре `cluster_id`. Чтобы узнать идентификатор, [получите список кластеров в каталоге](cluster-list.md#list-clusters).
  - Имя топика в параметре `topic_name`. Чтобы узнать имя, [получите список топиков в кластере](#list-topics).
  - Новые настройки топика в параметре `topic_spec`. 
  
  {% note important %}
  
  Этот метод API сбросит все настройки топика, которые не были явно указаны в параметре `topic_spec`, на значения по умолчанию.
  Чтобы избежать этого, перечислите настройки, которые вы хотите изменить, в параметре `update_mask` (одной строкой через запятую).

  {% endnote %}

{% endlist %}

## Удалить топик {#delete-topic}

{% list tabs %}

- Консоль управления

  Чтобы удалить топик, выполните следующие действия:
  1. Перейдите на страницу каталога и выберите сервис **{{ mkf-name }}**.
  1. Нажмите на имя нужного кластера, затем выберите вкладку **Топики**.
  1. Нажмите значок ![image](../../_assets/options.svg) для нужного топика и выберите пункт **Удалить**.
  1. Подтвердите удаление топика и нажмите кнопку **Удалить**.

- API

  Воспользуйтесь методом API [delete](../api-ref/Topic/delete.md) и передайте в запросе:
  - Идентификатор кластера, в котором находится топик, в параметре `cluster_id`. Чтобы узнать идентификатор, [получите список кластеров в каталоге](cluster-list.md#list-clusters).
  - Имя топика в параметре `topic_name`. Чтобы узнать имя, [получите список топиков в кластере](#list-topics).

{% endlist %}

## Получить список топиков в кластере {#list-topics}

{% list tabs %}

- Консоль управления

  Чтобы получить список топиков, выполните следующие действия:
  1. Перейдите на страницу каталога и выберите сервис **{{ mkf-name }}**.
  1. Нажмите на имя нужного кластера, затем выберите вкладку **Топики**.

- API

  Воспользуйтесь методом API [list](../api-ref/Topic/list.md): передайте значение идентификатора требуемого кластера в параметре `cluster_id` запроса.

  Чтобы узнать идентификатор кластера, [получите список кластеров в каталоге](cluster-list.md#list-clusters).

{% endlist %}

## Получить детальную информацию о топике {#get-topic}

{% list tabs %}

- Консоль управления

  Чтобы получить детальную информацию о топике, выполните следующие действия:
  1. Перейдите на страницу каталога и выберите сервис **{{ mkf-name }}**.
  1. Нажмите на имя нужного кластера, затем выберите вкладку **Топики**.
  1. Нажмите на имя нужного топика.

- API

  Чтобы получить детальную информацию о топике, воспользуйтесь методом API [get](../api-ref/Topic/get.md) и передайте в запросе:
  - Идентификатор кластера, в котором находится топик, в параметре `cluster_id`. Чтобы узнать идентификатор, [получите список кластеров в каталоге](cluster-list.md#list-clusters).
  - Имя топика в параметре `topic_name`. Чтобы узнать имя, [получите список топиков в кластере](#list-topics).

{% endlist %}

## Настройки топика {#topic-settings}

{% list tabs %}

- Консоль управления

  Доступны следующие настройки:
  
  - **Cleanup policy** — политика хранения старых сообщений лога:
    - `CLEANUP_POLICY_DELETE` — эта политика отбрасывает сегменты лога либо при истечении срока их хранения, либо при достижении предельного размера лога.
    - `CLEANUP_POLICY_COMPACT` — эта политика сжимает сообщения в логе.
    - `CLEANUP_POLICY_COMPACT_AND_DELETE` — эта политика использует как сжатие сообщений, так и удаление сегментов лога.
  
    Подробнее см. [в документации {{ KF }}](https://kafka.apache.org/documentation/#cleanup.policy).
  
  - **Compression type** — какой кодек использовать для сжатия сообщений:
    - `Uncompressed` — не использовать сжатие.
    - `Zstd` — кодек Zstandard.
    - `Lz4` — кодек LZ4.
    - `Snappy` — кодек Snappy.
    - `Gzip` — кодек GZip. 
    - `Producer` — кодек задается на стороне производителя.
  
    Подробнее см. [в документации {{ KF }}](https://kafka.apache.org/documentation/#compression.type).
  
  - **Delete delay** — время ожидания перед удалением файла из файловой системы (в миллисекундах).
  
    Подробнее см. [в документации {{ KF }}](https://kafka.apache.org/documentation/#file.delete.delay.ms).
  
  - **Flush messages** — количество сообщений, которые должны быть накоплены в разделе прежде, чем эти сообщения будут сброшены на диск.
    
    Подробнее см. [в документации {{ KF }}](https://kafka.apache.org/documentation/#flush.messages).
    
  - **Flush, ms** — максимальное время (в миллисекундах), в течение которого сообщение в любом топике хранится в памяти перед сбросом на диск.
  
    Подробнее см. [в документации {{ KF }}](https://kafka.apache.org/documentation/#flush.ms).
  
  - **Min compaction lag** — минимальное время в миллисекундах, в течение которого сообщение в логе будет оставаться несжатым.
  
    Подробнее см. [в документации {{ KF }}](https://kafka.apache.org/documentation/#min.compaction.lag.ms).
  
  - **Retention, bytes** — максимальный размер, до которого может вырасти раздел (в байтах), прежде чем {{ KF }} начнет отбрасывать старые сегменты лога, если действует настройка хранения `delete`.
  
    Эта настройка полезна, если вам необходимо контролировать размер лога из-за ограниченного дискового пространства.
    
    Подробнее см. [в документации {{ KF }}](https://kafka.apache.org/documentation/#retention.bytes).
    
  - **Retention, ms** — количество миллисекунд до удаления файла сегмента лога; в течение этого времени {{ KF }} будет хранить файл сегмента лога.

    Подробнее см. [в документации {{ KF }}](https://kafka.apache.org/documentation/#retention.ms).

{% endlist %}