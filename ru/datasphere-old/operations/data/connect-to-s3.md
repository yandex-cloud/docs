# Подключение к хранилищу S3

{% include [link-on-new-ui-datasphere-in-old-ui](../../../_includes/datasphere/datasphere-old-note.md) %}

Вы можете подключиться к объектному хранилищу S3 из интерфейса Jupyter Notebook.

1. Получите ключ доступа у вашего S3-провайдера. Чтобы сделать это в {{ objstorage-full-name }}:
   1. [Создайте сервисный аккаунт](../../../iam/operations/sa/create.md). 
   1. [Назначьте](../../../iam/operations/sa/assign-role-for-sa.md) созданному аккаунту [роль](../../../storage/security/), которая разрешит либо только чтение, либо чтение и запись.
   1. [Создайте ключ доступа](../../../iam/operations/sa/create-access-key.md) для сервисного аккаунта.
1. [Создайте секрет](secret-create.md) в формате `<идентификатор ключа>:<секретный ключ>`.
1. Перейдите на вкладку **S3 Mounts** ![S3 Mounts](../../../_assets/datasphere/bucket.svg) и нажмите значок ![plus](../../../_assets/datasphere/jupyterlab/add.svg).
1. В диалоговом окне заполните поля:
   * **Endpoint** — хост хранилища. Для {{ objstorage-full-name }} это `https://{{ s3-storage-host }}/`.
   * **Bucket** — имя бакета в хранилище.
   * **Mount name** — имя бакета для использования внутри проекта {{ ml-platform-name }}. Автоматически генерируется из значения **Bucket**, но вы можете его поменять.
   * **Static access key** — ключ, созданный в п.1. 
   * **Mode** — режим доступа (**Read Only** — только чтение или **Read / Write** — чтение и запись).
1. Нажмите кнопку **Test connection**. Если проверка прошла успешно, нажмите кнопку **Mount**.

После подключения бакет будет доступен в списке на вкладке **S3 Mounts** ![S3 Mounts](../../../_assets/datasphere/bucket.svg), и его можно будет просматривать как файловую систему.

{% note info %}

Старайтесь не использовать хранилище S3 в режиме [FUSE]{% if lang == "ru" %}(https://ru.wikipedia.org/wiki/FUSE_(модуль_ядра)){% endif %}{% if lang == "en" %}(https://en.wikipedia.org/wiki/Filesystem_in_Userspace){% endif %} для работы в бакете с одноуровневыми (нерекурсивными) каталогами с большим количеством файлов. Такой сценарий использования вызывает существенное снижение производительности хранилища.

{% endnote %}

## Использование S3 в проекте {#usage}

Вы можете обращаться к файлам в подключенном бакете из кода проекта. Выберите нужный файл в подключенном хранилище S3 во вкладке **S3 Mounts** ![S3 Mounts](../../../_assets/datasphere/bucket.svg), нажмите на него правой кнопкой мыши и выберите **Copy path**. Путь к файлу будет скопирован в буфер обмена. Вставьте скопированный путь в нужное место проекта.

## Отключение S3 {#unmount}

Чтобы отключить хранилище S3, выберите бакет в списке на вкладке **S3 Mounts** ![S3 Mounts](../../../_assets/datasphere/bucket.svg), нажмите на него правой кнопкой мыши и выберите **Unmount**.
