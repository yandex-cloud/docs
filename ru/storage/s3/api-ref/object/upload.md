# Метод upload

Загружает объект и его метаданные в {{ objstorage-full-name }}.

{% note info %}

{{ objstorage-name }} не блокирует объект на запись и может принимать одновременно несколько запросов на запись одного объекта, однако по умолчанию пользователь сможет получить из {{ objstorage-name }} только последний записанный объект. Чтобы при перезаписи или удалении объектов сохранялась история, включите [версионирование](../../../concepts/versioning.md).

{% endnote %}

Чтобы убедиться, что объект передан по сети без повреждений, используйте заголовок `Content-MD5`. {{ objstorage-name }} вычислит `MD5` для сохраненного объекта и если вычисленная `MD5` не совпадет с переданной в заголовке, вернет ошибку. Эту проверку можно выполнить и на стороне клиента, сравнив `ETag` из ответа {{ objstorage-name }} с предварительно вычисленной `MD5`.

{% note warning %}

Если в бакете настроены [блокировки версий объектов по умолчанию](../../../concepts/object-lock.md#default), использовать заголовок `Content-MD5` обязательно.

{% endnote %}


## Запрос {#request}

```
PUT /{bucket}/{key} HTTP/2
```

### Path параметры {#path-parameters}

Параметр | Описание
----- | -----
`bucket` | Имя бакета.
`key` | Ключ объекта. Идентификатор, под которым объект будет сохранен в {{ objstorage-name }}.


### Заголовки {#request-headers}

Используйте в запросе необходимые [общие заголовки](../common-request-headers.md).

Дополнительно можно использовать заголовки, перечисленные в таблице ниже.


Заголовок | Описание
----- | -----
`X-Amz-Meta-*` | Пользовательские метаданные объекта.<br/><br/>Все заголовки, начинающиеся с `X-Amz-Meta-`, {{ objstorage-name }} преобразует по правилу: `X-Amz-Meta-foo-bar_baz` → `X-Amz-Meta-Foo-Bar_baz`.<br/><br/>Общий размер пользовательских заголовков не должен превышать 2KB. Размер пользовательских данных определяется как длина строки в кодировке UTF-8. В размере учитываются и названия заголовков и их значения.
`X-Amz-Storage-Class` | [Класс хранилища](../../../concepts/storage-class.md) объекта.<br/><br/>Может иметь любое из значений:<ul><li>`STANDARD` — стандартное хранилище.</li><li>`COLD`, `STANDARD_IA` или `NEARLINE` — холодное хранилище.</li><li>`ICE` или `GLACIER` — ледяное хранилище.</li></ul>Если заголовок не указан, то объект сохраняется в хранилище, установленном в настройках бакета.
`X-Amz-Server-Side-Encryption` | Алгоритм шифрования загружаемого объекта. Доступные значения: `aws:kms`.
`X-Amz-Server-Side-Encryption-Aws-Kms-Key-Id` | Идентификатор [ключа {{ kms-short-name }}](../../../../kms/concepts/key.md) для шифрования загружаемого объекта.
`X-Amz-Object-Lock-Mode` | <p>Тип временной [блокировки](../../../concepts/object-lock.md), устанавливаемой на объект (если бакет [версионируемый](../../../concepts/versioning.md) и в нем включен механизм блокировок):</p><ul><li>`GOVERNANCE` — временная управляемая блокировка.</li><li>`COMPLIANCE` — временная строгая блокировка.</li></ul><p>Вы можете установить на версию объекта только временную блокировку (заголовки `X-Amz-Object-Lock-Mode` и `X-Amz-Object-Lock-Retain-Until-Date`), только бессрочную блокировку (`X-Amz-Object-Lock-Legal-Hold`) или обе сразу. Подробнее об их совместной работе см. в разделе [{#T}](../../../concepts/object-lock.md#types).</p>
`X-Amz-Object-Lock-Retain-Until-Date` | Дата и время окончания временной блокировки в любом из форматов, описанных в [стандарте HTTP](https://www.rfc-editor.org/rfc/rfc9110#name-date-time-formats). Например, `Mon, 12 Dec 2022 09:00:00 GMT`. Указывается только вместе с заголовком `X-Amz-Object-Lock-Mode`.
`X-Amz-Object-Lock-Legal-Hold` | <p>Статус бессрочной [блокировки](../../../concepts/object-lock.md), устанавливаемой на объект (если бакет [версионируемый](../../../concepts/versioning.md) и в нем включен механизм блокировок):</p><ul><li>`ON` — блокировка установлена.</li><li>`OFF` — блокировка не установлена.</li></ul><p>Вы можете установить на версию объекта только временную блокировку (заголовки `X-Amz-Object-Lock-Mode` и `X-Amz-Object-Lock-Retain-Until-Date`), только бессрочную блокировку (`X-Amz-Object-Lock-Legal-Hold`) или обе сразу. Подробнее об их совместной работе см. в разделе [{#T}](../../../concepts/object-lock.md#types).</p>


С помощью заголовков, перечисленных ниже, можно установить [ACL](../../../concepts/acl.md) для загружаемого объекта.

{% include [storage-acl-headers](../../../_includes_service/storage-acl-object-headers.md) %}


## Ответ {#response}

### Заголовки {#response-headers}

Ответ может содержать только [общие заголовки](../common-response-headers.md).

### Коды ответов {#response-codes}

Перечень возможных ответов смотрите в разделе [{#T}](../response-codes.md).

{% include [the-s3-api-see-also-include](../../../../_includes/storage/the-s3-api-see-also-include.md) %}