# Настройка HTTPS

Если бакет используется для [хостинга статического сайта](../../concepts/hosting.md), то для доступа к сайту по протоколу [HTTPS](https://ru.wikipedia.org/wiki/HTTPS) необходимо загрузить собственный сертификат безопасности и соответствующий ему секретный ключ.

{{ objstorage-name }} поддерживает только [PEM](https://en.wikipedia.org/wiki/Privacy-Enhanced_Mail)-encoded сертификаты.

{% note info %}

Доступ к бакету по HTTPS открывается в течение получаса после загрузки сертификата.

{% endnote %}

## Загрузка собственного сертификата безопасности {#own}

{% list tabs %}

- Консоль управления

    1. В [консоли управления]({{ link-console-main }}) выберите каталог.
    1. Выберите сервис **{{ objstorage-name }}**.
    1. Нажмите на имя необходимого бакета.
    1. Перейдите на вкладку **HTTPS**.
    1. В отобразившейся панели справа нажмите кнопку **Настроить**.
    1. В поле **Источник** выберите **Свой сертификат**.
    1. Добавьте сертификат и секретный ключ.
    1. Нажмите кнопку **Сохранить**.

{% endlist %}

## Выбор сертификата из {{ certificate-manager-name }} {#cert-manager}

{% list tabs %}

- Консоль управления

    1. В [консоли управления]({{ link-console-main }}) выберите каталог.
    1. Выберите сервис **{{ objstorage-name }}**.
    1. Нажмите на имя необходимого бакета.
    1. Перейдите на вкладку **HTTPS**.
    1. В отобразившейся панели справа нажмите кнопку **Настроить**.
    1. В поле **Источник** выберите **Перейти в {{ certificate-manager-name }}**.
    1. В поле **Сертификат** выберите сертификат в появившемся списке. 
    
        {% note info %}
        
        Если у вас еще нет ни одного сертификата в {{ certificate-manager-full-name }}, нажмите кнопку **Перейти в {{ certificate-manager-name }}** и воспользуйтесь {% if audience != "internal" %}[инструкцией](../../../certificate-manager/quickstart/index.md){% else %}инструкцией{% endif %}, чтобы создать свой первый сертификат.  
        
        {% endnote %}

    1. Нажмите кнопку **Сохранить**.

- {{ TF }}
 
  {% include [terraform-definition](../../../_tutorials/terraform-definition.md) %}

  Подробнее о {{ TF }} [читайте в документации](../../../tutorials/infrastructure-management/terraform-quickstart.md#install-terraform).

  Чтобы выбрать сертификат из {{ certificate-manager-name }}:

  1. Откройте файл конфигурации {{ TF }} и добавьте блок `https` в описание бакета:

     ```hcl
     ...
     resource "yandex_storage_bucket" "b" {
       bucket = "my-policy-bucket"

       https {
         certificate_id = "<идентификатор_сертификата>"
       }
     }
     ...
     ```

     Где:
     * `certificate_id` — идентификатор сертификата в {{ certificate-manager-name }}, который будет использован для бакета.

     Более подробную информацию о параметрах ресурса `yandex_storage_bucket` в {{ TF }} см. в [документации провайдера]({{ tf-provider-link }}/storage_bucket#bucket-https-certificate).

  1. Проверьте конфигурацию командой:

     ```bash
     terraform validate
     ```
     
     Если конфигурация является корректной, появится сообщение:
     
     ```bash
     Success! The configuration is valid.
     ```

  1. Выполните команду:

     ```bash
     terraform plan
     ```
  
     В терминале будет выведен список ресурсов с параметрами. На этом этапе изменения не будут внесены. Если в конфигурации есть ошибки, {{ TF }} на них укажет.

  1. Примените изменения конфигурации:

     ```bash
     terraform apply
     ```
     
  1. Подтвердите изменения: введите в терминал слово `yes` и нажмите **Enter**.

     Проверить выбранный сертификат можно в [консоли управления]({{ link-console-main }}).

{% endlist %}
