# Объект

Объекты размещаются в бакетах и содержат пользовательские данные произвольного формата в том виде, в котором они были загружены.

Идентификатор объекта — строковый [ключ](#key).

Вместе с объектом {{ objstorage-name }} хранит [пользовательские](#user-meta) и [системные](#system-meta) метаданные.

{{ objstorage-name }} позволяет сохранять объекты в Стандартном и Холодном хранилищах. Подробнее читайте в разделе [{#T}](storage-class.md).

{{ objstorage-name }} поддерживает следующие операции с объектами:

- Загрузка объекта в хранилище.
- Скачивание объекта из хранилища.
- Копирование объекта внутри хранилища, например, из бакета в бакет.

Все остальные операции, которые можно выполнить с помощью [инструментов](../tools/index.md), являются комбинациями из указанных выше.

Для объектов в бакете можно настраивать [жизненные циклы](lifecycles.md).

{{ objstorage-name }} накладывает ограничения на размеры объектов и их метаданных. Подробнее смотрите в разделе [{#T}](limits.md)).

## Ключ {#key}

Ключ — это идентификатор объекта в бакете.

Структура хранения объектов плоская, хотя [инструменты](../tools/index.md) с графическим интерфейсом предлагают работать с {{ objstorage-name }} как с иерархической файловой системой. Видимость иерархического хранилища достигается за счет того, что ключи можно записывать как пути в файловой системе, например, `top_level_prefix/subprefix/text_data.txt`. В консоли управления {{ yandex-cloud }} префиксы называются папками.

Ключ должен:

- иметь кодировку UTF-8;
- быть меньше 1024 байт;
- не содержать символов `: * ? " < > | !`.

Для использования в ключе безопасны следующие символы: `[a-zA-Z0-9]`, `-`, `_`, `/`, `\`. Другие символы могут вызвать различные проблемы при использовании {{ objstorage-name }}.

### Папка {#folder}

В {{ objstorage-name }} нет папок, однако графические файловые менеджеры, например, [CyberDuck](../tools/cyberduck.md) или интерфейс к {{ objstorage-name }} в консоли управления {{ yandex-cloud }} имитируют папки. В роли папки выступает объект с нулевым размером, ключ которого входит в ключи других объектов как префикс. Например, объект с ключом `x` и размером 0 в консоли управления будет папкой, а объект с ключом `x/y.txt` — объектом `y.txt`, лежащим в папке `x`.

Каждый из [инструментов](../tools/index.md) управляет объектами и папками согласно своей логике, которая описана в документации на каждый из них.

{% note info %}

Удаление папки с объектами — асинхронная операция. В начале операции {{ objstorage-name }} готовит список объектов для удаления, затем удаляет их. Если в процессе удаления в {{ objstorage-name }} загрузить объект, который должен лежать в той папке, которая удаляется в текущий момент времени, то объект успешно загрузится. После завершения обеих операций в {{objstorage-name}} останется папка, которая должна была быть удалена, с новым загруженным объектом.

{% endnote %}

## URL объекта {#object-url}

Ссылку на объект в бакете можно указывать в одном из форматов:
- Для бакета с публичным доступом:
  - `https://<bucket>.{{ s3-storage-host }}/<key>`
  - `https://{{ s3-storage-host }}/<bucket>/<key>`
- Для бакета с ограниченным доступом:
  - `https://{{ s3-storage-host }}/<bucket>/<key>?<parameters>`
  - `https://<bucket>.{{ s3-storage-host }}/<key>?<parameters>`

Где:

* `bucket` — имя бакета.
* `key` — [ключ](#key) (путь к файлу).
* `parameters` — дополнительные параметры, необходимые для доступа к бакету с ограниченным доступом. Например подпись и срок действия.

Для бакета с ограниченным доступом сервисом генерируется подписанная ссылка, которая позволяет временно скачать объект даже из бакета с ограниченным доступом. [Подробнее про подписанные ссылки, их генерацию и использование](pre-signed-urls.md).

{% include [storage-dotnet-host](../_includes_service/storage-dotnet-host.md) %}

## Метаданные {#metadata}

С объектом хранятся метаданные в виде пар `имя-значение`.

Метаданные могут быть системными и пользовательскими.

### Системные метаданные {#system-meta}

Системные метаданные определяются {{ objstorage-name }}.

Имя | Описание
----- | -----
`Date` | Дата и время отправки запроса на загрузку объекта в {{ objstorage-name }}.
`Content-Length` | Размер объекта в байтах.
`Last-Modified` | Дата создания или последнего изменения объекта.
`Content-MD5` | MD5 хэш объекта, закодированный в base64.
`Cache-Control` | Значение HTTP заголовка `Cache-Control`, который клиент передает при сохранении объекта в бакет. В дальнейшем, {{ objstorage-name }} возвращает этот заголовок клиентам при ответе на запрос объекта или его метаданных.<br/><br/>Например, заголовок `Cache-Control: max-age=200` обозначает, что объект устаревает через 200 секунд после того, как клиент получил его. Подробнее о заголовке читайте в [RFC 7234](https://tools.ietf.org/html/rfc7234#section-5.2).
`Expires` | Значение HTTP заголовка `Expires`, который клиент передает при сохранении объекта в бакет. В дальнейшем, {{ objstorage-name }} возвращает этот заголовок клиентам при ответе на запрос объекта или его метаданных.<br/><br/>Например, заголовок `Expires: Thu, 15 Apr 2020 20:00:00 GMT` обозначает, что объект устаревает 15 апреля 2020 года в 20:00:00 по Гринвичу. Подробнее о заголовке читайте в [RFC 7234](https://tools.ietf.org/html/rfc7234#section-5.3).


### Пользовательские метаданные {#user-meta}

При загрузке объекта в {{ objstorage-name }}, вместе с ним можно передать набор метаданных в виде пар `имя-значение`.

В HTTP API, совместимом с Amazon S3, метаданные передаются в виде HTTP-заголовков. Имя заголовка должно начинаться с `X-Amz-Meta-`. При запросе объекта через HTTP API Object Storage возвращает метаданные в виде HTTP-заголовков с этим же префиксом.

Имена метаданных должны состоять только из [ASCII-символов](https://{{ lang }}.wikipedia.org/wiki/ASCII). Передаваемые заголовки будут преобразованы по правилу: `X-Amz-Meta-foo-bar_baz` → `X-Amz-Meta-Foo-Bar_baz`. Здесь `Foo-Bar_baz` – имя метаданных, которые будут сохранены вместе с объектом.

{% note info %}

Заголовок PUT-запроса не должен превышать 8 КБ. Размер пользовательских метаданных в этом заголовке не должен превышать 2 КБ.

{% endnote %}

