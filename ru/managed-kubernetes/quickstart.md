# Начало работы

Создайте [кластер {{ k8s }}](concepts/index.md#kubernetes-cluster) и [группу узлов](concepts/index.md#node-group), и управляйте ими с помощью kubectl — командной оболочки {{ k8s}}.

## Перед началом работы {#before-you-begin}

Чтобы начать работать c сервисом {{ managed-k8s-short-name }}:

1. Перейдите в [консоль управления]({{ link-console-main }}), затем войдите в Облако или зарегистрируйтесь, если вы еще не зарегистрированы.
1. [На странице биллинга]({{ link-console-billing }}) убедитесь, что у вас подключен [платежный аккаунт](../billing/concepts/billing-account.md), и он находится в статусе `ACTIVE` или `TRIAL_ACTIVE`. Если платежного аккаунта нет, [создайте его](../billing/quickstart/index.md#create_billing_account).
1. Если у вас еще нет каталога, [создайте его](../resource-manager/operations/folder/create.md).
1. Установите [Kubernetes CLI (kubectl)](https://kubernetes.io/docs/tasks/tools/install-kubectl/).
1. Убедитесь, что у вас достаточно [свободных ресурсов в облаке](concepts/limits.md).
1. Если у вас еще нет сети, [создайте ее](../vpc/operations/network-create.md).
1. Если у вас еще нет подсетей, [создайте их](../vpc/operations/subnet-create.md) в зонах доступности, где будут созданы кластер {{ k8s }} и группа узлов.
1. Создайте [сервисные аккаунты](../iam/operations/sa/create.md):
    - Сервисный аккаунт для ресурсов с ролью [{{ roles-editor }}](../resource-manager/security/#roles-list) на каталог, в котором создается кластер {{ k8s }}. От его имени будут создаваться ресурсы, необходимые кластеру {{ k8s }}.
    - Сервисный аккаунт для узлов с ролью [{{ roles-cr-puller }}](../container-registry/security/index.md#required-roles) на каталог с реестром Docker-образов. От его имени узлы будут скачивать из реестра необходимые Docker-образы.
    
    Вы можете использовать один и тот же сервисный аккаунт для обеих операций.

## Создайте кластер {{ k8s }} {#kubernetes-cluster-create}

Чтобы создать кластер {{ k8s }}:
1. В [консоли управления](https://console.cloud.yandex.ru) выберите каталог, в котором будет создан кластер {{ k8s }}.
1. В списке сервисов выберите **{{ managed-k8s-name }}**.
1. Нажмите кнопку **Создать кластер**.
1. Введите имя и описание кластера {{ k8s }}. Требования к имени:

    {% include [name-format](../_includes/name-format.md) %}
1. В блоке **Конфигурация мастера**:
    - Выберите [зону доступности](../overview/concepts/geo-scope.md), в которой будет создан [мастер](concepts/index.md#master).
    - Выберите **Сервисный аккаунт для ресурсов**, который будет использоваться для создания ресурсов.
    - Выберите **Сервисный аккаунт для узлов**, который будет использоваться узлами для доступа к реестру Docker-образов.
    - В поле **Публичный адрес** выберите способ назначения адреса:
        - **Автоматически** — чтобы назначить случайный IP-адрес из пула адресов Яндекс.Облака.
        - **Без адреса** — чтобы не назначать публичный IP-адрес.
    - В поле **Формат сети** выберите способ отображения сетей:
        - **Список** — отображается список доступных сетей. Если у вас нет облачной сети, нажмите кнопку **Создать сеть**: 
            - В открывшемся окне задайте имя сети. Укажите, что необходимо создать подсети. Нажмите кнопку **Создать сеть**. По умолчанию будет создана сеть с подсетями в каждой зоне доступности.
        - **ID** — необходимо ввести уникальные идентификаторы необходимых сетей.
1. В блоке **Сетевые настройки кластера**:
    - Укажите **CIDR кластера** — диапазон IP-адресов, из которого будут выделяться IP-адреса для подов.
    - Укажите **CIDR сервисов** — диапазон IP-адресов, из которого будут выделяться IP-адреса для сервисов.
    - (опционально) Укажите **Адрес шлюза** — если вы не хотите создавать узлы с публичным IP-адресом, [настройте ВМ в качестве NAT-инстанса](operations/nat-instance.md) и укажите здесь внутренний IP-адрес этой ВМ.
1. Нажмите кнопку **Создать кластер**.
 
## Добавьте учетные данные в конфигурационный файл kubectl {#add-conf}

{% list tabs %}
    
- CLI
    
    {% include [cli-install](../_includes/cli-install.md) %}
    
    {% include [default-catalogue](../_includes/default-catalogue.md) %}
    
    Чтобы добавить учетные данные кластера {{ k8s }} в конфигурационный файл kubectl:
    1. Выполните команду:
    
        ```
        $ yc managed-kubernetes cluster get-credentials test-k8s-cluster --external
        ```
        
        - По умолчанию учетные данные добавляются в директорию `$HOME/.kube/config`.
        - Если необходимо изменить расположение конфигураций, используйте флаг `--kubeconfig <путь к файлу>`.
    1. Проверьте конфигурацию kubectl после добавления учетных данных:
    
        ```
        $ kubectl config view
        apiVersion: v1
        clusters:
        - cluster:
            certificate-authority-data: DATA+OMITTED
        ...
        ```
        
{% endlist%}

## Создайте группу узлов {#node-group-create}

Чтобы создать группу узлов: 
1. В [консоли управления](https://console.cloud.yandex.ru) выберите каталог, в котором будет создан кластер {{ k8s }}.
1. В списке сервисов выберите **{{ managed-k8s-name }}**.
1. Выберите кластер {{ k8s }}, для которого необходимо создать группу узлов.
1. На странице кластера {{ k8s }} перейдите на вкладку **Группы узлов**.
1. Нажмите кнопку **Создать группу узлов**.
1. Введите имя и описание группы узлов. Требования к имени:

    {% include [name-format](../_includes/name-format.md) %}
1. Укажите количество узлов в группе узлов.
1. В блоке **Вычислительные ресурсы**:
    - Выберите [платформу](../compute/concepts/vm-platforms.md).
    - Укажите [гарантированную долю](../compute/concepts/performance-levels.md) и необходимое количество vCPU, а также объем RAM.
    - (опционально) Укажите, что виртуальная машина должна быть [прерываемой](../compute/concepts/preemptible-vm.md).
1. В блоке **Хранилище**:
    - Укажите **Тип диска** узла:
        - **HDD** — стандартный сетевой диск, сетевое блочное хранилище на HDD-накопителе.
        - **SSD** — быстрый сетевой диск, сетевое блочное хранилище на SSD-накопителе. 
    - Укажите размер диска узла.
1. В блоке **Сетевые настройки**:
    - В поле **Публичный адрес** выберите способ назначения адреса:
        - **Автоматически** — чтобы назначить случайный IP-адрес из пула адресов Яндекс.Облака.
        - **Без адреса** — чтобы не назначать публичный IP-адрес.
    - Укажите расположение узлов по зонам доступности и сетям.
    - (опционально) Нажмите кнопку **Добавить расположение** и укажите дополнительную зону доступности и сеть, чтобы создать узлы в разных зонах доступности. 
1. В блоке **Доступ** укажите данные для доступа на узел:
    - В поле **Логин** введите имя пользователя.
    - В поле **SSH-ключ** вставьте содержимое файла [публичного ключа](operations/node-connect-ssh.md#creating-ssh-keys).
1. Нажмите кнопку **Создать группу узлов**.

## Что дальше {#what-is-next}

- Ознакомьтесь с [концепциями сервиса](concepts/index.md).
- Узнайте, как [работать с кластером {{ k8s }} и группами узлов](operations/index.md).
