---
title: "Начало работы с управляемым {{ k8s }}"
description: "В этой инструкции вы создадите кластер {{ k8s }} и группу узлов, научитесь управлять ими с помощью kubectl — командной оболочки {{ k8s }}. Для начала создайте кластер {{ k8s }}, добавьте учетные данные в конфигурационный файл kubectl, создайте группу узлов."
---

# Начало работы с {{ managed-k8s-name }}

Создайте [кластер {{ managed-k8s-name }}](concepts/index.md#kubernetes-cluster) и [группу узлов](concepts/index.md#node-group), и управляйте ими с помощью kubectl — командной оболочки {{ k8s}}.

## Перед началом работы {#before-you-begin}

Чтобы начать работать с сервисом {{ managed-k8s-name }}:
1. Перейдите в [консоль управления]({{ link-console-main }}), затем войдите в {{ yandex-cloud }} или зарегистрируйтесь, если вы еще не зарегистрированы.

{% if product == "yandex-cloud" %}

1. [На странице биллинга]({{ link-console-billing }}) убедитесь, что у вас подключен [платежный аккаунт](../billing/concepts/billing-account.md), и он находится в статусе `ACTIVE` или `TRIAL_ACTIVE`. Если платежного аккаунта нет, [создайте его](../billing/quickstart/index.md#create_billing_account).

{% endif %}

1. Если у вас еще нет [каталога](../resource-manager/concepts/resources-hierarchy.md#folder), [создайте его](../resource-manager/operations/folder/create.md).
1. Установите [{{ k8s }} CLI (kubectl)]({{ k8s-docs }}/tasks/tools/install-kubectl/).
1. Убедитесь, что у вас достаточно [свободных ресурсов в облаке](concepts/limits.md).
1. Если у вас еще нет [сети](../vpc/concepts/network.md#network), [создайте ее](../vpc/operations/network-create.md).
1. Если у вас еще нет [подсетей](../vpc/concepts/network.md#subnet), [создайте их](../vpc/operations/subnet-create.md) в [зонах доступности](../overview/concepts/geo-scope.md), где будут созданы кластер {{ k8s }} и группа узлов.
1. Создайте [сервисные аккаунты](../iam/operations/sa/create.md):
   * С ролью [{{ roles-editor }}](../iam/concepts/access-control/roles.md#editor) на каталог, в котором создается кластер. От имени этого сервисного аккаунта будут создаваться ресурсы, необходимые кластеру {{ managed-k8s-name }}.
   * С ролью [{{ roles-cr-puller }}](../iam/concepts/access-control/roles.md#cr-images-puller) на каталог с [реестром](../container-registry/concepts/registry.md) [Docker-образов](../container-registry/concepts/docker-image.md). От его имени узлы будут скачивать из реестра необходимые Docker-образы.

   Вы можете использовать один и тот же сервисный аккаунт для обеих операций.

   {% include [k8s.tunnelClusters.agent role](../_includes/managed-kubernetes/note-tunnelClusters-agent.md) %}

## Создайте кластер {{ managed-k8s-name }} {#kubernetes-cluster-create}

1. В [консоли управления]({{ link-console-main }}) выберите каталог, в котором нужно создать кластер {{ managed-k8s-name }}.
1. Выберите сервис **{{ managed-k8s-name }}**.
1. Нажмите кнопку **Создать кластер**.
1. Введите имя кластера. Оно должно быть уникальным в рамках каталога.
1. (Опционально) Введите описание кластера.
1. **Сервисный аккаунт для ресурсов** — укажите [сервисный аккаунт](../iam/concepts/users/service-accounts.md) с ролью [{{ roles-editor }}](../iam/concepts/access-control/roles.md#editor), который будет использоваться для создания ресурсов.
1. **Сервисный аккаунт для узлов** — укажите сервисный аккаунт с ролью [{{ roles-cr-puller }}](../iam/concepts/access-control/roles.md#cr-images-puller), который будет использоваться узлами для доступа к реестру Docker-образов.
1. Укажите [релизный канал](concepts/release-channels-and-updates.md). Эту настройку невозможно изменить после создания кластера.
1. В блоке **Конфигурация мастера**:
   * **Версия {{ k8s }}** выберите версию {{ k8s }}, которая будет установлена на [мастере](concepts/index.md#master).
   * **Публичный адрес** выберите способ назначения адреса:
     * **Автоматически** — чтобы назначить случайный IP-адрес из пула адресов {{ yandex-cloud }}.
     * **Без адреса** — чтобы не назначать публичный IP-адрес.
   * **Тип мастера** — выберите тип мастера:
     * **Зональный** — будет создан один хост-мастер в выбранной зоне доступности. Укажите облачную сеть и выберите в ней подсеть для размещения хоста-мастера.
     * **Региональный** — в каждой зоне доступности будет создано по одному хосту-мастеру. Укажите облачную сеть и подсеть для каждой зоны доступности.
   * Выберите [группы безопасности](operations/connect/security-groups.md) для сетевого трафика кластера.
1. В блоке **Сетевые настройки кластера**:
   * **CIDR кластера** — укажите диапазон IP-адресов, из которого будут выделяться IP-адреса для подов.
   * **CIDR сервисов** — укажите диапазон IP-адресов, из которого будут выделяться IP-адреса для сервисов.
   * Задайте маску подсети узлов и максимальное количество подов в узле.
1. Нажмите кнопку **Создать кластер**.

Подробнее см. в [пошаговой инструкции по созданию кластера](operations/kubernetes-cluster/kubernetes-cluster-create.md).

## Добавьте учетные данные в конфигурационный файл kubectl {#add-conf}

{% list tabs %}

- CLI

  {% include [cli-install](../_includes/cli-install.md) %}

  {% include [default-catalogue](../_includes/default-catalogue.md) %}

  Чтобы добавить учетные данные кластера {{ managed-k8s-name }} в конфигурационный файл kubectl:
  1. Выполните команду:

     ```bash
     yc managed-kubernetes cluster get-credentials test-k8s-cluster --external
     ```

     * По умолчанию учетные данные добавляются в директорию `$HOME/.kube/config`.
     * Если необходимо изменить расположение конфигураций, используйте флаг `--kubeconfig <путь к файлу>`.
  1. Проверьте конфигурацию kubectl после добавления учетных данных:

     ```bash
     kubectl config view
     ```

     Результат выполнения команды:

     ```yml
     apiVersion: v1
     clusters:
       - cluster:
         certificate-authority-data: DATA+OMITTED
     ...
     ```

{% endlist %}

## Создайте группу узлов {#node-group-create}

Чтобы создать группу узлов:
1. В [консоли управления]({{ link-console-main }}) выберите каталог, в котором создан нужный кластер {{ managed-k8s-name }}.
1. В списке сервисов выберите **{{ managed-k8s-name }}**.
1. Выберите кластер {{ managed-k8s-name }}, для которого необходимо создать группу узлов.
1. На странице кластера {{ managed-k8s-name }} перейдите на вкладку ![nodes-management.svg](../_assets/nodes-management.svg) **Управление узлами**.
1. Нажмите кнопку **Создать группу узлов**.
1. Введите имя и описание группы узлов.
1. Укажите **Версию {{ k8s }}** для узлов.
1. В блоке **Масштабирование** выберите его тип:
   * **Фиксированный**, чтобы количество узлов в группе оставалось неизменным. Укажите количество узлов в группе.
   * **Автоматический**, чтобы управлять количеством узлов в группе с помощью [автоматического масштабирования кластера](concepts/autoscale.md#ca).
1. В блоке **В процессе создания и обновления разрешено** укажите максимальное количество [виртуальных машин](../compute/concepts/vm.md), на которое можно превысить и уменьшить размер группы.
1. В блоке **Вычислительные ресурсы**:
   * Выберите [платформу](../compute/concepts/vm-platforms.md).
   * Укажите необходимое количество vCPU и [гарантированную долю vCPU](../compute/concepts/performance-levels.md), а также объем RAM.
   * (опционально) Укажите, что ВМ должна быть [прерываемой](../compute/concepts/preemptible-vm.md).
1. В блоке **Хранилище**:
   * Укажите **Тип диска** для узлов группы:
     * **HDD** — стандартный сетевой диск, сетевое блочное хранилище на HDD-накопителе.
     * **SSD** — быстрый сетевой диск, сетевое блочное хранилище на SSD-накопителе.
     * **Нереплицируемый SSD** — сетевой диск с повышенной производительностью, реализованной за счет устранения избыточности.

     Подробнее о типах дисков см. в [документации {{ compute-full-name }}](../compute/concepts/disk.md#disks_types).
   * Укажите размер дисков для узлов группы.
1. В блоке **Сетевые настройки**:
   * В поле **Публичный адрес** выберите способ назначения адреса:
     * **Автоматически** — чтобы назначить случайный IP-адрес из пула адресов {{ yandex-cloud }}.
     * **Без адреса** — чтобы не назначать публичный IP-адрес.
   * Выберите [группы безопасности](operations/connect/security-groups.md).
   * Выберите зону доступности и подсеть для размещения узлов группы.
1. В блоке **Доступ** укажите данные для доступа к узлам группы по SSH:
   * **Логин** — укажите имя пользователя.
   * **SSH-ключ** — вставьте содержимое файла [публичного ключа](operations/node-connect-ssh.md#creating-ssh-keys).
1. Нажмите кнопку **Создать**.

Подробнее см. в [пошаговой инструкции по созданию группы узлов](operations/node-group/node-group-create.md).

## Что дальше {#what-is-next}

* Ознакомьтесь с [концепциями сервиса](concepts/index.md).
* Узнайте, как [работать с кластером {{ managed-k8s-name }} и группами узлов](operations/index.md).
* Ознакомьтесь с [вопросами и ответами](qa/all.md).
* Изучите [рекомендации по использованию {{ k8s }}](concepts/usage-recommendations.md).