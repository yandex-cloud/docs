# Релизные каналы

{{ managed-k8s-name }} предоставляет обновления с помощью [релизных каналов](#release-channels).

В сервисе поддерживается три релизных канала {{ k8s }}. Версии мастера и группы узлов независимы, вы можете создавать их с указанием различных версий {{ k8s }}, доступных в пределах одного релизного канала.

{% include [note-about-version](../../_includes/managed-kubernetes/note-about-version.md) %}

При создании кластера {{ k8s }} вы указываете один из трех релизных каналов. Изменить канал после создания кластера {{ k8s }} нельзя, возможно только пересоздать кластер {{ k8s }} и указать новый релизный канал. В таблице ниже описаны релизные каналы и представлена актуальная информация о поддерживаемых версиях {{ k8s }}.

Канал | Версии {{ k8s }} | Автообновления | Описание канала
--- | --- | --- | ---
`rapid`| 1.18, 1.19, 1.20, 1.21, 1.22 | Нельзя отключить автообновления. Можно указать временной промежуток для автообновления. | Канал содержит последние версии {{ k8s }}. На канале часто появляются минорные обновления, содержащие новую функциональность и улучшения.
`regular`| 1.18, 1.19, 1.20, 1.21 | Можно отключить автообновления. | Содержит различные версии {{ k8s }}. Новая функциональность и улучшения порциями попадают на канал через некоторое время после того, как были предоставлены на канале `rapid`.
`stable`| 1.18, 1.19, 1.20, 1.21 | Можно отключить автообновления. | Содержит стабильную версию {{ k8s }}. На канале происходят только обновления, касающиеся исправления ошибок или улучшения безопасности.

## Обновления {#updates}

Когда на релизном канале появляется обновление, соответствующая информация отображается в консоли управления. Устанавливать обновления можно автоматически или вручную.
* Автоматическое обновление устанавливается без участия пользователя в заданный промежуток времени.

  Обновление будет инициировано в указанный промежуток времени и должно завершиться также в рамках этого промежутка. В некоторых случаях при обновлении группы узлов обновление может продолжаться за рамками указанного временного промежутка.

  В автоматическое обновление входят: новая функциональность, улучшения или исправления сервиса {{ managed-k8s-name }}, а также исправления компонентов {{ k8s }}.

  {% note alert %}

  В случае [прекращения поддержки версии {{ k8s }}](#unsupported), обновляется также минорная версия {{ k8s }}.

  {% endnote %}

* Ручное обновление инициируется пользователем в любое время.

  В ручное обновление входит обновление минорной версии {{ k8s }}.

Прочитайте подробнее про [прекращение поддержки версии {{k8s}}](#unsupported), а также как проиходит [процесс обновления для разных компонентов кластера {{ k8s }}](#cluster-upd).

### Прекращение поддержки версии {{ k8s }} {#unsupported}

Когда после обновления старая версия {{ k8s }} больше не поддерживается:
* Мастер автоматически обновляется, даже если автообновления выключены.
* Группы узлов автоматически обновляются, если автообновления включены. Если автообновления выключены, на группах узлов остается старая версия {{ k8s }}. В этом случае все проблемы, связанные с группой узлов, пользователь решает самостоятельно, так как старая версия {{ k8s }} становится неподдерживаемой.

### Процесс обновления компонентов кластера {{ k8s }} {#cluster-upd}

Процесс обновления для [мастера](#master) и для [группы узлов](#node-group) различается.

#### Мастер {#master}

{% if product == "yandex-cloud" %}

Для разных типов мастера обновление различается временем, в течение которого мастер будет недоступен:
* Зональный мастер — недоступен в течение обновления.
* Региональный мастер — не теряет сетевую доступность во время обновления.

{% endif %}

{% if product == "cloud-il" %}

Зональный мастер недоступен в течение обновления.

{% endif %}

Подробнее см. в разделе [Обновление кластера](../operations/update-kubernetes.md#cluster-upgrade).

#### Группа узлов {#node-group}

Группа узлов обновляется с выделением дополнительных ресурсов — через создание узлов с новой конфигурацией.

{% note warning %}

Чтобы обновление с выделением дополнительных ресурсов прошло успешно, у вас должно быть достаточно [квот](limits.md) на создание одного дополнительного узла.

{% endnote %}

Алгоритм обновления группы узлов:
1. Создается обновленный узел с конфигурацией, указанной для всей группы узлов.
1. С одного из старых узлов [расселяются](node-group/node-drain.md) все поды с учетом описанной политики PodDisruptionBudgets, затем этот узел удаляется.
1. Процесс повторяется до тех пор, пока не будут обновлены все узлы в группе узлов.

Такой процесс обновления гарантирует, что количество узлов в группе никогда не опустится ниже количества, заданного при создании группы узлов.

Вы можете указать максимальное количество виртуальных машин, на которое можно превысить или уменьшить размер группы при ее обновлении. Подробнее см. в разделе [Обновление группы узлов](../operations/update-kubernetes.md#node-group-upgrade).

#### Сертификаты {#certificates}

В соответствии с рекомендациями по безопасности [сертификаты кластера и групп узлов](https://kubernetes.io/docs/setup/best-practices/certificates/) выпускаются на один год. Когда срок действия сертификата закончится, кластер или группа узлов станут неработоспособными. Чтобы этого избежать, сервис {{ managed-k8s-name }} автоматически обновляет их сертификаты:
* Если автоматическое обновление включено, сертификаты обновляются автоматически при каждом обновлении кластера или группы узлов.
* Если автоматическое обновление выключено, сертификаты будут обновлены принудительно за неделю до окончания их срока действия.

Подробнее об обновлении сертификатов см. в [документации {{ k8s }}](https://kubernetes.io/docs/tasks/tls/certificate-rotation/).
