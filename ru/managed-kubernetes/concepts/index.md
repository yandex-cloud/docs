# Взаимосвязь ресурсов сервиса

[{{ k8s }}](https://{{ k8s }}.io) — система для управления контейнерными приложениями. {{ k8s }} предоставляет механизмы взаимодействия с кластером, с помощью которых осуществляется автоматизации развертывания, масштабирования и управления приложениями в контейнерах.

Основная сущность, которой оперирует сервис — _кластер {{ k8s }}_.

## Кластер {{ k8s }} {#kubernetes-cluster}

Кластер {{ k8s }} состоит из мастера и одной или нескольких групп узлов. Мастер отвечает за управление кластером {{ k8s }}. На узлах запускаются контейнеризованные приложения пользователя.

Сервис полностью управляет мастером, а также следит за состоянием и работоспособностью группы узлов. Пользователь может управлять узлами напрямую, а также настраивать кластер {{ k8s }} с помощью консоли управления {{ yandex-cloud }}, CLI и API Managed Service for Kubernetes.

{% note warning %}

Группам узлов {{ k8s }} требуется доступ в интернет для скачивания образов и компонентов.
Предоставить доступ в интернет можно следующими способами:
- Назначить каждому узлу в группе [публичный IP адрес](../../vpc/concepts/address.md#public-addresses).
- [Настроить виртуальную машину в качестве NAT-инстанса](../../solutions/routing/nat-instance.md).
- [Включить функцию NAT в интернет](../../vpc/operations/enable-nat.md).

{% endnote %}

При работе с кластером {{ k8s }} на инфраструктуре {{ yandex-cloud }} задействуются следующие ресурсы:

| Ресурс | Количество | Комментарий |
|----|:---:|----|
|Подсеть |2| {{ k8s }} резервирует диапазоны IP-адресов, которые будут использоваться для подов и сервисов. |
|Публичный IP |N|В количество N входит:</br> - **Один** публичный IP для NAT-инстанса.</br> - Публичный IP **каждому** узлу в группе, если вы используете технологию one-to-one NAT.</br> |

### Мастер {#master}

_Мастер_ — компонент, который управляет кластером {{ k8s }}.

Мастер запускает управляющие процессы {{ k8s }}, которые включают сервер {{ k8s }} API, планировщик и контроллеры основных ресурсов. Жизненный цикл мастера управляется сервисом при создании или удалении кластера {{ k8s }}. Мастер отвечает за глобальные решения, которые выполняются на всех узлах кластера {{ k8s }}. Они включают в себя планирование рабочих нагрузок, таких как контейнерные приложения, управление жизненным циклом рабочих нагрузок и масштабированием.

Мастер бывает двух типов, которые отличаются расположением в [зонах доступности](../../overview/concepts/geo-scope.md):  
- _Зональный_ — создается в подсети в одной зоне доступности.
- _Региональный_ — создается распределенно в трех подсетях в каждой зоне доступности. При недоступности одной зоны региональный мастер остается работоспособным. 

    {% note warning %}
        
    Внутренний IP-адрес регионального мастера доступен только в пределах одной облачной сети {{ vpc-full-name }}.
    
    {% endnote %}

### Группа узлов {#node-group}

_Группа узлов_ — группа виртуальных машин с одинаковой конфигурацией в кластере {{ k8s }}, на которых запускаются пользовательские контейнеры.

#### Конфигурация {#config}

При создании группы узлов пользователь может сконфигурировать следующие параметры виртуальных машин:
- Тип виртуальной машины.
- Тип и количество ядер (vCPU).
- Объем памяти (RAM) и диска.

В одном кластере {{ k8s }} можно создавать группы с разными конфигурациями и размещать их в разных [зонах доступности](../../overview/concepts/geo-scope.md).

#### Подключение к узлам группы {#node-connect-ssh}

К узлам группы можно подключаться по SSH. О том, как это сделать, читайте в разделе [Подключиться к узлу по SSH](../operations/node-connect-ssh.md).

### Под {#pod}

_Под_ — запрос на запуск одного или более контейнеров на одном узле группы. В рамках кластера {{ k8s }} каждый под имеет уникальный IP-адрес, чтобы приложения не конфликтовали при использовании портов.

Контейнеры описываются в поде через объект, написанный на языке JSON или YAML.

### Сервис {#service}

_Сервис_ — абстракция, которая обеспечивает функции сетевой балансировки нагрузки. Правила подачи трафика настраиваются для группы подов, объединенных набором меток.

По умолчанию сервис доступен только внутри конкретного кластера {{ k8s }}, но может быть общедоступным и получать [запросы извне](../operations/create-load-balancer.md#lb-create) кластера {{ k8s }}.

### Пространство имен {#namespace}

_Пространство имен_ — абстракция, которая логически изолирует ресурсы кластера {{ k8s }} и распределяет квоты на них. Это полезно для разделения ресурсов разных команд и проектов в одном кластере {{ k8s }}.

### Метки {#labels}

_Метки_ — основной механизм группировки в {{ k8s }}. Большинство сценариев работы с несколькими объектами (например, подача трафика через сервис, настройка сетевых политик, контроллеры приложений) используют селекторы по значениям меток. Это позволяет определить  подмножества управляемых объектов (обычно подов).