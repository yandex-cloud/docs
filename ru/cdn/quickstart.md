# Как начать работать с {{ cdn-full-name }}

Настройте раздачу контента через CDN на примере статического сайта в {{ objstorage-name }}:

1. [{#T}](#create-cdn-resource).
1. [{#T}](#upload-content-to-CDN).
1. [{#T}](#setup-cname).
1. [{#T}](#check-cdn-working).

## Перед началом работы {#before-you-begin}

1. Убедитесь, что у вас есть доменное имя и доступ к настройкам DNS на сайте компании, которая предоставляет вам услуги DNS-хостинга. Обычно это компания-регистратор вашего домена.
1. Перейдите в [консоль управления]({{ link-console-main }}), затем войдите в {{ yandex-cloud }} или зарегистрируйтесь, если вы еще не зарегистрированы.
1. Если у вас еще нет каталога, создайте его:

    {% include [create-folder](../_includes/create-folder.md) %}

1. Если провайдер CDN еще не активирован, активируйте его:
    1. Перейдите на страницу каталога и выберите сервис **{{ cdn-full-name }}**.
    1. Нажмите кнопку **Подключиться к провайдеру**.
1. Если у вас еще нет статического сайта в бакете {{ objstorage-name }}, создайте его:
    1. [Создайте бакет](../storage/operations/buckets/create.md).

        В настройках бакета включите публичный доступ к бакету и списку объектов в нем.

    1. [Загрузите](../storage/operations/objects/upload.md) в бакет контент сайта.
    1. [Настройте хостинг с поддержкой вашего домена](../solutions/web/static.md).

    Убедитесь, что статический сайт доступен по указанному адресу (например, `www.example.com`): страница открывается, и ее содержимое загружается.


## Создайте CDN-ресурс {#create-cdn-resource}

1. Перейдите на страницу каталога и выберите сервис **{{ cdn-full-name }}**.
1. На вкладке **CDN-ресурсы** нажмите кнопку **Создать ресурс**.

    Задайте параметры CDN-ресурса следующим образом:

    * **Запрос контента** — выберите **Из одного источника**.
    * **Тип источника** — выберите **Бакет**.
    * **Бакет** — выберите бакет, созданный в {{ objstorage-name }}, а также выберите опцию **Использовать сайт бакета**.
    * **Доменные имена для раздачи контента** — укажите одно, основное доменное имя, который будет использовать CDN для раздачи контента. На это имя должны указывать ссылки в коде сайта для получения статического контента из CDN. Поскольку в примере через CDN раздается весь сайт в бакете, то нужно в качестве значения этого параметра указать доменное имя сайта, например:

        ```http
        www.example.com
        ```

        {% note alert %}

        Основное доменное имя для раздачи контента невозможно изменить после создания CDN-ресурса!

        {% endnote %}

    * В блоке **Дополнительно**:

        1. Измените значение настройки **Заголовок Host** на **Свое значение**.
        1. В поле **Значение заголовка** укажите публичную ссылку на бакет со статическим сайтом. Эту ссылку можно найти на вкладке **Веб-сайт** на странице бакета в [консоли управления]({{ link-console-main }}). Например:

            ```http
            www.example.com.{{ s3-web-host }}
            ```

1. Нажмите кнопку **Создать**.

## Загрузите контент в CDN {#upload-content-to-CDN}

{% note tip %}

Рекомендуется предварительно загружать в CDN объемный контент (например, больше 200 МБ). Это опциональный шаг: если не загрузить контент на этом этапе, то он будет загружен в CDN автоматически при первом обращении.

{% endnote %}

Чтобы заранее загрузить контент на серверы CDN:

1. Перейдите на вкладку **Контент**.
1. Нажмите кнопку **Предзагрузить контент**.
1. В поле **Пути к файлам** укажите имена файлов, хранящихся в бакете, без указания имени бакета, например:

    ```text
    /index.html
    /static/styles.css
    /static/app.js
    ```

1. Нажмите кнопку **Предзагрузить контент**.


## Настройте CNAME для своего домена {#setup-cname}

1. На вкладке **Обзор** в разделе **Настройки DNS** скопируйте в буфер обмена сгенерированный сервисом адрес в домене `.gcdn.co`.
1. Перейдите в настройки DNS вашего домена на сайте компании, которая предоставляет вам услуги DNS-хостинга.
1. Измените CNAME-запись для `www` таким образом, чтобы она указывала на скопированный ранее адрес в домене `.gcdn.co`, например:

    ```http
    www CNAME cl-.....6bb.gcdn.co.
    ```


## Проверьте работу CDN {#check-cdn-working}

1. Дождитесь обновления DNS-записей.
1. Убедитесь, что CNAME-запись `www` в кеше DNS-серверов указывает на сгенерированный сервисом адрес (например, `cl-.....6bb.gcdn.co`).
1. Проверьте работу сайта, открыв в браузере его адрес, например:

    ```http
    http://www.example.com/
    ```
