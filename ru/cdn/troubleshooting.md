# Решение проблем в {{ cdn-name }}

Ниже перечислены проблемы, часто возникающие при работе с {{ cdn-name }}, и способы их решения.

## На запросы файлов CDN отвечает кодами 3xx (перенаправление) {#responses-3xx}

Проверьте, что в настройках [ресурса](concepts/resource.md) указаны:

* Протокол (HTTP или HTTPS), который используется источниками в качестве основного. Если источники перенаправляют запросы с URI со схемой `http` на URI со схемой `https`, для ресурса нужно выбрать протокол HTTPS, и наоборот.
* Значение HTTP-заголовка `Host`, с которого источники не перенаправляют запросы. 
  
  > Например, если настроено значение заголовка `www.example.com`, а источники перенаправляют запросы с таким значением на `example.com`, измените значение в настройках на `example.com`.

## На запросы файлов CDN отвечает кодами 4xx (ошибка клиента) {#responses-4xx}

Проверьте, что:

* Доступ конечных клиентов к контенту разрешен в настройках ресурса.
* Источники возвращают файлы в ответ на прямые запросы (в обход CDN).
* Источники разрешают и корректно обрабатывают запросы, соответствующие настройкам ресурса:

  * по указанному протоколу: HTTP или HTTPS;
  * с указанным значением HTTP-заголовка `Host` и другими заголовками. 

## На запросы файлов CDN отвечает кодами 5xx (ошибка сервера) {#responses-5xx}

{% include [ipv4-note](../_includes/cdn/ipv4-note.md) %}

Проверьте, что:

* Источники отвечают на запросы CDN-серверов в течение 5 секунд.
* Источники разрешают и корректно обрабатывают запросы, соответствующие настройкам ресурса:

  * по указанному протоколу: HTTP или HTTPS;
  * с указанным значением HTTP-заголовка `Host` и другими заголовками. 
  
Также проверьте статус {{ cdn-name }} на [специальной странице {{ yandex-cloud }}](https://status.cloud.yandex.ru/dashboard?service=cloud%20cdn).

## Изменения настроек не применились к ресурсу {#changes-not-applied}

{% include [after-changes-tip](../_includes/cdn/after-changes-tip.md) %}

## У CDN-ресурса статус Not active, и контент не доступен пользователям {#resource-not-active}

Ресурс может находиться в статусе `Not active` из-за того, что к нему нет пользовательских запросов в течение 90 дней, или потому что его деактивировали вручную. Чтобы ресурс снова стал активен, [включите](operations/resources/configure-basics.md) опцию **{{ ui-key.yacloud.cdn.field_access }}** в основных настройках ресурса. Активировать и деактивировать ресурсы могут пользователи с ролью `cdn.editor` или выше.

## Не удается настроить TLS-сертификат {#tls-certificate}

{% include [lets-encrypt-over](../_includes/cdn/lets-encrypt-over.md) %}

{% include [certificate-usage](../_includes/cdn/certificate-usage.md) %}

Ниже приведен пример ошибки в CLI, когда сертификат и CDN-ресурс находятся в разных каталогах:

```bash
ERROR: operation (id=bcdb6qaiw8mb********) failed: rpc error: code = InvalidArgument desc = folder ids of user and certificate don't match; operation-id: bcdb6qaiw8mb********
```
