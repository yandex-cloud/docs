---
title: Агрегатные функции (агрегации)
description: Агрегатные функции (агрегации) — это функции, которые вычисляются от группы значений и объединяют их в одно результирующее. Агрегации не могут быть вложены друг в друга.
keywords:
  - агрегатные функции
  - агрегации
  - агрегирующие функции
  - агрегированные данные
  - агрегирование данных
  - агрегирование
  - агрегация данных
editable: false
---

# Агрегатные функции
Агрегатные функции (агрегации) — это функции, которые вычисляются от группы значений и объединяют их в одно результирующее.

Если в поле с измерением добавить агрегацию, то поле становится показателем.

## Ограничения использования {#usage-restrictions}

Существуют следующие особенности использовании агрегаций:
1. Агрегации не могут быть вложены друг в друга. Например, следующее выражение не поддерживается: `MAX(SUM([Sales]))`. Любое выражение может может быть агрегировано не более одного раза.
1. Функция или оператор не может иметь среди своих аргументов одновременно агрегированные и неагрегированные выражения. Выражение `CONCAT([Profit], SUM([Profit]))` не поддерживается.



## [ALL_CONCAT](ALL_CONCAT.md)

**Синтаксис:**`ALL_CONCAT( expression [ , separator ] )`

Возвращает строку, которая содержит все попавшие в группу значения `expression`, с разделителем `separator` (по умолчанию разделитель — запятая).



## [ANY](ANY.md)

**Синтаксис:**`ANY( value )`

Возвращает произвольное значение `value` из группы. Это недетерминированная агрегация — результат может различаться от запроса к запросу на одних и тех же входных данных.



## [ARG_MAX](ARG_MAX.md)

**Синтаксис:**`ARG_MAX( value, comp )`

Возвращает значение `value`, соответствующее максимальному значению `comp`. Если есть несколько значений `value`, соответствующих максимальному значению `comp`, то возвращет первое попавшееся из них. Это делает функцию недетерминированной.



## [ARG_MIN](ARG_MIN.md)

**Синтаксис:**`ARG_MIN( value, comp )`

Возвращает значение `value`, соответствующее минимальному значению `comp`. Если есть несколько значений `value`, соответствующих минимальному значению `comp`, то возвращет первое попавшееся из них. Это делает функцию недетерминированной.



## [AVG](AVG.md)

**Синтаксис:**`AVG( value )`

Возвращает среднее для всех значений. Работает с числовыми типами данных и с типами `Дата | Дата и время`.



## [AVG_IF](AVG_IF.md)

**Синтаксис:**`AVG_IF( expression, condition )`

Возвращает среднее для всех значений, которые удовлетворяют условию `condition`. Если значения отсутствуют, то возвращается `NULL`. Работает только с числовыми типами данных.



## [COUNT](COUNT.md)

**Синтаксис:**`COUNT(  [ value ] )`

Возвращает количество элементов в группе.



## [COUNT_IF](COUNT_IF.md)

**Синтаксис:**`COUNT_IF( condition )`

Возвращает количество элементов в группе, которые удовлетворяют условию `condition`.



## [COUNTD](COUNTD.md)

**Синтаксис:**`COUNTD( value )`

Возвращает количество уникальных значений в группе.

См. также [COUNTD_APPROX](COUNTD_APPROX.md).



## [COUNTD_APPROX](COUNTD_APPROX.md)

**Синтаксис:**`COUNTD_APPROX( value )`

Вовзращает приблизительное количество уникальных значений в группе. Работает быстрее функции [COUNTD](COUNTD.md), но не гарантирует точность.



## [COUNTD_IF](COUNTD_IF.md)

**Синтаксис:**`COUNTD_IF( expression, condition )`

Возвращает количество уникальных значений в группе, которые удовлетворяют условию `condition`.

См. также [COUNTD_APPROX](COUNTD_APPROX.md).



## [MAX](MAX.md)

**Синтаксис:**`MAX( value )`

Возвращает максимальное значение.

Если `value`:
- число — возвращает наибольшее число;
- дата — возвращает самую позднюю дату;
- строка — возвращает последнее значение в алфавитном порядке.




## [MEDIAN](MEDIAN.md)

**Синтаксис:**`MEDIAN( value )`

Вовзращает медианное значение.



## [MIN](MIN.md)

**Синтаксис:**`MIN( value )`

Возвращает минимальное значение.

Если `value`:
- число — возвращает наименьшее число;
- дата — возвращает самую раннюю дату;
- строка — возвращает первое значение в алфавитном порядке.




## [QUANTILE](QUANTILE.md)

**Синтаксис:**`QUANTILE( value, quant )`

Возвращает точный квантиль уровня `quant` (значение от 0 до 1).



## [QUANTILE_APPROX](QUANTILE_APPROX.md)

**Синтаксис:**`QUANTILE_APPROX( value, quant )`

Возвращает примерный квантиль уровня `quant` (значение от 0 до 1).



## [STDEV](STDEV.md)

**Синтаксис:**`STDEV( value )`

Возвращает статистическое стандартное отклонение всех значений в выражении на основе выборки из совокупности.



## [STDEVP](STDEVP.md)

**Синтаксис:**`STDEVP( value )`

Возвращает статистическое стандартное отклонение всех значений в выражении на основе смещенной совокупности.



## [SUM](SUM.md)

**Синтаксис:**`SUM( value )`

Возвращает сумму всех значений выражения. Работает только с числовыми типами данных.



## [SUM_IF](SUM_IF.md)

**Синтаксис:**`SUM_IF( expression, condition )`

Возвращает сумму всех значений выражения, которые удовлетворяют условию `condition`. Работает только с числовыми типами данных.



## [TOP_CONCAT](TOP_CONCAT.md)

**Синтаксис:**`TOP_CONCAT( expression, amount [ , separator ] )`

Возвращает строку, которая содержит `amount` наиболее часто встречающихся значений из каждой группы `expression` с разделителем `separator` (по умолчанию разделитель — запятая).



## [VAR](VAR.md)

**Синтаксис:**`VAR( value )`

Возвращает статистическую дисперсию всех значений в выражении на основе выборки из совокупности.



## [VARP](VARP.md)

**Синтаксис:**`VARP( value )`

Возвращает статистическую дисперсию всех значений в выражении по всей совокупности.


