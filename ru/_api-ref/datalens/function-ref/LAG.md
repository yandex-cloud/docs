---
editable: false
---

# LAG (оконная)



#### Синтаксис {#syntax}


```
LAG( value [ , offset [ , default ] ] [ TOTAL | WITHIN ... | AMONG ... ] [ ORDER BY ... ] [ BEFORE FILTER BY ... ] )
```

#### Описание {#description}

{% note warning %}

Сортировка осуществляется на основе полей, перечисленных в области сортировки в чарте и в ORDER BY. При этом сначала берутся поля из `ORDER BY`.

{% endnote %}

Возвращает значение `value` из строки со смещением `offset` относительно текущей в рамках заданного окна:
- положительное значение `offset` делает смещение назад;
- отрицательное значение `offset` делает смещение вперед.

По умолчанию `offset` равно `1`.

Если значение отсутствует (`offset` ссылается на строку до первой или после последней), то возвращается значение `default` в качестве результата. Если `default` не задано, то используется `NULL`.

См. также [AGO](AGO.md) в качестве неоконной альтернативы.

**Типы аргументов:**
- `value` — `Любой`
- `offset` — `Целое число`
- `default` — `Любой`


**Возвращаемый тип**: Совпадает с типом аргументов (`value`)

{% note info %}

Значения аргументов (`offset`, `default`) должны быть константами.

{% endnote %}


#### Примеры {#examples}

```
LAG([Profit], 2)
```

```
LAG([Profit], 7 AMONG [Date] ORDER BY [Date])
```


#### Поддержка источников данных {#data-source-support}

`Материализованный датасет`, `ClickHouse 19.13`, `Microsoft SQL Server 2017 (14.0)`, `MySQL 5.6`, `Oracle Database 12c (12.1)`, `PostgreSQL 9.3`.
