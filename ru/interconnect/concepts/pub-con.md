# Публичное соединение



Публичное соединение (public connection) обеспечивает доступ к [сервисам](#svc-list) {{ yandex-cloud }}. Публичное соединение организуется внутри [транка](./trunk.md) и имеет свой идентификатор — **VLAN-ID**. В транке может быть одно или несколько публичных соединений, через которые можно предоставить доступ к любой комбинации [сервисов](#svc-list).

Максимальный размер IP MTU для публичного соединения — **1500 байт**. Изменение IP MTU со стороны оборудования {{ yandex-cloud }} не допускается.


## Список сервисов {#svc-list}

У каждого сервиса в {{ yandex-cloud }} есть своя точка входа — `API Endpoint`. Ознакомиться со списком точек входа сервисов {{ yandex-cloud }} можно по [ссылке](https://{{ api-host }}/endpoints). У каждой точки входа есть свой идентификатор и адрес, который состоит из `FQDN API Endpoint` и номера порта на который этот сервис получает запросы.

Список сервисов {{ yandex-cloud }}, к которым предоставляется доступ через публичное соединение:

{% include [svc-list](../../_includes/interconnect/svc-list.md) %}

Фактически, публичное соединение обеспечивает связность между вашей инфраструктурой и IP-адресом, в который преобразуется `FQDN API Endpoint` соответствующего сервиса. Преобразование [FQDN](../../glossary/fqdn.md) имени в IP-адрес выполняется через службу [DNS](../../glossary/dns.md).

Например, если вы хотите получить доступ из своей инфраструктуры в сервис [{{ objstorage-name }}](../../storage/) через сервисное соединение, то со стороны оборудования {{ yandex-cloud }} в направлении вашего маршрутизатора по протоколу BGP будет анонсироваться префикс `{{ cic-pbc-svc1-ip }}`, который соответствует FQDN API Endpoint `{{ s3-storage-host }}` для сервиса [{{ objstorage-name }}](../../storage/).

Вам необходимо настроить маршрутизацию трафика в собственной инфраструктуре таким образом, чтобы трафик к [сервисам](#svc-list) {{ yandex-cloud }} направлялся к устройствам, выполняющим [функции NAT](#pub-nat) для публичного соединения.


## Стыковая подсеть {#pub-address}

Стыковая подсеть для публичного соединения может быть организована следующими способами:

1. С использованием IPv4-адресов из [адресного пула](../../vpc/concepts/ips.md) {{ yandex-cloud }}. При таком способе организации соединения из адресного пула {{ yandex-cloud }} клиенту выделяется **стыковая подсеть** (point-to-point) размером `/31`. Со стороны оборудования клиента должна использоваться приватная BGP ASN для организации BGP-соседства.
1. С использованием приватных (RFC-1918) или собственных публичных IPv4-адресов. Это необходимо, если клиент планирует анонсировать собственные публичные IP-префиксы через стыковую подсеть. В этом случае необходимо следовать [рекомендациям](#pub-bgp) по организации BGP-соседства которые описаны ниже.


{% note alert %}

[Cервисы](#svc-list), к которым предоставляется доступ через публичное соединение, размещаются [в собственных ДЦ](../../overview/concepts/geo-scope.md). Трафик внутри публичного соединения между вашей инфраструктурой и [сервисами](#svc-list) не покидает периметр {{ yandex-cloud }}.

{% endnote %}

{% include [bgp](../../_includes/interconnect/bgp.md) %}


## Организации BGP-соседства при анонсировании собственных IP-префиксов {#pub-bgp}

Если вам необходимо анонсировать собственные публичные IP-префиксы для организации BGP-связности в рамках публичного соединения, следуйте следующим правилам:

1. Ваши публичные IP-префиксы должны быть надлежащим образом зарегистрированы — для них должны быть созданы соответствующие объекты [Route Object](https://docs.db.ripe.net/entire-documentation-HTML.html#creating-route-objects) и [Route Origin Authorization](https://www.ripe.net/manage-ips-and-asns/resource-management/rpki/resource-certification-roa-management/) у регионального регистратора.
1. Ваше оборудование должно устанавливать BGP-связность с оборудованием {{ yandex-cloud }} только с использованием публичной BGP ASN. Использование приватных BGP ASN для такого взаимодействия не допускается.
1. Длина ваших IP-префиксов не должна быть меньше `/24`. Анонсы более специфичных префиксов (с длиной от `/25` до `/32`) будут отбрасываться оборудованием {{ yandex-cloud }}.

## Функции NAT {#pub-nat}

При использовании IPv4-адресов, предоставленных {{ yandex-cloud }} для организации публичного соединения (стыковая подсеть 1-го типа), необходимо использовать технологию трансляции сетевых адресов [NAT](https://ru.wikipedia.org/wiki/NAT) на стороне вашего оборудования, чтобы трафик мог корректно маршрутизироваться к сервисам {{ yandex-cloud }}. Допускаются следующие варианты реализации NAT:

* NAT-функция выполняется на вашем оборудовании (маршрутизаторе), к которому подключается публичное соединение. Весь трафик публичного соединения отправляется от IPv4-адреса на интерфейсе маршрутизатора в [стыковой подсети](#pub-address). В этом случае, ваш маршрутизатор, к которому подключается публичное соединение, должен будет анонсировать префикс стыковой подсети по протоколу BGP в сторону оборудования {{ yandex-cloud }}.

* NAT-функция выполняется на вашем оборудовании, которое не используется для подключения публичного соединения, например сервере или межсетевом экране. В данном случае со стороны {{ yandex-cloud }} дополнительно выделяется сервисный IPv4-адрес (/32 префикс), и ваш маршрутизатор, к которому подключается публичное соединение, должен будет анонсировать этот префикс по протоколу BGP в сторону оборудования {{ yandex-cloud }}.

При использовании собственных IPv4-адресов (стыковая подсеть 2-го типа) функции NAT должны выполняться с использованием этих IP-адресов.


## Примеры использования {#examples}

* [{#T}](../tutorials/trunk-pub-add.md)
* [{#T}](../tutorials/partner-trunk-pub-add.md)
* [{#T}](../tutorials/pub-add.md)
* [{#T}](../tutorials/pub-del.md)


