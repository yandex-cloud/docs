# Подключение услуги {{ interconnect-full-name }}

Чтобы воспользоваться услугой {{ interconnect-full-name }}, вам потребуется настроить ряд параметров подключения, выбрать точку присутствия и запросить на ней кроссировку (линию связи):

1. [Указать тип трансивера](#transceiver-type).
1. [Выбрать точки присутствия](#points-of-presence).
1. [Задать настройки транкового подключения](#trunk-connection-config).
1. [Задать настройки приватного соединения](#private-connection-config).
1. [Подготовить параметры приватного соединения](#interconnect-params).
1. [Подготовить параметры облачных сетей](#vpc-networks) для приватного соединения.
1. [Выбрать скорость подключения и желаемый пакет трафика](#bandwidth).
1. [Заказать кроссировку](#cross-connect) в точках присутствия.

## Тип трансивера {#transceiver-type}

Выберите [тип трансивера](concepts/index.md#trunk-link) для стыка с оборудованием {{ yandex-cloud }} — вам потребуется указать его в заявке на подключение услуги. Учитывайте возможности вашего оборудования, а также расстояние между вашим оборудованием и точкой присутствия.

## Точки присутствия {#points-of-presence}

Выберите одну или несколько *точек присутствия* (point of presence, POP), куда вы хотите организовать [транковое подключение](concepts/index.md). Рекомендуем выбрать хотя бы две точки: это позволит обеспечить географическую отказоустойчивость и резервирование услуги. Каждая из точек присутствия позволяет вам получать доступ к вашим облачным ресурсам в любой из [зон доступности](../overview/concepts/geo-scope.md) {{ yandex-cloud }}.

![interconnect](../_assets/cloud-interconnect/interconnect.svg)

Точки присутствия (ТП) и их обозначения:

* ММТС-9, г. Москва, ул. Бутлерова, д. 7 — `M9`.
* Dataline OST, г. Москва, ул. Боровая, д. 7, стр. 10 — `OST`.
* Dataline NORD, г. Москва, Коровинское шоссе, д. 41 — `NORD`.
* StoreData, г. Москва, ул. Нижегородская, д. 32, стр. А — `STD`.

## Настройки транкового подключения {#trunk-connection-config}

На вашем оборудовании должны быть выполнены следующие настройки:

* Скорость передачи на порту оборудования клиента должна быть выставлена вручную в соответствии с типом трансивера. Автосогласование не поддерживается.
* Порт должен работать в транковом режиме по стандарту IEEE 802.1Q с идентификатором VLAN (VID) от `2` до `4000`. Native VLAN не поддерживается.
* Для передачи jumbo-кадров допускается выставить размер MTU 8910 байт.

В рамках одной точки присутствия можно использовать:

* Методы агрегации каналов с помощью [протокола LACP](https://en.wikipedia.org/wiki/Link_aggregation#Link_Aggregation_Control_Protocol) в режиме `Active`.
* Стекирование коммутаторов на стороне клиента при условии, что коммутаторы будут объединены в единое логическое устройство (стек).

## Настройки приватного соединения {#private-connection-config}

Настройка [приватного соединения](concepts/index.md#private-connection) происходит в два этапа:

1. Настройка IP-связности между клиентским устройством и оборудованием {{ yandex-cloud }}.
1. Настройка BGP-связности для обмена IPv4-префиксами (подсетями), которые анонсируются в рамках BGP-сессии как со стороны оборудования {{ yandex-cloud }}, так и со стороны клиентского устройства.

{% note warning %}

Несколько облачных сетей в рамках одного приватного соединения могут располагаться в разных облаках. Так можно в рамках одного приватного соединения обеспечить сетевое взаимодействие с несколькими облаками и сетями в них (VPC peering).

{% endnote %}

### Параметры приватного соединения {#interconnect-params}

Для настройки приватного соединения сообщите вашему менеджеру или архитектору следующую информацию:

* `cloud_id` — идентификатор вашего облака, куда следует подключить услугу {{ interconnect-name }}. 
* `folder_id` — идентификатор каталога, куда будут экспортироваться [метрики](concepts/user-metrics.md) услуги {{ interconnect-name }}.
* `vlan_id` — идентификатор VLAN для приватного подключения. Допустимы любые значения `2` до `4000`. Вы можете выбрать любой удобный номер. Порт должен быть настроен в режиме `802.1q trunk с тегированием VLAN`. VLAN-тег используется для идентификации логического приватного соединения в рамках транкового подключения. 
* IPv4-подсеть для BGP-пиринга. Выберите IPv4-подсеть из диапазонов, определенных в [RFC 1918](https://datatracker.ietf.org/doc/html/rfc1918), для организации BGP-взаимодействия между клиентским устройством и пограничным маршрутизатором {{ yandex-cloud }}. Подсеть может быть размером `/30` или `/31`. Один из адресов этой подсети будет настроен на оборудовании {{ yandex-cloud }}, а другой адрес — на клиентском устройстве. Эти адреса будут использованы для установления BGP сессии между сторонами.
* IPv4-адрес на стороне {{ yandex-cloud }} — IPv4-адрес из подсети для BGP-пиринга на стороне маршрутизатора {{ yandex-cloud }}.
* IPv4-адрес на стороне клиента — IPv4-адрес из подсети для BGP-пиринга на стороне клиентского устройства.
* BGP ASN — при настройке BGP-взаимодействия на клиентском маршрутизаторе в качестве номера автономной системы удаленного соседа (BGP ASN) используйте значение BGP ASN {{ yandex-cloud }} — `200350`. В качестве BGP ASN со стороны клиентского оборудования можно использовать свой публичный BGP ASN (при наличии) или взять любой удобный для вас номер из диапазона приватных BGP ASN номеров (`64512 – 65534`) и настроить его как свой собственный на вашем маршрутизаторе.
* (опционально) BGP MD5 password — используется для повышения уровня защиты BGP-соединения. Вы можете настроить MD5-авторизацию для BGP-сессии с использованием пароля. Рекомендуем использовать сложную случайную строку из 20 и более символов латинскими буквами, цифрами и специальными символами.

## Подключение облачных сетей к приватному соединению {#vpc-networks}

Чтобы подключить одну или несколько сетей к приватному соединению, укажите следующую информацию:

* `network_id` — идентификатор виртуальной сети, которую нужно подключить к {{ interconnect-name }}. Идентификатор сети можно увидеть в консоли управления в разделе **Сети** сервиса {{ vpc-name }} или с помощью команды [yc vpc network list](../cli/cli-ref/managed-services/vpc/network/list.md) CLI {{ yandex-cloud }}.
* Список анонсируемых IPv4-префиксов с указанием зоны доступности. Укажите префиксы, которые нужно анонсировать из указанной сети в сторону вашей инфраструктуры. Обычно префиксы соответствуют подсетям, настроенным в вашем облаке. В таком случае анонсируемые IPv4-префиксы и фактические диапазоны адресов подсети совпадают. 

Если вы захотите добавить новую подсеть в приватное соединение, вам нужно будет обратиться в поддержку с запросом добавить новый анонс в сервисе {{ interconnect-name }}. Новые подсети не анонсируются автоматически.

{% note warning %}

Адреса внутренних балансировщиков нагрузки анонсируются в виде маршрутов с длиной префикса `/32`.

{% endnote %}

Также можно анонсировать *агрегированные префиксы* — это позволит вам настроить приватное соединение один раз и в дальнейшем добавлять новые подсети в уже существующую сеть автоматически, без обращения в поддержку.

  > Например, при организации приватного подключения вы запросили анонс агрегированных IPv4-префиксов вида:
  >
  > ```
  > ru-central1-a [10.128.0.0/16]
  > ru-central1-b [10.130.0.0/16]
  > ru-central1-c [10.140.0.0/16]
  > ```
  >
  > Если позже вы создадите в данной сети в зоне `ru-central1-a` подсеть с префиксом `10.128.15.0/24`, она автоматически будет доступна через {{ interconnect-name }}, поскольку подсеть `10.128.15.0/24` принадлежит уже анонсированному адресному пространству `10.128.0.0/16`.

## Скорость подключения и желаемый пакет трафика {#bandwidth}

Желаемый пакет трафика — это единица тарификации сервиса {{ interconnect-name }}, которая равна объему трафика, передаваемому с указанной скоростью в течение месяца. 

> Например, если вы выбрали скорость 100 Мбит/с, то ваш пакет трафика составит 30 ТБ. Это объем, который можно передать за месяц при 100% утилизации канала с пропускной способностью 100 Мбит/c.

## Кроссировка в точке присутствия {#cross-connect}

В каждой из точек присутствия есть свой процесс по заказу оптической кроссировки:

### M9

1. Заполните [шаблон согласительного письма](https://storage.yandexcloud.net/doc-files/interconnect-agreement-M9-example.docx). Укажите информацию о стойке с вашим оборудованием и параметры соединения. Напишите в [техническую поддержку](https://concole.cloud.yandex.ru/support) или вашему менеджеру о желании подключить услугу {{ interconnect-name }} самостоятельно. 
1. В ответ мы пришлем подписанное согласительное письмо с номером порта, выделенного для вашего подключения на стороне {{ yandex-cloud }}.
1. Перешлите подписанное письмо по адресу `sekretar@mmts9.ru` c темой `Согласительное письмо от <Название вашей компании> — {{ yandex-cloud }}`.
1. Закажите кроссировку у вашего оператора связи или у технической поддержки, приложив согласительное письмо.
1. После этого оператор или сотрудники площадки смогут начать прокладку кроссировки и ее подключение к выделенному порту в оборудовании {{ yandex-cloud }}.

### OST

1. Заполните [шаблон согласительного письма](https://storage.yandexcloud.net/doc-files/interconnect-agreement-Ost-example.docx). Укажите информацию о стойке с вашим оборудованием и параметры соединения. Напишите в [техническую поддержку](https://concole.cloud.yandex.ru/support) или вашему менеджеру о желании подключить услугу {{ interconnect-name }} самостоятельно. 
1. В ответ мы пришлем подписанное согласительное письмо с номером порта, выделенного для вашего подключения на стороне {{ yandex-cloud }}.
1. Закажите кроссировку у вашего оператора связи или у технической поддержки, приложив согласительное письмо.
1. После этого оператор или сотрудники площадки смогут начать прокладку кроссировки и ее подключение в выделенный порт в оборудовании {{ yandex-cloud }}.

### NORD

1. Заполните [шаблон согласительного письма](https://storage.yandexcloud.net/doc-files/interconnect-agreement-Nord-example.docx). Укажите информацию о стойке с вашим оборудованием и параметры соединения. Напишите в [техническую поддержку](https://concole.cloud.yandex.ru/support) или вашему менеджеру о желании подключить услугу {{ interconnect-name }} самостоятельно. 
1. В ответ мы пришлем подписанное согласительное письмо с номером порта, выделенного для вашего подключения на стороне {{ yandex-cloud }}.
1. Закажите кроссировку у вашего оператора связи или у технической поддержки, приложив согласительное письмо.
1. После этого оператор или сотрудники площадки смогут начать прокладку кроссировки и ее подключение к выделенному порту в оборудовании {{ yandex-cloud }}.

### STD

1. Получите от вашего менеджера или архитектора номер порта и координаты стойки {{ yandex-cloud }}.
1. Сообщите данную информацию вашему оператору или самостоятельно закажите кроссировку силами сотрудников ТП до выделенного порта на оборудовании {{ yandex-cloud }}.
1. После этого оператор или сотрудники площадки смогут начать прокладку кроссировки и ее подключение в выделенный порт в оборудовании {{ yandex-cloud }}.

{% note warning %}

Согласительное письмо для площадки `STD` не требуется. Оператор, прокладывающий кроссировку, и {{ yandex-cloud }} взаимодействуют напрямую.

{% endnote %}
