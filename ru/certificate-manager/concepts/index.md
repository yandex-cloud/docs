# Концепции {{ certificate-manager-name }}

{{ certificate-manager-name }} — сервис для управления [TLS-сертификатами](https://en.wikipedia.org/wiki/Public_key_certificate#TLS/SSL_server_certificate) в {{ yandex-cloud }}. С помощью сервиса вы можете получать и обновлять сертификаты от Let's Encrypt<sup>®</sup>, а также добавлять собственные сертификаты.

{% note warning %}

* Если вы используете сертификат от Let's Encrypt, после добавления пройдите [процедуру проверки прав на домен](challenges.md).
* Если вы используете пользовательский сертификат, самостоятельно и своевременно обновляйте его.

{% endnote %}

## Типы сертификатов {#types}

В {{ certificate-manager-name }} поддерживаются два типа сертификатов:
* Сертификаты от Let's Encrypt (`Managed`) — это сертификаты, которые выписываются с помощью [Let's Encrypt](https://letsencrypt.org) и находятся под управлением сервиса {{ certificate-manager-name }}. Подробнее об этом типе читайте в разделе [Сертификат от Let's Encrypt](managed-certificate.md).
* Пользовательские (`Imported`) — это сертификаты, добавленные пользователем. За своевременным обновлением такого сертификата вы следите самостоятельно. Подробнее об этом типе читайте в разделе [Пользовательский сертификат](imported-certificate.md).

## Статусы сертификатов {#statuses}

Жизненный цикл и набор статусов сертификата зависит от его типа.

* Сертификаты от Let's Encrypt (`Managed`) могут находиться в следующих статусах:
    * `Validating` — сертификат запрошен у Let's Encrypt и ждет успешного прохождения процедуры проверки прав на домены.
    * `Issued` — сертификат получен и может быть использован  в сервисах, интегрированных с {{ certificate-manager-name }}.
    * `Invalid` — сертификат не прошел проверку: процедура проверки прав на домены заняла больше одной недели или завершилась ошибкой.
    * `Renewing` — сертификат обновляется.
    * `Renewal_failed` - сертификат не удалось обновить.
* Пользовательские (`Imported`) сертификаты всегда находятся в статусе `Issued` —  сертификат получен и может быть использован  в сервисах, интегрированных с {{ certificate-manager-name }}.

## Уведомление пользователя {#notify}

Если срок действия сертификата истекает и сертификат не удалось перевыпустить автоматически, вам будут отправлены уведомления с просьбой пройти процедуру проверки домена или самостоятельно загрузить новую версию сертификата.

### Куда отправляются уведомления {#where}

Уведомления будут отправлены на: 
* адрес электронной почты, указанный в настройках облака;
* дополнительные адреса, подписанные на уведомления.

### Когда отправляются уведомления {#when}

Срок отправки уведомлений:
* за 21, 7 и 3 дня до окончания срока действия сертификата;
* после окончания срока действия.

## Мониторинг состояния сертификатов {#monitoring}

Вы можете настроить метрики и алерты для мониторинга сертификатов. Графики метрик вы можете увидеть на сервисном [дашборде](../../monitoring/concepts/visualization/dashboard.md), который создается автоматически.

Список метрик сертификата:

* `certificate.days_until_expiration` — показывает вещественное число дней до наступления момента, после которого сертификат прекратил свое действие. 

    Метрика может использоваться для создания алертов, предупреждающих о скором истечении срока действия сертификата.
* `certificate.is_out_of_order` — показывает, может ли сертификат быть использован для обеспечения TLS-соединения.
    * Метрика равна единице, если сертификат не может быть использован для обеспечения TLS-соединения: находится в состоянии `Invalid` или `Revoked`, или срок его действия истек.
    * В любых других случаях метрика равна нулю, в том числе, когда сертификат находится в состоянии `Validating`. 
    
    Метрика может использоваться для создания алертов, предупреждающих о неработоспособности сертификата.
* `quota.certificates_count.usage` — показывает текущее потребление квоты количества сертификатов на облако.
* `quota.certificates_count.limit` — показывает текущее ограничение количества сертификатов на облако.

Вы можете использовать метрики для создания алертов. Подробнее об этом читайте в разделе [{#T}](../operations/alert.md).

#### См. также {#see-also}

- [Интегрированные с {{ certificate-manager-name }} сервисы](services.md)
- [Проверка прав на домен](challenges.md)