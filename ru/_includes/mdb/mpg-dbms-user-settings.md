- **Conn limit**{#setting-conn-limit} {{ tag-con }} {{ tag-api }} {{ tag-cli }}

  Максимальное допустимое количество соединений для пользователя.

  В транзакционном пулинге (transaction pooling) настройка ограничивает количество одновременных соединений в транзакции пользователя. При использовании этого типа пулинга пользователь может открыть тысячи соединений, но одновременно работать смогут только `N` соединений, где `N` — значение настройки.

  В сессионном пулинге (session pooling) настройка ограничивает количество соединений пользователя с каждым хостом в {{ PG }}-кластере. При использовании этого типа пулинга значение настройки должно быть не меньше суммы всех соединений, которые могут быть открыты бэкендами пользовательского сервиса. Каждое открытое серверное соединение немного замедляет работу {{ PG }} на OLTP-нагрузке (Online Transaction Processing).

  Для сессионного пулинга применяются следующие принципы:

  - При добавлении пользователя {{ mpg-name }} по умолчанию резервирует для него 50 подключений к каждому хосту в {{ PG }}-кластере. Минимальное количество подключений на пользователя — 1.
  - Суммарное количество подключений, зарезервированных для пользователей, не должно превышать значение параметра [Max connections](../../managed-postgresql/concepts/settings-list.md#setting-max-connections). {{ mpg-name }} резервирует 15 служебных подключений на каждом хосте.

    Например, если для кластера задана настройка `"max_connections": 100`, то вы можете зарезервировать не больше 85 подключений для пользователей на каждый хост кластера.

  - Рекомендуется разнести по разным пользователям разные сервисы, использующие {{ PG }}, и задать нужное значение настройки для каждого пользователя. Если при проблемах в одном сервисе возникнет большое количество соединений, другие сервисы не будут затронуты и смогут подключаться к {{ PG }}.

  Эта настройка [зависит от выбранного класса хостов](#settings-instance-dependent).

- **Default transaction isolation**{#setting-user-default-transaction-isolation} {{ tag-con }} {{ tag-api }} {{ tag-cli }}

  См. описание настройки уровня кластера [Default transaction isolation](#setting-default-transaction-isolation).

- **Grants**{#setting-user-grants} {{ tag-con }} {{ tag-api }} {{ tag-cli }} {{ tag-tf }}

  Набор [ролей](../../managed-postgresql/concepts/roles.md), выданных пользователю.

- **Lock timeout**{#setting-user-lock-timeout} {{ tag-con }} {{ tag-api }} {{ tag-cli }}

  См. описание настройки уровня кластера [Lock timeout](#setting-lock-timeout).

- **Log min duration statement**{#setting-user-log-min-duration-statement} {{ tag-con }} {{ tag-api }} {{ tag-cli }}

  См. описание настройки уровня кластера [Log min duration statement](#setting-log-min-duration-statement).

  Рекомендуется определить для каждого сервиса и соответствующего ему пользователя, что считается медленным выполнением запроса, и логировать только такие запросы. Например, для веб-сервиса медленным может считаться запрос, выполняющийся более одной секунды, а для сервиса построения отчетов — запрос, выполняющийся более 10 минут.

  Подробнее см. [в документации {{ PG }}](https://www.postgresql.org/docs/current/runtime-config-logging.html).

- **Log statement**{#setting-user-log-statement} {{ tag-con }} {{ tag-api }} {{ tag-cli }}

  См. описание настройки уровня кластера [Log statement](#setting-log-statement).

- **Login**{#setting-user-login} {{ tag-con }} {{ tag-api }} {{ tag-cli }}

  Определяет, может ли пользователь подключаться к кластеру {{ PG }}.

  Значение по умолчанию — `true` (пользователь может подключаться к кластеру).

- **Pooling mode**{#setting-pooling-mode} {{ tag-con }}

  Режим, в котором работает пулер соединений [PgBouncer](https://www.pgbouncer.org/).

  Возможные значения:

  * `session` — соединение с сервером назначается клиенту при подключении и сохраняется за ним. Соединение возвращается в пул в момент отключения клиента.
  * `transaction` — соединение с сервером назначается клиенту только на время выполнения транзакции. Соединение возвращается в пул в момент завершения транзакции.
  * `statement` — соединение с сервером возвращается в пул сразу после выполнения запроса. В этом режиме запрещены многооператорные транзакции.

  Значение по умолчанию — `session`.

  Подробнее см. в [документации PgBouncer](https://www.pgbouncer.org/usage).

- **Prepared statements pooling**{#setting-prepared-statements-pooling} {{ tag-con }}

  Разрешает использовать подготовленные инструкции с объединением транзакций.

- **Synchronous commit**{#setting-user-synchronous-commit} {{ tag-con }} {{ tag-api }} {{ tag-cli }}

  См. описание настройки уровня кластера [Synchronous commit](#setting-synchronous-commit).

- **Temp file limit**{#setting-temp-file-limit} {{ tag-con }} {{ tag-api }} {{ tag-cli }}

  См. описание настройки уровня кластера [Temp file limit](#setting-temp-file-limit).

- **Wal sender timeout**{#setting-wal-sender-timeout} {{ tag-con }}

  Время (в миллисекундах), по истечении которого прерываются неактивные соединения репликации. Доступно для кластеров {{ mpg-name }}, начиная с версии 12.
