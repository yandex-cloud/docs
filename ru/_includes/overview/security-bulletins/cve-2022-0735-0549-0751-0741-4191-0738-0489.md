## 28.02.2022 — CVE-2022-0735 (token disclosure), CVE-2022-0549, CVE-2022-0751, CVE-2022-0741, CVE-2021-4191, CVE-2022-0738, CVE-2022-0489 — Множестввенные уязвимости GitLab {#multiple-GitLab-vulnerabilities}

### Описание

Компания GitLab Inc опубликовала информацию о наборе уязвимостей [в статье](https://about.gitlab.com/releases/2022/02/25/critical-security-release-gitlab-14-8-2-released/).  

#### CVE-2022-0735
Наиболее критичная уязвимость из набора – [CVE-2022-0735](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-0735) «Runner registration token disclosure through Quick Actions» (Раскрытие регистрационного токена раннера через механизм «Quick Actions»).

Распространяется на следующие версии:

* все версии от 12.10 до 14.6.5 включительно;
* все версии от 14.7 до 14.7.4 включительно;
* все версии от 14.8 до 14.8.2 включительно.

Остальные уязвимости из набора менее опасны.

#### CVE-2022-0549

CVE-2022-0549 «Unprivileged users can add other users to groups through an API endpoint» имеет средний уровень критичности.

Распространяется на следующие версии:

* все версии от 14.4 до 14.4.4 включительно;
* все версии от 14.5 до 14.5.2 включительно.

#### CVE-2022-0751

CVE-2022-0751 «Inaccurate display of Snippet contents can be potentially misleading to users» имеет средний уровень критичности.

#### CVE-2022-0741

CVE-2022-0741 «Environment variables can be leaked via the sendmail delivery method» имеет средний уровень критичности.

#### CVE-2021-4191

CVE-2021-4191 «Unauthenticated user enumeration on GraphQL API» имеет средний уровень критичности и распространяется на все версии от 14.4 до 14.8 включительно.

#### CVE-2022-0738

CVE-2022-0738 «Adding a pull mirror with SSH credentials can leak password» имеет средний уровень критичности.

Распространяется на следующие версии:

* все версии от 14.6 до 14.6.5 включительно;
* все версии от 14.7 до 14.7.4 включительно;
* все версии от 14.8 до 14.8.2 включительно.

#### CVE-2022-0489

CVE-2022-0489 «Denial of Service via user comments» имеет низкий уровень критичности и распространяется и распространяется на все версии от 8.15.

#### Ссылки

Подробное описание уязвимости представлено в [исходном отчёте GitLab](https://about.gitlab.com/releases/2022/02/25/critical-security-release-gitlab-14-8-2-released/).

Описания уязвимостей:

* [CVE-2022-0735](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-0735)
* [CVE-2022-0549](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-0549)
* [CVE-2022-0751](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-0751)
* [CVE-2022-0741](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-0741)
* [CVE-2021-4191](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-4191)
* [CVE-2022-0738](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-0738)
* [CVE-2022-0489](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-0489)

### Влияние на сервисы {{ yandex-cloud }} 

#### {{ compute-full-name }}

Образ GitLab для {{ compute-full-name }} в {{ marketplace-full-name }} был обновлен до актуальной версии.

Уязвимости потенциально подвержены все пользователи {{ compute-full-name }}, которые использовали образы GitLab из {{ marketplace-name }} либо собственные образы. Таким пользователям необходимо выполнить переустановку системы из актуального образа {{ marketplace-name }} либо обновление версии GitLab до актуальной согласно [официальной инструкции](https://about.gitlab.com/releases/2022/02/25/critical-security-release-gitlab-14-8-2-released/). 
Если в настоящее время вы не можете выполнить обновление версии GitLab, примените компенсационные меры.

Всем пользователям, которые используют устаревший образ GitLab из {{ marketplace-name }}, отправлены оповещения с рекомендациями по обновлению.

#### {{ mgl-full-name }}

Для пользователей сервиса {{ mgl-name }}, который находится в тестовом режиме в {{ yandex-cloud }}, мы уже обновили существующие и будущие инстансы до актуальной версии.

Всем пользователям, которые используют {{ mgl-full-name }}, отправлены оповещения.

### Компенсационные меры {#multiple-GitLab-vulnerabilities-compensatory measures}

Если в настоящее время вы не можете выполнить обновление, то возможно временно закрыть уязвимость с помощью [hotpatch](https://about.gitlab.com/releases/2022/02/25/critical-security-release-gitlab-14-8-2-released/#hotpatch-for-runner-registration-token-disclosure-through-quick-actions).
