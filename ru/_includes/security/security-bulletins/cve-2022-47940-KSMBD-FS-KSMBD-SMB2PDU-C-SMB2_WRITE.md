## 26.12.2022 — CVE-2022-47940 — KSMBD FS/KSMBD/SMB2PDU.C SMB2_WRITE {#CVE-2022-47940}

CVE ID: CVE-2022-47940

Ссылка на CVE: <https://ubuntu.com/security/CVE-2022-47940>

### Исходный отчет {#original-report}

<https://ubuntu.com/security/CVE-2022-47940>

### Краткое описание {#brief-description}

Если инсталляция использует версию ядра Linux, которая содержит данную уязвимость, атакующие могут получить доступ к чувствительной информации. Атакующий должен аутентифицироваться, чтобы воспользоваться уязвимостью. Уязвимость использует недостатки обработки команд SMB2_WRITE. Из-за неправильной валидации пользовательских данных атакующий может считать данные за пределами разрешенного буфера и выполнить произвольный код в контексте ядра, воспользовавшись данной уязвимостью и другими.

Уязвимость появляется при запуске сервиса `ksmbd` из пакета `ksmbd-tools`.

### Затронутые технологии {#technologies-affected}

Ядро Linux.

### Уязвимые продукты и версии {#vulnerable-products-and-versions}

Linux Kernel до 5.18.17
ksmbd-tools

### Вендор {#vendor}

ksmbd-tools

### Вектор атаки и уровень опасности согласно CVSS v.3.0 {#attack-vector-and-severity-level}

4.1

### Рекомендации по обнаружению уязвимости и дополнительные материалы {#recommendations-for-vulnerability-detection}

<https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=158a66b245739e15858de42c0ba60fcf3de9b8e6>

### Безопасная версия уязвимого продукта или патч {#safe-version}

Уязвимость устранена в версии Linux Kernel 5.18.18.

### Влияние на сервисы {{ yandex-cloud }} {#impact-on-yandex-cloud-services}

В облачных ресурсах среди загруженных модулей и установленных пакетов данный компонент отсутствует.

Если вы используете в {{ compute-full-name }} образы из Marketplace, их необходимо обновить до безопасной версии самостоятельно.
