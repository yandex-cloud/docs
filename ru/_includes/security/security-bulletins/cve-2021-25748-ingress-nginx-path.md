## 15.06.2022 — CVE-2021-25748 — Ingress-nginx. Обход фильтрации в path {#CVE-2021-25748}

CVE ID: CVE-2021-25748

Ссылка на CVE: <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-25748>

### Исходный отчет {#original-report-CVE-2021-25748}

<https://discuss.kubernetes.io/t/security-advisory-cve-2021-25748-ingress-nginx-path-sanitization-can-be-bypassed-with-newline-character/20280>

### Краткое описание {#brief-description-CVE-2021-25748}

Пользователь может обойти фильтрацию в поле `spec.rules[].http.paths[].path` объекта ingress (в группе API networking.k8s.io или extensions), использовав в значении поля символ новой строки, и получить реквизиты доступа контроллера ingress-nginx. В конфигурации по умолчанию с этими реквизитами можно получить доступ ко всем секретам кластера.

### Затронутые технологии {#technologies-affected-CVE-2021-25748}

* Kubernetes
* Nginx

### Уязвимые продукты и версии {#vulnerable-products-and-versions-CVE-2021-25748}

ingress-nginx < v1.2.1

### Вендор {#vendor-CVE-2021-25748}

NGINX ingress controller

### Вектор атаки и уровень опасности согласно CVSS v.3.0 {#attack-vector-and-severity-level-CVE-2021-25748}

CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:L

### Рекомендации по обнаружению уязвимости и дополнительные материалы {#recommendations-for-vulnerability-detection-CVE-2021-25748}

<https://discuss.kubernetes.io/t/security-advisory-cve-2021-25748-ingress-nginx-path-sanitization-can-be-bypassed-with-newline-character/20280>

### Безопасная версия уязвимого продукта или патч {#safe-version-CVE-2021-25748}

ingress-nginx v1.2.1

### Компенсационные меры для пользователей {{ yandex-cloud }} {#compensatory-measures-CVE-2021-25748}

Если вы используете контроллер ingress-nginx в {{ managed-k8s-full-name }} или собственную инсталляцию Kubernetes и не можете обновиться до безопасной версии, используйте политику, которая ограничивает поле `spec.rules[].http.paths[].path` ресурса networking.k8s.io/Ingress только безопасными символами (новые [правила](https://github.com/kubernetes/ingress-nginx/blame/main/internal/ingress/inspector/rules.go) и предлагаемые значения для [annotation-value-word-blocklist](https://kubernetes.github.io/ingress-nginx/user-guide/nginx-configuration/configmap/#annotation-value-word-blocklist)).

### Влияние на сервисы {{ yandex-cloud }} {#impact-on-yandex-cloud-services-CVE-2021-25748}

Влияние на сервисы {{ yandex-cloud }} отсутствует, так как в инфраструктуре не используется ingress-nginx. Вместо него используется [alb-ingress controller](../../../application-load-balancer/tools/k8s-ingress-controller/index.md).
