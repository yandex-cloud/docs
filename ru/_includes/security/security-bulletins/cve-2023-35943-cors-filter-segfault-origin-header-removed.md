## 06.10.2023 — CVE-2023-35943 CORS filter segfault when origin header is removed {#CVE-2023-35943}

CVE ID: CVE-2023-35943

Ссылка на CVE: <https://nvd.nist.gov/vuln/detail/CVE-2023-35943>

### Исходный отчет {#original-report}

<https://github.com/envoyproxy/envoy/security/advisories/GHSA-mc6h-6j9x-v3gq>

### Краткое описание {#brief-description}

До версий 1.27.0, 1.26.4, 1.25.9, 1.24.10 и 1.23.12 фильтр CORS приводил к ошибкам сегментации и аварийному завершению работы Envoy, когда заголовок `origin` удалялся между `decodeHeaders` и `encodeHeaders`. В версиях 1.27.0, 1.26.4, 1.25.9, 1.24.10 и 1.23.12 эта проблема исправлена.

### Затронутые технологии {#technologies-affected}

Envoy

### Уязвимые продукты и версии {#vulnerable-products-and-versions}

Envoy до версий 1.27.0, 1.26.4, 1.25.9, 1.24.10, 1.23.12

### Вендор {#vendor}

Envoy

### Вектор атаки и уровень опасности согласно CVSS v.3.0 {#attack-vector-and-severity-level}

Рейтинг 7.5. Вектор CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H

### Рекомендации по обнаружению уязвимости и дополнительные материалы{#recommendations-for-vulnerability-detection}

Рекомендуется обновление до актуальных версий. Если обновление невозможно, не удаляйте заголовок `origin` в конфигурации Envoy.

### Безопасная версия уязвимого продукта или патч {#safe-version}

Уязвимость устранена в версиях 1.27.0, 1.26.4, 1.25.9, 1.24.10, 1.23.12

### Влияние на сервисы {{ yandex-cloud }} {#impact-on-yandex-cloud-services}

Мы обновили существующие и будущие образы до актуальной версии. Если вы используете собственный образ на ВМ, который подвержен уязвимости, рекомендуется обновить его самостоятельно.
