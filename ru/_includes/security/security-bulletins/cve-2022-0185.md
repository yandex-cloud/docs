## 28.01.2022 — CVE-2022-0185 — Heap overflow bug in legacy_parse_param {#CVE-2022-0185}

### Описание

Уязвимость [CVE-2022-0185](https://ubuntu.com/security/CVE-2022-0185) содержится в версиях ядра Linux, начиная с 5.1-rc1, в системе контекста файловой системы. Злоумышленник может использовать уязвимость, чтобы вызвать отказ в обслуживании (сбой системы), выполнить произвольный код и выйти за пределы контейнера.

Подробное описание уязвимости представлено в [статье](https://sysdig.com/blog/cve-2022-0185-container-escape/).

Описание уязвимости [CVE-2022-0185](https://ubuntu.com/security/CVE-2022-0185).

CVSS рейтинг: 7.8.

### Влияние

#### Общее влияние

Влиянию подвержены Linux Kernel-системы по всему миру, начиная с версии ядра 5.1-rc1.

#### Влияние на сервисы {{ yandex-cloud }}

В настоящее время принимаются меры по компенсации уязвимости в сервисах {{ yandex-cloud }}:

* {{ marketplace-full-name }};
* {{ managed-k8s-full-name }};
* во внутренней инфраструктуре {{ yandex-cloud }}.

По результатам работ будет выполнено обновление данного бюллетеня.

### Компенсационные меры

Если вы используете образы Linux из {{ marketplace-full-name }} и k8s группы узлов в сервисе {{ managed-k8s-full-name }}, примените официальное обновление, как только оно станет доступно.

До выхода официального обновления примите компенсирующие меры:

* Используйте подготовленный для данной уязвимости [daemonset fix](https://github.com/yandex-cloud/yc-solution-library-for-security/tree/master/kubernetes-security/cve-quickfix/CVE-2022-0185) из Yc-solution-library-for-security, который устанавливает настройки в соответствии с рекомендациями Ubuntu.
* Используйте официальные советы по обновлению либо по компенсации уязвимости для вашего дистрибутива Linux, например для Ubuntu установите параметр: `sysctl -w kernel.unprivileged_userns_clone=0`.
* Используйте seccomp в Kubernetes согласно [статье](https://kubernetes.io/docs/tutorials/security/seccomp/).
* Не назначайте избыточных capabilities и используйте [раздел по безопасности k8s](../../../security/domains/checklist.md#kubernetes-secure-configuration) из нашего чек-листа для контроля за ними.
