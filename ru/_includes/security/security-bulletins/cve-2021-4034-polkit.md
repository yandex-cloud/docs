## 28.01.2022 — CVE-2021-4034 – Polkit's pkexec {#cve-2021-4034}

### Описание

Уязвимость [CVE-2021-4034](https://ubuntu.com/security/notices/USN-5252-1) содержится во всех версиях Unix-подобных ОС. Инструмент PolicyKit pkexec неправильно обрабатывает аргументы командной строки. Злоумышленник может использовать это поведение pkexec для повышения привилегий до уровня администратора.

Подробное описание уязвимости представлено в [статье](https://www.openwall.com/lists/oss-security/2022/01/25/11).

Описание уязвимости [CVE-2021-4034](https://ubuntu.com/security/notices/USN-5252-1).

CVSS рейтинг: 7.8.

### Влияние

#### Общее влияние

Влиянию подвержены все Unix-подобные ОС, использующие policykit-1 (0.105) версий ниже, чем указаны в статье, например для [Ubuntu](https://ubuntu.com/security/notices/USN-5252-1).

#### Влияние на сервисы {{ yandex-cloud }}

Со стороны облака были выполнены обновления в сервисах {{ yandex-cloud }}:

* {{ marketplace-full-name }};
* во внутренней инфраструктуре {{ yandex-cloud }}.

Готовим обновления в сервисе {{ managed-k8s-full-name }}.

### Компенсационные меры

Если вы используете облачную группу узлов в сервисе {{ managed-k8s-full-name }}, дождитесь официального обновления со стороны сервиса и примените его. Либо самостоятельно выполните [обновление ОС](https://ubuntu.com/security/notices/USN-5252-1).

Также существуют компенсирующие меры:

* Используйте подготовленный для данной уязвимости [daemonset fix](https://github.com/yandex-cloud/yc-solution-library-for-security/tree/master/kubernetes-security/cve-quickfix/CVE-2021-4034) из Yc-solution-library-for-security, который устанавливает настройки в соответствии с рекомендациями Ubuntu.

* Для образов из {{ marketplace-full-name }} либо собственных образов в {{ compute-full-name }} используйте официальные советы по обновлению либо по компенсации уязвимости, например для Ubuntu установите права доступа: `chmod 0755 /usr/bin/pkexec`.