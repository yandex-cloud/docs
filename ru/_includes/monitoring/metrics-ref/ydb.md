Имя метрики пишется в метку `name`.

## Метрики базы данных {#managed-ydb-db-metrics}
Имя метрики<br>Тип, единицы измерения | Описание<br>Метки
--- | ---
`database_size`<br/>`DGAUGE`, байты | Размер базы данных.

## Метрики использования ресурсов {#resources}

Имя метрики<br>Тип, единицы измерения | Описание<br>Метки
--- | ---
`resources.storage.limit_bytes`<br>`IGAUGE`, байты | Ограничение на размер пользовательских и служебных данных, которые база данных может сохранить в распределенном сетевом хранилище.
`resources.storage.topic.used_bytes`<br>`DGAUGE`, байты | Используемый объем хранилища топиков.
`resources.storage.used_bytes`<br>`IGAUGE`, байты | Размер пользовательских и служебных данных, сохраненных в распределенном сетевом хранилище. К служебным данным относятся данные первичного и [вторичных индексов](https://ydb.tech/docs/ru/concepts/secondary_indexes).
`resources.stream.limit_shards`<br>`DGAUGE`, штуки | Ограничение на количество шардов в потоке.
`resources.stream.storage.limit_bytes`<br>`DGAUGE`, байты | Ограничение на размер хранилища потока.
`resources.stream.storage.reserved_bytes`<br>`DGAUGE`, байты | Зарезервированный размер хранилища потока.
`resources.stream.throughput.limit_bytes_per_second`<br>`DGAUGE`, байты/с | Ограничение на пропускную способность потока.
`resources.stream.used_shards`<br>`DGAUGE`, штуки | Количество шардов, используемых потоком.

## Метрики API {#api}

Имя метрики<br>Тип, единицы измерения | Описание<br>Метки
--- | ---
`api.grpc.request.bytes`<br>`RATE`, байты | Размер запросов, которые получены базой данных в определенный период времени.<br>Метки:<ul><li>`api_service` – название сервиса gRPC API, например `table`.</li><li>`method` – название метода сервиса gRPC API, например `ExecuteDataQuery`.</li></ul>
`api.grpc.request.count`<br>`RATE`, штуки | Общее количество запросов к базе данных.<br>Метки:<ul><li>`api_service` – название сервиса gRPC API, например `table`.</li><li>`method` – название метода сервиса gRPC API, например `ExecuteDataQuery`.</li></ul>
`api.grpc.request.dropped_count`<br>`RATE`, штуки | Количество запросов, обработка которых была прекращена на транспортном (gRPC) уровне из-за ошибки.<br>Метки:<ul><li>`api_service` – название сервиса gRPC API, например `table`.</li><li>`method` – название метода сервиса gRPC API, например `ExecuteDataQuery`.</li></ul>
`api.grpc.request.inflight_bytes`<br>`IGAUGE`, байты | Размер запросов, которые одновременно обрабатываются базой данных в определенный период времени.<br>Метки:<ul><li>`api_service` – название сервиса gRPC API, например `table`.</li><li>`method` – название метода сервиса gRPC API, например `ExecuteDataQuery`.</li></ul>
`api.grpc.request.inflight_count`<br>`IGAUGE`, штуки | Количество запросов, которые одновременно обрабатываются базой данных в определенный период времени.<br>Метки:<ul><li>`api_service` – название сервиса gRPC API, например `table`.</li><li>`method` – название метода сервиса gRPC API, например `ExecuteDataQuery`.</li></ul>
`api.grpc.response.bytes`<br>`RATE`, байты | Размер ответов, которые отправлены базой данный в определенный период времени.<br>Метки:<ul><li>`api_service` – название сервиса gRPC API, например `table`.</li><li>`method` – название метода сервиса gRPC API, например `ExecuteDataQuery`.</li></ul>
`api.grpc.response.count`<br>`RATE`, штуки | Количество ответов, которые отправлены базой в определенный период времени.<br>Метки:<ul><li>`api_service` – название сервиса gRPC API, например `table`.</li><li>`method` – название метода сервиса gRPC API, например `ExecuteDataQuery`.</li><li>`status` – статус выполнения запроса, подробнее статусы описаны в разделе [Обработка ошибок](https://ydb.tech/docs/ru/reference/ydb-sdk/error_handling).</li></ul>
`api.grpc.response.dropped_count`<br>`RATE`, штуки | Количество ответов, отправка которых была прекращена на транспортном (gRPC) уровне из-за ошибки.<br>Метки:<ul><li>`api_service` – название сервиса gRPC API, например `table`.</li><li>`method` – название метода сервиса gRPC API, например `ExecuteDataQuery`.</li></ul>
`api.grpc.response.issues`<br>`RATE`, штуки | Количество ошибок определенного типа, возникших при выполнении запросов в определенный период времени.<br>Метки:<ul><li>`issue_type` – тип ошибки, единственное значение – `optimistic_locks_invalidation`, подробнее инвалидация блокировок описана в разделе [Транзакции и запросы к {{ ydb-short-name }}](https://ydb.tech/docs/ru/concepts/secondary_indexes).</li></ul>
`api.request.completed_per_second`<br>`DGAUGE`, запросы/с | Скорость завершения запросов API.
`api.request.latency_milliseconds`<br>`IGAUGE`, миллисекунды | Задержка, с которой API обрабатывает запросы.
`api.request.latency_milliseconds_count`<br>`COUNTER`, количество запросов | Общее количество запросов API, для которых измерялась задержка.
`api.request.latency_milliseconds_sum`<br>`COUNTER`, миллисекунды | Суммарная задержка при обработке запросов API.
`api.request.size_bytes_per_second`<br>`DGAUGE`, байты/с | Скорость обработки запросов API.
`api.response.size_bytes_per_second`<br>`DGAUGE`, байты/с | Скорость обработки ответов API.
`api.units.consumed_by_method_per_second`<br>`DGAUGE`, штуки/с | Скорость потребления ресурсов конкретным методом API.
`api.units.consumed_per_second`<br>`DGAUGE`, штуки/с | Общая скорость потребления ресурсов методами API.

## Метрики сессий {#sessions}

Имя метрики<br>Тип, единицы измерения | Описание<br>Метки
--- | ---
`table.session.active_count`<br>`IGAUGE`, штуки | Количество сессий, открытых клиентами в данный момент времени.
`table.session.closed_by_idle_count`<br>`RATE`, штуки | Количество сессий, которые закрыты по инициативе сервера баз данных в определенный период времени из-за превышения времени, выделенного на существование неактивной сессии.

## Метрики обработки транзакций {#transactions}

Длительность выполнения транзакции можно анализировать с помощью гистограммного счетчика. Интервалы заданы в миллисекундах. График показывает количество транзакций, длительность которых попадает в определенный интервал времени.

Имя метрики<br>Тип, единицы измерения | Описание<br>Метки
--- | ---
`table.transaction.client_duration_milliseconds`<br>`HIST_RATE`, штуки | Количество транзакций определенной длительности выполнения на клиенте. Длительность выполнения – это время ожидания на клиенте между отправкой отдельных запросов в одной транзакции. Не включает время выполнения запросов на сервере.<br>Метки:<ul><li>`tx_kind` – тип транзакции, возможные значения `read_only`, `read_write`, `write_only`, `pure`.</li></ul>
`table.transaction.server_duration_milliseconds`<br>`HIST_RATE`, штуки | Количество транзакций определенной длительности выполнения на сервере. Длительность выполнения – это время выполнения запросов в транзакции на сервере. Не включает время ожидания на клиенте между отправкой отдельных запросов в одной транзакции.<br>Метки:<ul><li>`tx_kind` – тип транзакции, возможные значения `read_only`, `read_write`, `write_only`, `pure`.</li></ul>
`table.transaction.total_duration_milliseconds`<br>`HIST_RATE`, штуки | Количество транзакций определенной длительности выполнения на сервере и клиенте. Длительность выполнения – это время выполнения транзакции от момента явного или неявного открытия транзакции до момента фиксации изменений или отката. Включает время обработки транзакции на сервере и время на клиенте между отправкой разных запросов в одной транзакции.<br>Метки:<ul><li>`tx_kind` – тип транзакции, возможные значения `read_only`, `read_write`, `write_only`, `pure`.</li></ul>

## Метрики обработки запросов {#queries}

Имя метрики<br>Тип, единицы измерения | Описание<br>Метки
--- | ---
`table.query.compilation.latency_milliseconds`<br>`HIST_RATE`, штуки | Гистограммный счетчик. Интервалы заданы в миллисекундах. Показывает количество успешно выполненных запросов на компиляцию, длительность которых попадает в определенный интервал времени.
`table.query.compilation.active_count`<br>`IGAUGE`, штуки | Количество компиляций, которые находятся в процессе выполнения в данный момент времени.
`table.query.compilation.count`<br>`RATE`, штуки | Количество компиляций, которые успешно завершились в определенный период времени.
`table.query.compilation.error_count`<br>`RATE`, штуки | Количество компиляций, которые завершились с ошибкой в определенный период времени.
`table.query.compilation.cache_hits`<br>`RATE`, штуки | Количество запросов в определенный период времени, для выполнения которых не потребовалось компилировать запрос, так как в кэше подготовленных запросов был созданный ранее план.
`table.query.compilation.cache_misses`<br>`RATE`, штуки | Количество запросов в определенный период времени, для выполнения которых потребовалось компилировать запрос.
`table.query.execution.latency_milliseconds`<br>`HIST_RATE`, штуки | Гистограммный счетчик. Интервалы заданы в миллисекундах. Показывает количество запросов, время выполнения которых попадает в определенный интервал.
`table.query.request.bytes`<br>`RATE`, байты | Размер текста YQL-запросов и значений параметров к запросам, которые поступили в базу данных в определенный период времени.
`table.query.request.parameters_bytes`<br>`RATE`, байты | Размер параметров к запросам, которые поступили в базу данных в определенный период времени.
`table.query.response.bytes`<br>`RATE`, байты | Размер ответов, которые отправлены базой данных в определенный период времени.

## Метрики партиций таблиц (DataShards) {#datashards}

Имя метрики<br/>Тип, единицы измерения | Описание<br>Метки
--- | ---
`table.datashard.bulk_upsert.bytes`<br>`RATE`, байты | Размер данных, которые добавлены через вызов gRPC API `BulkUpsert` во все партиции всех таблиц в базе в определенный период времени.
`table.datashard.bulk_upsert.rows`<br>`RATE`, штуки | Количество строк, которые добавлены через вызов gRPC API `BulkUpsert` во все партиции всех таблиц в базе данных в определенный период времени.
`table.datashard.erase.bytes`<br>`RATE`, байты | Размер данных, которые удалены в базе в определенный период времени.
`table.datashard.erase.rows`<br>`RATE`, штуки | Количество строк, которые удалены в базе данных в определенный период времени.
`table.datashard.read.bytes`<br>`RATE`, байты | Размер данных, которые прочитаны всеми партициями всех таблиц в базе в определенный период времени.
`table.datashard.read.rows`<br>`RATE`, штуки | Количество строк, которые прочитаны всеми партициями всех таблиц в базе данных в определенный период времени.
`table.datashard.row_count`<br>`GAUGE`, штуки | Количество строк в таблицах базы данных.
`table.datashard.scan.bytes`<br>`RATE`, байты | Размер данных, которые прочитаны через вызов gRPC API `StreamExecuteScanQuery` или `StreamReadTable` всеми партициями всех таблиц в базе в определенный период времени.
`table.datashard.scan.rows`<br>`RATE`, штуки | Количество строк, которые прочитаны через вызовы gRPC API `StreamExecuteScanQuery` или `StreamReadTable` всеми партициями всех таблиц в базе данных в определенный период времени.
`table.datashard.size_bytes`<br>`GAUGE`, байты | Размер данных в таблицах базы.
`table.datashard.used_core_percents`<br>`HIST_GAUGE`, % | Гистограммный счетчик. Интервалы заданы в процентах. Показывает количество партиций таблиц, которые используют вычислительные ресурсы в доле, попадающей в определенный интервал.
`table.datashard.write.rows`<br>`RATE`, штуки | Количество строк, которые записаны всеми партициями всех таблиц в базе данных в определенный период времени.
`table.datashard.write.bytes`<br>`RATE`, байты | Размер данных, которые записаны всеми партициями всех таблиц в базе в определенный период времени.

## Метрики партиций таблиц (ColumnShards) {#columnshards}

Имя метрики<br/>Тип, единицы измерения | Описание<br>Метки
--- | ---
`table.columnshard.bulk_upsert.bytes`<br>`RATE`, байты/с | Размер данных, которые добавлены через вызов gRPC API `BulkUpsert` во все партиции всех таблиц в базе в определенный период времени.
`table.columnshard.bulk_upsert.rows`<br>`RATE`, строки/с | Количество строк, которые добавлены через вызов gRPC API `BulkUpsert` во все партиции всех таблиц в базе данных в определенный период времени.
`table.columnshard.scan.bytes`<br>`RATE`, байты/с | Размер данных, которые прочитаны через вызов gRPC API `StreamExecuteScanQuery` или `StreamReadTable` всеми партициями всех таблиц в базе в определенный период времени.
`table.columnshard.scan.rows`<br>`RATE`, строки/с | Количество строк, которые прочитаны через вызовы gRPC API `StreamExecuteScanQuery` или `StreamReadTable` всеми партициями всех таблиц в базе данных в определенный период времени.

## Метрики использования ресурсов (только для режима Dedicated) {#ydb_dedicated_resources}

Имя метрики<br>Тип<br>единицы измерения | Описание<br>Метки
--- | ---
`resources.cpu.limit_core_percents`<br>`IGAUGE`, % | Доступный базе данных CPU в процентах. Например, для БД из трех нод по 4 ядра в `pool=user` в каждой ноде, значение этого сенсора будет равно `1200`.<br>Метки:<ul><li>`pool` – вычислительный пул, возможные значения `user`, `system`, `batch`, `io`, `ic`.</li></ul>
`resources.cpu.used_core_percents`<br>`RATE`, % | Использование CPU. Значение `100` означает, что одно из ядер использовано на 100%. Значение может быть больше `100` для конфигураций с более чем 1 ядром.<br>Метки:<ul><li>`pool` – вычислительный пул, возможные значения `user`, `system`, `batch`, `io`, `ic`.</li></ul>
`resources.memory.limit_bytes`<br>`IGAUGE`, байты | Доступная нодам базы данных оперативная память.
`resources.memory.used_bytes`<br>`IGAUGE`, байты | Использованная нодами базы данных оперативная память.

## Метрики обработки запросов (только для режима Dedicated) {#ydb_dedicated_queries}

Имя метрики<br>Тип<br>единицы измерения | Описание<br>Метки
--- | ---
`table.query.compilation.cache_evictions`<br>`RATE`, штуки | Количество запросов, вытесненных из кэша [подготовленных запросов](https://ydb.tech/docs/ru/reference/ydb-sdk/example/#param-queries) в определенный период времени.
`table.query.compilation.cache_size_bytes`<br>`IGAUGE`, байты | Размер кэша подготовленных запросов.
`table.query.compilation.cached_query_count`<br>`IGAUGE`, штуки | Размер кэша подготовленных запросов.
