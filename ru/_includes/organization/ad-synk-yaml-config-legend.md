Где:

* `userpool_id` — идентификатор [пула пользователей](../../organization/concepts/user-pools.md) в {{ org-name }}.
* `cloud_credentials_file_path` — путь к файлу, содержащему [авторизованный ключ](../../iam/concepts/authorization/key.md) сервисного аккаунта в {{ yandex-cloud }}. Например:

    * `/etc/yc-identityhub-sync-agent/authorized_key.json` (для Linux);
    * `C:\\ProgramData\\YcIdentityHubSyncAgent\\authorized_key.json` (для Windows).

    В параметре `cloud_credentials_file_path` вместо полного пути вы можете передать только имя файла. В этом случае файл будет сохранен в рабочей директории, заданной в параметре `working_directory`, или, если рабочая директория не задана, — в директории, в которой расположен исполняемый файл агента.
* `replication_tokens_path` — путь к директории, в которой сохраняются токены с информацией о текущем прогрессе процессов [полной синхронизации](../../organization/concepts/ad-sync.md#full-sync). Необязательный параметр.

    Если параметр не задан, токены сохраняются в рабочей директории агента, указанной в параметре `working_directory`, или, если рабочая директория не задана, — в директории, в которой расположен исполняемый файл агента.
* `working_directory` — путь к директории, в которой сохраняются другие файлы, необходимые агенту для работы. Необязательный параметр.

    Если параметр не задан, в качестве рабочей директории используется директория, в которой расположен исполняемый файл агента. По умолчанию исполняемый файл агента располагается в следующих директориях:

    * `/etc/yc-identityhub-sync-agent/` (для Linux);
    * `C:\\ProgramData\\YcIdentityHubSyncAgent\\` (для Windows).

    {% note info %}

    Если в параметрах `cloud_credentials_file_path`, `replication_tokens_path` и/или `logger.level` заданы пути, отличные от пути, заданного в параметре `working_directory`, будут использоваться пути, указанные в параметрах `cloud_credentials_file_path`, `replication_tokens_path` и/или `logger.level`.

    {% endnote %}

* `drsr` — настройки протокола [DRSR](https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-drsr/) для аутентификации на стороне {{ microsoft-idp.ad-short }} [пользователя](#dc-setup) с назначенными правами на выполнение репликации данных в каталоге.
* `ldap` — настройки протокола [LDAP](https://learn.microsoft.com/en-us/windows/win32/api/_ldap/) для аутентификации на стороне {{ microsoft-idp.ad-short }} [пользователя](#dc-setup) с назначенными правами на выполнение репликации данных в каталоге.
* `logger` — настройки [логирования](#logging) процесса синхронизации:

    * `level` — уровень логирования. Возможные значения:

        {% include [ad-synk-log-levels](./ad-synk-log-levels.md) %}

    * `format` — формат вывода информации о событиях. Необязательный параметр. Возможные значения:

        * `plain` — информация выводится в простом текстовом виде. Значение по умолчанию.
        * `json` — информация выводится в формате [JSON](https://ru.wikipedia.org/wiki/JSON).
    * `file` — настройки сохранения логов в файлы:

        * `filename` — путь к файлу, в который будет сохраняться информация о событиях при синхронизации.

            В параметре `filename` вместо полного пути вы можете передать только имя файла. В этом случае файл будет сохранен в рабочей директории, заданной в параметре `working_directory`, или, если рабочая директория не задана, — в директории, в которой расположен исполняемый файл агента.

            Необязательный параметр. Имя файла по умолчанию — `identity_hub.log`.
        * `maxsize` — максимальный размер одного файла с логами в мегабайтах.
        * `maxbackups` — максимальное количество файлов с логами, которые агент будет хранить. При превышении максимального количества файлов наиболее старый файл будет удален.

        Необязательный параметр. Если настройки в параметре `file` не заданы, информация не сохраняется в файлы, а выводится в поток `stdout`.
* `sync_settings` — настройки процесса синхронизации:

    * `interval` — периодичность выполнения [инкрементальной синхронизации](../../organization/concepts/ad-sync.md#incremental-sync). Необязательный параметр. Значение по умолчанию — 240 секунд.

        {% note info %}

        Периодичность выполнения синхронизации паролей и состояний пользователей в {{ microsoft-idp.ad-short }} составляет несколько секунд, является константой и не зависит от значения, заданного в параметре `interval`.

        {% endnote %}

    * `allow_to_capture_users` — параметр, позволяющий изменять существующего пользователя пула {{ org-name }} при совпадении его логина с логином пользователя {{ microsoft-idp.ad-short }}, которого требуется синхронизировать. Возможные значения:

        * `true` — агент синхронизации будет изменять существующих пользователей {{ org-name }}, приводя их в соответствие с учетной записью в {{ microsoft-idp.ad-short }}.
        * `false` — агент синхронизации не будет изменять существующих пользователей {{ org-name }}. При обнаружении совпадения логинов пользователя в пуле и в {{ microsoft-idp.ad-short }} процесс синхронизации выдаст ошибку.
    * `allow_to_capture_groups` — параметр, позволяющий изменять существующую группу пользователей {{ org-name }} при совпадении ее имени с именем группы в {{ microsoft-idp.ad-short }}, которую требуется синхронизировать. Возможные значения:

        * `true` — агент синхронизации будет изменять существующие группы пользователей {{ org-name }}, приводя их в соответствие с группами в {{ microsoft-idp.ad-short }}.
        * `false` — агент синхронизации не будет изменять существующие группы пользователей {{ org-name }}. При обнаружении совпадения имен групп в пуле и в {{ microsoft-idp.ad-short }} процесс синхронизации выдаст ошибку.
    * `replacement_domain` — [домен](../../organization/concepts/domains.md), привязанный к пулу пользователей {{ org-name }}, в котором находятся синхронизируемые пользователи и группы. Например: `newdomain.idp.{{ dns-ns-host-sld }}`.

        Необязательный параметр. Значение параметра `replacement_domain` требуется задавать только в том случае, если имя домена, привязанного к пулу пользователей, отличается от имени домена на контроллере домена {{ microsoft-idp.ad-short }}.
    * `filter` — настройки фильтрации синхронизируемых объектов на стороне {{ microsoft-idp.ad-short }}:

        * `domain` — имя домена на контроллере домена {{ microsoft-idp.ad-short }}, в котором агент будет синхронизировать пользователей и группы.
        * `organization_units` — список Organization Units (OU) в каталоге {{ microsoft-idp.ad-short }}, в которых агент будет синхронизировать пользователей и группы.

        Если не настроить фильтрацию синхронизируемых объектов, агент {{ ad-sync-agent }} попытается синхронизировать все [доступные объекты](../../organization/concepts/ad-sync.md#sync-objects) в каталоге {{ microsoft-idp.ad-short }}.

        {% note info %}

        Если в процессе синхронизации пользователь или группа перестают удовлетворять заданным фильтрам (например, они были перенесены в другой Organization Unit в рамках {{ microsoft-idp.ad-short }}), то на стороне {{ org-name }} такие пользователи и группы удаляются.

        {% endnote %}