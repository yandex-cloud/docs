## Общая информация {#about}

### Вкладка {#tab-common-dash}

```json
{
  "tabs": [
    {
      "id": "WR",
      "title": "Sales",
      "items": [...],
      "layout": [...],
      "connections": [...],
      "aliases": {...}
    },
    ...
  ]
}
```

Включает в себя:

* `items` - набор элементов
* `layout` - описание сетки (схемы расположения элементов)
* `connections` - перечень связей между элементами
* `aliases`

**Примечание**: все `id` (вкладок, элементов, табов чартов (элемент типа `widget`)) в рамках схемы должны быть уникальными

### Элемент {#element-common-dash}

```json
{
  "items": [
    {
      "id": "7r5",
      "namespace": "default",
      "type": "...",
      "data": {...}
    },
    ...
  ]
}
```

**Примечание**: Каждый элемент должен иметь соответствующую запись в схеме

**Примечание**: У каждого элемента есть свойство `namespace`, которое на данный момент всегда должно быть равно `default`.

Элемент в зависимости от типа (`type`) имеет свой набор данных (`data`), необходимых для корректной работы.

Элемент может быть следующего типа:

* **title** - заголовок

  ```json
  {
    ...,
    "type": "title",
    "data": {
      "text": "Sales",

      // размер: xs, s, m, l
      "size": "l",

      // отображать в оглавлении
      "showInTOC": true
    }
  }
  ```

* **text** - текст

  ```json
  {
    ...,
    "type": "text",
    "data": {
      "text": "Пример дашборда построенный по данным Sample SuperStore."
    }
  }
  ```

* **widget** - чарт

  ```json
  {
    ...,
    "type": "widget",
    "data": {
      // скрыть заголовок (только для случая если в tabs один элемент)
      "hideTitle": false,

      // табы
      "tabs": [
        {
          "id": "xq",
          "title": "Sales dynamics by Region",

          // параметры по умолчанию
          "params": {},

          // id чарта
          "chartId": "rj9ym88l5zd8q",

          // является ли вкладкой по умолчанию
          "isDefault": true,

          "description": ""
        }
      ]
    }
  }
  ```

* **control** - селектор

  ```json
  {
    ...,
    "type": "control",
    "data": {
      "title": "Segment",
      "sourceType": "...",
      "source": {...}
    },
    "defaults": {
      "b9024e08-70ca-402e-9236-ec1e63a3e91b": ["Consumer"],
      "Date": "__interval_2014-01-01_2014-01-31"
    }
  }
  ```

У элемента типа `control` есть свойство `defaults` -
это перечень связанных с элементом параметров и их значения по умолчанию.

Элемент типа `control` в зависимости от типа источника (`sourceType`) имеет разный набор данных (`source`), необходимых для корректной работы.

Тип источника может принимать следующие значения:

* **dataset** - на основе датасета

  ```json
  {
    ...,
    "type": "control",
    "data": {
      ...
      "sourceType": "dataset",
      "source": {
        // показывать заголовок
        "showTitle": true,

        // id датасета
        "datasetId": "aoetfany4sy88",

        // id поля датасета
        "datasetFieldId": "b9024e08-70ca-402e-9236-ec1e63a3e91b",

        // тип элемента
        "elementType": "select",

        // множественный выбор (только для "elementType": "select")
        "multiselectable": true,

        // значение по умолчанию
        // (для "elementType": "select")
        "defaultValue": ["Consumer"]

        // (для "elementType": "date")
        // "defaultValue": "__interval_2014-01-01_2014-01-31"
      }
    }
  }
  ```

* **manual** - ручной ввод

  ```json
  {
    ...,
    "type": "control",
    "data": {
      ...,
      "sourceType": "manual",
      "source": {
        // показывать заголовок
        "showTitle": true,

        // имя параметра
        "fieldName": "Date",

        // доступные значения
        // (только для "elementType": "date")
        "acceptableValues": {
          "to": "2017-12-31",
          "from": "2014-01-01"
        },

        // доступные значения
        // (только для "elementType": "select")
        // "acceptableValues": [{
        //   "title": "daily",
        //   "value": "daily"
        // }, ...],

        // тип элемента
        "elementType": "date",

        // календарь на интервал (только для "elementType": "date")
        "isRange": true,

        // значение по умолчанию
        // (для "elementType": "date")
        "defaultValue": "__interval_2014-01-01_2014-01-31"

        // (для "elementType": "select")
        // "defaultValue": ["Consumer"]
      }
    }
  }
  ```

* **external** - внешний селектор

  ```json
  {
    ...,
    "type": "control",
    "data": {
      ...,
      "sourceType": "external",
      "source": {
        // id чарта типа селектор
        "chartId": "az26sxbs6uga7"
      }
    }
  }
  ```

### Сетка {#grid-common-dash}

```json
{
  "layout": [
    {
      // id элемента
      "i": "Xb",

      // высота
      "h": 14,

      // ширина
      "w": 12,

      "x": 21,
      "y": 4
    },
    ...
  ]
}
```

36 колонок, каждая единица высоты 18px.

**Примечание**: Каждый элемент должен иметь соответствующую запись в схеме

### Связи {#connections-common-dash}

```json
{
  "connections": [
    {
      // id элемента типа control или id таба элемента типа widget
      "from": "lRM",

      // id элемента типа control или id таба элемента типа widget
      "to": "wz",

      // вид связи
      "kind": "ignore"
    },
    ...
  ]
}
```

На данный момент связь возможна только между селекторами -> табами чартов (однонаправленная) и селекторами <-> селекторами (двунаправленная).
По умолчанию связь устанавливается между элементами по совпадающим именам параметров.

Доступные виды связей:

* `ignore` — игнорирование

### Aliases {#aliases-common-dash}

```json
{
  "aliases": {
    // namespace
    "default": [
      // имена параметров
      [
        "Category",
        "b029ce50-4551-4267-9241-74c079c130d5"
      ],
      ...
    ]
  }
}
```

Состоит из перечесления имен параметров.
Перечисленные в alias параметры синхронизируются по значению, т. е. значение всегда будет одинаковое для всех и изменяться это значение будет одновременно.

Например:
* селектор А задает параметр `car`
* селектор В задает параметр `machine`
* чарт принимает параметр `machine`

По умолчанию связаны только селектор В и чарт.
Если указать alias `["car", "machine"]`, то параметры `car` и `machine` будут синхронизированы.
Тогда при изменении параметра `car` селектором А, селектор В и чарт получат параметр `machine`, равный по значению параметру `car`.
Аналогично при изменении селектором в параметре `machine`, в чарт поступит параметр `machine`, а селектор А получит параметр `car`, равный по значению параметру `machine`.

**Примечание**: На данный момент в `aliases` должно присутствовать одно свойство `default`, уже в котором будет вестись перечисление aliases.
