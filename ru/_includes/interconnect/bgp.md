## BGP-связность {#bgp-peering}

BGP-связность настраивается внутри каждого приватного или публичного соединения между клиентским оборудованием и оборудованием {{ yandex-cloud }} в [точке присутствия](../../interconnect/concepts/pops.md) для обмена информацией о подсетях (префиксах) между сторонами. После обмена этой маршрутной информацией стороны могут передавать IPv4-трафик между подсетями, о которых они сообщили друг другу.

{% note warning %}

Существует [лимит](../../interconnect/concepts/limits.md#interconnect-limits) со стороны оборудования {{ yandex-cloud }} на количество получаемых префиксов от маршрутизатора клиента по протоколу BGP.
Если количество префиксов от маршрутизатора клиента превысит установленный лимит, то BGP-сессия будет разорвана на 30 минут.

Для поддержания непрерывной BGP-связности рекомендуется на маршрутизаторе клиента настраивать политики агрегации маршрутной информации для минимизации количества префиксов анонсируемых по протоколу BGP в направлении оборудования {{ yandex-cloud }} до разумных и необходимых размеров.

{% endnote %}

### BGP ASN {#bgp-asn}

Для настройки BGP-связности с каждой из сторон нужно указать номер автономной системы (BGP ASN) в формате ASPlain. Значение BGP ASN для {{ yandex-cloud }} постоянно и всегда равно **{{ cic-bgp-asn }}**.

На клиентском оборудовании **разрешается** использовать публичный номер BGP ASN (если он есть). На клиентском оборудовании **разрешается** использовать любое значение из следующих диапазонов приватных номеров BGP ASN [RFC 6996](https://datatracker.ietf.org/doc/rfc6996):
* `64512 - 65534` для двухбайтовых BGP ASN.
* `4200000000 - 4294967294` для четырехбайтовых BGP ASN.

На клиентском оборудовании **запрещается** использовать следующие диапазоны номеров BGP ASN [RFC 5398](https://datatracker.ietf.org/doc/rfc5398):
* `64496 – 64511` для двухбайтовых BGP ASN
* `65536 – 65551` для четырехбайтовых BGP ASN

На клиентском оборудовании **запрещается** иметь BGP ASN из вышеперечисленных диапазонов в атрибуте BGP `AS_Path`.

{% note warning %}

Со стороны {{ yandex-cloud }} используется четырехбайтовое значение BGP ASN — **{{ cic-bgp-asn }}**. Часто на сетевом оборудовании разных производителей приоритет отдается использованию двухбайтовых значений BGP ASN, как более распространенному варианту. 

При настройке BGP-взаимодействия со стороны клиентского маршрутизатора необходимо явно разрешить в его конфигурации использование четырехбайтовых значений BGP ASN.

При настройке BGP-взаимодействия со стороны клиентского маршрутизатора, для публичных соединений с использованием публичных IPv4-адресов принадлежащих клиенту, необходимо указывать публичный номер BGP ASN клиента.

{% endnote %}

### BGP аутентификация (опционально) {#bgp-auth}

Для повышения уровня защиты BGP-соединения можно использовать BGP-аутентификацию с использованием механизма `BGP MD5 password`. При включении данной функциональности рекомендуется использовать в качестве пароля строку длиной более 20 символов, состоящую из латинских букв, цифр и специальных символов.

### Протокол BFD {#bfd}

Если у клиента нет возможности подключить свой маршрутизатор к оборудованию {{ yandex-cloud }} напрямую, допускается использование промежуточных сетевых устройств — коммутаторов. Для быстрого обнаружения отказов в схемах с использованием промежуточных сетевых устройств рекомендуется использовать [протокол BFD](https://en.wikipedia.org/wiki/Bidirectional_Forwarding_Detection).

Протокол BFD всегда включен со стороны оборудования {{ yandex-cloud }} cо следующими значениями параметров: 
* `timer` — 300ms
* `multiplier` — 3

Эти значения параметров фиксированы и не могут быть изменены в ручном режиме.

При необходимости клиент может настроить на своём оборудовании нужное ему значение `timer`. В процессе установки BFD-сессии эти параметры будут согласовываться в рамках протокола BFD между оборудованием клиента и оборудованием {{ yandex-cloud }}. 

Устанавливать значение `multiplier`, отличное от 3, не рекомендуется — это может привести к неоптимальной работе протокола.
