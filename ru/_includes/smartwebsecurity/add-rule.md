1. Введите имя правила.
1. (опционально) Введите описание.
1. Задайте приоритет правила. Правило будет иметь больший приоритет, чем преднастроенные.

    {% include [preconfigured-rules-priority](preconfigured-rules-priority.md) %}

1. (опционально) Включите опцию **Только логирование (dry run)**, если вы хотите фиксировать информацию о трафике, который соответствует заданным условиям, но не применять к нему никаких действий.
1. Выберите тип правила:
    * [**Базовое**](../../smartwebsecurity/concepts/rules.md#base-rules) — правило, которое разрешает или запрещает трафик по заданным условиям.
    * [**Smart Protection**](../../smartwebsecurity/concepts/rules.md#smart-protection-rules) — правило, которое отправляет трафик на автоматический анализ с помощью алгоритмов машинного обучения и поведенческого анализа. Подозрительные запросы отправляются в [{{ captcha-full-name }}](../../smartcaptcha/) для дополнительной верификации.
1. Выберите [действие](../../smartwebsecurity/concepts/rules.md#rule-action):
    * Для базового правила: **Запретить** или **Разрешить** трафик, параметры которого соответствуют условиям.
    * Для правила Smart Protection:
      * **Полная защита** — трафик проверяется на основе ML-моделей и поведенческого анализа. Подозрительные запросы отправляются в {{ captcha-name }}.
      * **Защита API** — трафик проверяется на основе ML-моделей и поведенческого анализа. Подозрительные запросы блокируются.
1. Раскройте поле **Условия**.
1. Задайте условия, которым должен соответствовать трафик, чтобы попасть под действие правила. Подробнее см. [Условия действия правила](../../smartwebsecurity/concepts/conditions.md).
      
    Вы можете задать несколько условий одного типа. Для разных типов условий действуют разные логические операторы: _и_ или _или_. Чтобы добавить более одного условия определенного типа нажмите кнопки ![plus-sign](../../_assets/plus-sign.svg) **и** или ![plus-sign](../../_assets/plus-sign.svg) **или**.
1. Нажмите кнопку **Сохранить правило**.