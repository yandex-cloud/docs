# Аннотации

Аннотации — это коллекция пар `ключ:значение`, которые используются для присвоения метаданных объекту. Значения аннотаций всегда имеют тип данных `string`. Подробнее об аннотациях см. в [документации {{ k8s }}](https://kubernetes.io/docs/concepts/overview/working-with-objects/annotations/).

В {{ alb-name }} аннотации используются в ресурсах `Service` только для настройки Ingress-контроллеров.

Для объекта `ObjectMeta` можно передать следующие аннотации:

* **ingress.alb.yc.io/protocol** {#annot-protocol}

   Протокол соединений между балансировщиком и бэкендами, описанными в `Ingress`:

   * `http` — HTTP/1.1. Значение по умолчанию.
   * `http2` — HTTP/2.
   * `grpc` — gRPC.

* **ingress.alb.yc.io/transport-security** {#annot-transport-security}

   Протокол шифрования соединений между балансировщиком и бэкендами, указанными в `Ingress` напрямую (без `HttpBackendGroup`).

   Допустимое значение: `tls` — TLS без проверки сертификата.

   Если аннотация не указана, балансировщик соединяется с бэкендами без шифрования.

   Для бэкендов, входящих в состав групп, значение аннотации игнорируется. Шифрование соединений балансировщика с бэкендами из групп настраивается с помощью поля `spec.backend.tls` ресурса `HttpBackendGroup` (см. [конфигурацию ресурса](../../../application-load-balancer/k8s-ref/http-backend-group.md)).

* **ingress.alb.yc.io/health-checks** {#annot-health-checks}

  Параметры, которые позволяют настроить пользовательские проверки состояния приложений в кластере.

  * `http-path` — путь в URI запроса к эндпоинту приложения для проверок состояния (только для соединений с бэкендами по протоколам `http` и `http2`). Значение по умолчанию — `/healthz`.

  * `grpc-service-name` — имя GRPC-сервиса приложения для проверок состояния (только для соединений с бэкендами по протоколу `grpc`). Если не указано, то выполняется проверка состояния бэкенда в целом.

  * `port` — порт на узлах кластера для проверки доступности приложения. Приложение будет доступно для проверок состояния по адресу `http://<IP-адрес_узла>:<порт>/<путь>`.

  * `healthy-threshold` — количество последовательных успешных проверок, после которых эндпоинт приложения считается работоспособным. Значение по умолчанию — `1`.

  * `unhealthy-threshold` — количество последовательных неуспешных проверок, после которых эндпоинт приложения считается неработоспособным. Значение по умолчанию — `1`.

  * `timeout` — время ожидания ответа в секундах. Возможные значения — от `1s` до `60s`, по умолчанию — `2s`.

  * `interval` — интервал отправки проверочных запросов в секундах. Возможные значения — от `1s` до `60s`, по умолчанию — `5s`. Значение `interval` должно быть больше значения `timeout` минимум на одну секунду.

  Обязательный параметр — `port`. Если не указывать остальные, вместо них будут использоваться значения по умолчанию.

  Параметры перечисляются через запятую. Пример:

     ```
     ...
     annotations:
       ingress.alb.yc.io/health-checks: port=30103,http-path=/health-1,timeout=10s,interval=20s,healthy-threshold=3,unhealthy-threshold=2
     ...
     ```
   