# Оптическое распознавание текста (OCR)

В этом разделе описано, как работает возможность _распознавание текста_ (Optical Character Recognition, OCR) в сервисе.

## Процесс распознавания текста

Распознавание текста на изображении состоит из двух этапов:

1. [Определение языковой модели для распознавания текста](#detect-model).
1. [Поиск текста на изображении](#detect-text).

В результате распознавания сервис вернет JSON-объект с распознанным текстом, его расположением на странице и [достоверностью распознавания](#confidence).

### Определение языковой модели {#detect-model}

Для распознавания текста в сервисе используется модель, обученная на определенном наборе языков. Некоторые языки сильно отличаются друг от друга (например, арабский и китайский), поэтому для них используются [разные модели](supported-languages.md).

Модель выбирается автоматически на основе списка языков, указанных в запросе в свойстве `language_codes`. Если вы не знаете язык текста, укажите `"language_codes": ["*"]`, чтобы сервис выбрал наиболее подходящую модель.

Для каждой запрошенной [возможности](../index.md#features) (`feature`) используется только одна модель. Например, если на изображении текст на китайском и японском, то распознан будет только один из этих языков. Чтобы распознать языки из разных моделей, укажите несколько возможностей в запросе.

Примеры смотрите в инструкции [#T](../../operations/ocr/text-detection.md).

{% note tip %}

Для текста на русском и английском лучше всего работает [англо-русская модель](supported-languages.md#engrus). Чтобы использовать ее укажите один из этих языков или оба, но не указывайте другие языки в той же конфигурации.

{% endnote %}

### Поиск текста на изображении {#detect-text}

Сервис выделяет найденный текст на изображении и группирует его по уровням: слова группируются в строки, строки в блоки, блоки в страницы.

![image](../../../_assets/vision/text-detection.jpg)

В результате сервис возвращает JSON-объект, где для каждого из уровней дополнительно указывается:

* страницы (`pages[]`) — размер страницы;
* блоки текста (`blocks[]`) — расположение текста на странице;
* строки (`lines[]`) — расположение и [достоверность распознавания](#confidence);
* слова (`words[]`) — расположение, достоверность, текст и язык, использованный при распознавании.

Чтобы показать расположение текста, сервис возвращает координаты прямоугольника, обрамляющего текст. Координаты — количество пикселей от левого верхнего угла на изображении.

{% include [coordinates](../../../_includes/vision/coordinates.md) %}

Пример распознанного слова с координатами:

```json
{
  "boundingBox": {
    "vertices": [{
        "x": "410",
        "y": "404"
      },
      {
        "x": "410",
        "y": "467"
      },
      {
        "x": "559",
        "y": "467"
      },
      {
        "x": "559",
        "y": "404"
      }
    ]
  },
  "languages": [{
    "languageCode": "en",
    "confidence": 0.9412244558
  }],
  "text": "you",
  "confidence": 0.9412244558
}
```

## Требования к изображению

Изображение в запросе должно соответствовать следующим требованиям:

{% include [file-restrictions](../../../_includes/vision/file-restrictions.md) %}

## Достоверность распознавания {#confidence}

Достоверность распознавания показывает уверенность сервиса в результате. Например, значение `"confidence": 0.9412244558` для строки <q>we like you</q> означает, что с вероятностью в 94% текст распознан корректно.

Сейчас достоверность считается только для строк. В значение `confidence` для слов и языка подставляется значение для `confidence` строки.

#### Что дальше

* [Посмотрите список поддерживаемых языков и моделей](supported-languages.md)
* [Посмотрите известные ограничения в текущей версии](known-issues.md)
* [Попробуйте распознать текст на картинке](../../operations/ocr/text-detection.md)

