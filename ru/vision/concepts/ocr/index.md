# Оптическое распознавание текста (OCR)

В этом разделе описано, как работает возможность _распознавание текста_ (Optical Character Recognition, OCR).

## Подготовка запроса на распознавание {#request}

В запросе вы указываете список [возможностей для анализа](../index.md#features), которые необходимо применить к изображению. Чтобы распознать текст, используйте тип `TEXT_DETECTION` и задайте список языков в конфигурации.

### Конфигурация запроса {#config}

В конфигурации указывается:
* список языков, на основе которого будет [определена языковая модель](#detect-model) для распознавания.

  Если вы не знаете язык текста, укажите `"*"`, чтобы сервис выбрал наиболее подходящую модель автоматически.
* модель, которая будет использована для поиска текста на изображении. Доступные модели:
  * `page` (по умолчанию) — подходит для изображений с любым количеством строк текста.
  * `line` — подходит для распознавания одной строки текста. Например, если вы не хотите передавать изображение целиком, вы можете вырезать строку и отправить на распознавание только ее.

      {% include [include](../../../_includes/vision/text-detection-line-note.md) %}

### Определение языковой модели {#detect-model}

Для распознавания текста в сервисе используется [языковая модель](supported-languages.md), обученная на определенном наборе языков. Модель выбирается автоматически на основе списка языков, который вы указываете в конфигурации.

При каждом распознавании текста используется только одна модель. Например, если на изображении текст на китайском и японском, то распознан будет только один из этих языков. Чтобы распознать оба этих языка, укажите в запросе несколько возможностей для анализа с разными списками языков.

{% note tip %}

Для текста на русском и английском лучше всего работает [англо-русская модель](supported-languages.md#engrus). Чтобы использовать ее, укажите один из этих языков или оба в `text_detection_config`, но не указывайте другие языки.

{% endnote %}

### Требования к изображению {#image-requirements}

Изображение в запросе должно соответствовать следующим требованиям:

{% include [file-restrictions](../../../_includes/vision/file-restrictions.md) %}

## Ответ с результатами распознавания {#response}

Сервис выделяет найденный текст на изображении и группирует его по уровням: слова группируются в строки, строки в блоки, блоки в страницы.

![image](../../../_assets/vision/text-detection.jpg)

В результате сервис возвращает объект, где для каждого из уровней дополнительно указывается:

* страницы (`pages[]`) — размер страницы;
* блоки текста (`blocks[]`) — расположение текста на странице;
* строки (`lines[]`) — расположение и [достоверность распознавания](#confidence);
* слова (`words[]`) — расположение, достоверность, текст и язык, использованный при распознавании.

Чтобы показать расположение текста, сервис возвращает координаты прямоугольника, обрамляющего текст. Координаты — количество пикселей от левого верхнего угла на изображении.

{% include [coordinates](../../../_includes/vision/coordinates.md) %}

Пример распознанного слова с координатами:

```json
{
  "boundingBox": {
    "vertices": [{
        "x": "410",
        "y": "404"
      },
      {
        "x": "410",
        "y": "467"
      },
      {
        "x": "559",
        "y": "467"
      },
      {
        "x": "559",
        "y": "404"
      }
    ]
  },
  "languages": [{
    "languageCode": "en",
    "confidence": 0.9412244558
  }],
  "text": "you",
  "confidence": 0.9412244558
}
```

### Достоверность распознавания {#confidence}

Достоверность распознавания показывает уверенность сервиса в результате. Например, значение `"confidence": 0.9412244558` для строки <q>we like you</q> означает, что с вероятностью в 94% текст распознан корректно.

Сейчас достоверность считается только для строк. В значение `confidence` для слов и языка подставляется значение для `confidence` строки.

#### Что дальше {#what-is-next}

* [Посмотрите список поддерживаемых языков и моделей](supported-languages.md)
* [Посмотрите известные ограничения в текущей версии](known-issues.md)
* [Попробуйте распознать текст на картинке](../../operations/ocr/text-detection.md)

