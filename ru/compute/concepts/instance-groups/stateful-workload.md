# Работа со Stateful-нагрузкой

Вы можете использовать группы виртуальных машин для размещения приложений со _Stateful-_, _Stateless-_ и комбинированной нагрузкой.

Отличие Stateful- и Stateless-нагрузки заключается в том, сохраняет ли приложение данные о своих состояниях и/или историю взаимодействия с пользователем:
* Stateful — данные о состоянии сохраняются. Примеры: RESTless-сервисы, базы данных, очереди сообщений, сервера мониторинга и логов.
* Stateless — данные о состоянии не сохраняются. Примеры: RESTful-сервисы, фронтенд веб-приложения.

Состояние приложений может храниться на [дополнительных дисках ВМ группы](#disks) или в [независимых от группы ВМ ресурсах облака](#external-resources).

## Хранение состояния на дисках ВМ группы {#disks}

{% note warning %}

Сохранение состояния на _загрузочных_ дисках ВМ не рекомендуется. Это накладывает существенные ограничения на работу с группой ВМ, например ВМ из такой группы нельзя свободно перезагружать, удалять, пересоздавать и масштабировать.

{% endnote %}

Вы можете сохранять состояние приложений на _дополнительных_ дисках ВМ группы, соблюдая следующие условия:
* Не уменьшайте размер группы.
* Не уменьшайте размер дисков ВМ.
* Используйте в [политике развертывания](./policies/deploy-policy.md) значение параметра `max_expansion` (максимальное количество ВМ, на которое можно превысить целевой размер группы) равное `0`.
* Не удаляйте ВМ через интерфейсы групп ВМ:
  * В [консоли управления]({{ link-console-main }}) на вкладке ![image](../../../_assets/console-icons/layers-3-diagonal.svg) **{{ ui-key.yacloud.compute.instance-groups_hx3kX }}**.
  * Командой [{{ yc-compute-ig }} delete-instances](../../../cli/cli-ref/compute/cli-ref/instance-group/delete-instances.md) CLI.
  * Вызовом gRPC API [InstanceGroupService/DeleteInstances](../../instancegroup/api-ref/grpc/InstanceGroup/deleteInstances.md).
  
  Эти действия удалят дополнительный диск вместе с ВМ. При этом вы можете [удалить](../../operations/vm-control/vm-delete.md) ВМ напрямую в {{ compute-name }}, это не приведет к удалению дополнительного диска.

Если эти условия выполняются, группа ВМ не будет удалять дополнительные диски, даже если понадобится пересоздать какую-то ВМ. Дополнительный диск будет сохранен и подключен к новой ВМ.

## Хранение состояния вне группы ВМ {#external-resources}

Чтобы без ограничений выполнять операции с виртуальными машинами группы, на которых запущены приложения со Stateful-нагрузкой, сохраняйте состояние приложений в независимых от группы ВМ ресурсах облака:
* Управляемые базы данных.
* [Файловые хранилища](../filesystem.md), подробнее см. на странице [{#T}](../../operations/instance-groups/create-with-filesystem.md).
* [Бакеты](../../../storage/concepts/bucket.md) {{ objstorage-full-name }}, подробнее см. на странице [{#T}](../../operations/instance-groups/create-with-bucket.md).
