# Шифрование в {{ compute-name }}


По умолчанию все данные на [дисках](../../compute/concepts/disk.md) {{ compute-name }} шифруются на уровне базы данных хранилища с помощью системного ключа. Это позволяет защитить данные от компрометации в случае физической кражи дисков из дата-центров {{ yandex-cloud }}. Подробнее см. [{#T}](../../security/standarts.md#sec-data).

Рекомендуем также использовать шифрование дисков и [снимков дисков](../../compute/concepts/snapshot.md) с помощью пользовательских [симметричных ключей](../../kms/concepts/key.md) {{ kms-full-name }}. Такой подход позволяет:
* защищаться от потенциальных угроз нарушения изоляции и компрометации данных на уровне виртуальной инфраструктуры;
* контролировать шифрование и жизненный цикл ключей {{ kms-short-name }}, а также управлять ими, см. [{#T}](../../kms/operations/key.md);
* повысить уровень контроля доступа к данным на диске за счет необходимости прав на ключ {{ kms-short-name }}, см. [{#T}](../../kms/operations/key-access.md);
* отслеживать операции шифрования и расшифрования вашим ключом {{ kms-short-name }} с помощью сервиса {{ at-full-name }}, см. [Аудит использования ключей](../../kms/concepts/#keys-audit).


{% include [encryption-preview-note](../../_includes/compute/encryption-preview-note.md) %}

Вы можете зашифровать диски следующих типов:
* Сетевой SSD-диск (`network-ssd`).
* Сетевой HDD-диск (`network-hdd`).
* Нереплицируемый SSD-диск (`network-ssd-nonreplicated`).
* Высокопроизводительный SSD-диск (`network-ssd-io-m3`).

Подробнее см. [Типы дисков](disk.md#disks-types).

Шифрование в {{ compute-name }} доступно с помощью [консоли управления]({{ link-console-main }}).

## Варианты шифрования {#encryption-options}

Варианты создания зашифрованных ресурсов {{ compute-name }}, а также особенности использования ключей {{ kms-short-name }} представлены в таблице:

| **Конечный ресурс** | **Исходный ресурс** | **Ключ** | **Примечание** |
| --- | --- | --- | --- |
| Пустой зашифрованный диск | — | Любой | См. [{#T}](../operations/disk-create/empty.md). |
| Зашифрованный диск | Незашифрованный образ | Любой | См. [{#T}](../operations/disk-create/from-image.md).</br>Также с помощью образа можно</br>зашифровать существующие [диски](../operations/disk-control/disk-encrypt.md) и [снимки](../operations/snapshot-control/snapshot-encrypt.md). |
| Зашифрованный диск | Зашифрованный снимок | Ключ снимка | См. [{#T}](../operations/disk-create/from-snapshot.md). |
| Зашифрованный снимок | Зашифрованный диск | Ключ диска | См. [{#T}](../operations/disk-control/create-snapshot.md). |

Позже в {{ compute-name }} будут реализованы следующие опции для шифрования:

| **Конечный ресурс** | **Исходный ресурс** | **Ключ** | **Примечание** |
| --- | --- | --- | --- |
| Зашифрованный диск | Зашифрованный образ | Ключ образа | См. [{#T}](../operations/disk-create/from-image.md).</br>Также с помощью зашифрованного</br>образа можно сделать копию</br>зашифрованного диска. |
| Зашифрованный диск | Незашифрованный снимок | Любой | См. [{#T}](../operations/disk-create/from-snapshot.md). |
| Зашифрованный образ | Зашифрованный диск | Ключ диска | См. [{#T}](../operations/image-create/create-from-disk.md). |

## Использование пользовательских ключей {#user-keys}

Использование пользовательских ключей {{ kms-short-name }} для шифрования дисков и снимков позволяет гранулярнее контролировать доступ к зашифрованным данным: создавать ключи под конкретного пользователя или задачу, своевременно деактивировать или удалять конкретные ключи.

{% include [encryption-keys-note](../../_includes/compute/encryption-keys-note.md) %}

Чтобы ВМ имела доступ к зашифрованному диску, к ней должен быть привязан [сервисный аккаунт](../../iam/concepts/users/service-accounts.md) c [ролью](../../kms/security/index.md#kms-keys-encrypterDecrypter) `kms.keys.encrypterDecrypter`. Обратите внимание, к ВМ могут быть привязаны два сервисных аккаунта:
*  Для [работы с ресурсами облака](../operations/vm-connect/auth-inside-vm) изнутри ВМ, например для отправки метрик в {{ monitoring-full-name }}, логов в {{ cloud-logging-full-name }} или подключения к {{ backup-full-name }}. Этот сервисный аккаунт указывается в блоке параметров доступа.
*  Для работы с зашифрованными дисками. Этот сервисный аккаунт указывается в блоке параметров дисков.

Чтобы использовать шифрование в {{ compute-name }} у пользователя должны быть следующие роли:
* `iam.serviceAccounts.user` и выше на сервисный аккаунт, который используется для шифрования. Подробнее см. [Роли {{ iam-full-name }}](../../iam/security/index.md#iam-serviceAccounts-user).
* `kms.viewer` и выше на ключ, который используется для шифрования. Подробнее см. [Роли {{ kms-full-name }}](../../kms/security/index.md#kms-viewer).

### См. также {#see-also}

* [{#T}](../../security/domains/encryption.md)
