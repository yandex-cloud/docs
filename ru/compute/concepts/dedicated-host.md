# Выделенный хост

_Выделенный хост_ — физический сервер, предназначенный для размещения исключительно ваших виртуальных машин в {{ yandex-cloud }}. ВМ на выделенных хостах обладают всеми возможностями обычных ВМ и дополнительно получают физическую изоляцию от ВМ других пользователей. Вы также можете разделить свои ВМ для разных проектов:

![Dedicated host](../../_assets/compute/dedicated-host.svg "Dedicated host")

Вы можете создать группу, состоящую из одного или нескольких однотипных выделенных хостов. На каждом выделенном хосте вы можете разместить несколько [ВМ разных конфигураций](vm-platforms.md), что позволит оптимально использовать ресурсы.

Преимущества работы на выделенных хостах:

* Безопасность работы и соответствие требованиям.
  Вы можете использовать выделенный хост для физической изоляции ВМ в публичном облаке, если этого требуют служба информационной безопасности вашей организации или отраслевые стандарты (например, медицинские или финансовые).
* Использование собственных лицензий.
  Если в вашей организации уже есть лицензии Microsoft или других производителей, требующих привязки к физическим ресурсам, вы можете использовать их в {{ yandex-cloud }} по модели <q>Bring your own license</q> (BYOL).
* Управление размещением ВМ.
  Вы можете самостоятельно выбрать, на каком выделенном хосте запустить ВМ, или разрешить {{ compute-name }} сделать это автоматически.

## Типы выделенных хостов {#host-types}

Характеристики выделенного хоста:

Тип | Процессор | Количество</br>процессоров | Ядра | vCPU | RAM, ГБ
--- | --- | --- | ---  | --- | ---
`intel-6230-c66-m454` | [Intel® Xeon® Gold 6230](https://ark.intel.com/content/www/ru/ru/ark/products/192437/intel-xeon-gold-6230-processor-27-5m-cache-2-10-ghz.html) | 2 | 40 | 66* | 454

\* У процессора Intel Xeon Gold 6230 доступно 80 vCPU, однако 14 из них потребляются системой.

{% include [dedicated](../../_includes/compute/dedicated-quota.md) %}

### Фрагментация физических ресурсов хоста {#resource-fragmentation}

На физическом сервере установлено два процессора. Однако не все ядра процессоров доступны для запуска ВМ. Часть ядер выделены для системного потребления.

Например, у выделенного хоста с двумя процессорами Intel® Xeon® Gold 6230 для запуска ВМ доступны 66 vCPU (34 на первом процессоре и 32 на втором). Оставшиеся 14 vCPU (6 + 8) используются системой.

При создании ВМ на выделенном хосте вы можете столкнуться с фрагментацией ресурсов: при наличии необходимого количества свободных vCPU невозможно запустить ВМ. Например, на выделенном хосте с 66 vCPU вы можете запустить только 10 ВМ по 6 vCPU.

![Resource fragmentation](../../_assets/compute/resource-fragmentation.svg "Resource fragmentation")

В этом случае для полной утилизации vCPU выделенного хоста можно запустить две ВМ с 2 и 4 vCPU.

## Политика масштабирования {#scale-policy}

При создании группы хостов необходимо указать количество выделенных хостов. При изменении группы вы можете уменьшить или увеличить количество хостов в группе. Политика масштабирования определяется параметром `ScalePolicy`:

```
yc compute host-group create \
  --fixed-size <количество хостов> \
  ...
```

Ключи:

Ключ | Значение
----- | -----
`fixed-size` | Количество выделенных хостов в группе.

## Политика обслуживания {#maintenance-policy}

{{ compute-name }} останавливает ВМ во время технического обслуживания, и не перемещает их на другие хосты. Дальнейшее поведение ВМ зависит от состояния физического сервера.

Если физический сервер перезагружен, работающие на нем ВМ тоже будут автоматически перезапущены с привязкой:

* К той же группе хостов, если ВМ была привязана к группе. При этом возможна привязка к другому хосту группы.
* К выделенному хосту, если ВМ была привязана к конкретному хосту.
 
 Политика обслуживания задается при создании группы выделенных хостов и определяется параметром `MaintenancePolicy`:
 
 ```
 yc compute host-group create \
   --maintenance-policy restart \
   ...
 ```
 
 Ключи:
 
 Ключ | Значение
 ----- | -----
 `maintenance-policy` | Политика обслуживания.</br> Возможные значения:</br> - `restart` — остановка ВМ на время обслуживания и последующий перезапуск.
 
 Если физический сервер полностью остановлен, {{ compute-name }}:
 
 1. Закрывает доступ к вашему выделенному хосту.
 1. Удаляет физический сервер и его уникальный идентификатор (`server-id`). Идентификаторы группы хостов (`host-group-id`) и каждого выделенного хоста (`host-id`) при этом сохраняются.
 1. Заменяет вышедшее из строя оборудование и присваивает новый идентификатор.
 1. Перемещает ВМ с неисправного оборудования на новое по правилам [привязки ВМ](#bind-vm).

## Привязка ВМ к группе или хосту {#bind-vm}

Чтобы однозначно сопоставить ВМ и физический сервер, вы можете создать ВМ с привязкой:

* К группе выделенных хостов.
  При остановке ВМ она будет недоступна на хостах группы, а при последующем перезапуске может быть привязана к другому хосту из группы.
* К выбранному хосту из группы.
  При остановке ВМ она будет недоступна на хосте, а при последующем перезапуске будет привязана к этому же хосту из группы.

Привязка ВМ гарантирует, что ВМ будет запущена на одном и том же физическом сервере или группе серверов даже после плановых перерывов в работе.

Чтобы переместить ВМ между выделенными хостами, необходимо:
1. [Остановить ВМ](../operations/vm-control/vm-stop-and-start).
1. Привязать ВМ к другому хосту из группы.
1. Перезапустить ВМ.

При создании ВМ вы можете указать несколько групп хостов или конкретных хостов, к которым она может быть привязана. Пример привязки к одной из групп хостов:

```
yc compute instance create \
  --host-group-id 1 или host-group-id 2 \
  --network-interface subnet-name=default-ru-central1-a \
  --zone ru-central1-a
```

В этом случае ВМ будет привязана к одной из указанных групп хостов:

```
done (33s)
id: abcdefghigklm12no3pq
folder_id: a1b23cd45efg6higklmn
created_at: "2020-09-08T20:19:41Z"
zone_id: ru-central1-a
platform_id: standard-v2
resources:
  memory: "2147483648"
  cores: "2"
  core_fraction: "100"
host-group-id: 2
...
```

## Тарификация {#billing}

Тарифы на использование выделенных хостов описаны на странице [{#T}](../pricing.md#prices-dedicated-host).