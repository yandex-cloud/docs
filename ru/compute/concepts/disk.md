# Диски

_Диск_ — это виртуальный аналог физических накопителей, таких как SSD и HDD.

Диски предназначены для хранения данных и подключаются к виртуальным машинам для работы с ними. При отключении диска данные сохраняются.

Каждый диск находится в одной из зон доступности и [реплицируется](#backup) внутри нее, что обеспечивает сохранность данных. В другие зоны диски не реплицируются.

## Диск как ресурс Яндекс.Облака {#disk-as-resource}

Диск создается внутри каталога и наследует права доступа к нему.

Диск занимает место в хранилище, которое дополнительно оплачивается. Подробнее читайте в разделе [{#T}](../pricing.md). Размер диска указывается при создании нового диска. Именно этот объем подлежит оплате.

Если диск создан из снимка или из образа, в информации о диске содержится идентификатор ресурса-источника. Помимо этого от ресурса-источника наследуется идентификаторы лицензий (`product_ids`), которые используются при расчете стоимости использования диска.

## Типы дисков {#disks_types}

Виртуальные машины в Яндекс.Облаке могут использовать следующие типы дисков:

- Сетевой SSD-диск (`network-ssd`) — быстрый сетевой диск, сетевое блочное хранилище на SSD-накопителе. 
- Сетевой HDD-диск (`network-hdd`) — стандартный сетевой диск, сетевое блочное хранилище на HDD-накопителе.

Сетевые диски обеспечивают достаточную избыточность для надежного хранения данных и позволяют непрерывно выполнять операции чтения и записи даже при одновременном выходе из строя нескольких физических дисков.

Если физический диск вышел из строя, виртуальная машина продолжит работу и быстро получит доступ к данным в полном объеме.

Сетевые диски уступают локальным в скорости выполнения операций и пропускной способности, но обеспечивают большую надежность и бесперебойность работы виртуальных машин.

## Подключение и отключение дисков {#attach-detach}

Каждый диск можно подключить только к одной виртуальной машине. Диск и виртуальная машина должны находиться в одной зоне доступности.

К виртуальной машине необходимо подключить загрузочный диск, а также можно подключить дополнительные диски.

{% include [attach-empty-disk](../_includes_service/attach-empty-disk.md) %}

При выборе диска для подключении к виртуальной машине можно указать, должен ли быть удален диск при удалении виртуальной машины. Это можно выбрать как при создании виртуальной машины, при изменении и при подключении нового диска к ней.

Если к виртуальной машине были подключены ранее созданные диски, то при удалении виртуальной машины они будут отключены. Данные на диске при этом сохраняются, в дальнейшем можно подключить диск к другой виртуальной машине.

Если вы хотите, чтобы диск был удален вместе с виртуальной машиной, это необходимо указать в одной из операций: при создании виртуальной машины, при изменении или при подключении диска к ней. Такие диски будут удалены при удалении виртуальной машины.

**Смотрите также**

- Узнайте, как [{#T}](../operations/vm-control/vm-attach-disk.md).
- Узнайте, как [{#T}](../operations/vm-control/vm-detach-disk.md).

## Резервное копирование {#backup}

Каждый диск доступен и реплицируется внутри определенной зоны доступности.

Вы можете создавать резервные копии дисков в виде [снимков](snapshot.md). Снимки реплицируются во всех зонах доступности, поэтому их также можно использовать чтобы переносить диски между зонами доступности.

Иногда восстановление определенного состояния диска становится рутинной операцией: например, вы хотите подключать один и тот же загрузочный диск к каждой новой виртуальной машине. Вы можете загрузить [образ](image.md) этого диска в {{ compute-name }} — создание диска из образа происходит быстрее, чем из снимка. Образ диска тоже автоматически реплицируется в несколько зон доступности.

Рекомендации о резервном копировании и восстановлении виртуальных машин в целом приведены в разделе [{#T}](backups.md). 

## Операции чтения и записи {#rw}

Операции чтения и записи имеют ограничения для дисков и блоков размещения. Блок размещения (allocation unit) — единица выделения дискового пространства, в ГБ. Величина блока размещения зависит от [типа диска](../concepts/limits.md#limits-disks).

Операции чтения и записи имеют предельные возможные значения по следующим параметрам:

* Максимальное значение IOPS — максимальное количество операций чтения и записи, выполняемых диском в секунду.
* Максимальная пропускная способность (bandwidth) — суммарное количество байт, которые можно прочитать с диска или записать на диск в секунду.

Фактическое значение IOPS зависит как от характеристик диска, так и от совокупного значения пропускной способности и размера запроса в байтах. IOPS, обеспечиваемый диском, определяется по формуле:

![image](../../_assets/compute/iops.svg)

Где:

* _Макс. IOPS_ — [максимальное значение IOPS](../concepts/limits.md#limits-disks) для диска.
* _Макс. bandwith_ — [максимальное значение пропускной способности](../concepts/limits.md#limits-disks) для диска.

Операции чтения и записи потребляют один и тот же дисковый ресурс — чем больше производится операций чтения, тем меньше операций записи, и наоборот. Суммарное количество операций и чтения, и записи в секунду определяется по формуле:

![image](../../_assets/compute/max-iops.svg)

Где:

* ![image](../../_assets/compute/alpha.svg) — доля операций записи из общего количества операций чтения и записи, выполняемых в секунду. Возможные значения — ![image](../../_assets/compute/range.svg).
* _WriteIOPS_ — значение IOPS на запись, полученное по формуле расчета фактического значения IOPS.
* _ReadIOPS_ — значение IOPS на чтение, полученное по формуле расчета фактического значения IOPS.

Подробнее про максимально допустимые значения IOPS и пропускной способности читайте в разделе [Квоты и лимиты](../concepts/limits.md#limits-disks).

### Производительность дисков {#performance}

Чтобы получить максимальные значения IOPS, рекомендуется делать чтения и записи, не превышающие 4 КБ. Сетевые SSD-диски предоставляют существенно большие значения IOPS на чтение, а также меньшие значения времени обработки запроса.

Чтобы получить максимальные значения пропускной способности, рекомендуется делать чтения и записи размером 4 МБ.

Производительность диска зависит от его объема — чем выше количество блоков размещения, тем выше значения IOPS и пропускной способности.

Для HDD-дисков небольшого размера предусмотрен механизм увеличения характеристик до уровня дисков размером 1 ТБ на период повышенной нагрузки. Работая на [базовом уровне производительности](../concepts/limits.md#limits-disks) в течение 12 часов, небольшой диск накапливает "кредиты на операции", которые будут потрачены автоматически при увеличении нагрузки (например, при старте виртуальной машины). Небольшие HDD-диски могут работать с увеличенными характеристиками около 30 минут в день. "Кредиты на операции" могут быть потрачены как за один раз, так и небольшими промежутками.
