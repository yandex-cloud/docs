---

__system: {"dislikeVariants":["Нет ответа на мой вопрос","Рекомендации не помогли","Содержание не соответствует заголовку","Другое"]}
---
# Восстановление доступа к виртуальной машине

Восстановление доступа к виртуальной машине может понадобиться, если:
* [{#T}](#cloud-init).
* [{#T}](#serial-console).
* [{#T}](#os-recovery).

## Утрачены учетные данные пользователя виртуальной машины {#cloud-init}

Если вы утратили закрытый ключ SSH для Linux или пароль пользователя Windows:
1. [Создайте снимок](../disk-control/create-snapshot.md) диска ВМ, доступ к которой нужно восстановить.
1. [Создайте ВМ с диском из снимка](../disk-control/create-snapshot.md), указав этот диск в качестве загрузочного. При создании ВМ в блоке **Доступ** укажите новые учетные данные для входа.
1. Подключитесь к ВМ по SSH или RDP используя новые учетные данные.

Если для ВМ была изменена конфигурация 'cloud-init' или сети, то описанный способ может не сработать. В этом случае смотрите раздел [{#T}](#os-recovery).

## Невозможно подключиться по SSH или RDP {#serial-console}

Проблема может возникнуть из-за ошибки в настройках SSH, RDP, [групп безопасности](../../../vpc/concepts/security-groups.md) или сети. Для восстановления доступа подключитесь к ВМ с помощью [серийной консоли](../serial-console/index.md) и сделайте необходимые исправления.

{% list tabs %}

- Linux

  {% note info %}

  Вы можете воспользоваться серийной консолью, только если был установлен пароль пользователя. Иначе смотрите раздел [{#T}](#os-recovery).

  {% endnote %}

  1. [Включите доступ](../serial-console/index.md#turn-on-for-current-instance) к серийной консоли ВМ.
  1. [Подключитесь](../serial-console/connect-cli.md#connect-to-serial-console) к серийной консоли.
  1. Измените настройки SSH или сети. Если настроены [группы безопасности](../../../vpc/concepts/security-groups.md), проверьте, чтобы в правилах был разрешен входящий трафик по протоколу TCP на порт 22.
  1. Подключитесь к ВМ через SSH.

- Windows

  1. [Включите доступ](../serial-console/index.md#turn-on-for-current-instance) к серийной консоли ВМ.
  1. [Подключитесь](../serial-console/connect-cli.md#connect-to-serial-console) к серийной консоли.
  1. Измените настройки RDP или сети. Если настроены [группы безопасности](../../../vpc/concepts/security-groups.md), проверьте, чтобы в правилах был разрешен входящий трафик по протоколу TCP на порт 3389.
  1. Подключитесь к ВМ через RDP.

{% endlist %}

## Не загружается виртуальная машина {#os-recovery}

Если ВМ не загружается, получите доступ к данным диска следующим образом:
1. [Создайте снимок](../disk-control/create-snapshot.md) диска ВМ, доступ к которой нужно восстановить.
1. [Создайте диск](../disk-create/empty.md) из снимка. При создании диска в поле **Наполнение** выберите `Снимок` и укажите созданный снимок.
1. [Подключите диск](../vm-control/vm-attach-disk.md) в качестве дополнительного к вспомогательной ВМ.
1. Измените конфигурационные файлы, влияющие на загрузку ВМ или скопируйте важные данные.
1. [Отключите диск](../vm-control/vm-detach-disk.md) от вспомогательной ВМ.
1. Если вы обнаружили и устранили проблему загрузки, создайте новую ВМ. При создании в блоке **Выбор образа/загрузочного диска** укажите `Пользовательские` и выберите исправленный диск в качестве загрузочного.