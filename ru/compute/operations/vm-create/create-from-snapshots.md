# Создать виртуальную машину с дисками из снимков

Вы можете создать виртуальную машину с дисками, восстановленными из имеющихся в каталоге снимков. О том, как создать снимок диска, см. раздел [{#T}](../disk-control/create-snapshot.md).

{% list tabs %}

- Консоль управления

  Чтобы создать виртуальную машину:
  1. В [консоли управления]({{ link-console-main }}) выберите каталог, в котором будет создана виртуальная машина.
  1. В списке сервисов выберите **{{ compute-name }}**.
  1. Нажмите кнопку **Создать ВМ**.
  1. В блоке **Базовые параметры**:
      * Введите имя и описание ВМ. Требования к имени:

          {% include [name-format](../../../_includes/name-format.md) %}

          {% include [name-fqdn](../../../_includes/compute/name-fqdn.md) %}

      * Выберите [зону доступности](../../../overview/concepts/geo-scope.md), в которой будет находиться виртуальная машина.

  1. В блоке **Выбор образа/загрузочного диска** выберите один из снимков:
     * Перейдите на вкладку **Пользовательские** и нажмите **Выбрать**.
     * В открывшемся окне перейдите на вкладку **Снимок**.
     * Выберите снимок диска из списка и нажмите **Применить**.

  1. В блоке **Диски и файловые хранилища** [добавьте диск](./create-from-disks.md):
      * Нажмите кнопку **Добавить диск**.
      * Введите имя диска.
      * Выберите [тип диска](../../concepts/disk.md#disks_types).
      * Укажите нужный размер блока.
      * Укажите нужный размер диска.
      * (опционально) Включите опцию **Удалять вместе с ВМ**, если нужно автоматически удалять диск при удалении ВМ, к которой он будет подключен.
      * Выберите наполнение `Снимок`.
      * Выберите нужный снимок в списке.
      * Нажмите кнопку **Добавить**.


  1. (опционально) В блоке **Диски и файловые хранилища** на вкладке **Файловые хранилища** подключите [файловое хранилище](../../concepts/filesystem.md):
     
     * Нажмите кнопку **Подключить файловое хранилище**.
     * В открывшемся окне выберите файловое хранилище.
     * Введите имя устройства.
     * Нажмите кнопку **Подключить файловое хранилище**.
 

  1. В блоке **Вычислительные ресурсы**:
      * Выберите [платформу](../../concepts/vm-platforms.md).
      * Укажите [гарантированную долю](../../../compute/concepts/performance-levels.md) и необходимое количество vCPU, а также объем RAM.
      * При необходимости сделайте виртуальную машину [прерываемой](../../concepts/preemptible-vm.md).
      * (опционально) Включите [программно-ускоренную сеть](../../concepts/software-accelerated-network.md).

  1. В блоке **Сетевые настройки**:

      {% include [network-settings](../../../_includes/compute/network-settings.md) %}

    1. {% include [backup-info](../../../_includes/compute/backup-info.md) %}

  1. В блоке **Доступ** укажите данные для доступа на виртуальную машину:
      * (опционально) Выберите или создайте [сервисный аккаунт](../../../iam/concepts/users/service-accounts.md). Использование сервисного аккаунта позволяет гибко настраивать права доступа к ресурсам.
      * В поле **Логин** введите имя пользователя.

          {% note alert %}

          Не используйте логин `root` или другие имена, зарезервированные операционной системой. Для выполнения операций, требующих прав суперпользователя, используйте команду `sudo`.

          {% endnote %}

      * В поле **SSH-ключ** вставьте содержимое файла [открытого ключа](../../operations/vm-connect/ssh.md#creating-ssh-keys).
      * Если требуется, разрешите доступ к [серийной консоли](../../operations/serial-console/index.md).

  1. Нажмите кнопку **Создать ВМ**. 
  
  Виртуальная машина появится в списке. При создании виртуальной машине назначаются [IP-адрес](../../../vpc/concepts/address.md) и [имя хоста](../../../vpc/concepts/address.md#fqdn) (FQDN).

- CLI

  {% include [cli-install](../../../_includes/cli-install.md) %}

  {% include [default-catalogue](../../../_includes/default-catalogue.md) %}

  1. Посмотрите описание команды CLI для создания виртуальной машины:

      ```
      yc compute instance create --help
      ```

  1. Подготовьте снимки нужных дисков, см. раздел [{#T}](../disk-control/create-snapshot.md).
  1. Получите список снимков в каталоге по умолчанию:

      {% include [compute-snapshot-list](../../_includes_service/compute-snapshot-list.md) %}

  1. Выберите идентификатор (`ID`) или имя (`NAME`) нужных снимков.
  1. Создайте виртуальную машину в каталоге по умолчанию:

      ```
      yc compute instance create \
        --name first-instance \
        --zone {{ region-id }}-a \
        --public-ip \
        --create-boot-disk snapshot-name=first-snapshot \
        --create-disk snapshot-name=second-snapshot \
        --ssh-key ~/.ssh/id_ed25519.pub
      ```

      Данная команда создаст виртуальную машину именем `first-instance` в зоне `{{ region-id }}-a`, с публичным IP и дисками из снимков.

      {% include [name-fqdn](../../../_includes/compute/name-fqdn.md) %}
     
      Чтобы создать виртуальную машину без публичного IP, исключите флаг `--public-ip`.

 
- API

  Воспользуйтесь методом REST API [create](../../api-ref/Instance/create.md) для ресурса [Instance](../../api-ref/Instance/) или вызовом gRPC API [InstanceService/Create](../../api-ref/grpc/instance_service.md#Create).

{% endlist %}
