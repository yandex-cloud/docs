# Создание навыка Алисы

В качестве примера будет создан навык <q>Попугай</q>, который повторяет все, что ему написал или сказал пользователь. Пример реализован на двух языках программирования: Python и Node.js.

Чтобы добавить навык Алисы на основе [функции](../concepts/function.md):
1. [Подготовьте код навыка](#prepare-code).
1. [Создайте функцию](#create-function).
1. [Создайте версию функции](#create-version). 
1. [Подготовьте ссылку на функцию](#link).
1. [Добавьте ссылку на функцию в навык Алисы](#add-link).
1. [Протестируйте работу навыка](#test).

Подробнее о [разработке навыка Алисы](https://yandex.ru/dev/dialogs/alice/doc/development-docpage/#test__dev-cycle).

## 1. Подготовьте код для навыка Алисы {#prepare-code}

Обратите внимание, что файл с кодом функции необходимо добавить в ZIP-архив. Это один из [способов загрузки кода в сервис](../concepts/function.md) {{ sf-short-name }}.

{% list tabs %}

- Python

    1. Скачайте с GitHub файл с примером: [parrot.py](https://github.com/yandex-cloud/examples/blob/master/serverless/functions/alice/python/parrot/parrot.py).
    1. Создайте ZIP-архив `parrot-py.zip` с файлом `parrot.py`.

- Node.js

    1. Скачайте с GitHub файл с примером: [index.js](https://github.com/yandex-cloud/examples/blob/master/serverless/functions/alice/nodejs/parrot/index.js).
    1. Создайте ZIP-архив `parrot-js.zip` с файлом `index.js`.

{% endlist %}

## 2. Создайте функцию {#create-function}

{% note important %}

Для вызова функции необходимо назначить пользователю соответствующие права доступа. Права доступа назначаются на каталог. Узнайте как это сделать в разделе [{#T}](../operations/function/function-public.md).

{% endnote %}

После создания функция будет содержать только информацию о себе: имя, описание, уникальный идентификатор и т. д. Непосредственно код навыка будет добавлен в функцию на шаге [создания версии](#create-version).

1. В [консоли управления]({{ link-console-main }}) выберите каталог, в котором будет создана функция.
1. Нажмите кнопку **Создать ресурс**.
1. Выберите **Функция**.
1. Введите имя функции.

    {% include [name-format](../../_includes/name-format.md) %}

1. Нажмите кнопку **Создать**.

## 3. Создайте версию функции {#create-version}

Выберите язык программирования и создайте [версию функции](../concepts/function.md#version).

{% list tabs %}

- Python

  1. В [консоли управления]({{ link-console-main }}) откройте **Serverless Functions** в каталоге, где вы хотите создать версию функции.
  1. Выберите функцию, для которой необходимо создать версию.
  1. В разделе **Последняя версия** нажмите кнопку **Создать в редакторе**.
  1. Задайте параметры версии:
      - **Среда выполнения:** `python37`.
      - **Таймаут, секунды:** 2.
      - **Память:** 128 МБ.
      - **Сервисный аккаунт:** Не выбрано.
  1. Подготовьте код функции:
      - **Способ:** ZIP-архив.
      - **Файл:** `parrot-py.zip`.
      - **Точка входа:** `parrot.handler`.
  1. Нажмите кнопку **Создать версию**.

- Node.js

  1. В [консоли управления]({{ link-console-main }}) откройте **Serverless Functions** в каталоге, где вы хотите создать версию функции.
  1. Выберите функцию, для которой необходимо создать версию.
  1. В разделе **Последняя версия** нажмите кнопку **Создать в редакторе**.
  1. Задайте параметры версии:
      - **Среда выполнения:** `nodejs10`.
      - **Таймаут, секунды:** 2.
      - **Память:** 128 МБ.
      - **Сервисный аккаунт:** Не выбрано.
  1. Подготовьте код функции:
      - **Способ:** ZIP-архив.
      - **Файл:** `parrot-js.zip`.
      - **Точка входа:** `index.handler`.
  1. Нажмите кнопку **Создать версию**.

{% endlist %}

## 4. Подготовьте ссылку на функцию {#link}

{% note important %}

Для корректного вызова функции ссылка должна содержать параметр строки запроса: `integration=raw`. Если его не указать, функция будет вызвана в роли обработчика HTTP-запроса, что требует определенной структуры данных запроса к функции и ответа функции. Подробнее об этом в разделе [{#T}](../concepts/function-invoke.md).

{% endnote %}

Скопируйте ссылку из описания функции и добавьте необходимый параметр:
1. В [консоли управления]({{ link-console-main }}) откройте **Serverless Functions** в каталоге, где была создана функция для навыка.
1. Выберите соответствующую функцию.
1. На странице **Обзор** из раздела **Общая информация** скопируйте ссылку из поля **Ссылка для вызова**.
1. Добавьте в ссылку параметр строки запроса: `integration=raw`:
    
    ```
    https://functions.yandexcloud.net/d4eu6mm0t6cci8jrccp7?integration=raw
    ```

## 5. Добавьте ссылку на функцию в навык Алисы {#add-link}

1. Перейдите на страницу навыка Алисы в [личном кабинете](https://dialogs.yandex.ru/developer/). 
1. Откройте вкладку **Настройки**.
1. В поле **Webhook URL** добавьте ссылку на функцию, полученную на [шаге 4](#link).
1. Нажмите кнопку **Сохранить** внизу страницы и сохраните изменения.

## 6. Протестируйте работу навыка {#test}

1. Откройте вкладку **Тестирование** на странице навыка в [личном кабинете](https://dialogs.yandex.ru/developer/).
1. Если все настроено правильно, в разделе **Чат** будет сообщение с приглашением начать беседу: `Hello! I'll repeat anything you say to me.`. 
1. Отправьте сообщение с любым текстом и убедитесь, что вам пришел ответ с таким же содержанием.
