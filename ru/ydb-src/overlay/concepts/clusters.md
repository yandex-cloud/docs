В разделе описаны кластеры YDB, развёрнутые в Яндексе. Описаны различия в характеристиках кластеров, даны базовые рекомендации по выбору кластера для решения задачи.

## Кластеры

Кластеры YDB можно разделить по нескольким признакам: по модели доступности (однодатацентровые и геораспределённые), по назначению (продакшн и тестовые) а также по местоположению.

### Геораспределённые кластеры

В настоящий момент пользователям внутри Яндекса доступны три геораспределённых кластера:

* ydb-ru – кластер, развёрнутый в трёх датацентрах MYT-SAS-VLA, предназначенный для создания production баз данных;
* ydb-ru-prestable – кластер, развёрнутый в трёх датацентрах MYT-SAS-VLA, предназначенный для тестирования приложений со свежими версиями YDB;
* ydb-eu – кластер, развёрнутый в трёх датацентрах MAN-SAS-VLA, предназначенный для создания production баз данных в особых случаях, подробнее описанных ниже.

Базы данных, развёрнутые в геораспредённом кластере позволяют переживать полную недоступность одного из трёх датацентров и одной из стоек в оставшихся двух датацентрах. Во время выключения датацентра в течение непродолжительного времени (десятки секунд) приложения, работающие с базой, будут получать ошибки в ответ на часть запросов. После завершения переходных процессов, вызванных отказом датацентра, база данных продолжит работать с характеристиками, наблюдавшимися до отключения датацентра.

В геораспределёных кластерах данные хранятся в трёх копиях. Вычислительные ресурсы выделяются с запасом, достаточным, для работы в рамках модели доступности. Запас позволяет предотвратить ухудшение времени выполнения запросов и снижение пропускной способности базы данных, вызванные недостатком вычислительных ресурсов при отключении одного датацентра.

**YDB-RU**

Геораспределённый кластер, развёрнутый в трёх датацентрах MYT-SAS-VLA, доступный за балансером `ydb-ru.yandex.net` – это основной кластер, рекомендованный для запуска production баз данных.

**YDB-RU-PRESTABLE**

Геораспределённый кластер, развёрнутый в трёх датацентрах MYT-SAS-VLA, доступный за балансером `ydb-ru-prestable.yandex.net` – это prestable кластер. Основное назначение кластера – проверять отсутствие регрессий в работе приложений при обновлении кластера на свежую версию YDB. Также кластер используется для тестовых и разработческих баз данных.


{% note info "Зеркалирование нагрузки" %}

Для каждой production базы на ydb-ru рекомендуется создавать prestable базу на кластере ydb-ru-prestable и настраивать зеркалирование части production нагрузки. Если зеркалирование невозможно, целесообразно организовать проведение регулярных нагрузочных испытаний.

{% endnote %}

Как правило, на кластере работают версии YDB, установленные и проверенные на других тестовых, prestable и production кластерах.

**YDB-EU**

Геораспределённый кластер, развёрнутый в трёх датацентрах MAN-SAS-VLA, доступный за балансером `ydb-eu.yandex.net` – это production кластер. Данный кластер подходит для единственного сценария:

* чтения выполняются из одного шарда по ключу, в результате допустимо получать потенциально непротиворечивые (eventually consistent) данные;
* допустимы задержки до 1 секунды в высоких (99.9) персентилях для остальных категорий запросов;
* приложению требуются низкие задержки при обработке читающих запросов, отправленых из датацентра MAN.

### Однодатацентровые кластеры

Сейчас пользователям внутри Яндекса недоступны однодатацентровые кластеры.

## Кластеры в Яндекс.Облаке

Сервисы Яндекса.Облака проходят обязательную сертификацию на соответствие требованиям стандартов ISO-270x, PCI DSS и требованиям [ФЗ-152 "О персональных данных"](https://storage.yandexcloud.net/yc-compliance/conformance_ru_pdp.pdf). Чтобы обеспечить соответствие требованиям, кластеры сервисов Яндекс.Облака отделены от кластеров для других проектов.

### Геораспределённые кластеры

Для задач Яндекс.Облака развёрнуты два геораспределённых кластера:

* global – используется для хранения метаданных сервисов Яндекс.Облака;
* public – предназначен для создания баз YDB пользователями Яндекс.Облака в рамках предоставления услуги Yandex Database as a Service.

{% note info "Публичный доступ к Yandex Database" %}

Подробнее о публичном доступе к YDB в Яндекс.Облаке можно прочитать в [документации](https://cloud.yandex.ru/docs/ydb/).

{% endnote %}

### Однодатацентровые кластеры

В каждой [зоне доступности](https://cloud.yandex.ru/docs/overview/concepts/geo-scope) Яндекс.Облака развёрнут однодатацентровый кластер, используемый для хранения данных [сетевых дисков](https://cloud.yandex.ru/docs/compute/concepts/disk), размещённых в соответствующей зоне доступности.
