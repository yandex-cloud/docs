## 3/11/2023: CVE-2023-5043 NGINX Ingress Controller for Kubernetes vulnerabilities {#CVE-2023-5043}

CVE IDs: CVE-2023-5043, CVE-2023-5044, CVE-2022-4886

CVE links:

<https://nvd.nist.gov/vuln/detail/CVE-2023-5043>
<https://nvd.nist.gov/vuln/detail/CVE-2023-5044>
<https://nvd.nist.gov/vuln/detail/CVE-2022-4886>

### Original report {#original-report}

<https://github.com/kubernetes/ingress-nginx/issues/10571>
<https://github.com/kubernetes/ingress-nginx/issues/10572>
<https://github.com/kubernetes/ingress-nginx/issues/10570>

### Summary {#brief-description}

The first two vulnerabilities, CVE-2023-5043 and CVE-2023-5044, are related to insufficiently checking input data, which may lead to adding malicious code, taking control of privileged credentials, and stealing all cluster's secrets. Both issues have 7.60/10 vulnerability score as per the CVSS.

The CVE-2022-4886 vulnerability has higher score, 8.80 as per the CVSS. This issue can be exploited when creating or updating Ingress objects. The attackers may get access to the Kubernetes API credentials from Ingress Controller and, consequently, steal all cluster's secrets. This vulnerability affects version 1.8.0 and lower.

### Technologies affected {#technologies-affected}

NGINX

### Vulnerable products and versions {#vulnerable-products-and-versions}

NGINX: Up to version 1.9.0

### Recommendations for vulnerability detection and additional materials {#recommendations-for-vulnerability-detection}

Here is what we recommend in order to avoid exploiting these vulnerabilities:

1. Update NGINX Ingress Controller to 1.9.0; this version has annotation validation, while the custom snippets are disabled by default.

1. Add the `--enable-annotation-validation` argument to the controller startup options.

1. Add the `strict-validate-path-type` option to `Configmap`.

1. Use a policy engine, such as [Kyverno](https://yandex.cloud/en/marketplace/products/yc/kyverno), to validate the paths used in the Ingress rules. You can find [this ready-to-use policy](https://kyverno.io/policies/nginx-ingress/restrict-ingress-paths/restrict-ingress-paths/) on the Kyverno website.

### Safe version of vulnerable product or patch {#safe-version}

The vulnerability has been fixed as of version 1.9.0.

### How it impacts {{ yandex-cloud }} services {#impact-on-yandex-cloud-services}

These vulnerabilities are irrelevant when using {{ yandex-cloud }} ALB Ingress Controller, as it is based on different technologies and does not have any annotations or settings that may lead to such vulnerabilities.
