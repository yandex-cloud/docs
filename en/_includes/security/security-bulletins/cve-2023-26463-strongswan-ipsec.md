## 13/04/2023 — CVE-2023-26463 — StrongSwan IPsec — Incorrectly Accepted Untrusted Public Key With Incorrect Refcount {#CVE-2023-26463}

CVE ID: CVE-2023-26463

Link to CVE: <https://cve.mitre.org/cgi-bin/cvename.cgi?name=2023-26463>

### Original report {#original-report}

<https://www.strongswan.org/blog/2023/03/02/strongswan-vulnerability-(cve-2023-26463).html>

### Summary {#brief-description}

The TLS implementation in `libtls` incorrectly treats the public key from the peer's certificate as trusted, even if the certificate cannot be verified successfully. However, the public key does not have the correct reference count either, which then causes a dereference of an expired pointer. This commonly leads to a segmentation fault and a denial of service; however, the information exposure or code execution might still be possible.

An attacker is able to trigger this issue by sending a self-signed (or otherwise untrusted) certificate to a server that authenticates clients with a TLS-based EAP method, such as EAP-TLS. Clients may be similarly vulnerable to attackers that send them a request for such an EAP method followed by an untrusted server certificate. Affected versions: StrongSwan 5.9.8 and 5.9.9.

### Technologies affected {#technologies-affected}

StrongSwan IPsec

### Vulnerable products and versions {#vulnerable-products-and-versions}

StrongSwan IPsec prior to 5.9.10

### Vendor {#vendor}

StrongSwan IPsec

### Attack vector and severity level per CVSS v.3.0 {#attack-vector-and-severity-level}

Not rated as of 29/03/2023.

### Recommendations for vulnerability detection and supporting materials {#recommendations-for-vulnerability-detection}

* <https://www.strongswan.org/blog/2023/03/02/strongswan-vulnerability-(cve-2023-26463).html>
* <https://www.opennet.ru/opennews/art.shtml?num=58736>

Servers that do not load plugins that implement TLS-based EAP methods (EAP-TLS, EAP-TTLS, EAP-PEAP, or EAP-TNC) are not vulnerable. If these plugins are loaded, they must not be used as a remote authentication method. You should not use the `eap-dynamic` plugin either, since it allows clients to choose their preferred EAP method. Servers that use TLS-based methods via the `eap-radius` plugin and only configure that as a remote authentication method are also not vulnerable.

### Safe version of vulnerable product or patch {#safe-version}

StrongSwan IPsec starting with version 5.9.10.

### Impact on {{ yandex-cloud }} services {#impact-on-yandex-cloud-services}

The [StrongSwan IPsec image](/marketplace/products/yc/ipsec-instance-ubuntu) in {{ marketplace-full-name }} is not vulnerable according to <https://ubuntu.com/security/CVE-2023-26463>. If you are using a custom image on your VMs and it is vulnerable, we recommend that you update it on your own.
