## 03/07/2023: CVE-2023-27491 Envoy forwards invalid HTTP/2 and HTTP/3 downstream headers {#CVE-2023-27491}

CVE ID: CVE-2023-27491

Link to CVE: <https://nvd.nist.gov/vuln/detail/CVE-2023-27491>

### Original report {#original-report}

<https://github.com/envoyproxy/envoy/security/advisories/GHSA-5jmv-cw9p-f9rp>

### Summary {#brief-description}

HTTP/1 compatible service must reject incorrectly generated request lines. Prior to versions 1.26.0, 1.25.3, 1.24.4, 1.23.6, and 1.22.9, invalid HTTP/1 service might allow incorrect requests to be executed, which could help attackers bypass security policies.

### Technologies affected {#technologies-affected}

Envoy

### Vulnerable products and versions {#vulnerable-products-and-versions}

Envoy versions prior to 1.26.0, 1.25.3, 1.24.4, 1.23.6, and 1.22.9.

### Vendor {#vendor}

Envoy

### Attack vector and severity level per CVSS v.3.0 {#attack-vector-and-severity-level}

CVSS score: 9.1. Attack vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N

### Recommendations for vulnerability detection and supporting materials {#recommendations-for-vulnerability-detection}

Update to the latest version.

* <https://datatracker.ietf.org/doc/html/rfc9113#section-8.3>
* <https://datatracker.ietf.org/doc/html/rfc9114#section-4.3.1>
* <https://github.com/envoyproxy/envoy/security/advisories/GHSA-5jmv-cw9p-f9rp>
* <https://www.rfc-editor.org/rfc/rfc9110#section-5.6.2>

### Safe version of vulnerable product or patch {#safe-version}

Vulnerability resolved in versions 1.26.0, 1.25.3, 1.24.4, 1.23.6, and 1.22.9.

### Impact on {{ yandex-cloud }} services {#impact-on-yandex-cloud-services}

We updated the component used in our services to the latest version. If you are using a custom image on your VMs and it is vulnerable, we recommend that you update it on your own.