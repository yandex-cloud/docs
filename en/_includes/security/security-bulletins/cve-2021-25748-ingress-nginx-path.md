## 15/06/2022: CVE-2021-25748: Ingress-nginx. Path sanitization bypass {#CVE-2021-25748}

CVE ID: CVE-2021-25748

Link to CVE: <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-25748>

### Original report

<https://discuss.kubernetes.io/t/security-advisory-cve-2021-25748-ingress-nginx-path-sanitization-can-be-bypassed-with-newline-character/20280>

### Brief description

The user can bypass sanitization of the `spec.rules[].http.paths[].path` field of an ingress object (in the networking.k8s.io or extensions API group) by using a newline character in the field value to obtain the credentials of the ingress-nginx controller. In the default configuration, that credential has access to all secrets in the cluster.

### Involved technologies

* Kubernetes
* Nginx

### Affected products and versions

ingress-nginx < v1.2.1

### Vendor

NGINX ingress controller

### Attack vector and severity level according to CVSS v.3.0

CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:L

### Recommendations for vulnerability detection and supporting materials

<https://discuss.kubernetes.io/t/security-advisory-cve-2021-25748-ingress-nginx-path-sanitization-can-be-bypassed-with-newline-character/20280>

### Safe version of the vulnerable product or patch

ingress-nginx v1.2.1

### Compensatory measures for {{ yandex-cloud }} users

If you are using ingress-nginx controller in {{ managed-k8s-full-name }} or self-hosted Kubernetes and are unable to roll out the fix, use a policy that restricts the `spec.rules[].http.paths[].path` field of the networking.k8s.io/Ingress resource to safe characters (see the newly added [rules](https://github.com/kubernetes/ingress-nginx/blame/main/internal/ingress/inspector/rules.go) and the suggested values for [annotation-value-word-blocklist](https://kubernetes.github.io/ingress-nginx/user-guide/nginx-configuration/configmap/#annotation-value-word-blocklist)).

### Impact on {{ yandex-cloud }} services

There is no impact on {{ yandex-cloud }} services, since the infrastructure does not use ingress-nginx. The [alb-ingress controller](../../../application-load-balancer/tools/k8s-ingress-controller/index.md) is used instead.
