## 15.06.2022: CVE-2021-25748: Ingress-nginx path sanitization can be bypassed with newline character {#CVE-2021-25748}

CVE ID: CVE-2021-25748

Link to CVE: <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-25748>

### Original report

<https://discuss.kubernetes.io/t/security-advisory-cve-2021-25748-ingress-nginx-path-sanitization-can-be-bypassed-with-newline-character/20280>

### Short description

A security issue was discovered in ingress-nginx where a user that can create or update Ingress objects can use a newline character to bypass the sanitization of the `spec.rules[].http.paths[].path` field of an Ingress object (in the [networking.k8s.io](http://networking.k8s.io) or extensions API group) to obtain the credentials of the ingress-nginx controller. In the default configuration, that credential has access to all secrets in the cluster.

### Technology

* Kubernetes
* Nginx

### Name and versions of affected software or hardware

ingress-nginx < v1.2.1

### Developer/manufacturer (vendor) of vulnerable software or hardware

NGINX ingress controller

### Base vector and severity level of the vulnerability according to CVSS v.3.0

CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:L

### Procedure for checking the vulnerability and supporting materials (PoC code, video demonstration or others)

<https://discuss.kubernetes.io/t/security-advisory-cve-2021-25748-ingress-nginx-path-sanitization-can-be-bypassed-with-newline-character/20280>

### Update or patch version

ingress-nginx v1.2.1

### Compensatory measures, fixes for {{ yandex-cloud }} users

If you are using ingress-nginx controller in your {{ managed-k8s-full-name }} or self-hosted Kubernetes and unable to roll out the fix, this vulnerability can be mitigated by implementing an admission policy that restricts the `spec.rules[].http.paths[].path` field on the networking.k8s.io/Ingress resource to known safe characters (see the newly added [rules](https://github.com/kubernetes/ingress-nginx/blame/main/internal/ingress/inspector/rules.go), or the suggested value for [annotation-value-word-blocklist](https://kubernetes.github.io/ingress-nginx/user-guide/nginx-configuration/configmap/#annotation-value-word-blocklist)).

### Are {{ yandex-cloud }} services affected?

There is no impact on {{ yandex-cloud }} services, since the internal components do not use ingress-nginx, but our own [alb-ingress controller](../../../application-load-balancer/tools/k8s-ingress-controller/index.md).
