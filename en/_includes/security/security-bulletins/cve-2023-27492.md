## 03/07/2023: CVE-2023-27492 Crash when a large request body is processed in Lua filter {#CVE--2023-27492}

CVE ID: CVE-2023-27492

Link to CVE: <https://nvd.nist.gov/vuln/detail/CVE-2023-27492>

### Original report {#original-report}

<https://github.com/envoyproxy/envoy/security/advisories/GHSA-wpc2-2jp6-ppg2>

### Summary {#brief-description}

Prior to versions 1.26.0, 1.25.3, 1.24.4, 1.23.6, and 1.22.9, the Lua filter was vulnerable to denial of service. Attackers can send large request bodies for routes with the Lua filter enabled and trigger crashes. As of versions 1.26.0, 1.25.3, 1.24.4, 1.23.6, and 1.22.9, Envoy no longer invokes the Lua coroutine if the filter has been reset.

### Technologies affected {#technologies-affected}

Envoy

### Vulnerable products and versions {#vulnerable-products-and-versions}

Envoy versions prior to 1.26.0, 1.25.3, 1.24.4, 1.23.6, and 1.22.9.

### Vendor {#vendor}

Envoy

### Attack vector and severity level per CVSS v.3.0 {#attack-vector-and-severity-level}

CVSS score: 6.5. Attack vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H

### Recommendations for vulnerability detection and supporting materials {#recommendations-for-vulnerability-detection}

Update to the latest version.

<https://github.com/envoyproxy/envoy/security/advisories/GHSA-wpc2-2jp6-ppg2>

### Safe version of vulnerable product or patch {#safe-version}

Vulnerability resolved in versions 1.26.0, 1.25.3, 1.24.4, 1.23.6, and 1.22.9.

### Impact on {{ yandex-cloud }} services {#impact-on-yandex-cloud-services}

We updated the component used in our services to the latest version. If you are using a custom image on your VMs and it is vulnerable, we recommend that you update it on your own.