## 28/02/2022: CVE-2022-0735 (token disclosure), CVE-2022-0549, CVE-2022-0751, CVE-2022-0741, CVE-2021-4191, CVE-2022-0738, CVE-2022-0489: Multiple GitLab vulnerabilities {#multiple-GitLab-vulnerabilities}

### Description

GitLab Inc. published an overview of a number of vulnerabilities in their [article](https://about.gitlab.com/releases/2022/02/25/critical-security-release-gitlab-14-8-2-released/).

#### CVE-2022-0735
The most severe vulnerability is [CVE-2022-0735](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-0735) "Runner registration token disclosure through Quick Actions".

It affects the following versions:

* All versions from 12.10 to 14.6.5 inclusive.
* All versions from 14.7 to 14.7.4 inclusive.
* All versions from 14.8 to 14.8.2 inclusive.

Other vulnerabilities are less critical.

#### CVE-2022-0549

CVE-2022-0549 "Unprivileged users can add other users to groups through an API endpoint" is a medium severity issue.

It affects the following versions:

* All versions from 14.4 to 14.4.4 inclusive.
* All versions from 14.5 to 14.5.2 inclusive.

#### CVE-2022-0751

CVE-2022-0751 "Inaccurate display of Snippet contents can be potentially misleading to users" is a medium severity issue.

#### CVE-2022-0741

CVE-2022-0741 "Environment variables can be leaked via the sendmail delivery method" is a medium severity issue.

#### CVE-2021-4191

CVE-2021-4191 "Unauthenticated user enumeration on GraphQL API" is a medium severity issue and applies to all versions from 14.4 to 14.8 inclusive.

#### CVE-2022-0738

CVE-2022-0738 "Adding a pull mirror with SSH credentials can leak password" is a medium severity issue.

It affects the following versions:

* All versions from 14.6 to 14.6.5 inclusive.
* All versions from 14.7 to 14.7.4 inclusive.
* All versions from 14.8 to 14.8.2 inclusive.

#### CVE-2022-0489

CVE-2022-0489 "Denial of Service via user comments" is a minor severity issue and can affect all new versions starting from 8.15.

#### Links

For more information about vulnerabilities, see the [original GitLab report](https://about.gitlab.com/releases/2022/02/25/critical-security-release-gitlab-14-8-2-released/).

Description of vulnerabilities:

* [CVE-2022-0735](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-0735)
* [CVE-2022-0549](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-0549)
* [CVE-2022-0751](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-0751)
* [CVE-2022-0741](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-0741)
* [CVE-2021-4191](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-4191)
* [CVE-2022-0738](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-0738)
* [CVE-2022-0489](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-0489)

### Impact on {{ yandex-cloud }} services

#### {{ compute-full-name }}

A GitLab image for {{ compute-full-name }} in {{ marketplace-full-name }} was updated to the latest version.

All {{ compute-full-name }} users who have used GitLab images from {{ marketplace-name }} or their own images are potentially vulnerable. These users need to reinstall the system from the current {{ marketplace-name }} image or upgrade their GitLab version to the latest one by following the [official instructions](https://about.gitlab.com/releases/2022/02/25/critical-security-release-gitlab-14-8-2-released/).
If you can't upgrade the GitLab version, take compensatory measures.

Notifications with update recommendations were sent to all users who are using a deprecated GitLab image from {{ marketplace-name }}.

#### {{ mgl-full-name }}

For users of {{ mgl-name }}, which is now being tested in {{ yandex-cloud }}, we already updated current and upcoming instances to the latest version.

All {{ mgl-full-name }} users have been sent notification.

### Compensatory measures {#multiple-GitLab-vulnerabilities-compensatory measures}

If you can't update now, you can temporarily fix the vulnerability using the [hotpatch](https://about.gitlab.com/releases/2022/02/25/critical-security-release-gitlab-14-8-2-released/#hotpatch-for-runner-registration-token-disclosure-through-quick-actions).
