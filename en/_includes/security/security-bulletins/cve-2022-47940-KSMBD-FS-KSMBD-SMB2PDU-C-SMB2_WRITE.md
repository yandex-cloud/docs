## 26.12.2022 — CVE-2022-47940 — KSMBD FS/KSMBD/SMB2PDU.C SMB2_WRITE {#CVE-2022-47940}

CVE ID: CVE-2022-47940

Link to CVE: <https://ubuntu.com/security/CVE-2022-47940>

### Original report {#original-report}

<https://ubuntu.com/security/CVE-2022-47940>

### Summary {#brief-description}

This vulnerability allows remote attackers to disclose sensitive information on affected installations of Linux Kernel. Authentication is required to exploit this vulnerability. The specific flaw exists within the handling of SMB2_WRITE commands. The issue results from the lack of proper validation of user-supplied data, which can result in a read past the end of an allocated buffer. An attacker can leverage this in conjunction with other vulnerabilities to execute arbitrary code in the context of the kernel. To be vulnerable, needs ksmbd-tools installed to enable the ksmbd service, which is not installed by default.

### Technologies affected {#technologies-affected}

Linux Kernel.

### Vulnerable products and versions {#vulnerable-products-and-versions}

Linux Kernel up to 5.18.17
ksmbd-tools

### Vendor {#vendor}

ksmbd-tools

### Attack vector and severity level per CVSS v.3.0 {#attack-vector-and-severity-level}

Severity level: 4.1

### Recommendations for vulnerability detection and supporting materials {#recommendations-for-vulnerability-detection}

<https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=158a66b245739e15858de42c0ba60fcf3de9b8e6>

### Safe version of vulnerable product or patch {#safe-version}

The vulnerability is fixed as of Linux Kernel version 5.18.18.

### Impact on {{ yandex-cloud }} services {#impact-on-yandex-cloud-services}

The vulnerable component is not present among loaded modules and installed components in cloud services.

If you are using vulnerable OS images from Marketplace in {{ compute-full-name }}, you have to update them to secure versions yourself.
