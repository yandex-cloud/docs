## 28.01.2022: CVE-2022-0185: Heap overflow bug in legacy_parse_param {#CVE-2022-0185}

### Description

Vulnerability [CVE-2022-0185](https://ubuntu.com/security/CVE-2022-0185) is found in Linux kernel versions from 5.1-rc1, in the file system context functionality. An attacker may use this to cause a denial of service (system crash), execute arbitrary code, and go out of container bounds.

For a detailed description of the vulnerability, see this [article](https://sysdig.com/blog/cve-2022-0185-container-escape/).

Vulnerability description: [CVE-2022-0185](https://ubuntu.com/security/CVE-2022-0185).

CVSS rating: 7.8.

### Impact

#### General impact

Linux Kernel systems around the world, starting from kernel version 5.1-rc1, are vulnerable.

#### Impact on {{ yandex-cloud }} services

The following measures are being taken to mitigate the vulnerability in {{ yandex-cloud }} services:

* {{ marketplace-full-name }};
* {{ managed-k8s-full-name }};
* In the {{ yandex-cloud }} internal infrastructure.

An update to this bulletin will be rolled out based on the outcome of the final activities.

### Compensatory measures

If you're using Linux images from {{ marketplace-full-name }} and k8s node groups in {{ managed-k8s-full-name }}, apply the official update as soon as it is available.

Before that, take the following compensatory measures:

* Use a [daemonset fix](https://github.com/yandex-cloud/yc-solution-library-for-security/tree/master/kubernetes-security/cve-quickfix/CVE-2022-0185) for this vulnerability from the Yc-solution-library-for-security. It sets the settings according to Ubuntu recommendations.
* Follow the official update or vulnerability compensation guidelines for your Linux distribution. For example, set `sysctl -w kernel.unprivileged_userns_clone=0` for Ubuntu.
* Use seccomp in Kubernetes as described in this [article](https://kubernetes.io/docs/tutorials/security/seccomp/).
* Do not assign redundant capabilities and use the [k8s security section](../../../security/domains/checklist.md#kubernetes-secure-configuration) from our checklist for monitoring them.

