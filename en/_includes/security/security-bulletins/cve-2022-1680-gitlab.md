## 22.06.2022: CVE-2022-1680: Critical Account Takeover Vulnerability in GitLab {#CVE-2022-1680}

CVE ID: CVE-2022-1680

Link to CVE: <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1680>

### Original report

<https://about.gitlab.com/releases/2022/06/01/critical-security-release-gitlab-15-0-1-released/>

### Short description

When group SAML SSO is configured, the SCIM feature (available only on Premium+ subscriptions) may allow any owner of a Premium group to invite arbitrary users through their username and email, then change those users' email addresses via SCIM to an attacker controlled email address and thus — in the absence of 2FA — take over those accounts.
Having achieved this, a malicious actor can also change the display name and username of the targeted account.

### Technology

Gitlab

### Name and versions of affected software or hardware

Affects all versions of GitLab Enterprise Edition (EE) starting from 11.10 before 14.9.5, all versions starting from 14.10 before 14.10.4, and all versions starting from 15.0 before 15.0.1.

### Developer/manufacturer (vendor) of vulnerable software or hardware

GitLab Inc.

### Base vector and severity level of the vulnerability according to CVSS v.3.0

Severity level: 9.9

### Procedure for checking the vulnerability and supporting materials (PoC code, video demonstration or others)

Self-managed administrators can check whether `group_saml` is enabled by reviewing <https://docs.gitlab.com/ee/integration/saml.html#configuring-group-saml-on-a-self-managed-gitlab-instance>

### Update or patch version

15.0.1, 14.10.4 and 14.9.5.

### Compensatory measures, fixes for {{ yandex-cloud }} users

* {{ compute-full-name }}

    The GitLab image for {{ compute-full-name }} in {{ marketplace-full-name }} has been updated to the latest version.

    All {{ compute-full-name }} users who use outdated GitLab images from {{ marketplace-full-name }} or their own images of outdated versions are potentially exposed to the vulnerability.

    Update to the latest release.

* {{ mgl-full-name }}

    For {{ mgl-full-name }} (preview stage) users we have already updated existing and future instances to the current version.
