## 18.03.2022: CVE-2022-0811: cr8escape {#CVE-2022-0811}

### Description

On March 15 CrowdStrike security researchers discovered a new vulnerability in the Kubernetes container engine CRI-O. The vulnerability allows an attacker who is able to run pods in a Kubernetes cluster to escape from the Kubernetes container and gain root privileges on the host and be able to move anywhere in the cluster.

An attacker is able to abuse sysctl functionality introduced in CRI-O v1.19. The functionality allows to set kernel.core_pattern variable from PodSpec and then trigger execution of a malicious script with root privileges.

Original report: [article](https://www.crowdstrike.com/blog/cr8escape-new-vulnerability-discovered-in-cri-o-container-engine-cve-2022-0811/).

Vulnerability description: [CVE-2022-0811](https://nvd.nist.gov/vuln/detail/CVE-2022-0811).

### Impact on {{ yandex-cloud }} services

{{ managed-k8s-name }} is not affected by the issue as CRI-O is not allowed for usage there.

### Compensatory measures

Patch:

* Update to CRI-O v1.23.2.
* Downgrade to CRI-O v1.18 or lower.

Additional mitigation:

1. Security policy which blocks symbols "+" or "=" in sysctl values.
2. PodSecurityPolicy [forbiddenSysctls(]https://kubernetes.io/docs/concepts/policy/pod-security-policy/#sysctl) which blocks all sysctl usage.