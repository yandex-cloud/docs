## 18.03.2022: CVE-2022-0811: cr8escape {#CVE-2022-0811}

### Description

CrowdStrike security researchers discovered a new vulnerability in the CRI-O container engine that can be used in Kubernetes. It can be exploited by an attacker with rights to deploy a pod to escape a container, gain root privileges, and move anywhere in the cluster.

The issue is that, starting from CRI-O 1.19, the sysctl system parameters can be overridden, for example, by abusing kernel.core_pattern to escape a container.

Original report: [article](https://www.crowdstrike.com/blog/cr8escape-new-vulnerability-discovered-in-cri-o-container-engine-cve-2022-0811/).

Vulnerability description: [CVE-2022-0811](https://nvd.nist.gov/vuln/detail/CVE-2022-0811).

### Impact on {{ yandex-cloud }} services

There is no impact, since CRI-O is not used in {{ managed-k8s-name }}.

### Compensatory measures

If you're using Kubernetes as a custom bare metal installation rather than within {{ managed-k8s-name }}:

* Update the CRI-O to version 1.23.2.
* If there is no patch with updates for your OS, roll back the CRI-O version to 1.18 or lower.
* If you can't change the CRI-O version:

   1. Apply the policy that disallows"+" or "=" in sysctl values.
   2. PodSecurityPolicy [forbiddenSysctls](https://kubernetes.io/docs/concepts/policy/pod-security-policy/#sysctl) to forbid any sysctl.
