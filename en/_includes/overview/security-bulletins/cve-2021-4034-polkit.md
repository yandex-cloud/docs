## 28.01.2022: CVE-2021-4034: Polkit's pkexec {#cve-2021-4034}

### Description

Vulnerability [CVE-2021-4034](https://ubuntu.com/security/notices/USN-5252-1) is found in all versions of Unix-like operating systems. The PolicyKit pkexec tool incorrectly handles command-line arguments. An attacker may use this pkexec behavior to escalate privileges to an administrator.

For a detailed description of the vulnerability, see this [article](https://www.openwall.com/lists/oss-security/2022/01/25/11).

Vulnerability description: [CVE-2021-4034](https://ubuntu.com/security/notices/USN-5252-1).

CVSS rating: 7.8.

### Impact

#### General impact

All Unix-like operating systems are vulnerable.

#### Impact on {{ yandex-cloud }} services

The following measures are being taken to mitigate the vulnerability in {{ yandex-cloud }} services:

* {{ marketplace-full-name }};
* {{ managed-k8s-full-name }};
* In the {{ yandex-cloud }} internal infrastructure.

An update to this bulletin will be rolled out based on the outcome of the final activities.

### Compensatory measures

If you're using Unix-like OS images from {{ marketplace-full-name }} and k8s node groups in {{ managed-k8s-full-name }}, apply the official update as soon as it is available.

Before that, take the following compensatory measures:

* Use a [daemonset fix](https://github.com/yandex-cloud/yc-solution-library-for-security/tree/master/kubernetes-security/cve-quickfix/CVE-2021-4034) for this vulnerability from the Yc-solution-library-for-security. It sets the settings according to Ubuntu recommendations.

* Follow the official update or vulnerability compensation guidelines for images from {{ marketplace-full-name }} or your own images in {{ compute-full-name }}. For example, set access rights for Ubuntu: `chmod 0755 /usr/bin/pkexec`.

